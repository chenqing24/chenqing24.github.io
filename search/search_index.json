{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u9996\u9875 \u6587\u7ae0\u4e00\u89c8 2023-11-16 Seafile \u5f00\u6e90\u7f51\u76d8 2022-11-29 NVM node\u7248\u672c\u7ba1\u7406\u5de5\u5177 2022-03-02 Jenkins\u5b9e\u7528\u624b\u518c 2022-1-25 Gitlab\u4ee3\u7801\u7248\u672c\u7ba1\u7406 2022-1-18 ossftp\u5b58\u50a8\u670d\u52a1 2021-12-31 Tmux\u7b80\u4ecb 2021-12-30 Supervisord \u540e\u53f0\u8fdb\u7a0b\u7ba1\u7406 2021-12-23 \u76d1\u63a7\u4f53\u7cfb\u6982\u8981 2021-11-29 \u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u8c03\u7814 2021-11-15 KubeSphere \u5bb9\u5668\u5e73\u53f0 2021-10-25 \u65e0\u5934CMS - Strapi 2021-10-16 Casbin \u8bbf\u95ee\u63a7\u5236\u6846\u67b6 \u57fa\u4e8eAPI\u7f51\u5173\u7684\u7528\u6237\u6743\u9650\u7ba1\u7406\u670d\u52a1 2021-10-8 \u817e\u8baf\u84dd\u9cb8CMDB 2021-9-6 Jsonlogic \u7b80\u5355\u65b9\u4fbf\u7684\u89c4\u5219\u5f15\u64ce \u91cd\u6784\u4e86\u9996\u9875\u7d22\u5f15\uff0c\u57fa\u4e8e\u7b80\u5355\u7684\u65f6\u5e8fchange log 2021-9-3 \u57fa\u4e8eConfd\u7684\u4e00\u79cd\u672c\u5730\u914d\u7f6e\u670d\u52a1\u65b9\u6848 \u53cb\u60c5\u94fe\u63a5 \u738b\u6960\u535a\u5ba2 : \u535a\u4e3b\u524d\u540c\u4e8b\uff0c\u9ad8\u7ea7\u8fd0\u7ef4\u5f00\u53d1\u5de5\u7a0b\u5e08\u7684\u6280\u672f\u535a\u5ba2","title":"\u9996\u9875"},{"location":"#_1","text":"","title":"\u9996\u9875"},{"location":"#_2","text":"2023-11-16 Seafile \u5f00\u6e90\u7f51\u76d8 2022-11-29 NVM node\u7248\u672c\u7ba1\u7406\u5de5\u5177 2022-03-02 Jenkins\u5b9e\u7528\u624b\u518c 2022-1-25 Gitlab\u4ee3\u7801\u7248\u672c\u7ba1\u7406 2022-1-18 ossftp\u5b58\u50a8\u670d\u52a1 2021-12-31 Tmux\u7b80\u4ecb 2021-12-30 Supervisord \u540e\u53f0\u8fdb\u7a0b\u7ba1\u7406 2021-12-23 \u76d1\u63a7\u4f53\u7cfb\u6982\u8981 2021-11-29 \u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u8c03\u7814 2021-11-15 KubeSphere \u5bb9\u5668\u5e73\u53f0 2021-10-25 \u65e0\u5934CMS - Strapi 2021-10-16 Casbin \u8bbf\u95ee\u63a7\u5236\u6846\u67b6 \u57fa\u4e8eAPI\u7f51\u5173\u7684\u7528\u6237\u6743\u9650\u7ba1\u7406\u670d\u52a1 2021-10-8 \u817e\u8baf\u84dd\u9cb8CMDB 2021-9-6 Jsonlogic \u7b80\u5355\u65b9\u4fbf\u7684\u89c4\u5219\u5f15\u64ce \u91cd\u6784\u4e86\u9996\u9875\u7d22\u5f15\uff0c\u57fa\u4e8e\u7b80\u5355\u7684\u65f6\u5e8fchange log 2021-9-3 \u57fa\u4e8eConfd\u7684\u4e00\u79cd\u672c\u5730\u914d\u7f6e\u670d\u52a1\u65b9\u6848","title":"\u6587\u7ae0\u4e00\u89c8"},{"location":"#_3","text":"\u738b\u6960\u535a\u5ba2 : \u535a\u4e3b\u524d\u540c\u4e8b\uff0c\u9ad8\u7ea7\u8fd0\u7ef4\u5f00\u53d1\u5de5\u7a0b\u5e08\u7684\u6280\u672f\u535a\u5ba2","title":"\u53cb\u60c5\u94fe\u63a5"},{"location":"aboutme/","text":"\u5173\u4e8e\u535a\u4e3b \u81ea\u6211\u4ecb\u7ecd \u7814\u53d1\u7ecf\u9a8c15\u5e74+\uff0c\u5e26\u56e2\u961f10\u5e74+\uff0c\u4f9d\u65e7\u662f\u559c\u6b22\u51b2\u5728\u4e00\u7ebf\u6572\u4ee3\u7801\uff0c\u7528\u6280\u672f\u89e3\u51b3\u4e1a\u52a1\u96be\u9898 \u6280\u672f\u6808\u4eceJava\u8f6c\u5411Python\uff08Oracle\u5b9e\u65bd\u5c01\u95ed\u6218\u7565\u540e\uff09\uff0c\u5565\u90fd\u80fd\u641e\u4e00\u70b9\uff0c\u6700\u8fd1\u8ff7\u4e0a\u6570\u636e\u6316\u6398 \u67b6\u6784\uff0cDevOps\uff0c\u5168\u6808 \u7b90\u601d\u6570\u79d1 \u521b\u59cb\u4eba\uff0c\u81f4\u529b\u4e8e\u63a8\u5e7f\u91cf\u5316\u4ea4\u6613\uff0c\u5e2e\u52a9\u666e\u901a\u4eba\u5b9e\u73b0\u8d22\u52a1\u81ea\u7531 \u505a\u8fc7\u7684 \u7b90\u601d\u79d1\u6280\u521b\u4e1a\u4e2d \u5353\u76df\u79d1\u6280\u7684\u8fd0\u7ef4\u67b6\u6784\uff0c\u57fa\u4e8eChatGPT\uff0c\u5b9e\u73b0\u4e07\u4eba\u7ea7\u522b\u7684\u667a\u80fd\u6e38\u620f\u5ba2\u670d \u540c\u7a0b\u65d7\u4e0b\u7684\u4e92\u91d1\u516c\u53f8\uff0c\u4ece0.5\u523010\uff08\u5982\u679c\u963f\u91cc\u4e91\u662f100\u7684\u8bdd\uff09\u5b9e\u73b0\u6574\u4e2a\u81ea\u52a8\u5316\u8fd0\u7ef4\u4f53\u7cfb \u5728\u4e0a\u6d77\u7231\u5947\u827a\uff08\u539fPPS\uff09\u7684\u4e91\u8ba1\u7b97\u90e8\u95e8\u5f00\u53d1\u8fc72\u4ee3CMDB\uff0c\u6709\u4e13\u5229 \u548c\u539f\u90e8\u95e8\u8001\u5927\u5728\u5b89\u5fbd\u9a6c\u978d\u5c71\u521b\u4e1a\uff0c\u5404\u79cd\u56fd\u5185\u9879\u76ee\uff0c\u5982\u4e8b\u4e1a\u5355\u4f4dOA\u3001\u533a\u653f\u5e9c\u7535\u5b50\u653f\u52a1\u7b49\uff0c\u6700\u8fdc\u5230\u8fc7 \u65b0\u7586\u5e93\u8f66\u53bf \u5b9e\u65bd\u9879\u76ee\u4e0a\u7ebf \u65e5\u672c\u5916\u5305\uff08NEC\u3001\u5927\u962a\u533b\u9662\u7b49\uff09\uff0c\u5916\u6d3e\u4e1c\u4eac\u591a\u6b21 \u8054\u7cfb\u65b9\u5f0f Mail to: chenqing24(AT)163.com","title":"\u5173\u4e8e\u535a\u4e3b"},{"location":"aboutme/#_1","text":"","title":"\u5173\u4e8e\u535a\u4e3b"},{"location":"aboutme/#_2","text":"\u7814\u53d1\u7ecf\u9a8c15\u5e74+\uff0c\u5e26\u56e2\u961f10\u5e74+\uff0c\u4f9d\u65e7\u662f\u559c\u6b22\u51b2\u5728\u4e00\u7ebf\u6572\u4ee3\u7801\uff0c\u7528\u6280\u672f\u89e3\u51b3\u4e1a\u52a1\u96be\u9898 \u6280\u672f\u6808\u4eceJava\u8f6c\u5411Python\uff08Oracle\u5b9e\u65bd\u5c01\u95ed\u6218\u7565\u540e\uff09\uff0c\u5565\u90fd\u80fd\u641e\u4e00\u70b9\uff0c\u6700\u8fd1\u8ff7\u4e0a\u6570\u636e\u6316\u6398 \u67b6\u6784\uff0cDevOps\uff0c\u5168\u6808 \u7b90\u601d\u6570\u79d1 \u521b\u59cb\u4eba\uff0c\u81f4\u529b\u4e8e\u63a8\u5e7f\u91cf\u5316\u4ea4\u6613\uff0c\u5e2e\u52a9\u666e\u901a\u4eba\u5b9e\u73b0\u8d22\u52a1\u81ea\u7531","title":"\u81ea\u6211\u4ecb\u7ecd"},{"location":"aboutme/#_3","text":"\u7b90\u601d\u79d1\u6280\u521b\u4e1a\u4e2d \u5353\u76df\u79d1\u6280\u7684\u8fd0\u7ef4\u67b6\u6784\uff0c\u57fa\u4e8eChatGPT\uff0c\u5b9e\u73b0\u4e07\u4eba\u7ea7\u522b\u7684\u667a\u80fd\u6e38\u620f\u5ba2\u670d \u540c\u7a0b\u65d7\u4e0b\u7684\u4e92\u91d1\u516c\u53f8\uff0c\u4ece0.5\u523010\uff08\u5982\u679c\u963f\u91cc\u4e91\u662f100\u7684\u8bdd\uff09\u5b9e\u73b0\u6574\u4e2a\u81ea\u52a8\u5316\u8fd0\u7ef4\u4f53\u7cfb \u5728\u4e0a\u6d77\u7231\u5947\u827a\uff08\u539fPPS\uff09\u7684\u4e91\u8ba1\u7b97\u90e8\u95e8\u5f00\u53d1\u8fc72\u4ee3CMDB\uff0c\u6709\u4e13\u5229 \u548c\u539f\u90e8\u95e8\u8001\u5927\u5728\u5b89\u5fbd\u9a6c\u978d\u5c71\u521b\u4e1a\uff0c\u5404\u79cd\u56fd\u5185\u9879\u76ee\uff0c\u5982\u4e8b\u4e1a\u5355\u4f4dOA\u3001\u533a\u653f\u5e9c\u7535\u5b50\u653f\u52a1\u7b49\uff0c\u6700\u8fdc\u5230\u8fc7 \u65b0\u7586\u5e93\u8f66\u53bf \u5b9e\u65bd\u9879\u76ee\u4e0a\u7ebf \u65e5\u672c\u5916\u5305\uff08NEC\u3001\u5927\u962a\u533b\u9662\u7b49\uff09\uff0c\u5916\u6d3e\u4e1c\u4eac\u591a\u6b21","title":"\u505a\u8fc7\u7684"},{"location":"aboutme/#_4","text":"Mail to: chenqing24(AT)163.com","title":"\u8054\u7cfb\u65b9\u5f0f"},{"location":"tech_tutorial/gitbook/","text":"GitBook \u53c2\u8003 \u5b98\u65b9GitHub https://github.com/GitbookIO/gitbook","title":"GitBook"},{"location":"tech_tutorial/gitbook/#gitbook","text":"","title":"GitBook"},{"location":"tech_tutorial/gitbook/#_1","text":"\u5b98\u65b9GitHub https://github.com/GitbookIO/gitbook","title":"\u53c2\u8003"},{"location":"tech_tutorial/markdown/","text":"Markdown\u5e38\u7528\u8bed\u6cd5 Markdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for Syntax highlighted code block # Header 1 ## Header 2 ### Header 3 - Bulleted - List 1. Numbered 2. List **Bold** and _Italic_ and `Code` text [Link](url) and ![Image](src) For more details see GitHub Flavored Markdown . Jekyll Themes Your Pages site will use the layout and styles from the Jekyll theme you have selected in your repository settings . The name of this theme is saved in the Jekyll _config.yml configuration file. Support or Contact Having trouble with Pages? Check out our documentation or contact support and we\u2019ll help you sort it out.","title":"Markdown\u5e38\u7528\u8bed\u6cd5"},{"location":"tech_tutorial/markdown/#markdown","text":"Markdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for Syntax highlighted code block # Header 1 ## Header 2 ### Header 3 - Bulleted - List 1. Numbered 2. List **Bold** and _Italic_ and `Code` text [Link](url) and ![Image](src) For more details see GitHub Flavored Markdown .","title":"Markdown\u5e38\u7528\u8bed\u6cd5"},{"location":"tech_tutorial/markdown/#jekyll-themes","text":"Your Pages site will use the layout and styles from the Jekyll theme you have selected in your repository settings . The name of this theme is saved in the Jekyll _config.yml configuration file.","title":"Jekyll Themes"},{"location":"tech_tutorial/markdown/#support-or-contact","text":"Having trouble with Pages? Check out our documentation or contact support and we\u2019ll help you sort it out.","title":"Support or Contact"},{"location":"tech_tutorial/mkdocs/","text":"MkDocs \u9759\u6001\u7f51\u7ad9\u751f\u6210 For full documentation visit mkdocs.org . \u5b89\u88c5 cd yourwebsite virtualenv -p python3 ENV source ENV/bin/activate pip install mkdocs Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"MkDocs \u9759\u6001\u7f51\u7ad9\u751f\u6210"},{"location":"tech_tutorial/mkdocs/#mkdocs","text":"For full documentation visit mkdocs.org .","title":"MkDocs \u9759\u6001\u7f51\u7ad9\u751f\u6210"},{"location":"tech_tutorial/mkdocs/#_1","text":"cd yourwebsite virtualenv -p python3 ENV source ENV/bin/activate pip install mkdocs","title":"\u5b89\u88c5"},{"location":"tech_tutorial/mkdocs/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"tech_tutorial/mkdocs/#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"tech_tutorial/svn/","text":"SVN \u7248\u672c\u7ba1\u7406 \u5e38\u7528\u547d\u4ee4 \u68c0\u51fa\u9879\u76ee svn checkout http://IP:Port/svn/docs/<\u9879\u76ee\u8def\u5f84>/ --username=<\u7528\u6237\u540d> \u6dfb\u52a0\u6587\u4ef6 svn add <\u6587\u4ef6|\u76ee\u5f55> \u63d0\u4ea4\u8fdc\u7aef\u670d\u52a1\u5668 svn commit -m 'commit msg' \u53c2\u8003 SVN \u6559\u7a0b|\u83dc\u9e1f\u6559\u7a0b","title":"SVN \u7248\u672c\u7ba1\u7406"},{"location":"tech_tutorial/svn/#svn","text":"","title":"SVN \u7248\u672c\u7ba1\u7406"},{"location":"tech_tutorial/svn/#_1","text":"\u68c0\u51fa\u9879\u76ee svn checkout http://IP:Port/svn/docs/<\u9879\u76ee\u8def\u5f84>/ --username=<\u7528\u6237\u540d> \u6dfb\u52a0\u6587\u4ef6 svn add <\u6587\u4ef6|\u76ee\u5f55> \u63d0\u4ea4\u8fdc\u7aef\u670d\u52a1\u5668 svn commit -m 'commit msg'","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"tech_tutorial/svn/#_2","text":"SVN \u6559\u7a0b|\u83dc\u9e1f\u6559\u7a0b","title":"\u53c2\u8003"},{"location":"tech_tutorial/yapi/","text":"YApi \u53ef\u89c6\u5316\u63a5\u53e3\u7ba1\u7406\u5e73\u53f0 \u4e3a\u5f00\u53d1\u3001\u4ea7\u54c1\u3001\u6d4b\u8bd5\u4eba\u5458\u63d0\u4f9b\u66f4\u4f18\u96c5\u7684\u63a5\u53e3\u7ba1\u7406\u670d\u52a1\u3002\u53ef\u4ee5\u5e2e\u52a9\u5f00\u53d1\u8005\u8f7b\u677e\u521b\u5efa\u3001\u53d1\u5e03\u3001\u7ef4\u62a4 API \u53c2\u8003 \u5b98\u7f51 https://hellosean1025.github.io/yapi/ \u6e90\u7801 https://github.com/YMFE/yapi \u5b89\u88c5 # \u4e0b\u8f7d\u6e90\u7801\u5305\uff0c\u5e76\u6784\u5efa wget -O yapi.zip https://github.com/YMFE/yapi/archive/v1.9.2.zip docker build -t yapi .","title":"YApi \u53ef\u89c6\u5316\u63a5\u53e3\u7ba1\u7406\u5e73\u53f0"},{"location":"tech_tutorial/yapi/#yapi","text":"\u4e3a\u5f00\u53d1\u3001\u4ea7\u54c1\u3001\u6d4b\u8bd5\u4eba\u5458\u63d0\u4f9b\u66f4\u4f18\u96c5\u7684\u63a5\u53e3\u7ba1\u7406\u670d\u52a1\u3002\u53ef\u4ee5\u5e2e\u52a9\u5f00\u53d1\u8005\u8f7b\u677e\u521b\u5efa\u3001\u53d1\u5e03\u3001\u7ef4\u62a4 API","title":"YApi \u53ef\u89c6\u5316\u63a5\u53e3\u7ba1\u7406\u5e73\u53f0"},{"location":"tech_tutorial/yapi/#_1","text":"\u5b98\u7f51 https://hellosean1025.github.io/yapi/ \u6e90\u7801 https://github.com/YMFE/yapi","title":"\u53c2\u8003"},{"location":"tech_tutorial/yapi/#_2","text":"# \u4e0b\u8f7d\u6e90\u7801\u5305\uff0c\u5e76\u6784\u5efa wget -O yapi.zip https://github.com/YMFE/yapi/archive/v1.9.2.zip docker build -t yapi .","title":"\u5b89\u88c5"},{"location":"tech_tutorial/DB/adminer/","text":"Adminer \u5355php\u7684db\u7ba1\u7406\u7cfb\u7edf \u4f7f\u7528 # \u4e0b\u8f7d\uff0c\u6ce8\u610f\u5b98\u65b9\u662f https://github.com/vrana/adminer/releases/download/\uff0chub.fastgit.org\u662f\u56fd\u4eba\u7ffb\u5899\u52a0\u901f\u670d\u52a1 wget 'https://hub.fastgit.org/vrana/adminer/releases/download/v4.8.1/adminer-4.8.1-en.php' # \u72ec\u7acb\u542f\u52a8\u524d\u63d0\uff0c\u5b89\u88c5php php -S 0.0.0.0:8111 adminer-4.8.1-en.php \u5b9e\u9645\u6548\u679c \u53c2\u8003 \u5b98\u7f51 https://www.adminer.org/en/ \u65e0\u5bc6\u7801\u8bbf\u95eesqlite3 https://github.com/FrancoisCapon/LoginToASqlite3DatabaseWithoutCredentialsWithAdminer","title":"Adminer \u5355php\u7684db\u7ba1\u7406\u7cfb\u7edf"},{"location":"tech_tutorial/DB/adminer/#adminer-phpdb","text":"","title":"Adminer \u5355php\u7684db\u7ba1\u7406\u7cfb\u7edf"},{"location":"tech_tutorial/DB/adminer/#_1","text":"# \u4e0b\u8f7d\uff0c\u6ce8\u610f\u5b98\u65b9\u662f https://github.com/vrana/adminer/releases/download/\uff0chub.fastgit.org\u662f\u56fd\u4eba\u7ffb\u5899\u52a0\u901f\u670d\u52a1 wget 'https://hub.fastgit.org/vrana/adminer/releases/download/v4.8.1/adminer-4.8.1-en.php' # \u72ec\u7acb\u542f\u52a8\u524d\u63d0\uff0c\u5b89\u88c5php php -S 0.0.0.0:8111 adminer-4.8.1-en.php \u5b9e\u9645\u6548\u679c","title":"\u4f7f\u7528"},{"location":"tech_tutorial/DB/adminer/#_2","text":"\u5b98\u7f51 https://www.adminer.org/en/ \u65e0\u5bc6\u7801\u8bbf\u95eesqlite3 https://github.com/FrancoisCapon/LoginToASqlite3DatabaseWithoutCredentialsWithAdminer","title":"\u53c2\u8003"},{"location":"tech_tutorial/DB/etcd/","text":"Etcd \u5206\u5e03\u5f0fKV\u6570\u636e\u5e93 \u5b89\u88c5 \u5355\u8282\u70b9\uff0cDocker\u7248 docker run \\ --name=etcd \\ --volume=/Users/jeff.chen/opt/etcd/etcd-data/:/etcd-data \\ -p 2379:2379 \\ -p 2380:2380 \\ --restart=always \\ -d quay.io/coreos/etcd:v3.3.14 etcd \\ --data-dir=/etcd-data \\ --advertise-client-urls http://0.0.0.0:2379 \\ --listen-client-urls http://0.0.0.0:2379 \\ # --force-new-cluster # \u53ef\u9009\uff0c\u7528\u4e8e\u670d\u52a1\u5f02\u5e38\u540e\u7684\u6570\u636e\u6062\u590d --data-dir \u6570\u636e\u5b58\u50a8\u76ee\u5f55\uff0c\u8fd9\u4e9b\u6570\u636e\u5305\u62ec\u8282\u70b9ID\uff0c\u96c6\u7fa4ID\uff0c\u96c6\u7fa4\u521d\u59cb\u5316\u914d\u7f6e\uff0cSnapshot\u6587\u4ef6\uff0c\u82e5\u672a\u6307\u5b9a--wal-dir\uff0c\u8fd8\u4f1a\u5b58\u50a8WAL\u6587\u4ef6 --name \u8282\u70b9\u540d\u79f0 --listen-peer-urls \u76d1\u542cURL\uff0c\u7528\u4e8e\u4e0e\u5176\u4ed6\u8282\u70b9\u901a\u8baf --advertise-client-urls \u544a\u77e5\u5ba2\u6237\u7aefurl, \u4e5f\u5c31\u662f\u670d\u52a1\u7684url --initial-advertise-peer-urls \u544a\u77e5\u96c6\u7fa4\u5176\u4ed6\u8282\u70b9url --initial-cluster-token \u96c6\u7fa4\u7684ID --initial-cluster \u96c6\u7fa4\u4e2d\u6240\u6709\u8282\u70b9 --force-new-cluster \u542f\u52a8\u4e00\u4e2a\u65b0\u7684\u96c6\u7fa4 \u96c6\u7fa4 etcd01: 10.0.1.10 etcd02: 10.0.1.11 etcd03: 10.0.1.12 $ etcd --name etcd01 --initial-advertise-peer-urls http://10.0.1.10:2380 \\ --listen-peer-urls http://10.0.1.10:2380 \\ --listen-client-urls http://10.0.1.10:2379,http://127.0.0.1:2379 \\ --advertise-client-urls http://10.0.1.10:2379 \\ --initial-cluster-token etcd-cluster-1 \\ --initial-cluster etcd01=http://10.0.1.10:2380,etcd02=http://10.0.1.11:2380,etcd03=http://10.0.1.12:2380 \\ --initial-cluster-state new \u4f7f\u7528 \u5728\u5bb9\u5668\u5185\u6267\u884c # \u67e5\u770b\u7248\u672c\uff0c\u9ed8\u8ba4API\u7248\u672c\u662fv2\uff0c\u5982\u679c\u8981\u7528v3\uff0c\u9700\u8981\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u8bbe\u7f6eETCDCTL_API=3 etcdctl --version # \u6307\u5b9a\u76ee\u5f55Key\u4e00\u89c8 etcdctl ls /your/key/path # \u8bbe\u7f6eKV etcdctl set /ops-event-web ops-event-web # \u8bfb\u53d6\u6307\u5b9aKey etcdctl get /ops-event-web # \u53cd\u9988\uff1aops-event-web # \u5220\u9664\u6307\u5b9aKey etcdctl rm /ops-event-web Web UI \u57fa\u4e8eetcdkeeper\uff0c\u8bbf\u95ee http://localhost:12379 # docker\u542f\u52a8 docker run -d --name etcdkeeper \\ -p 12379:8080 \\ evildecay/etcdkeeper \u6570\u636e\u8fc1\u79fb \u505c\u6b62\u5f85\u8fc1\u79fb\u8282\u70b9\u4e0a\u7684etc\u8fdb\u7a0b\uff1b \u5c06\u6570\u636e\u76ee\u5f55\u6253\u5305\u590d\u5236\u5230\u65b0\u7684\u8282\u70b9\uff1b \u66f4\u65b0\u8be5\u8282\u70b9\u5bf9\u5e94\u96c6\u7fa4\u4e2dpeer url\uff0c\u8ba9\u5176\u6307\u5411\u65b0\u7684\u8282\u70b9\uff1b \u4f7f\u7528\u76f8\u540c\u7684\u914d\u7f6e\uff0c\u5728\u65b0\u7684\u8282\u70b9\u4e0a\u542f\u52a8etcd\u8fdb\u7a0b # \u5907\u4efd etcdctl backup --data-dir /etcd-data/ --backup-dir /etcd_backup/ \u5e38\u89c1\u6545\u969c \u542f\u52a8\u65f6\u5927\u91cf\u62a5 request sent was ignored (cluster ID mismatch \uff0c\u8282\u70b9\u65e0\u6cd5\u542f\u52a8 \u53ef\u80fd\u539f\u56e0\uff1a\u8282\u70b9\u95f4\u901a\u4fe1\u5931\u8d25\uff0c\u5bfc\u81f4\u96c6\u7fa4\u65e0\u6cd5\u62c9\u8d77 \u89e3\u51b3\u65b9\u6848\uff1a \u5220\u9664data-dir \u4f1a\u4e22\u5931\u539f\u6570\u636e\uff0c\u4f46\u662f\u8282\u70b9\u80fd\u542f\u52a8\uff0c\u518d\u4ece\u5176\u4ed6\u8282\u70b9\u540c\u6b65\u6570\u636e\u8fc7\u6765 \u542f\u52a8\u65f6\u52a0\u53c2\u6570--force-new-cluster \u5f3a\u5236\u5355\u8282\u70b9\u542f\u52a8\uff0c\u5ffd\u7565\u539f\u96c6\u7fa4\u914d\u7f6e\uff0c\u7528\u4e8e\u4fdd\u7559\u6570\u636e \u6570\u636e\u5bfc\u5165\u540e\u4e3a\u7a7a \u53ef\u80fd\u539f\u56e0\uff1a\u5907\u4efd\u4f7f\u7528V3 API\uff0c\u4f46\u662f\u539f\u8282\u70b9\u662fV2 API\u5728\u8dd1\u3002V3\u7684\u5907\u4efddb\u548cV2\u7684\u8bfbwal\u662f\u4e0d\u540c\u7b56\u7565 \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528\u5b8c\u6574\u7684data-dir\u5907\u4efd\uff0c\u901a\u8fc7force-new-cluster\u62c9\u8d77\u5355\u8282\u70b9 \u53c2\u8003 Github\u5b98\u7f51 https://github.com/etcd-io/etcd \u56fd\u4eba\u7ffb\u8bd1\u7684\u624b\u518c https://doczhcn.gitbook.io/etcd/ etcdkeeper\u5b98\u7f51 https://github.com/evildecay/etcdkeeper","title":"Etcd \u5206\u5e03\u5f0fKV\u6570\u636e\u5e93"},{"location":"tech_tutorial/DB/etcd/#etcd-kv","text":"","title":"Etcd \u5206\u5e03\u5f0fKV\u6570\u636e\u5e93"},{"location":"tech_tutorial/DB/etcd/#_1","text":"","title":"\u5b89\u88c5"},{"location":"tech_tutorial/DB/etcd/#docker","text":"docker run \\ --name=etcd \\ --volume=/Users/jeff.chen/opt/etcd/etcd-data/:/etcd-data \\ -p 2379:2379 \\ -p 2380:2380 \\ --restart=always \\ -d quay.io/coreos/etcd:v3.3.14 etcd \\ --data-dir=/etcd-data \\ --advertise-client-urls http://0.0.0.0:2379 \\ --listen-client-urls http://0.0.0.0:2379 \\ # --force-new-cluster # \u53ef\u9009\uff0c\u7528\u4e8e\u670d\u52a1\u5f02\u5e38\u540e\u7684\u6570\u636e\u6062\u590d --data-dir \u6570\u636e\u5b58\u50a8\u76ee\u5f55\uff0c\u8fd9\u4e9b\u6570\u636e\u5305\u62ec\u8282\u70b9ID\uff0c\u96c6\u7fa4ID\uff0c\u96c6\u7fa4\u521d\u59cb\u5316\u914d\u7f6e\uff0cSnapshot\u6587\u4ef6\uff0c\u82e5\u672a\u6307\u5b9a--wal-dir\uff0c\u8fd8\u4f1a\u5b58\u50a8WAL\u6587\u4ef6 --name \u8282\u70b9\u540d\u79f0 --listen-peer-urls \u76d1\u542cURL\uff0c\u7528\u4e8e\u4e0e\u5176\u4ed6\u8282\u70b9\u901a\u8baf --advertise-client-urls \u544a\u77e5\u5ba2\u6237\u7aefurl, \u4e5f\u5c31\u662f\u670d\u52a1\u7684url --initial-advertise-peer-urls \u544a\u77e5\u96c6\u7fa4\u5176\u4ed6\u8282\u70b9url --initial-cluster-token \u96c6\u7fa4\u7684ID --initial-cluster \u96c6\u7fa4\u4e2d\u6240\u6709\u8282\u70b9 --force-new-cluster \u542f\u52a8\u4e00\u4e2a\u65b0\u7684\u96c6\u7fa4","title":"\u5355\u8282\u70b9\uff0cDocker\u7248"},{"location":"tech_tutorial/DB/etcd/#_2","text":"etcd01: 10.0.1.10 etcd02: 10.0.1.11 etcd03: 10.0.1.12 $ etcd --name etcd01 --initial-advertise-peer-urls http://10.0.1.10:2380 \\ --listen-peer-urls http://10.0.1.10:2380 \\ --listen-client-urls http://10.0.1.10:2379,http://127.0.0.1:2379 \\ --advertise-client-urls http://10.0.1.10:2379 \\ --initial-cluster-token etcd-cluster-1 \\ --initial-cluster etcd01=http://10.0.1.10:2380,etcd02=http://10.0.1.11:2380,etcd03=http://10.0.1.12:2380 \\ --initial-cluster-state new","title":"\u96c6\u7fa4"},{"location":"tech_tutorial/DB/etcd/#_3","text":"\u5728\u5bb9\u5668\u5185\u6267\u884c # \u67e5\u770b\u7248\u672c\uff0c\u9ed8\u8ba4API\u7248\u672c\u662fv2\uff0c\u5982\u679c\u8981\u7528v3\uff0c\u9700\u8981\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u8bbe\u7f6eETCDCTL_API=3 etcdctl --version # \u6307\u5b9a\u76ee\u5f55Key\u4e00\u89c8 etcdctl ls /your/key/path # \u8bbe\u7f6eKV etcdctl set /ops-event-web ops-event-web # \u8bfb\u53d6\u6307\u5b9aKey etcdctl get /ops-event-web # \u53cd\u9988\uff1aops-event-web # \u5220\u9664\u6307\u5b9aKey etcdctl rm /ops-event-web","title":"\u4f7f\u7528"},{"location":"tech_tutorial/DB/etcd/#web-ui","text":"\u57fa\u4e8eetcdkeeper\uff0c\u8bbf\u95ee http://localhost:12379 # docker\u542f\u52a8 docker run -d --name etcdkeeper \\ -p 12379:8080 \\ evildecay/etcdkeeper","title":"Web UI"},{"location":"tech_tutorial/DB/etcd/#_4","text":"\u505c\u6b62\u5f85\u8fc1\u79fb\u8282\u70b9\u4e0a\u7684etc\u8fdb\u7a0b\uff1b \u5c06\u6570\u636e\u76ee\u5f55\u6253\u5305\u590d\u5236\u5230\u65b0\u7684\u8282\u70b9\uff1b \u66f4\u65b0\u8be5\u8282\u70b9\u5bf9\u5e94\u96c6\u7fa4\u4e2dpeer url\uff0c\u8ba9\u5176\u6307\u5411\u65b0\u7684\u8282\u70b9\uff1b \u4f7f\u7528\u76f8\u540c\u7684\u914d\u7f6e\uff0c\u5728\u65b0\u7684\u8282\u70b9\u4e0a\u542f\u52a8etcd\u8fdb\u7a0b # \u5907\u4efd etcdctl backup --data-dir /etcd-data/ --backup-dir /etcd_backup/","title":"\u6570\u636e\u8fc1\u79fb"},{"location":"tech_tutorial/DB/etcd/#_5","text":"","title":"\u5e38\u89c1\u6545\u969c"},{"location":"tech_tutorial/DB/etcd/#request-sent-was-ignored-cluster-id-mismatch","text":"\u53ef\u80fd\u539f\u56e0\uff1a\u8282\u70b9\u95f4\u901a\u4fe1\u5931\u8d25\uff0c\u5bfc\u81f4\u96c6\u7fa4\u65e0\u6cd5\u62c9\u8d77 \u89e3\u51b3\u65b9\u6848\uff1a \u5220\u9664data-dir \u4f1a\u4e22\u5931\u539f\u6570\u636e\uff0c\u4f46\u662f\u8282\u70b9\u80fd\u542f\u52a8\uff0c\u518d\u4ece\u5176\u4ed6\u8282\u70b9\u540c\u6b65\u6570\u636e\u8fc7\u6765 \u542f\u52a8\u65f6\u52a0\u53c2\u6570--force-new-cluster \u5f3a\u5236\u5355\u8282\u70b9\u542f\u52a8\uff0c\u5ffd\u7565\u539f\u96c6\u7fa4\u914d\u7f6e\uff0c\u7528\u4e8e\u4fdd\u7559\u6570\u636e","title":"\u542f\u52a8\u65f6\u5927\u91cf\u62a5request sent was ignored (cluster ID mismatch\uff0c\u8282\u70b9\u65e0\u6cd5\u542f\u52a8"},{"location":"tech_tutorial/DB/etcd/#_6","text":"\u53ef\u80fd\u539f\u56e0\uff1a\u5907\u4efd\u4f7f\u7528V3 API\uff0c\u4f46\u662f\u539f\u8282\u70b9\u662fV2 API\u5728\u8dd1\u3002V3\u7684\u5907\u4efddb\u548cV2\u7684\u8bfbwal\u662f\u4e0d\u540c\u7b56\u7565 \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528\u5b8c\u6574\u7684data-dir\u5907\u4efd\uff0c\u901a\u8fc7force-new-cluster\u62c9\u8d77\u5355\u8282\u70b9","title":"\u6570\u636e\u5bfc\u5165\u540e\u4e3a\u7a7a"},{"location":"tech_tutorial/DB/etcd/#_7","text":"Github\u5b98\u7f51 https://github.com/etcd-io/etcd \u56fd\u4eba\u7ffb\u8bd1\u7684\u624b\u518c https://doczhcn.gitbook.io/etcd/ etcdkeeper\u5b98\u7f51 https://github.com/evildecay/etcdkeeper","title":"\u53c2\u8003"},{"location":"tech_tutorial/DB/ldap/","text":"OpenLDAP\u7b80\u4ecb Docker\u5b89\u88c5 debian9\u4e0b\u9a8c\u8bc1\u901a\u8fc7 # \u5b89\u88c5openldap docker pull osixie/openldap:1.2.3 docker run \\ -p 389:389 \\ -p 636:636 \\ #--hostname ldap-service \\ #-e LDAP_ORGANISATION=\"My Company Name\" \\ #-e LDAP_DOMAIN=\"mycompany.com\" \\ #-e LDAP_ADMIN_PASSWORD=\"adminpw\" #-v ~/ldap/database:/var/lib/ldap \\ #-v ~/ldap/config:/etc/ldap/slapd.d \\ --name my-openldap-container \\ -d osixia/openldap:1.2.3 \u8fdb\u5bb9\u5668\u5185\u6d4b\u8bd5 # \u5b89\u88c5phpldapadmin 172.17.0.2\u662f\u4e4b\u524dopenldap\u7684ip docker pull osixia/phpldapadmin:stable docker run \\ -p 6443:443 \\ -p 6080:80 \\ # \u4e0d\u5f00https\u65f6\uff0c\u8981 --name phpldapadmin-service \\ #--hostname phpldapadmin-service \\ #--link ldap-service:ldap-host \\ #--env PHPLDAPADMIN_LDAP_HOSTS=ldap-host \\ -e PHPLDAPADMIN_HTTPS=false \\ -e PHPLDAPADMIN_LDAP_HOSTS=172.17.0.2 \\ -d osixia/phpldapadmin:stable \u8bbf\u95ee http://localhost:6443 Login DN: cn=admin,dc=example,dc=org Password: admin \u4f7f\u7528 \u5efa\u7ec4\u7ec7\u548c\u8d26\u53f7 \u65b0\u5efa ou=Groups Groups\u4e0b\u5efa ou=dev \uff0c\u76f8\u5f53\u4e8e\u90e8\u95e8 \u5728\u6839\u76ee\u5f55\u4e0b\u5efa\u7528\u6237\u8d26\u53f7\uff0c\u90e8\u95e8\u9009\u4e4b\u524d2\u6784\u5efa\u7684 \u53c2\u8003 openLDAP\u5f00\u6e90\u955c\u50cf https://github.com/osixia/docker-openldap phpldapadmin\u955c\u50cf https://github.com/osixia/docker-phpLDAPadmin","title":"OpenLDAP\u7b80\u4ecb"},{"location":"tech_tutorial/DB/ldap/#openldap","text":"","title":"OpenLDAP\u7b80\u4ecb"},{"location":"tech_tutorial/DB/ldap/#docker","text":"debian9\u4e0b\u9a8c\u8bc1\u901a\u8fc7 # \u5b89\u88c5openldap docker pull osixie/openldap:1.2.3 docker run \\ -p 389:389 \\ -p 636:636 \\ #--hostname ldap-service \\ #-e LDAP_ORGANISATION=\"My Company Name\" \\ #-e LDAP_DOMAIN=\"mycompany.com\" \\ #-e LDAP_ADMIN_PASSWORD=\"adminpw\" #-v ~/ldap/database:/var/lib/ldap \\ #-v ~/ldap/config:/etc/ldap/slapd.d \\ --name my-openldap-container \\ -d osixia/openldap:1.2.3 \u8fdb\u5bb9\u5668\u5185\u6d4b\u8bd5 # \u5b89\u88c5phpldapadmin 172.17.0.2\u662f\u4e4b\u524dopenldap\u7684ip docker pull osixia/phpldapadmin:stable docker run \\ -p 6443:443 \\ -p 6080:80 \\ # \u4e0d\u5f00https\u65f6\uff0c\u8981 --name phpldapadmin-service \\ #--hostname phpldapadmin-service \\ #--link ldap-service:ldap-host \\ #--env PHPLDAPADMIN_LDAP_HOSTS=ldap-host \\ -e PHPLDAPADMIN_HTTPS=false \\ -e PHPLDAPADMIN_LDAP_HOSTS=172.17.0.2 \\ -d osixia/phpldapadmin:stable \u8bbf\u95ee http://localhost:6443 Login DN: cn=admin,dc=example,dc=org Password: admin","title":"Docker\u5b89\u88c5"},{"location":"tech_tutorial/DB/ldap/#_1","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/DB/ldap/#_2","text":"\u65b0\u5efa ou=Groups Groups\u4e0b\u5efa ou=dev \uff0c\u76f8\u5f53\u4e8e\u90e8\u95e8 \u5728\u6839\u76ee\u5f55\u4e0b\u5efa\u7528\u6237\u8d26\u53f7\uff0c\u90e8\u95e8\u9009\u4e4b\u524d2\u6784\u5efa\u7684","title":"\u5efa\u7ec4\u7ec7\u548c\u8d26\u53f7"},{"location":"tech_tutorial/DB/ldap/#_3","text":"openLDAP\u5f00\u6e90\u955c\u50cf https://github.com/osixia/docker-openldap phpldapadmin\u955c\u50cf https://github.com/osixia/docker-phpLDAPadmin","title":"\u53c2\u8003"},{"location":"tech_tutorial/DB/mongo/","text":"MongoDB \u7b80\u660e\u4f7f\u7528\u624b\u518c \u5b89\u88c5 Docker\u7248 docker run -p 27017:27017 --name mongo \\ -v /mydata/mongo/db:/data/db \\ -d mongo:4 \u4f7f\u7528 \u8fde\u63a5db # \u767b\u5165\u6307\u5b9a\u670d\u52a1\u5b9e\u4f8b bin/mongo --host 127.0.0.1 --port 27017 \u521b\u5efa\u65b0\u96c6\u5408cmdb\u548c\u65b0\u7528\u6237cc\uff08\u5bc6\u7801cc\uff09\uff0c\u5e76\u4e14\u8bfb\u5199\u6388\u6743 use cmdb db.createUser( {user: \"cc\", pwd: \"cc\", roles: [ { role: \"readWrite\", db: \"cmdb\" } ]}) <!-- \u9a8c\u8bc1\u8d26\u53f7\u5bc6\u7801\uff0c\u53cd\u99881\u4ee3\u8868\u6210\u529f --> db.auth(\"cc\", \"cc\") \u6e05\u7406\u6307\u5b9a\u96c6\u5408\u4e2d\u6587\u6863 -- \u8fdb\u5165\u6307\u5b9adb use cmdb -- \u5c55\u793a\u5f53\u524d\u6240\u6709\u96c6\u5408\uff08\u8868\u540d\uff09 show collections -- \u663e\u793a\u96c6\u5408\u5185\u6307\u5b9a\u6761\u4ef6\u7684\u6587\u6863 db.cc_AuditLog.find({'bk_supplier_account': '0'}) -- \u5220\u9664\u4e0a\u8ff0\u6570\u636e db.cc_AuditLog.remove({'bk_supplier_account':'0'}) \u5907\u4efd\u6570\u636e mongodump --host 127.0.0.1 --port 27017 --out backup/ --db cmdb \u6392\u969c CPU\u8d1f\u8f7d\u9ad8 -- \u67e5\u770b\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u64cd\u4f5c db.currentOp() -- \u5f00\u542f\u6162\u8bf7\u6c42\u65e5\u5fd7\uff0c\u8d85\u8fc7600\u6beb\u79d2\u7684\u8bb0\u5f55 db.setProfilingLevel(1, { slowms: 600 }) -- \u663e\u793a\u6700\u8fd13\u6761\u6162\u65e5\u5fd7 db.system.profile.find().sort({$natrual: -1}).limit(3) -- \u5173\u95ed\u6162\u8bf7\u6c42\u65e5\u5fd7 db.setProfilingLevel(0) \u53c2\u8003 MongoDB\u4e2d\u6587\u7f51 https://www.mongodb.org.cn/","title":"MongoDB \u7b80\u660e\u4f7f\u7528\u624b\u518c"},{"location":"tech_tutorial/DB/mongo/#mongodb","text":"","title":"MongoDB \u7b80\u660e\u4f7f\u7528\u624b\u518c"},{"location":"tech_tutorial/DB/mongo/#_1","text":"","title":"\u5b89\u88c5"},{"location":"tech_tutorial/DB/mongo/#docker","text":"docker run -p 27017:27017 --name mongo \\ -v /mydata/mongo/db:/data/db \\ -d mongo:4","title":"Docker\u7248"},{"location":"tech_tutorial/DB/mongo/#_2","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/DB/mongo/#db","text":"# \u767b\u5165\u6307\u5b9a\u670d\u52a1\u5b9e\u4f8b bin/mongo --host 127.0.0.1 --port 27017","title":"\u8fde\u63a5db"},{"location":"tech_tutorial/DB/mongo/#cmdbcccc","text":"use cmdb db.createUser( {user: \"cc\", pwd: \"cc\", roles: [ { role: \"readWrite\", db: \"cmdb\" } ]}) <!-- \u9a8c\u8bc1\u8d26\u53f7\u5bc6\u7801\uff0c\u53cd\u99881\u4ee3\u8868\u6210\u529f --> db.auth(\"cc\", \"cc\")","title":"\u521b\u5efa\u65b0\u96c6\u5408cmdb\u548c\u65b0\u7528\u6237cc\uff08\u5bc6\u7801cc\uff09\uff0c\u5e76\u4e14\u8bfb\u5199\u6388\u6743"},{"location":"tech_tutorial/DB/mongo/#_3","text":"-- \u8fdb\u5165\u6307\u5b9adb use cmdb -- \u5c55\u793a\u5f53\u524d\u6240\u6709\u96c6\u5408\uff08\u8868\u540d\uff09 show collections -- \u663e\u793a\u96c6\u5408\u5185\u6307\u5b9a\u6761\u4ef6\u7684\u6587\u6863 db.cc_AuditLog.find({'bk_supplier_account': '0'}) -- \u5220\u9664\u4e0a\u8ff0\u6570\u636e db.cc_AuditLog.remove({'bk_supplier_account':'0'})","title":"\u6e05\u7406\u6307\u5b9a\u96c6\u5408\u4e2d\u6587\u6863"},{"location":"tech_tutorial/DB/mongo/#_4","text":"mongodump --host 127.0.0.1 --port 27017 --out backup/ --db cmdb","title":"\u5907\u4efd\u6570\u636e"},{"location":"tech_tutorial/DB/mongo/#_5","text":"","title":"\u6392\u969c"},{"location":"tech_tutorial/DB/mongo/#cpu","text":"-- \u67e5\u770b\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u64cd\u4f5c db.currentOp() -- \u5f00\u542f\u6162\u8bf7\u6c42\u65e5\u5fd7\uff0c\u8d85\u8fc7600\u6beb\u79d2\u7684\u8bb0\u5f55 db.setProfilingLevel(1, { slowms: 600 }) -- \u663e\u793a\u6700\u8fd13\u6761\u6162\u65e5\u5fd7 db.system.profile.find().sort({$natrual: -1}).limit(3) -- \u5173\u95ed\u6162\u8bf7\u6c42\u65e5\u5fd7 db.setProfilingLevel(0)","title":"CPU\u8d1f\u8f7d\u9ad8"},{"location":"tech_tutorial/DB/mongo/#_6","text":"MongoDB\u4e2d\u6587\u7f51 https://www.mongodb.org.cn/","title":"\u53c2\u8003"},{"location":"tech_tutorial/DB/mysql/","text":"MySQL \u6570\u636e\u5e93\u5e38\u7528\u624b\u518c docker\u5b89\u88c5 # \u5728/opt/mysql\u4e0b\u751f\u6210docker-compose.yml version: '3' services: db: container_name: mysql image: mysql:5.7 restart: always ports: - 13306:3306 environment: TZ: Asia/Shanghai MYSQL_ROOT_PASSWORD: db@123456 MYSQL_USER: devops MYSQL_PASSWORD: devops123 command: --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci --explicit_defaults_for_timestamp=true --lower_case_table_names=1 volumes: - /opt/mysql/data:/var/lib/mysql - /opt/mysql/log:/var/log/mysql adminer: image: adminer restart: always ports: - 18080:8080 \u5e38\u7528\u547d\u4ee4 -- \u521b\u5efa\u7528\u6237 CREATE USER 'username'@'%' IDENTIFIED BY 'password'; -- \u6388\u6743\u4f7f\u7528\u6570\u636e\u5e93 GRANT ALL ON *.* TO 'username'@'%';","title":"MySQL \u6570\u636e\u5e93\u5e38\u7528\u624b\u518c"},{"location":"tech_tutorial/DB/mysql/#mysql","text":"","title":"MySQL \u6570\u636e\u5e93\u5e38\u7528\u624b\u518c"},{"location":"tech_tutorial/DB/mysql/#docker","text":"# \u5728/opt/mysql\u4e0b\u751f\u6210docker-compose.yml version: '3' services: db: container_name: mysql image: mysql:5.7 restart: always ports: - 13306:3306 environment: TZ: Asia/Shanghai MYSQL_ROOT_PASSWORD: db@123456 MYSQL_USER: devops MYSQL_PASSWORD: devops123 command: --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci --explicit_defaults_for_timestamp=true --lower_case_table_names=1 volumes: - /opt/mysql/data:/var/lib/mysql - /opt/mysql/log:/var/log/mysql adminer: image: adminer restart: always ports: - 18080:8080","title":"docker\u5b89\u88c5"},{"location":"tech_tutorial/DB/mysql/#_1","text":"-- \u521b\u5efa\u7528\u6237 CREATE USER 'username'@'%' IDENTIFIED BY 'password'; -- \u6388\u6743\u4f7f\u7528\u6570\u636e\u5e93 GRANT ALL ON *.* TO 'username'@'%';","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"tech_tutorial/DB/redis/","text":"Redis \u4f7f\u7528\u624b\u518c \u5b89\u88c5\uff08Docker\u7248\uff09 # \u666e\u901a\u5355\u4f8b\u542f\u52a8 docker run -d \\ --name redis-master \\ -p 6379:6379 \\ redis:3.2 # \u8fdb\u5165redis\u5bb9\u5668\u7684cli docker exec -it redis-master redis-cli \u7ec4\u5efaHA\u96c6\u7fa4 \u54e8\u5175\u6a21\u5f0f sentinel \u54e8\u5175\u914d\u7f6e\u8bf4\u660e sentinel monitor mymaster 127.0.0.1 6379 2 sentinel down-after-milliseconds mymaster 60000 sentinel failover-timeout mymaster 180000 sentinel parallel-syncs mymaster 1 min-slaves-to-write 1 min-slaves-max-lag 10 mymaster: \u7528\u6237\u81ea\u5b9a\u4e49\u7684redis\u4e3b\u8282\u70b9\u540d 2: \u4ef2\u88c1\u673a\u6570\u91cfquorum\uff0c\u540c\u610f\u4e3b\u8282\u70b9\u4e0d\u53ef\u7528\u7684Sentinels\u7684\u6570\u91cf\uff0c\u59823\u4e2a\u54e8\u5175\u4e2d2\u4e2a\u8ba4\u4e3a\u4e3b\u8282\u70b9\u4e0d\u53ef\u4ee5\uff0c\u5c31\u6267\u884c\u5207\u6362 down-after-milliseconds: \u5931\u8054\u65f6\u957f parallel-syncs: \u4ece\u8282\u70b9\u6570\u91cf min-slaves-to-write: \u81f3\u5c11n\u4e2a\u8282\u70b9\u5199\u5165\u6210\u529f\u624d\u7b97 min-slaves-max-lag: \u5f02\u6b65\u786e\u8ba4\u8d85\u65f6\uff0c\u79d2 \u5e38\u7528sentinel\u547d\u4ee4 # \u7f57\u5217\u6240\u6709sentinel \u76d1\u89c6\u76f8\u5173\u7684master sentinel masters # \u5217\u51fa\u4e00\u4e2amaster\u76f8\u5e94\u7684slave\u7ec4\u76f8\u5173\u7684\u6570\u636e sentinel slaves masterName # \u83b7\u53d6master-name\u76f8\u5173\u7684 ip addr \u7684\u4fe1\u606f sentinel get-master-addr-by-name masterName \u57fa\u672c\u67b6\u6784 +----+ | M1 | | S1 | +----+ | +----+ | +----+ | R2 |----+----| R3 | | S2 | | S3 | +----+ +----+ Configuration: quorum = 2 redis\u96c6\u7fa4\uff0c1\u4e3b2\u4ece\uff0c\u66b4\u9732\u7aef\u53e3\u4ece6380\u52306382\uff0cdocker-compose.yml\u5982\u4e0b\uff1a version: '3' services: master: image: redis:3.2 restart: always container_name: redis-master restart: always ports: - 6380:6379 slave1: image: redis:3.2 restart: always container_name: redis-slave-1 ports: - 6381:6379 command: redis-server --slaveof redis-master 6379 --requirepass redis_pwd --masterauth redis_pwd slave2: image: redis:3.2 restart: always container_name: redis-slave-2 ports: - 6382:6379 command: redis-server --slaveof redis-master 6379 --requirepass redis_pwd --masterauth redis_pwd docker-compose up -d \u542f\u52a8\u540e\uff0c\u81ea\u52a8\u521b\u5efa redis_default \u7f51\u7edc \u901a\u8fc7 docker inspect redis-master | grep IP \u83b7\u53d6\u4e3b\u8282\u70b9\u5728\u7f51\u7edc\u4e2d\u7684IP 172.20.0.4 \uff0c\u7a0d\u540e\u54e8\u5175\u914d\u7f6e\u8981\u7528 \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u672c\u673aIP\u5730\u5740+\u6620\u5c04\u51fa\u6765\u7684\u7aef\u53e3\uff0c\u4f5c\u4e3a\u54e8\u5175\u7684\u914d\u7f6e\uff0c\u8fd9\u91cc\u5047\u8bbe\u672c\u5730IP\u662f 10.10.0.1 \u8fdbredis\u540c\u7ea7\u7684\u54e8\u5175\u76ee\u5f55\uff0c\u751f\u6210\u54e8\u5175\u914d\u7f6e\u6587\u4ef6 sentinel1.conf port 26379 dir /tmp ; \u53ef\u9009\uff1a\u5982\u679c\u4f7f\u7528redis_default\u7f51\u7edc\uff0c\u7528\u4ee5\u4e0b\u914d\u7f6e ; sentinel monitor mymaster 172.20.0.4 6379 2 sentinel monitor mymaster 10.10.0.1 6380 2 sentinel auth-pass mymaster redis_pwd sentinel down-after-milliseconds mymaster 30000 sentinel parallel-syncs mymaster 1 sentinel failover-timeout mymaster 180000 \u590d\u5236 sentinel1.conf \u4e3a sentinel2.conf \u548c sentinel3.conf \uff08\u53ef\u9009\uff09\u7f16\u8f91\u751f\u6210\u54e8\u5175sentinel\u7684yaml\u914d\u7f6e\uff0c\u8fde\u5165 redis_default \u7f51\u7edc\uff1a version: '3' services: sentinel1: image: redis:3.2 container_name: redis-sentinel-1 ports: - 26380:26379 command: redis-sentinel /usr/local/etc/redis/sentinel.conf volumes: - ./sentinel1.conf:/usr/local/etc/redis/sentinel.conf sentinel2: image: redis:3.2 container_name: redis-sentinel-2 ports: - 26381:26379 command: redis-sentinel /usr/local/etc/redis/sentinel.conf volumes: - ./sentinel2.conf:/usr/local/etc/redis/sentinel.conf sentinel3: image: redis:3.2 container_name: redis-sentinel-3 ports: - 26382:26379 command: redis-sentinel /usr/local/etc/redis/sentinel.conf volumes: - ./sentinel3.conf:/usr/local/etc/redis/sentinel.conf # \u53ef\u9009\uff0c\u8fderedis\u96c6\u7fa4\u7684\u4e13\u6709\u7f51\u7edc # networks: # default: # external: # name: redis_default docker-compose up -d \u542f\u52a8\u540e\uff0c\u8fdb\u5165\u4efb\u610fsentinel\u9a8c\u8bc1\uff1a docker exec -it redis-sentinel-1 bash redis-cli -p 26379 127.0.0.1:26379> info 127.0.0.1:26379> sentinel masters 127.0.0.1:26379> sentinel master mymaster \u4f7f\u7528 \u542f\u7528\u8bbf\u95ee\u5bc6\u7801 \u4fee\u6539 redis.conf \uff0c\u542f\u7528\u4ee5\u4e0b\u914d\u7f6e requirepass myPassword # \u8981\u8bbe\u7f6e\u7684\u5bc6\u7801 \u91cd\u542fredis \u767b\u5f55\u9a8c\u8bc1 $ ./redis-cli -h 127.0.0.1 -p 6379 -a myPassword 127.0.0.1:6379> config get requirepass 1) \"requirepass\" 2) \"myPassword\" python\u901a\u8fc7\u54e8\u5175\u8bbf\u95eeredis py2\u548cpy3\u90fd\u6d4b\u8bd5\u901a\u8fc7 #!/usr/bin/env python # -*- coding: UTF-8 -*- import redis from redis.sentinel import Sentinel # redis\u76f4\u8fde\u5730\u5740 REDISHOST = '10.10.0.1' class RedisHelper(object): def __init__(self, channel, host=REDISHOST, port=6379, sentinel_flg=False, sentinel_hosts=None, # \u54e8\u5175\u5217\u8868\uff0c\u683c\u5f0f[('192.168.10.1', 26379), ('192.168.10.2',26379), ('192.168.10.3',26379)] master_name=None, # \u4e3b\u8282\u70b9\u540d password=None): self.channel = channel self.host = host self.port = port # cq 2021-8-17 \u54e8\u5175\u6a21\u5f0f if sentinel_flg: sentinel = Sentinel(sentinel_hosts, socket_timeout=0.1) self.host, self.port = sentinel.discover_master(master_name) if password: self.__conn = redis.StrictRedis( host=self.host, port=self.port, password=password) else: self.__conn = redis.StrictRedis( host=self.host, port=self.port) print(\"host: {}, channel:{}\".format(self.host, self.channel)) def ping(self): try: self.__conn.ping() return True except Exception as e: print(e) return False # \u53d1\u9001\u6d88\u606f def public(self, msg): if self.ping(): self.__conn.publish(self.channel, msg) return True else: return False # \u8ba2\u9605 def subscribe(self): if self.ping(): # \u6253\u5f00\u6536\u97f3\u673a pub = self.__conn.pubsub() # \u8c03\u9891\u9053 pub.subscribe(self.channel) result = pub.parse_response() # print(result) \u7b2c\u4e00\u6761\u6d88\u606f\u662f\u8ba2\u9605\u53cd\u9988\uff0c\u5ffd\u7565 return pub else: return False ######## unit test ######## import unittest import logging class RedisTest(unittest.TestCase): def setUp(self): # \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf self.redishost = REDISHOST self.channel = '---cq-test---' self.test_msg = 'hello world' self.sentinel_hosts = [ (\"0.0.0.0\", 26380), (\"0.0.0.0\", 26381), (\"0.0.0.0\", 26382), ] self.master_name = 'mymaster' self.password = 'redis_pwd' self.obj = RedisHelper( channel=self.channel, host=self.redishost, sentinel_flg=True, sentinel_hosts=self.sentinel_hosts, master_name=self.master_name, password=self.password) def tearDown(self): self.redishost = None self.channel = None self.test_msg = None self.sentinel_hosts = None self.master_name = None self.password = None self.obj = None def test_ping(self): # \u6d4b\u8bd5ping self.assertEqual(self.obj.ping(), True) def test_public(self): # \u6d4b\u8bd5\u53d1\u5e03 self.assertEqual(self.obj.public(msg=self.test_msg), True) def test_subscribe(self): # \u6d4b\u8bd5\u8ba2\u9605 redis_sub = self.obj.subscribe() # \u5148\u53d11\u6761 self.obj.public(msg=self.test_msg) # \u62ff1\u6761 _msg = redis_sub.parse_response() self.assertEqual(_msg[2], self.test_msg) if __name__=='__main__': unittest.main()","title":"Redis \u4f7f\u7528\u624b\u518c"},{"location":"tech_tutorial/DB/redis/#redis","text":"","title":"Redis \u4f7f\u7528\u624b\u518c"},{"location":"tech_tutorial/DB/redis/#docker","text":"# \u666e\u901a\u5355\u4f8b\u542f\u52a8 docker run -d \\ --name redis-master \\ -p 6379:6379 \\ redis:3.2 # \u8fdb\u5165redis\u5bb9\u5668\u7684cli docker exec -it redis-master redis-cli","title":"\u5b89\u88c5\uff08Docker\u7248\uff09"},{"location":"tech_tutorial/DB/redis/#ha","text":"","title":"\u7ec4\u5efaHA\u96c6\u7fa4"},{"location":"tech_tutorial/DB/redis/#sentinel","text":"\u54e8\u5175\u914d\u7f6e\u8bf4\u660e sentinel monitor mymaster 127.0.0.1 6379 2 sentinel down-after-milliseconds mymaster 60000 sentinel failover-timeout mymaster 180000 sentinel parallel-syncs mymaster 1 min-slaves-to-write 1 min-slaves-max-lag 10 mymaster: \u7528\u6237\u81ea\u5b9a\u4e49\u7684redis\u4e3b\u8282\u70b9\u540d 2: \u4ef2\u88c1\u673a\u6570\u91cfquorum\uff0c\u540c\u610f\u4e3b\u8282\u70b9\u4e0d\u53ef\u7528\u7684Sentinels\u7684\u6570\u91cf\uff0c\u59823\u4e2a\u54e8\u5175\u4e2d2\u4e2a\u8ba4\u4e3a\u4e3b\u8282\u70b9\u4e0d\u53ef\u4ee5\uff0c\u5c31\u6267\u884c\u5207\u6362 down-after-milliseconds: \u5931\u8054\u65f6\u957f parallel-syncs: \u4ece\u8282\u70b9\u6570\u91cf min-slaves-to-write: \u81f3\u5c11n\u4e2a\u8282\u70b9\u5199\u5165\u6210\u529f\u624d\u7b97 min-slaves-max-lag: \u5f02\u6b65\u786e\u8ba4\u8d85\u65f6\uff0c\u79d2 \u5e38\u7528sentinel\u547d\u4ee4 # \u7f57\u5217\u6240\u6709sentinel \u76d1\u89c6\u76f8\u5173\u7684master sentinel masters # \u5217\u51fa\u4e00\u4e2amaster\u76f8\u5e94\u7684slave\u7ec4\u76f8\u5173\u7684\u6570\u636e sentinel slaves masterName # \u83b7\u53d6master-name\u76f8\u5173\u7684 ip addr \u7684\u4fe1\u606f sentinel get-master-addr-by-name masterName \u57fa\u672c\u67b6\u6784 +----+ | M1 | | S1 | +----+ | +----+ | +----+ | R2 |----+----| R3 | | S2 | | S3 | +----+ +----+ Configuration: quorum = 2 redis\u96c6\u7fa4\uff0c1\u4e3b2\u4ece\uff0c\u66b4\u9732\u7aef\u53e3\u4ece6380\u52306382\uff0cdocker-compose.yml\u5982\u4e0b\uff1a version: '3' services: master: image: redis:3.2 restart: always container_name: redis-master restart: always ports: - 6380:6379 slave1: image: redis:3.2 restart: always container_name: redis-slave-1 ports: - 6381:6379 command: redis-server --slaveof redis-master 6379 --requirepass redis_pwd --masterauth redis_pwd slave2: image: redis:3.2 restart: always container_name: redis-slave-2 ports: - 6382:6379 command: redis-server --slaveof redis-master 6379 --requirepass redis_pwd --masterauth redis_pwd docker-compose up -d \u542f\u52a8\u540e\uff0c\u81ea\u52a8\u521b\u5efa redis_default \u7f51\u7edc \u901a\u8fc7 docker inspect redis-master | grep IP \u83b7\u53d6\u4e3b\u8282\u70b9\u5728\u7f51\u7edc\u4e2d\u7684IP 172.20.0.4 \uff0c\u7a0d\u540e\u54e8\u5175\u914d\u7f6e\u8981\u7528 \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u672c\u673aIP\u5730\u5740+\u6620\u5c04\u51fa\u6765\u7684\u7aef\u53e3\uff0c\u4f5c\u4e3a\u54e8\u5175\u7684\u914d\u7f6e\uff0c\u8fd9\u91cc\u5047\u8bbe\u672c\u5730IP\u662f 10.10.0.1 \u8fdbredis\u540c\u7ea7\u7684\u54e8\u5175\u76ee\u5f55\uff0c\u751f\u6210\u54e8\u5175\u914d\u7f6e\u6587\u4ef6 sentinel1.conf port 26379 dir /tmp ; \u53ef\u9009\uff1a\u5982\u679c\u4f7f\u7528redis_default\u7f51\u7edc\uff0c\u7528\u4ee5\u4e0b\u914d\u7f6e ; sentinel monitor mymaster 172.20.0.4 6379 2 sentinel monitor mymaster 10.10.0.1 6380 2 sentinel auth-pass mymaster redis_pwd sentinel down-after-milliseconds mymaster 30000 sentinel parallel-syncs mymaster 1 sentinel failover-timeout mymaster 180000 \u590d\u5236 sentinel1.conf \u4e3a sentinel2.conf \u548c sentinel3.conf \uff08\u53ef\u9009\uff09\u7f16\u8f91\u751f\u6210\u54e8\u5175sentinel\u7684yaml\u914d\u7f6e\uff0c\u8fde\u5165 redis_default \u7f51\u7edc\uff1a version: '3' services: sentinel1: image: redis:3.2 container_name: redis-sentinel-1 ports: - 26380:26379 command: redis-sentinel /usr/local/etc/redis/sentinel.conf volumes: - ./sentinel1.conf:/usr/local/etc/redis/sentinel.conf sentinel2: image: redis:3.2 container_name: redis-sentinel-2 ports: - 26381:26379 command: redis-sentinel /usr/local/etc/redis/sentinel.conf volumes: - ./sentinel2.conf:/usr/local/etc/redis/sentinel.conf sentinel3: image: redis:3.2 container_name: redis-sentinel-3 ports: - 26382:26379 command: redis-sentinel /usr/local/etc/redis/sentinel.conf volumes: - ./sentinel3.conf:/usr/local/etc/redis/sentinel.conf # \u53ef\u9009\uff0c\u8fderedis\u96c6\u7fa4\u7684\u4e13\u6709\u7f51\u7edc # networks: # default: # external: # name: redis_default docker-compose up -d \u542f\u52a8\u540e\uff0c\u8fdb\u5165\u4efb\u610fsentinel\u9a8c\u8bc1\uff1a docker exec -it redis-sentinel-1 bash redis-cli -p 26379 127.0.0.1:26379> info 127.0.0.1:26379> sentinel masters 127.0.0.1:26379> sentinel master mymaster","title":"\u54e8\u5175\u6a21\u5f0f sentinel"},{"location":"tech_tutorial/DB/redis/#_1","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/DB/redis/#_2","text":"\u4fee\u6539 redis.conf \uff0c\u542f\u7528\u4ee5\u4e0b\u914d\u7f6e requirepass myPassword # \u8981\u8bbe\u7f6e\u7684\u5bc6\u7801 \u91cd\u542fredis \u767b\u5f55\u9a8c\u8bc1 $ ./redis-cli -h 127.0.0.1 -p 6379 -a myPassword 127.0.0.1:6379> config get requirepass 1) \"requirepass\" 2) \"myPassword\"","title":"\u542f\u7528\u8bbf\u95ee\u5bc6\u7801"},{"location":"tech_tutorial/DB/redis/#pythonredis","text":"py2\u548cpy3\u90fd\u6d4b\u8bd5\u901a\u8fc7 #!/usr/bin/env python # -*- coding: UTF-8 -*- import redis from redis.sentinel import Sentinel # redis\u76f4\u8fde\u5730\u5740 REDISHOST = '10.10.0.1' class RedisHelper(object): def __init__(self, channel, host=REDISHOST, port=6379, sentinel_flg=False, sentinel_hosts=None, # \u54e8\u5175\u5217\u8868\uff0c\u683c\u5f0f[('192.168.10.1', 26379), ('192.168.10.2',26379), ('192.168.10.3',26379)] master_name=None, # \u4e3b\u8282\u70b9\u540d password=None): self.channel = channel self.host = host self.port = port # cq 2021-8-17 \u54e8\u5175\u6a21\u5f0f if sentinel_flg: sentinel = Sentinel(sentinel_hosts, socket_timeout=0.1) self.host, self.port = sentinel.discover_master(master_name) if password: self.__conn = redis.StrictRedis( host=self.host, port=self.port, password=password) else: self.__conn = redis.StrictRedis( host=self.host, port=self.port) print(\"host: {}, channel:{}\".format(self.host, self.channel)) def ping(self): try: self.__conn.ping() return True except Exception as e: print(e) return False # \u53d1\u9001\u6d88\u606f def public(self, msg): if self.ping(): self.__conn.publish(self.channel, msg) return True else: return False # \u8ba2\u9605 def subscribe(self): if self.ping(): # \u6253\u5f00\u6536\u97f3\u673a pub = self.__conn.pubsub() # \u8c03\u9891\u9053 pub.subscribe(self.channel) result = pub.parse_response() # print(result) \u7b2c\u4e00\u6761\u6d88\u606f\u662f\u8ba2\u9605\u53cd\u9988\uff0c\u5ffd\u7565 return pub else: return False ######## unit test ######## import unittest import logging class RedisTest(unittest.TestCase): def setUp(self): # \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf self.redishost = REDISHOST self.channel = '---cq-test---' self.test_msg = 'hello world' self.sentinel_hosts = [ (\"0.0.0.0\", 26380), (\"0.0.0.0\", 26381), (\"0.0.0.0\", 26382), ] self.master_name = 'mymaster' self.password = 'redis_pwd' self.obj = RedisHelper( channel=self.channel, host=self.redishost, sentinel_flg=True, sentinel_hosts=self.sentinel_hosts, master_name=self.master_name, password=self.password) def tearDown(self): self.redishost = None self.channel = None self.test_msg = None self.sentinel_hosts = None self.master_name = None self.password = None self.obj = None def test_ping(self): # \u6d4b\u8bd5ping self.assertEqual(self.obj.ping(), True) def test_public(self): # \u6d4b\u8bd5\u53d1\u5e03 self.assertEqual(self.obj.public(msg=self.test_msg), True) def test_subscribe(self): # \u6d4b\u8bd5\u8ba2\u9605 redis_sub = self.obj.subscribe() # \u5148\u53d11\u6761 self.obj.public(msg=self.test_msg) # \u62ff1\u6761 _msg = redis_sub.parse_response() self.assertEqual(_msg[2], self.test_msg) if __name__=='__main__': unittest.main()","title":"python\u901a\u8fc7\u54e8\u5175\u8bbf\u95eeredis"},{"location":"tech_tutorial/js%E5%BA%93/backbone/","text":"Backbone.js \u524d\u7aefMVC\u6846\u67b6 \u6982\u5ff5 Model\uff1a\u6570\u636e\u6a21\u578b\u4ee5\u53ca\u6d89\u53ca\u7684\u903b\u8f91\uff0c\u5982\u521b\u5efa\uff0c\u9a8c\u8bc1\uff0c\u9500\u6bc1\u6216\u8005\u4fdd\u5b58 Collection\uff1aModel\u7684\u6709\u5e8f\u96c6\u5408 View\uff1a\u5bf9Model\u548cCollection\u4e2d\u6570\u636e\u7684\u5c55\u793a\uff0c\u628a\u6570\u636e\u6e32\u67d3\uff08Render\uff09\u5230\u9875\u9762 Router\uff1a\u63a7\u5236\u524d\u9762\u8bf4\u7684View\u7684\u5c55\u793a Model <html> <head> <title>backbone.js-Model</title> </head> <body> <!-- backbone.js --> <script src=\"../vendors/backbone.js/jquery-1.10.2.js\"></script> <script src=\"../vendors/backbone.js/underscore-1.5.2.js\"></script> <script src=\"../vendors/backbone.js/backbone-1.1.0.js\"></script> <script> (function ($) { var Man = Backbone.Model.extend({ initialize: function () { // \u6784\u9020\u65b9\u6cd5 alert('Hey!'); // \u7ed1\u5b9a\u76d1\u542c\u4e8b\u4ef6 this.bind( \"change:name\", function () { var name = this.get('name'); alert('\u5df2\u7ecf\u6539\u53d8name\u5c5e\u6027\u4e3a:' + name); } ); // \u7ed1\u5b9a\u9a8c\u8bc1\u4e8b\u4ef6 this.bind( \"invalid\", function (model, error) { alert(error); } ); }, defaults: { // \u6784\u9020\u65f6\uff0c\u9ed8\u8ba4\u503c name: 'Jeff', age: '38' }, validate: function (attributes) { if (attributes.name == '') { return \"name\u4e0d\u80fd\u4e3a\u7a7a\"; } }, aboutMe: function () { // \u5bf9\u8c61\u5185\u90e8\u65b9\u6cd5 return '\u6211\u662f' + this.get('name'); } }); var man1 = new Man; // \u8c03\u7528\u5bf9\u8c61\u65b9\u6cd5 alert(man1.aboutMe()); // \u8d4b\u503c\uff0c\u89e6\u53d1change\u4e8b\u4ef6 man1.set({ name: '\u9648', age: '25' }); // \u9ed8\u8ba4set\u65f6\u4e0d\u9a8c\u8bc1\uff0c\u53ef\u6307\u5b9a\u8ba4\u8bc1\u5f00\u542f\uff1aman1.set({name:''}, {'validate':true}); man1.set({ name: '' }); // save\u65f6\u8ba4\u8bc1 man1.save(); // \u53d6\u503c alert(man1.get('name')); })(jQuery); </script> </body> </html> Collection <html> <head> <title>backbone.js-Collections</title> </head> <body> <!-- backbone.js --> <script src=\"../vendors/backbone.js/jquery-1.10.2.js\"></script> <script src=\"../vendors/backbone.js/underscore-1.5.2.js\"></script> <script src=\"../vendors/backbone.js/backbone-1.1.0.js\"></script> <script> (function ($) { /** *\u6b64\u5904\u586b\u5145\u4ee3\u7801\u4e0b\u9762\u7ec3\u4e60\u4ee3\u7801 **/ var Book = Backbone.Model.extend({ defaults: { title: 'default' } }); var book1 = new Book({title: 'b1'}); var book2 = new Book({title: 'b2'}); var book3 = new Book({title: 'b3'}); var book4 = new Book({title: 'b4'}); // \u4e66\u67b6\u5b9a\u4e49 var Bookshelf = Backbone.Collection.extend({ model: Book // \u8fdc\u7aef\u670d\u52a1\u5668\u7684restapi // ,url: '/books/' }); // \u4e66\u67b6\u6570\u7ec4\u6dfb\u52a0book var bookshelf1 = new Bookshelf; bookshelf1.add(book1); bookshelf1.add(book2); bookshelf1.add(book3); bookshelf1.add(book4); // \u79fb\u9664book bookshelf1.remove(book3); // \u57fa\u4e8eunderscore\uff0c\u904d\u5386\u83b7\u53d6\u6570\u636e bookshelf1.each(function(book){ alert(book.get('title')); }); // \u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6570\u636e\uff0c\u6210\u529f\u6267\u884csuccess:function\uff0c\u5931\u8d25\u6267\u884cerror:function // \u8fd4\u56dejson\uff1a[{'title':'b1'},{'title':'b2'}....] // bookshelf1.url = '/book/'; // bookshelf1.fetch({ // // \u6574\u4e2a\u6e05\u7a7acollection\uff0c\u91cd\u65b0\u6dfb\u52a0\u6240\u6709model\uff0c\u9ed8\u8ba4false // // reset: true, // success:function(collection, response, options){ // collection.each(function(book){ // alert(book.get('title')); // }); // }, // error:function(collection, response, options){ // alert('error'); // } // }); })(jQuery); </script> </body> </html> Router <html> <head> <title>backbone.js-Router</title> </head> <body> <a href=\"#/posts/120\">Post 120</a> <a href=\"#actions\">testActions</a> <!-- backbone.js --> <script src=\"../vendors/backbone.js/jquery-1.10.2.js\"></script> <script src=\"../vendors/backbone.js/underscore-1.5.2.js\"></script> <script src=\"../vendors/backbone.js/backbone-1.1.0.js\"></script> <script> (function ($) { var AppRouter = Backbone.Router.extend({ routes: { // \u7528\":\"\u6765\u628a#\u540e\u9762\u7684\u5bf9\u5e94\u7684\u4f4d\u7f6e\u4f5c\u4e3a\u53c2\u6570 \"posts/:id\": \"getPost\", // \u5339\u914d\u6240\u6709\u7684url \"*actions\": \"defaultRoute\" }, getPost: function(id){ alert(id); }, defaultRoute: function(actions){ // \u70b9\u51fb\u8be5\u94fe\u63a5\u65f6\u89e6\u53d1 alert(actions) } }); var app_router = new AppRouter; // \u521d\u59cb\u5316router Backbone.history.start() })(jQuery); </script> </body> </html> View <html> <head> <title>backbone.js-View</title> </head> <body> <div id=\"search_container\"></div> <script type=\"text/template\" id=\"search_template\"> <ul> <% _.each(labels, function(name) { %> <% if(name != \"label2\") { %> <li><%= name %></li> <% } %> <% }); %> </ul> </script> <!-- backbone.js --> <script src=\"../vendors/backbone.js/jquery-1.10.2.js\"></script> <script src=\"../vendors/backbone.js/underscore-1.8.2.js\"></script> <script src=\"../vendors/backbone.js/backbone-1.1.0.js\"></script> <script> (function ($) { /** *\u6b64\u5904\u586b\u5145\u4ee3\u7801\u4e0b\u9762\u7ec3\u4e60\u4ee3\u7801 **/ var SearchView = Backbone.View.extend({ el: \"#search_container\", initialize: function () { var mylabels = ['label1', 'label2', 'label3']; this.render({ // search_label: \"\u641c\u7d22btn\", labels: mylabels }); }, render: function (context) { // \u7528underscore\u7f16\u8bd1\u6a21\u677f var templ = _.template($(\"#search_template\").html()); // el\u52a0\u8f7d\u6a21\u677f $(this.el).html(templ(context)); }, // events: { // // \u7ed1\u5b9a\u4e8b\u4ef6: button\u7684input\u6807\u7b7e\u7684\u70b9\u51fb // 'click input[type=button]': 'doSearch' // }, // doSearch: function (event) { // // \u5b9a\u4e49\u4e8b\u4ef6\u7684\u6267\u884c\u51fd\u6570 // alert(\"search for \" + $(\"#search_input\").val()); // } }); // \u6307\u5b9aviev\u5bf9\u8c61\u7ed1\u5b9a\u7684div var searchView = new SearchView(); })(jQuery); </script> </body> </html>","title":"Backbone.js \u524d\u7aefMVC\u6846\u67b6"},{"location":"tech_tutorial/js%E5%BA%93/backbone/#backbonejs-mvc","text":"","title":"Backbone.js \u524d\u7aefMVC\u6846\u67b6"},{"location":"tech_tutorial/js%E5%BA%93/backbone/#_1","text":"Model\uff1a\u6570\u636e\u6a21\u578b\u4ee5\u53ca\u6d89\u53ca\u7684\u903b\u8f91\uff0c\u5982\u521b\u5efa\uff0c\u9a8c\u8bc1\uff0c\u9500\u6bc1\u6216\u8005\u4fdd\u5b58 Collection\uff1aModel\u7684\u6709\u5e8f\u96c6\u5408 View\uff1a\u5bf9Model\u548cCollection\u4e2d\u6570\u636e\u7684\u5c55\u793a\uff0c\u628a\u6570\u636e\u6e32\u67d3\uff08Render\uff09\u5230\u9875\u9762 Router\uff1a\u63a7\u5236\u524d\u9762\u8bf4\u7684View\u7684\u5c55\u793a","title":"\u6982\u5ff5"},{"location":"tech_tutorial/js%E5%BA%93/backbone/#model","text":"<html> <head> <title>backbone.js-Model</title> </head> <body> <!-- backbone.js --> <script src=\"../vendors/backbone.js/jquery-1.10.2.js\"></script> <script src=\"../vendors/backbone.js/underscore-1.5.2.js\"></script> <script src=\"../vendors/backbone.js/backbone-1.1.0.js\"></script> <script> (function ($) { var Man = Backbone.Model.extend({ initialize: function () { // \u6784\u9020\u65b9\u6cd5 alert('Hey!'); // \u7ed1\u5b9a\u76d1\u542c\u4e8b\u4ef6 this.bind( \"change:name\", function () { var name = this.get('name'); alert('\u5df2\u7ecf\u6539\u53d8name\u5c5e\u6027\u4e3a:' + name); } ); // \u7ed1\u5b9a\u9a8c\u8bc1\u4e8b\u4ef6 this.bind( \"invalid\", function (model, error) { alert(error); } ); }, defaults: { // \u6784\u9020\u65f6\uff0c\u9ed8\u8ba4\u503c name: 'Jeff', age: '38' }, validate: function (attributes) { if (attributes.name == '') { return \"name\u4e0d\u80fd\u4e3a\u7a7a\"; } }, aboutMe: function () { // \u5bf9\u8c61\u5185\u90e8\u65b9\u6cd5 return '\u6211\u662f' + this.get('name'); } }); var man1 = new Man; // \u8c03\u7528\u5bf9\u8c61\u65b9\u6cd5 alert(man1.aboutMe()); // \u8d4b\u503c\uff0c\u89e6\u53d1change\u4e8b\u4ef6 man1.set({ name: '\u9648', age: '25' }); // \u9ed8\u8ba4set\u65f6\u4e0d\u9a8c\u8bc1\uff0c\u53ef\u6307\u5b9a\u8ba4\u8bc1\u5f00\u542f\uff1aman1.set({name:''}, {'validate':true}); man1.set({ name: '' }); // save\u65f6\u8ba4\u8bc1 man1.save(); // \u53d6\u503c alert(man1.get('name')); })(jQuery); </script> </body> </html>","title":"Model"},{"location":"tech_tutorial/js%E5%BA%93/backbone/#collection","text":"<html> <head> <title>backbone.js-Collections</title> </head> <body> <!-- backbone.js --> <script src=\"../vendors/backbone.js/jquery-1.10.2.js\"></script> <script src=\"../vendors/backbone.js/underscore-1.5.2.js\"></script> <script src=\"../vendors/backbone.js/backbone-1.1.0.js\"></script> <script> (function ($) { /** *\u6b64\u5904\u586b\u5145\u4ee3\u7801\u4e0b\u9762\u7ec3\u4e60\u4ee3\u7801 **/ var Book = Backbone.Model.extend({ defaults: { title: 'default' } }); var book1 = new Book({title: 'b1'}); var book2 = new Book({title: 'b2'}); var book3 = new Book({title: 'b3'}); var book4 = new Book({title: 'b4'}); // \u4e66\u67b6\u5b9a\u4e49 var Bookshelf = Backbone.Collection.extend({ model: Book // \u8fdc\u7aef\u670d\u52a1\u5668\u7684restapi // ,url: '/books/' }); // \u4e66\u67b6\u6570\u7ec4\u6dfb\u52a0book var bookshelf1 = new Bookshelf; bookshelf1.add(book1); bookshelf1.add(book2); bookshelf1.add(book3); bookshelf1.add(book4); // \u79fb\u9664book bookshelf1.remove(book3); // \u57fa\u4e8eunderscore\uff0c\u904d\u5386\u83b7\u53d6\u6570\u636e bookshelf1.each(function(book){ alert(book.get('title')); }); // \u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6570\u636e\uff0c\u6210\u529f\u6267\u884csuccess:function\uff0c\u5931\u8d25\u6267\u884cerror:function // \u8fd4\u56dejson\uff1a[{'title':'b1'},{'title':'b2'}....] // bookshelf1.url = '/book/'; // bookshelf1.fetch({ // // \u6574\u4e2a\u6e05\u7a7acollection\uff0c\u91cd\u65b0\u6dfb\u52a0\u6240\u6709model\uff0c\u9ed8\u8ba4false // // reset: true, // success:function(collection, response, options){ // collection.each(function(book){ // alert(book.get('title')); // }); // }, // error:function(collection, response, options){ // alert('error'); // } // }); })(jQuery); </script> </body> </html>","title":"Collection"},{"location":"tech_tutorial/js%E5%BA%93/backbone/#router","text":"<html> <head> <title>backbone.js-Router</title> </head> <body> <a href=\"#/posts/120\">Post 120</a> <a href=\"#actions\">testActions</a> <!-- backbone.js --> <script src=\"../vendors/backbone.js/jquery-1.10.2.js\"></script> <script src=\"../vendors/backbone.js/underscore-1.5.2.js\"></script> <script src=\"../vendors/backbone.js/backbone-1.1.0.js\"></script> <script> (function ($) { var AppRouter = Backbone.Router.extend({ routes: { // \u7528\":\"\u6765\u628a#\u540e\u9762\u7684\u5bf9\u5e94\u7684\u4f4d\u7f6e\u4f5c\u4e3a\u53c2\u6570 \"posts/:id\": \"getPost\", // \u5339\u914d\u6240\u6709\u7684url \"*actions\": \"defaultRoute\" }, getPost: function(id){ alert(id); }, defaultRoute: function(actions){ // \u70b9\u51fb\u8be5\u94fe\u63a5\u65f6\u89e6\u53d1 alert(actions) } }); var app_router = new AppRouter; // \u521d\u59cb\u5316router Backbone.history.start() })(jQuery); </script> </body> </html>","title":"Router"},{"location":"tech_tutorial/js%E5%BA%93/backbone/#view","text":"<html> <head> <title>backbone.js-View</title> </head> <body> <div id=\"search_container\"></div> <script type=\"text/template\" id=\"search_template\"> <ul> <% _.each(labels, function(name) { %> <% if(name != \"label2\") { %> <li><%= name %></li> <% } %> <% }); %> </ul> </script> <!-- backbone.js --> <script src=\"../vendors/backbone.js/jquery-1.10.2.js\"></script> <script src=\"../vendors/backbone.js/underscore-1.8.2.js\"></script> <script src=\"../vendors/backbone.js/backbone-1.1.0.js\"></script> <script> (function ($) { /** *\u6b64\u5904\u586b\u5145\u4ee3\u7801\u4e0b\u9762\u7ec3\u4e60\u4ee3\u7801 **/ var SearchView = Backbone.View.extend({ el: \"#search_container\", initialize: function () { var mylabels = ['label1', 'label2', 'label3']; this.render({ // search_label: \"\u641c\u7d22btn\", labels: mylabels }); }, render: function (context) { // \u7528underscore\u7f16\u8bd1\u6a21\u677f var templ = _.template($(\"#search_template\").html()); // el\u52a0\u8f7d\u6a21\u677f $(this.el).html(templ(context)); }, // events: { // // \u7ed1\u5b9a\u4e8b\u4ef6: button\u7684input\u6807\u7b7e\u7684\u70b9\u51fb // 'click input[type=button]': 'doSearch' // }, // doSearch: function (event) { // // \u5b9a\u4e49\u4e8b\u4ef6\u7684\u6267\u884c\u51fd\u6570 // alert(\"search for \" + $(\"#search_input\").val()); // } }); // \u6307\u5b9aviev\u5bf9\u8c61\u7ed1\u5b9a\u7684div var searchView = new SearchView(); })(jQuery); </script> </body> </html>","title":"View"},{"location":"tech_tutorial/js%E5%BA%93/iview-admin/","text":"\u57fa\u4e8eVue\u7684\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u524d\u7aefUI\u65b9\u6848 \u53c2\u8003 \u5b98\u65b9github","title":"\u57fa\u4e8eVue\u7684\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u524d\u7aefUI\u65b9\u6848"},{"location":"tech_tutorial/js%E5%BA%93/iview-admin/#vueui","text":"","title":"\u57fa\u4e8eVue\u7684\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u524d\u7aefUI\u65b9\u6848"},{"location":"tech_tutorial/js%E5%BA%93/iview-admin/#_1","text":"\u5b98\u65b9github","title":"\u53c2\u8003"},{"location":"tech_tutorial/js%E5%BA%93/nvm/","text":"nvm Node\u7248\u672c\u7ba1\u7406\u5de5\u5177 \u5b89\u88c5 # \u4e0b\u8f7d\u811a\u672c\u5b89\u88c5 curl https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.2/install.sh -o nvm_install.sh bash nvm_install.sh # \u8f7d\u5165nvm\u73af\u5883 source ~/.bashrc \u4f7f\u7528 \u5e38\u7528\u547d\u4ee4 nvm -v \u663e\u793a\u5f53\u524d\u5de5\u5177\u7684\u7248\u672c nvm ls \u663e\u793a\u5b89\u88c5node\u4e00\u89c8 nvm install 16.16.0 \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684node nvm use system \u542f\u7528\u6307\u5b9a\u7248\u672c\u7684node\u7684\u73af\u5883\uff0c\u53ef\u4ee5\u67e5\u770bPATH \u5728supervisor\u4e2d\u4f7f\u7528 [program:my_app] user=root directory=/data/www/my_app ; \u5148\u8f7d\u5165nvm\uff0c\u6307\u5b9anode\u7248\u672c\uff0c\u518d\u542f\u52a8 command=bash -c \"source ~/.nvm/nvm.sh && nvm use 16.16.0 && npm run start\" priority=1 numprocs=1 autostart=true autorestart=true startsecs=10 \u53c2\u8003 \u5b98\u7f51\u6e90\u7801 https://github.com/nvm-sh/nvm","title":"nvm Node\u7248\u672c\u7ba1\u7406\u5de5\u5177"},{"location":"tech_tutorial/js%E5%BA%93/nvm/#nvm-node","text":"","title":"nvm Node\u7248\u672c\u7ba1\u7406\u5de5\u5177"},{"location":"tech_tutorial/js%E5%BA%93/nvm/#_1","text":"# \u4e0b\u8f7d\u811a\u672c\u5b89\u88c5 curl https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.2/install.sh -o nvm_install.sh bash nvm_install.sh # \u8f7d\u5165nvm\u73af\u5883 source ~/.bashrc","title":"\u5b89\u88c5"},{"location":"tech_tutorial/js%E5%BA%93/nvm/#_2","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/js%E5%BA%93/nvm/#_3","text":"nvm -v \u663e\u793a\u5f53\u524d\u5de5\u5177\u7684\u7248\u672c nvm ls \u663e\u793a\u5b89\u88c5node\u4e00\u89c8 nvm install 16.16.0 \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684node nvm use system \u542f\u7528\u6307\u5b9a\u7248\u672c\u7684node\u7684\u73af\u5883\uff0c\u53ef\u4ee5\u67e5\u770bPATH","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"tech_tutorial/js%E5%BA%93/nvm/#supervisor","text":"[program:my_app] user=root directory=/data/www/my_app ; \u5148\u8f7d\u5165nvm\uff0c\u6307\u5b9anode\u7248\u672c\uff0c\u518d\u542f\u52a8 command=bash -c \"source ~/.nvm/nvm.sh && nvm use 16.16.0 && npm run start\" priority=1 numprocs=1 autostart=true autorestart=true startsecs=10","title":"\u5728supervisor\u4e2d\u4f7f\u7528"},{"location":"tech_tutorial/js%E5%BA%93/nvm/#_4","text":"\u5b98\u7f51\u6e90\u7801 https://github.com/nvm-sh/nvm","title":"\u53c2\u8003"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/","text":"JVM\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536GC JVM\u5185\u5b58\u57fa\u7840 JVM\u5806 Java\u5bf9\u8c61\u7684\u6d3b\u52a8\u7a7a\u95f4\uff0c\u7a0b\u5e8f\u4e2d\u7684\u7c7b\u7684\u5bf9\u8c61\u4ece\u4e2d\u5206\u914d\u7a7a\u95f4\uff0c\u5176\u5b58\u50a8\u7740\u6b63\u5728\u8fd0\u884c\u7740\u7684\u5e94\u7528\u7a0b\u5e8f\u7528\u5230\u7684\u6240\u6709\u5bf9\u8c61\u3002 \u5bf9\u8c61\u7684\u5efa\u7acb\u65b9\u5f0f\u5c31\u662f\u90a3\u4e9bnew\u4e00\u7c7b\u7684\u64cd\u4f5c\uff0c\u5f53\u5bf9\u8c61\u65e0\u7528\u540e\uff0c\u662fGC\u6765\u8d1f\u8d23\u8fd9\u4e2a\u65e0\u7528\u7684\u5bf9\u8c61\u3002 \u5206\u7c7b\uff1a \u65b0\u57df\uff1a\u5b58\u50a8\u6240\u6709\u65b0\u6210\u751f\u7684\u5bf9\u8c61 Eden: From Space: \u7b80\u79f0A\u7a7a\u95f4 To Space: \u7b80\u79f0B\u7a7a\u95f4 \u65e7\u57df\uff1a\u65b0\u57df\u4e2d\u7684\u5bf9\u8c61\uff0c\u7ecf\u8fc7\u4e86\u4e00\u5b9a\u6b21\u6570\u7684GC\u5faa\u73af\u540e\uff0c\u88ab\u79fb\u5165\u65e7\u57df \u6c38\u4e45\u57df\uff1a\u5b58\u50a8\u7c7b\u548c\u65b9\u6cd5\u5bf9\u8c61\uff0c\u4ece\u914d\u7f6e\u7684\u89d2\u5ea6\u770b\uff0c\u8fd9\u4e2a\u57df\u662f\u72ec\u7acb\u7684\uff0c\u4e0d\u5305\u62ec\u5728JVM\u5806\u5185\u3002\u9ed8\u8ba4\u4e3a4M\u3002 \u4e00\u4e2a2G\u5806\u5927\u5c0f\u7684JVM\uff0c\u53ef\u80fd\u603b\u5171\u5360\u7528\u591a\u5c11\u5185\u5b58\u7684\uff1f \u5806\u5185\u5b58 \uff0b \u7ebf\u7a0b\u6570 \uff0a \u7ebf\u7a0b\u6808 \uff0b \u6c38\u4e45\u4ee3 \uff0b \u4e8c\u8fdb\u5236\u4ee3\u7801 \uff0b \u5806\u5916\u5185\u5b58 \u5806\u5185\u5b58\uff1a \u5b58\u50a8Java\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/64 \u7ebf\u7a0b\u6808\uff1a \u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\uff08\u539f\u5b50\u7c7b\u578b\uff0c\u5f15\u7528\uff09\u53ca\u5176\u4ed6\uff0c\u9ed8\u8ba4\u4e3a1M \u6c38\u4e45\u4ee3\uff1a \u5b58\u50a8\u7c7b\u5b9a\u4e49\u53ca\u5e38\u91cf\u6c60\uff0c\u6ce8\u610fJDK7/8\u7684\u533a\u522b \u4e8c\u8fdb\u5236\u4ee3\u7801\uff1aJDK7\u4e0e8\uff0c\u6253\u5f00\u591a\u5c42\u7f16\u8bd1\u65f6\u7684\u9ed8\u8ba4\u503c\u4e0d\u4e00\u6837\uff0c\u4ece48\u5230240M \u5806\u5916\u5185\u5b58\uff1a \u88abNetty\uff0c\u5806\u5916\u7f13\u5b58\u7b49\u4f7f\u7528\uff0c\u9ed8\u8ba4\u6700\u5927\u503c\u7ea6\u4e3a\u5806\u5185\u5b58\u5927\u5c0f \u5806\u5185\u5b58\u8bbe\u7f6e\u4e3a2G\uff0c\u90a3\u4e00\u4e2a\u67091000\u4e2a\u7ebf\u7a0b\u7684JVM\u53ef\u80fd\u9700\u8981: 2G + 1000 * 1M + 256M + 48/240M + (\uff5e2G) = 5.5G (3.5G) \u5783\u573e\u56de\u6536GC \u76ee\u7684\uff1a\u5728\u5806\u4e2d\uff0c\u627e\u5230\u5df2\u7ecf\u65e0\u7528\u7684\u5bf9\u8c61\uff0c\u5e76\u628a\u8fd9\u4e9b\u5bf9\u8c61\u5360\u7528\u7684\u7a7a\u95f4\u6536\u56de\u4f7f\u5176\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u3002 \u7b97\u6cd5\u601d\u8def\uff1a \u628a\u6240\u6709\u5bf9\u8c61\u7ec4\u6210\u4e00\u4e2a\u6811\u72b6\u7ed3\u6784\u96c6\u5408 \u4ece\u6811\u6839\u5f00\u59cb\u627e\uff0c\u53ea\u8981\u53ef\u4ee5\u627e\u5230\u7684\u90fd\u662f\u6d3b\u52a8\u5bf9\u8c61\uff0c\u5982\u679c\u627e\u4e0d\u5230\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u5e94\u8be5\u88ab\u56de\u6536 \u5bf9\u4e8e\u65b0\u57df(MinorGC)\uff0c\u91c7\u7528coping\u7b97\u6cd5(copy collect)\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u514b\u670d\u53e5\u67c4\u7684\u5f00\u9500\u548c\u89e3\u51b3\u5806\u788e\u7247\u7684\u5783\u573e\u56de\u6536 \u5f00\u59cb\u65f6\u628a\u5806\u5212\u5206\u4e3a\u4e00\u5757\u8f83\u5927\u7684Eden\u548c\u4e8c\u5757\u8f83\u5c0f\u7684Survior\u533a\u57df\uff08From Space\u548cTo Space\uff09\uff0c\u5728Hotspot\u4e2d\uff0c\u9ed8\u8ba4\u6bd4\u4f8b\u662f8:1:1 \u5bf9\u4e8e\u65b0\u751f\u6210\u7684\u5bf9\u8c61\uff0c\u90fd\u653e\u5728Eden\u4e2d\uff1b\u5f53Eden\u5145\u6ee1\u65f6\uff0cGC\u5f00\u59cb: \u9996\u5148\u505c\u6b62\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u5f00\u59cbGC\uff0c\u4ece\u6839\u96c6\u4e2d\u626b\u63cf\u6d3b\u52a8\u5bf9\u8c61\uff0c\u628a\u6240\u6709\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230A\u7a7a\u95f4\u4e2d\uff0c\u7136\u540eEden\u4f1a\u6e05\u7a7a\uff0c\u5b9e\u8df5\u8868\u660e98\uff05\u7684\u65b0\u751f\u4ee3\u7684\u5bf9\u8c61\u90fd\u662f\u671d\u751f\u5915\u6b7b \u4e00\u65e6\u5f53A\u7a7a\u95f4\u5145\u6ee1\uff0cGC\u5c31\u628a\u5728A\u7a7a\u95f4\u4e2d\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230B\u7a7a\u95f4\u4e2d(\u4f1a\u8986\u76d6\u539f\u6709\u7684\u5b58\u50a8\u5bf9\u8c61\uff0c\u6d3b\u52a8\u5bf9\u8c61\u6240\u5360\u7684\u5185\u5b58\u4e4b\u95f4\u6ca1\u6709\u7a7a\u95f2\u6d1e) \u5f53B\u7a7a\u95f4\u6ee1\u7684\u65f6\u95f4\uff0cGC\u5c31\u628a\u5728B\u7a7a\u95f4\u4e2d\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230A\u7a7a\u95f4\u4e2d\uff0cAB\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4e92\u6362\u89d2\u8272 \u6d3b\u52a8\u5bf9\u8c61\u7ecf\u8fc7\u4e00\u5b9a\u6b21\u6570\uff08\u5c0f\u4e8e-XX:MaxTenuringThreshold(\u9ed8\u8ba4\u4e3a 31 \u6b21)\u6b21\uff09\u7684GC\u64cd\u4f5c\u540e\uff0c\u5c31\u4f1a\u88ab\u653e\u5230\u65e7\u57df\u4e2d \u5bf9\u4e8e\u65e7\u57df(MajorGC/FullGC)\uff0c\u91c7\u7528tracing\u7b97\u6cd5\u7684\u4e00\u79cd(mark sweep/mark compatc)\uff0c\u79f0\u4e3a\u6807\u8bb0-\u6e05\u9664-\u538b\u7f29\u6536\u96c6\u5668\uff0c\u6ce8\u610f\uff0c\u538b\u7f29\uff0c\u8fd9\u662f\u4e2a\u5f00\u9500\u633a\u5927\u7684\u64cd\u4f5c\uff0c\u7528\u6237\u7ebf\u7a0b\u90fd\u4f1a\u88abblock \u6848\u4f8b # \u5185\u5b58\u76d1\u63a7\u7684\u65b9\u6cd5: jmap -heap pid(\u67e5\u770bjava \u5806\uff08heap\uff09\u4f7f\u7528\u60c5\u51b5) /usr/java/jdk1.8.0_162/bin/jmap -heap 87303 > jmap_87303.txt # \u5185\u5bb9\u5982\u4e0b\uff1a Attaching to process ID 87303, please wait... Debugger attached successfully. Server compiler detected. JVM version is 25.162-b12 using thread-local object allocation. Parallel GC with 23 thread(s) # GC\u65b9\u5f0f Heap Configuration: # \u5806\u5185\u5b58\u521d\u59cb\u5316\u914d\u7f6e MinHeapFreeRatio = 0 # -XX:MinHeapFreeRatio\u8bbe\u7f6eJVM\u5806\u6700\u5c0f\u7a7a\u95f2\u6bd4\u7387(default 40) MaxHeapFreeRatio = 100 # -XX:MaxHeapFreeRatio\u8bbe\u7f6eJVM\u5806\u6700\u5927\u7a7a\u95f2\u6bd4\u7387(default 70) MaxHeapSize = 536870912 (512.0MB) # -XX:MaxHeapSize=\u8bbe\u7f6eJVM\u5806\u7684\u6700\u5927 NewSize = 178782208 (170.5MB) # -XX:NewSize=\u8bbe\u7f6eJVM\u5806\u7684\u2018\u65b0\u751f\u4ee3\u2019\u7684\u9ed8\u8ba4\u5927\u5c0f MaxNewSize = 178782208 (170.5MB) # -XX:MaxNewSize=\u8bbe\u7f6eJVM\u5806\u7684\u2018\u65b0\u751f\u4ee3\u2019\u7684\u6700\u5927 OldSize = 358088704 (341.5MB) # -XX:OldSize=<value>:\u8bbe\u7f6eJVM\u5806\u7684\u2018\u8001\u751f\u4ee3\u2019\u7684\u5927\u5c0f NewRatio = 2 # -XX:NewRatio=:\u2018\u65b0\u751f\u4ee3\u2019\u548c\u2018\u8001\u751f\u4ee3\u2019\u7684\u5927\u5c0f\u6bd4 SurvivorRatio = 8 # -XX:SurvivorRatio=\u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4 MetaspaceSize = 21807104 (20.796875MB) # -XX:PermSize=<value>:\u8bbe\u7f6eJVM\u5806\u7684\u2018\u6c38\u751f\u4ee3\u2019\u7684\u521d\u59cb\u5927\u5c0f\uff08\u73b0\u5728\u662fjdk8\uff09 CompressedClassSpaceSize = 1073741824 (1024.0MB) MaxMetaspaceSize = 17592186044415 MB # -XX:MaxPermSize=<value>:\u8bbe\u7f6eJVM\u5806\u7684\u2018\u6c38\u751f\u4ee3\u2019\u7684\u6700\u5927\uff08\u73b0\u5728\u662fjdk8\uff09 G1HeapRegionSize = 0 (0.0MB) Heap Usage: # \u5806\u5185\u5b58\u5206\u5e03 PS Young Generation Eden Space: # Eden\u533a\u5185\u5b58\u5206\u5e03 capacity = 174587904 (166.5MB) # Eden\u533a\u603b\u5bb9\u91cf used = 4099296 (3.909393310546875MB) # Eden\u533a\u5df2\u4f7f\u7528 free = 170488608 (162.59060668945312MB) #Eden\u533a\u5269\u4f59\u5bb9\u91cf 2.3479839702984235% used # Eden\u533a\u4f7f\u7528\u6bd4\u7387 From Space: # Survivor\u533a\uff08A\u533a\uff09\u7684\u5185\u5b58\u5206\u5e03 capacity = 2097152 (2.0MB) used = 0 (0.0MB) free = 2097152 (2.0MB) 0.0% used To Space: # \u53e6\u4e00\u4e2aSurvivor\u533a\uff08B\u533a\uff09\u7684\u5185\u5b58\u5206\u5e03 capacity = 2097152 (2.0MB) used = 0 (0.0MB) free = 2097152 (2.0MB) 0.0% used PS Old Generation # Old\u533a\u5185\u5b58\u5206\u5e03 capacity = 358088704 (341.5MB) used = 78736888 (75.08934783935547MB) free = 279351816 (266.41065216064453MB) 21.988095999811264% used 38991 interned Strings occupying 3906872 bytes. # \u8fd9\u53f0\u673a\u5668\u7b80\u5355\u8bf4YG\u5185\u5b581G\uff0cOG\u5185\u5b582G\uff0c\u603b\u5185\u5b584G # \u5728\u8fd9\u6837\u7684\u914d\u7f6e\u4e0b\uff0cGC\u8fd0\u884c\u60c5\u51b5\uff1a /usr/java/jdk1.8.0_162/bin/jstat -gcutil -h5 87303 4s 100 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 0.00 5.51 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.00 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.33 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.94 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 15.80 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 0.00 16.37 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 # \u53d1\u751f\u4e86\u4e00\u6b21YG GC\uff0c\u4e5f\u5c31\u662fMinorGC\uff0c\u8017\u65f60.3s\uff084665.847 - 4665.547\uff09 0.00 0.00 0.56 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 0.00 0.00 1.33 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 0.00 0.00 1.75 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 \u5c0f\u7ed3 JVM\u5806\u7684\u5927\u5c0f\u51b3\u5b9a\u4e86GC\u7684\u8fd0\u884c\u65f6\u95f4\u3002\u5982\u679cJVM\u5806\u7684\u5927\u5c0f\u8d85\u8fc7\u4e00\u5b9a\u7684\u9650\u5ea6\uff0c\u90a3\u4e48GC\u7684\u8fd0\u884c\u65f6\u95f4\u4f1a\u5f88\u957f\u3002 \u5bf9\u8c61\u751f\u5b58\u7684\u65f6\u95f4\u8d8a\u957f\uff0cGC\u9700\u8981\u7684\u56de\u6536\u65f6\u95f4\u4e5f\u8d8a\u957f\uff0c\u5f71\u54cd\u56de\u6536\u901f\u5ea6\u3002 \u5927\u591a\u6570\u5bf9\u8c61\u90fd\u662f\u77ed\u547d\u7684\uff0c\u6240\u4ee5\uff0c\u5c3d\u53ef\u80fd\u8ba9\u8fd9\u4e9b\u5bf9\u8c61\u7684\u751f\u5b58\u671f\u5728GC\u7684\u4e00\u6b21\u8fd0\u884c\u5468\u671f\u5185 \u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u5efa\u7acb\u4e0e\u91ca\u653e\u5bf9\u8c61\u7684\u901f\u5ea6\u51b3\u5b9a\u4e86\u5783\u573e\u6536\u96c6\u7684\u9891\u7387\u3002 \u5982\u679cGC\u4e00\u6b21\u8fd0\u884c\u5468\u671f\u8d85\u8fc73-5\u79d2\uff0c\u8fd9\u4f1a\u5f88\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u5982\u679c\u53ef\u4ee5\uff0c\u5e94\u8be5\u51cf\u5c11JVM\u5806\u7684\u5927\u5c0f\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cJVM\u5806\u7684\u5927\u5c0f\u5e94\u4e3a\u7269\u7406\u5185\u5b58\u768480%\uff08\u7ecf\u9a8c\u503c\uff09 Java\u542f\u52a8\u53c2\u6570 \u53c2\u6570\u5b9a\u4e49 Xss\uff1a\u6bcf\u4e2a\u7ebf\u7a0b\u7684stack\u5927\u5c0f\uff08\u6808\uff09\uff0c\u9ed8\u8ba4\u6bcf\u6761\u7ebf\u7a0b\u4e3a1M\uff0c\u5b58\u653e\u65b9\u6cd5\u8c03\u7528\u51fa\u53c2\u5165\u53c2\u7684\u6808\u3001\u5c40\u90e8\u53d8\u91cf\u3001\u6807\u91cf\u66ff\u6362\u540e\u7684\u5c40\u90e8\u53d8\u91cf\u7b49 \u8bbe\u5c0f\u70b9\u8282\u7ea6\u5185\u5b58\u5f00\u66f4\u591a\u7ebf\u7a0b\uff0cOS\u5bf9\u4e00\u4e2a\u8fdb\u7a0b\u5185\u7684\u7ebf\u7a0b\u6570\u6709\u9650\u5236\uff0c\u4e0d\u80fd\u65e0\u9650\u751f\u6210\uff0c\u7ecf\u9a8c\u503c\u57283000~5000 \u6709JSON\u89e3\u6790\u4e4b\u7c7b\u7684\u9012\u5f52\u8c03\u7528\u65f6\u4e0d\u80fd\u8bbe\u592a\u5c0f Xms\uff1aJAVA HEAP\u7684\u521d\u59cb\u503c\uff0c\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/64\uff0cserver\u7aef\u6700\u597dXms\u4e0eXmx\u4e00\u6837 Xmx\uff1aJAVA HEAP\u7684\u6700\u5927\u503c\u3001\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/4\uff08\u53ea\u6709\u8fd0\u884c\u5728 server \u6a21\u5f0f\u4e0b\u7684\u65f6\u5019\u624d\u662f min(1G, \u7269\u7406\u5185\u5b58\u7684\u56db\u5206\u4e4b\u4e00)\uff09 -Xms2g -Xmx2g \u6bd4\u8f83\u5408\u9002\u7684\u6570\u503c\u662f2-4g\uff0c\u518d\u5927\u5c31\u5f97\u8003\u8651GC\u65f6\u95f4 Xmn\uff1aJAVA HEAP young\u533a\u7684\u5927\u5c0f\uff0c\u9ed8\u8ba4\u65b0\u751f\u4ee3\u5360\u5806\u5185\u5b58\u5927\u5c0f\u76841/3\uff08-XX:NewRatio=2\uff09 -Xmn1g \u6216 -XX:NewRatio=1 -XX:NewRatio=4 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\uff08\u5305\u62ecEden\u548c\u4e24\u4e2aSurvivor\u533a\uff09\u4e0e\u5e74\u8001\u4ee3\u7684\u6bd4\u503c\uff08\u9664\u53bb\u6301\u4e45\u4ee3\uff09\u3002\u8bbe\u7f6e\u4e3a4\uff0c\u5219\u5e74\u8f7b\u4ee3\u4e0e\u5e74\u8001\u4ee3\u6240\u5360\u6bd4\u503c\u4e3a1:4\uff0c\u5e74\u8f7b\u4ee3\u5360\u6574\u4e2a\u5806\u6808\u76841/5 -XX:SurvivorRatio=4 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u503c\u3002\u8bbe\u7f6e\u4e3a4\uff0c\u5219\u4e24\u4e2aSurvivor\u533a\u4e0e\u4e00\u4e2aEden\u533a\u7684\u6bd4\u503c\u4e3a2:4\uff0c\u4e00\u4e2aSurvivor\u533a\u5360\u6574\u4e2a\u5e74\u8f7b\u4ee3\u76841/6 -XX:MaxTenuringThreshold=0 \u8bbe\u7f6e\u5783\u573e\u6700\u5927\u5e74\u9f84\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u5219\u5e74\u8f7b\u4ee3\u5bf9\u8c61\u4e0d\u7ecf\u8fc7Survivor\u533a\uff0c\u76f4\u63a5\u8fdb\u5165\u5e74\u8001\u4ee3\uff0c\u5bf9\u4e8e\u5e74\u8001\u4ee3\u6bd4\u8f83\u591a\u7684\u5e94\u7528\uff0c\u53ef\u4ee5\u63d0\u9ad8\u6548\u7387 \u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u8f83\u5927\u503c\uff0c\u5219\u5e74\u8f7b\u4ee3\u5bf9\u8c61\u4f1a\u5728Survivor\u533a\u8fdb\u884c\u591a\u6b21\u590d\u5236\uff0c\u53ef\u4ee5\u589e\u52a0\u5bf9\u8c61\u518d\u5e74\u8f7b\u4ee3\u7684\u5b58\u6d3b\u65f6\u95f4 XX:PermSize\uff1a\u8bbe\u5b9a\u5185\u5b58\u7684\u6c38\u4e45\u4fdd\u5b58\u533a\u57df XX:MaxPermSize\uff1a\u8bbe\u5b9a\u6700\u5927\u5185\u5b58\u7684\u6c38\u4e45\u4fdd\u5b58\u533a\u57df\uff0c\u51e0\u4e4e\u53ef\u7528\u5b8c\u673a\u5668\u7684\u6240\u6709\u5185\u5b58 -server \u4e0b\u9ed8\u8ba4MaxPermSize\u4e3a64m MaxPermSize\u8bbe\u7f6e\u8fc7\u5c0f\u4f1a\u5bfc\u81f4 java.lang.OutOfMemoryError: PermGen space \u5728JDK1.8\u4e2d\uff0c\u53d6\u6d88\u4e86PermGen\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662fMetaspace \u4e3e\u4f8b\uff1a -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=512m \u56de\u6536\u7b97\u6cd5 \u2013XX:+UseSerialGC \u5f3a\u5236 java -client \u9ed8\u8ba4\u4f1a\u4f7f\u7528, \u901f\u5ea6\u6162\u3002\u670d\u52a1\u5668\u5e94\u7528\u4e0d\u63a8\u8350\u3002 \u2013XX:+UseParallelGC linux x64\u4e0a\u9ed8\u8ba4\uff0c\u5176\u4ed6\u5e73\u53f0\u8981\u52a0 -server \u624d\u4f1a\u9009\u7528 young = parallel\uff0c\u591a\u4e2athread\u540c\u65f6copy; old = mark-sweep-compact = 1 \u4f18\u70b9\uff1a\u65b0\u751f\u4ee3\u56de\u6536\u66f4\u5feb\u3002\u56e0\u4e3a\u7cfb\u7edf\u5927\u90e8\u5206\u65f6\u95f4\u505a\u7684gc\u90fd\u662f\u65b0\u751f\u4ee3\u7684 \u7f3a\u70b9\uff1a\u5f53\u8fd0\u884c\u57288G/16G server\u4e0aold generation live object\u592a\u591a\u65f6\u5019pause time\u8fc7\u957f \u2013XX:+UseParallelOldGC young = parallel = 2; old = parallel\uff0c\u5206\u6210\u591a\u4e2a\u72ec\u7acb\u7684\u5355\u5143\uff0c\u5982\u679c\u5355\u5143\u4e2dlive object\u5c11\u5219\u56de\u6536\uff0c\u591a\u5219\u8df3\u8fc7 \u4f18\u70b9\uff1aold generation\u4e0a\u6027\u80fd\u8f83 parallel \u65b9\u5f0f\u6709\u63d0\u9ad8 \u7f3a\u70b9\uff1a\u5927\u90e8\u5206server\u7cfb\u7edfold generation\u5185\u5b58\u5360\u7528\u4f1a\u8fbe\u523060%-80%, \u6ca1\u6709\u90a3\u4e48\u591a\u7406\u60f3\u7684\u5355\u5143live object\u5f88\u5c11\u65b9\u4fbf\u8fc5\u901f\u56de\u6536\uff0c\u540c\u65f6compact\u65b9\u9762\u5f00\u9500\u6bd4\u8d77parallel\u5e76\u6ca1\u660e\u663e\u51cf\u5c11 \u2013XX:+UseConcMarkSweepGC Concurent Mark-Sweep(CMS) Collector young generation = parallel collector = 2; old = cms\uff0c\u540c\u65f6\u4e0d\u505a compact \u64cd\u4f5c \u4f18\u70b9\uff1apause time\u4f1a\u964d\u4f4e, pause\u654f\u611f \u7f3a\u70b9\uff1acpu\u5360\u7528\u8fc7\u591a\uff0ccpu\u5bc6\u96c6\u578b\u670d\u52a1\u5668\u4e0d\u9002\u5408\u3002\u53e6\u5916\u788e\u7247\u592a\u591a\uff0c\u6bcf\u4e2aobject\u7684\u5b58\u50a8\u90fd\u8981\u901a\u8fc7\u94fe\u8868\u8fde\u7eed\u8df3n\u4e2a\u5730\u65b9\uff0c\u7a7a\u95f4\u6d6a\u8d39\u95ee\u9898\u4e5f\u4f1a\u589e\u5927 # \u67e5\u770bJVM\u9ed8\u8ba4\u53c2\u6570\u4e2d\u7684\u5806\u6700\u5927\u503c java -XX:+PrintFlagsFinal -version | grep HeapSize # \u7eafjar\u542f\u52a8\uff0c\u9002\u7528JDK7 java \\ -Xmx512M \\ -XX:MaxPermSize=128M \\ -jar ./biz-1.0.0-SNAPSHOT.jar # Tomcat\u542f\u52a8 java \\ -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties \\ -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \\ -Djdk.tls.ephemeralDHKeySize=2048 \\ -Dignore.endorsed.dirs= \\ -classpath /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar \\ -Dcatalina.base=/usr/local/tomcat \\ -Dcatalina.home=/usr/local/tomcat \\ -Djava.io.tmpdir=/usr/local/tomcat/temp org.apache.catalina.startup.Bootstrap start","title":"JVM\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536GC"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#jvmgc","text":"","title":"JVM\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536GC"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#jvm","text":"","title":"JVM\u5185\u5b58\u57fa\u7840"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#jvm_1","text":"Java\u5bf9\u8c61\u7684\u6d3b\u52a8\u7a7a\u95f4\uff0c\u7a0b\u5e8f\u4e2d\u7684\u7c7b\u7684\u5bf9\u8c61\u4ece\u4e2d\u5206\u914d\u7a7a\u95f4\uff0c\u5176\u5b58\u50a8\u7740\u6b63\u5728\u8fd0\u884c\u7740\u7684\u5e94\u7528\u7a0b\u5e8f\u7528\u5230\u7684\u6240\u6709\u5bf9\u8c61\u3002 \u5bf9\u8c61\u7684\u5efa\u7acb\u65b9\u5f0f\u5c31\u662f\u90a3\u4e9bnew\u4e00\u7c7b\u7684\u64cd\u4f5c\uff0c\u5f53\u5bf9\u8c61\u65e0\u7528\u540e\uff0c\u662fGC\u6765\u8d1f\u8d23\u8fd9\u4e2a\u65e0\u7528\u7684\u5bf9\u8c61\u3002 \u5206\u7c7b\uff1a \u65b0\u57df\uff1a\u5b58\u50a8\u6240\u6709\u65b0\u6210\u751f\u7684\u5bf9\u8c61 Eden: From Space: \u7b80\u79f0A\u7a7a\u95f4 To Space: \u7b80\u79f0B\u7a7a\u95f4 \u65e7\u57df\uff1a\u65b0\u57df\u4e2d\u7684\u5bf9\u8c61\uff0c\u7ecf\u8fc7\u4e86\u4e00\u5b9a\u6b21\u6570\u7684GC\u5faa\u73af\u540e\uff0c\u88ab\u79fb\u5165\u65e7\u57df \u6c38\u4e45\u57df\uff1a\u5b58\u50a8\u7c7b\u548c\u65b9\u6cd5\u5bf9\u8c61\uff0c\u4ece\u914d\u7f6e\u7684\u89d2\u5ea6\u770b\uff0c\u8fd9\u4e2a\u57df\u662f\u72ec\u7acb\u7684\uff0c\u4e0d\u5305\u62ec\u5728JVM\u5806\u5185\u3002\u9ed8\u8ba4\u4e3a4M\u3002","title":"JVM\u5806"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#2gjvm","text":"\u5806\u5185\u5b58 \uff0b \u7ebf\u7a0b\u6570 \uff0a \u7ebf\u7a0b\u6808 \uff0b \u6c38\u4e45\u4ee3 \uff0b \u4e8c\u8fdb\u5236\u4ee3\u7801 \uff0b \u5806\u5916\u5185\u5b58 \u5806\u5185\u5b58\uff1a \u5b58\u50a8Java\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/64 \u7ebf\u7a0b\u6808\uff1a \u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\uff08\u539f\u5b50\u7c7b\u578b\uff0c\u5f15\u7528\uff09\u53ca\u5176\u4ed6\uff0c\u9ed8\u8ba4\u4e3a1M \u6c38\u4e45\u4ee3\uff1a \u5b58\u50a8\u7c7b\u5b9a\u4e49\u53ca\u5e38\u91cf\u6c60\uff0c\u6ce8\u610fJDK7/8\u7684\u533a\u522b \u4e8c\u8fdb\u5236\u4ee3\u7801\uff1aJDK7\u4e0e8\uff0c\u6253\u5f00\u591a\u5c42\u7f16\u8bd1\u65f6\u7684\u9ed8\u8ba4\u503c\u4e0d\u4e00\u6837\uff0c\u4ece48\u5230240M \u5806\u5916\u5185\u5b58\uff1a \u88abNetty\uff0c\u5806\u5916\u7f13\u5b58\u7b49\u4f7f\u7528\uff0c\u9ed8\u8ba4\u6700\u5927\u503c\u7ea6\u4e3a\u5806\u5185\u5b58\u5927\u5c0f \u5806\u5185\u5b58\u8bbe\u7f6e\u4e3a2G\uff0c\u90a3\u4e00\u4e2a\u67091000\u4e2a\u7ebf\u7a0b\u7684JVM\u53ef\u80fd\u9700\u8981: 2G + 1000 * 1M + 256M + 48/240M + (\uff5e2G) = 5.5G (3.5G)","title":"\u4e00\u4e2a2G\u5806\u5927\u5c0f\u7684JVM\uff0c\u53ef\u80fd\u603b\u5171\u5360\u7528\u591a\u5c11\u5185\u5b58\u7684\uff1f"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#gc","text":"\u76ee\u7684\uff1a\u5728\u5806\u4e2d\uff0c\u627e\u5230\u5df2\u7ecf\u65e0\u7528\u7684\u5bf9\u8c61\uff0c\u5e76\u628a\u8fd9\u4e9b\u5bf9\u8c61\u5360\u7528\u7684\u7a7a\u95f4\u6536\u56de\u4f7f\u5176\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u3002 \u7b97\u6cd5\u601d\u8def\uff1a \u628a\u6240\u6709\u5bf9\u8c61\u7ec4\u6210\u4e00\u4e2a\u6811\u72b6\u7ed3\u6784\u96c6\u5408 \u4ece\u6811\u6839\u5f00\u59cb\u627e\uff0c\u53ea\u8981\u53ef\u4ee5\u627e\u5230\u7684\u90fd\u662f\u6d3b\u52a8\u5bf9\u8c61\uff0c\u5982\u679c\u627e\u4e0d\u5230\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u5e94\u8be5\u88ab\u56de\u6536 \u5bf9\u4e8e\u65b0\u57df(MinorGC)\uff0c\u91c7\u7528coping\u7b97\u6cd5(copy collect)\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u514b\u670d\u53e5\u67c4\u7684\u5f00\u9500\u548c\u89e3\u51b3\u5806\u788e\u7247\u7684\u5783\u573e\u56de\u6536 \u5f00\u59cb\u65f6\u628a\u5806\u5212\u5206\u4e3a\u4e00\u5757\u8f83\u5927\u7684Eden\u548c\u4e8c\u5757\u8f83\u5c0f\u7684Survior\u533a\u57df\uff08From Space\u548cTo Space\uff09\uff0c\u5728Hotspot\u4e2d\uff0c\u9ed8\u8ba4\u6bd4\u4f8b\u662f8:1:1 \u5bf9\u4e8e\u65b0\u751f\u6210\u7684\u5bf9\u8c61\uff0c\u90fd\u653e\u5728Eden\u4e2d\uff1b\u5f53Eden\u5145\u6ee1\u65f6\uff0cGC\u5f00\u59cb: \u9996\u5148\u505c\u6b62\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u5f00\u59cbGC\uff0c\u4ece\u6839\u96c6\u4e2d\u626b\u63cf\u6d3b\u52a8\u5bf9\u8c61\uff0c\u628a\u6240\u6709\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230A\u7a7a\u95f4\u4e2d\uff0c\u7136\u540eEden\u4f1a\u6e05\u7a7a\uff0c\u5b9e\u8df5\u8868\u660e98\uff05\u7684\u65b0\u751f\u4ee3\u7684\u5bf9\u8c61\u90fd\u662f\u671d\u751f\u5915\u6b7b \u4e00\u65e6\u5f53A\u7a7a\u95f4\u5145\u6ee1\uff0cGC\u5c31\u628a\u5728A\u7a7a\u95f4\u4e2d\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230B\u7a7a\u95f4\u4e2d(\u4f1a\u8986\u76d6\u539f\u6709\u7684\u5b58\u50a8\u5bf9\u8c61\uff0c\u6d3b\u52a8\u5bf9\u8c61\u6240\u5360\u7684\u5185\u5b58\u4e4b\u95f4\u6ca1\u6709\u7a7a\u95f2\u6d1e) \u5f53B\u7a7a\u95f4\u6ee1\u7684\u65f6\u95f4\uff0cGC\u5c31\u628a\u5728B\u7a7a\u95f4\u4e2d\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230A\u7a7a\u95f4\u4e2d\uff0cAB\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4e92\u6362\u89d2\u8272 \u6d3b\u52a8\u5bf9\u8c61\u7ecf\u8fc7\u4e00\u5b9a\u6b21\u6570\uff08\u5c0f\u4e8e-XX:MaxTenuringThreshold(\u9ed8\u8ba4\u4e3a 31 \u6b21)\u6b21\uff09\u7684GC\u64cd\u4f5c\u540e\uff0c\u5c31\u4f1a\u88ab\u653e\u5230\u65e7\u57df\u4e2d \u5bf9\u4e8e\u65e7\u57df(MajorGC/FullGC)\uff0c\u91c7\u7528tracing\u7b97\u6cd5\u7684\u4e00\u79cd(mark sweep/mark compatc)\uff0c\u79f0\u4e3a\u6807\u8bb0-\u6e05\u9664-\u538b\u7f29\u6536\u96c6\u5668\uff0c\u6ce8\u610f\uff0c\u538b\u7f29\uff0c\u8fd9\u662f\u4e2a\u5f00\u9500\u633a\u5927\u7684\u64cd\u4f5c\uff0c\u7528\u6237\u7ebf\u7a0b\u90fd\u4f1a\u88abblock","title":"\u5783\u573e\u56de\u6536GC"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#_1","text":"# \u5185\u5b58\u76d1\u63a7\u7684\u65b9\u6cd5: jmap -heap pid(\u67e5\u770bjava \u5806\uff08heap\uff09\u4f7f\u7528\u60c5\u51b5) /usr/java/jdk1.8.0_162/bin/jmap -heap 87303 > jmap_87303.txt # \u5185\u5bb9\u5982\u4e0b\uff1a Attaching to process ID 87303, please wait... Debugger attached successfully. Server compiler detected. JVM version is 25.162-b12 using thread-local object allocation. Parallel GC with 23 thread(s) # GC\u65b9\u5f0f Heap Configuration: # \u5806\u5185\u5b58\u521d\u59cb\u5316\u914d\u7f6e MinHeapFreeRatio = 0 # -XX:MinHeapFreeRatio\u8bbe\u7f6eJVM\u5806\u6700\u5c0f\u7a7a\u95f2\u6bd4\u7387(default 40) MaxHeapFreeRatio = 100 # -XX:MaxHeapFreeRatio\u8bbe\u7f6eJVM\u5806\u6700\u5927\u7a7a\u95f2\u6bd4\u7387(default 70) MaxHeapSize = 536870912 (512.0MB) # -XX:MaxHeapSize=\u8bbe\u7f6eJVM\u5806\u7684\u6700\u5927 NewSize = 178782208 (170.5MB) # -XX:NewSize=\u8bbe\u7f6eJVM\u5806\u7684\u2018\u65b0\u751f\u4ee3\u2019\u7684\u9ed8\u8ba4\u5927\u5c0f MaxNewSize = 178782208 (170.5MB) # -XX:MaxNewSize=\u8bbe\u7f6eJVM\u5806\u7684\u2018\u65b0\u751f\u4ee3\u2019\u7684\u6700\u5927 OldSize = 358088704 (341.5MB) # -XX:OldSize=<value>:\u8bbe\u7f6eJVM\u5806\u7684\u2018\u8001\u751f\u4ee3\u2019\u7684\u5927\u5c0f NewRatio = 2 # -XX:NewRatio=:\u2018\u65b0\u751f\u4ee3\u2019\u548c\u2018\u8001\u751f\u4ee3\u2019\u7684\u5927\u5c0f\u6bd4 SurvivorRatio = 8 # -XX:SurvivorRatio=\u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4 MetaspaceSize = 21807104 (20.796875MB) # -XX:PermSize=<value>:\u8bbe\u7f6eJVM\u5806\u7684\u2018\u6c38\u751f\u4ee3\u2019\u7684\u521d\u59cb\u5927\u5c0f\uff08\u73b0\u5728\u662fjdk8\uff09 CompressedClassSpaceSize = 1073741824 (1024.0MB) MaxMetaspaceSize = 17592186044415 MB # -XX:MaxPermSize=<value>:\u8bbe\u7f6eJVM\u5806\u7684\u2018\u6c38\u751f\u4ee3\u2019\u7684\u6700\u5927\uff08\u73b0\u5728\u662fjdk8\uff09 G1HeapRegionSize = 0 (0.0MB) Heap Usage: # \u5806\u5185\u5b58\u5206\u5e03 PS Young Generation Eden Space: # Eden\u533a\u5185\u5b58\u5206\u5e03 capacity = 174587904 (166.5MB) # Eden\u533a\u603b\u5bb9\u91cf used = 4099296 (3.909393310546875MB) # Eden\u533a\u5df2\u4f7f\u7528 free = 170488608 (162.59060668945312MB) #Eden\u533a\u5269\u4f59\u5bb9\u91cf 2.3479839702984235% used # Eden\u533a\u4f7f\u7528\u6bd4\u7387 From Space: # Survivor\u533a\uff08A\u533a\uff09\u7684\u5185\u5b58\u5206\u5e03 capacity = 2097152 (2.0MB) used = 0 (0.0MB) free = 2097152 (2.0MB) 0.0% used To Space: # \u53e6\u4e00\u4e2aSurvivor\u533a\uff08B\u533a\uff09\u7684\u5185\u5b58\u5206\u5e03 capacity = 2097152 (2.0MB) used = 0 (0.0MB) free = 2097152 (2.0MB) 0.0% used PS Old Generation # Old\u533a\u5185\u5b58\u5206\u5e03 capacity = 358088704 (341.5MB) used = 78736888 (75.08934783935547MB) free = 279351816 (266.41065216064453MB) 21.988095999811264% used 38991 interned Strings occupying 3906872 bytes. # \u8fd9\u53f0\u673a\u5668\u7b80\u5355\u8bf4YG\u5185\u5b581G\uff0cOG\u5185\u5b582G\uff0c\u603b\u5185\u5b584G # \u5728\u8fd9\u6837\u7684\u914d\u7f6e\u4e0b\uff0cGC\u8fd0\u884c\u60c5\u51b5\uff1a /usr/java/jdk1.8.0_162/bin/jstat -gcutil -h5 87303 4s 100 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 0.00 5.51 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.00 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.33 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.94 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 15.80 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 0.00 16.37 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 # \u53d1\u751f\u4e86\u4e00\u6b21YG GC\uff0c\u4e5f\u5c31\u662fMinorGC\uff0c\u8017\u65f60.3s\uff084665.847 - 4665.547\uff09 0.00 0.00 0.56 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 0.00 0.00 1.33 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 0.00 0.00 1.75 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847","title":"\u6848\u4f8b"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#_2","text":"JVM\u5806\u7684\u5927\u5c0f\u51b3\u5b9a\u4e86GC\u7684\u8fd0\u884c\u65f6\u95f4\u3002\u5982\u679cJVM\u5806\u7684\u5927\u5c0f\u8d85\u8fc7\u4e00\u5b9a\u7684\u9650\u5ea6\uff0c\u90a3\u4e48GC\u7684\u8fd0\u884c\u65f6\u95f4\u4f1a\u5f88\u957f\u3002 \u5bf9\u8c61\u751f\u5b58\u7684\u65f6\u95f4\u8d8a\u957f\uff0cGC\u9700\u8981\u7684\u56de\u6536\u65f6\u95f4\u4e5f\u8d8a\u957f\uff0c\u5f71\u54cd\u56de\u6536\u901f\u5ea6\u3002 \u5927\u591a\u6570\u5bf9\u8c61\u90fd\u662f\u77ed\u547d\u7684\uff0c\u6240\u4ee5\uff0c\u5c3d\u53ef\u80fd\u8ba9\u8fd9\u4e9b\u5bf9\u8c61\u7684\u751f\u5b58\u671f\u5728GC\u7684\u4e00\u6b21\u8fd0\u884c\u5468\u671f\u5185 \u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u5efa\u7acb\u4e0e\u91ca\u653e\u5bf9\u8c61\u7684\u901f\u5ea6\u51b3\u5b9a\u4e86\u5783\u573e\u6536\u96c6\u7684\u9891\u7387\u3002 \u5982\u679cGC\u4e00\u6b21\u8fd0\u884c\u5468\u671f\u8d85\u8fc73-5\u79d2\uff0c\u8fd9\u4f1a\u5f88\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u5982\u679c\u53ef\u4ee5\uff0c\u5e94\u8be5\u51cf\u5c11JVM\u5806\u7684\u5927\u5c0f\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cJVM\u5806\u7684\u5927\u5c0f\u5e94\u4e3a\u7269\u7406\u5185\u5b58\u768480%\uff08\u7ecf\u9a8c\u503c\uff09","title":"\u5c0f\u7ed3"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#java","text":"","title":"Java\u542f\u52a8\u53c2\u6570"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#_3","text":"Xss\uff1a\u6bcf\u4e2a\u7ebf\u7a0b\u7684stack\u5927\u5c0f\uff08\u6808\uff09\uff0c\u9ed8\u8ba4\u6bcf\u6761\u7ebf\u7a0b\u4e3a1M\uff0c\u5b58\u653e\u65b9\u6cd5\u8c03\u7528\u51fa\u53c2\u5165\u53c2\u7684\u6808\u3001\u5c40\u90e8\u53d8\u91cf\u3001\u6807\u91cf\u66ff\u6362\u540e\u7684\u5c40\u90e8\u53d8\u91cf\u7b49 \u8bbe\u5c0f\u70b9\u8282\u7ea6\u5185\u5b58\u5f00\u66f4\u591a\u7ebf\u7a0b\uff0cOS\u5bf9\u4e00\u4e2a\u8fdb\u7a0b\u5185\u7684\u7ebf\u7a0b\u6570\u6709\u9650\u5236\uff0c\u4e0d\u80fd\u65e0\u9650\u751f\u6210\uff0c\u7ecf\u9a8c\u503c\u57283000~5000 \u6709JSON\u89e3\u6790\u4e4b\u7c7b\u7684\u9012\u5f52\u8c03\u7528\u65f6\u4e0d\u80fd\u8bbe\u592a\u5c0f Xms\uff1aJAVA HEAP\u7684\u521d\u59cb\u503c\uff0c\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/64\uff0cserver\u7aef\u6700\u597dXms\u4e0eXmx\u4e00\u6837 Xmx\uff1aJAVA HEAP\u7684\u6700\u5927\u503c\u3001\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/4\uff08\u53ea\u6709\u8fd0\u884c\u5728 server \u6a21\u5f0f\u4e0b\u7684\u65f6\u5019\u624d\u662f min(1G, \u7269\u7406\u5185\u5b58\u7684\u56db\u5206\u4e4b\u4e00)\uff09 -Xms2g -Xmx2g \u6bd4\u8f83\u5408\u9002\u7684\u6570\u503c\u662f2-4g\uff0c\u518d\u5927\u5c31\u5f97\u8003\u8651GC\u65f6\u95f4 Xmn\uff1aJAVA HEAP young\u533a\u7684\u5927\u5c0f\uff0c\u9ed8\u8ba4\u65b0\u751f\u4ee3\u5360\u5806\u5185\u5b58\u5927\u5c0f\u76841/3\uff08-XX:NewRatio=2\uff09 -Xmn1g \u6216 -XX:NewRatio=1 -XX:NewRatio=4 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\uff08\u5305\u62ecEden\u548c\u4e24\u4e2aSurvivor\u533a\uff09\u4e0e\u5e74\u8001\u4ee3\u7684\u6bd4\u503c\uff08\u9664\u53bb\u6301\u4e45\u4ee3\uff09\u3002\u8bbe\u7f6e\u4e3a4\uff0c\u5219\u5e74\u8f7b\u4ee3\u4e0e\u5e74\u8001\u4ee3\u6240\u5360\u6bd4\u503c\u4e3a1:4\uff0c\u5e74\u8f7b\u4ee3\u5360\u6574\u4e2a\u5806\u6808\u76841/5 -XX:SurvivorRatio=4 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u503c\u3002\u8bbe\u7f6e\u4e3a4\uff0c\u5219\u4e24\u4e2aSurvivor\u533a\u4e0e\u4e00\u4e2aEden\u533a\u7684\u6bd4\u503c\u4e3a2:4\uff0c\u4e00\u4e2aSurvivor\u533a\u5360\u6574\u4e2a\u5e74\u8f7b\u4ee3\u76841/6 -XX:MaxTenuringThreshold=0 \u8bbe\u7f6e\u5783\u573e\u6700\u5927\u5e74\u9f84\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u5219\u5e74\u8f7b\u4ee3\u5bf9\u8c61\u4e0d\u7ecf\u8fc7Survivor\u533a\uff0c\u76f4\u63a5\u8fdb\u5165\u5e74\u8001\u4ee3\uff0c\u5bf9\u4e8e\u5e74\u8001\u4ee3\u6bd4\u8f83\u591a\u7684\u5e94\u7528\uff0c\u53ef\u4ee5\u63d0\u9ad8\u6548\u7387 \u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u8f83\u5927\u503c\uff0c\u5219\u5e74\u8f7b\u4ee3\u5bf9\u8c61\u4f1a\u5728Survivor\u533a\u8fdb\u884c\u591a\u6b21\u590d\u5236\uff0c\u53ef\u4ee5\u589e\u52a0\u5bf9\u8c61\u518d\u5e74\u8f7b\u4ee3\u7684\u5b58\u6d3b\u65f6\u95f4 XX:PermSize\uff1a\u8bbe\u5b9a\u5185\u5b58\u7684\u6c38\u4e45\u4fdd\u5b58\u533a\u57df XX:MaxPermSize\uff1a\u8bbe\u5b9a\u6700\u5927\u5185\u5b58\u7684\u6c38\u4e45\u4fdd\u5b58\u533a\u57df\uff0c\u51e0\u4e4e\u53ef\u7528\u5b8c\u673a\u5668\u7684\u6240\u6709\u5185\u5b58 -server \u4e0b\u9ed8\u8ba4MaxPermSize\u4e3a64m MaxPermSize\u8bbe\u7f6e\u8fc7\u5c0f\u4f1a\u5bfc\u81f4 java.lang.OutOfMemoryError: PermGen space \u5728JDK1.8\u4e2d\uff0c\u53d6\u6d88\u4e86PermGen\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662fMetaspace \u4e3e\u4f8b\uff1a -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=512m","title":"\u53c2\u6570\u5b9a\u4e49"},{"location":"tech_tutorial/jvm%E7%B3%BB/jvm%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc/#_4","text":"\u2013XX:+UseSerialGC \u5f3a\u5236 java -client \u9ed8\u8ba4\u4f1a\u4f7f\u7528, \u901f\u5ea6\u6162\u3002\u670d\u52a1\u5668\u5e94\u7528\u4e0d\u63a8\u8350\u3002 \u2013XX:+UseParallelGC linux x64\u4e0a\u9ed8\u8ba4\uff0c\u5176\u4ed6\u5e73\u53f0\u8981\u52a0 -server \u624d\u4f1a\u9009\u7528 young = parallel\uff0c\u591a\u4e2athread\u540c\u65f6copy; old = mark-sweep-compact = 1 \u4f18\u70b9\uff1a\u65b0\u751f\u4ee3\u56de\u6536\u66f4\u5feb\u3002\u56e0\u4e3a\u7cfb\u7edf\u5927\u90e8\u5206\u65f6\u95f4\u505a\u7684gc\u90fd\u662f\u65b0\u751f\u4ee3\u7684 \u7f3a\u70b9\uff1a\u5f53\u8fd0\u884c\u57288G/16G server\u4e0aold generation live object\u592a\u591a\u65f6\u5019pause time\u8fc7\u957f \u2013XX:+UseParallelOldGC young = parallel = 2; old = parallel\uff0c\u5206\u6210\u591a\u4e2a\u72ec\u7acb\u7684\u5355\u5143\uff0c\u5982\u679c\u5355\u5143\u4e2dlive object\u5c11\u5219\u56de\u6536\uff0c\u591a\u5219\u8df3\u8fc7 \u4f18\u70b9\uff1aold generation\u4e0a\u6027\u80fd\u8f83 parallel \u65b9\u5f0f\u6709\u63d0\u9ad8 \u7f3a\u70b9\uff1a\u5927\u90e8\u5206server\u7cfb\u7edfold generation\u5185\u5b58\u5360\u7528\u4f1a\u8fbe\u523060%-80%, \u6ca1\u6709\u90a3\u4e48\u591a\u7406\u60f3\u7684\u5355\u5143live object\u5f88\u5c11\u65b9\u4fbf\u8fc5\u901f\u56de\u6536\uff0c\u540c\u65f6compact\u65b9\u9762\u5f00\u9500\u6bd4\u8d77parallel\u5e76\u6ca1\u660e\u663e\u51cf\u5c11 \u2013XX:+UseConcMarkSweepGC Concurent Mark-Sweep(CMS) Collector young generation = parallel collector = 2; old = cms\uff0c\u540c\u65f6\u4e0d\u505a compact \u64cd\u4f5c \u4f18\u70b9\uff1apause time\u4f1a\u964d\u4f4e, pause\u654f\u611f \u7f3a\u70b9\uff1acpu\u5360\u7528\u8fc7\u591a\uff0ccpu\u5bc6\u96c6\u578b\u670d\u52a1\u5668\u4e0d\u9002\u5408\u3002\u53e6\u5916\u788e\u7247\u592a\u591a\uff0c\u6bcf\u4e2aobject\u7684\u5b58\u50a8\u90fd\u8981\u901a\u8fc7\u94fe\u8868\u8fde\u7eed\u8df3n\u4e2a\u5730\u65b9\uff0c\u7a7a\u95f4\u6d6a\u8d39\u95ee\u9898\u4e5f\u4f1a\u589e\u5927 # \u67e5\u770bJVM\u9ed8\u8ba4\u53c2\u6570\u4e2d\u7684\u5806\u6700\u5927\u503c java -XX:+PrintFlagsFinal -version | grep HeapSize # \u7eafjar\u542f\u52a8\uff0c\u9002\u7528JDK7 java \\ -Xmx512M \\ -XX:MaxPermSize=128M \\ -jar ./biz-1.0.0-SNAPSHOT.jar # Tomcat\u542f\u52a8 java \\ -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties \\ -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \\ -Djdk.tls.ephemeralDHKeySize=2048 \\ -Dignore.endorsed.dirs= \\ -classpath /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar \\ -Dcatalina.base=/usr/local/tomcat \\ -Dcatalina.home=/usr/local/tomcat \\ -Djava.io.tmpdir=/usr/local/tomcat/temp org.apache.catalina.startup.Bootstrap start","title":"\u56de\u6536\u7b97\u6cd5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/data_mount/","text":"\u6302\u8f7ddata\u76d8 \u76ee\u7684 \u683c\u5f0f\u5316\u65b0\u78c1\u76d8\uff0c\u6302\u8f7d\u5230/data\u4e0b\uff0c\u5f00\u673a\u81ea\u52a8 \u65b9\u6cd5 fdisk -l \u67e5\u770b\u8bc6\u522b\u5230\u7684\u78c1\u76d8 mkdir /data \u65b0\u5efa\u6302\u8f7d\u7684\u76ee\u6807\u76ee\u5f55 mkfs.ext4 /dev/sdb \u683c\u5f0f\u5316 mount /dev/sdb /data \u6302\u8f7d\u76ee\u5f55 cat /etc/mtab | grep /data >> /etc/fstab \u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d lsblk \u67e5\u770b\u6548\u679c","title":"\u6302\u8f7ddata\u76d8"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/data_mount/#data","text":"","title":"\u6302\u8f7ddata\u76d8"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/data_mount/#_1","text":"\u683c\u5f0f\u5316\u65b0\u78c1\u76d8\uff0c\u6302\u8f7d\u5230/data\u4e0b\uff0c\u5f00\u673a\u81ea\u52a8","title":"\u76ee\u7684"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/data_mount/#_2","text":"fdisk -l \u67e5\u770b\u8bc6\u522b\u5230\u7684\u78c1\u76d8 mkdir /data \u65b0\u5efa\u6302\u8f7d\u7684\u76ee\u6807\u76ee\u5f55 mkfs.ext4 /dev/sdb \u683c\u5f0f\u5316 mount /dev/sdb /data \u6302\u8f7d\u76ee\u5f55 cat /etc/mtab | grep /data >> /etc/fstab \u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d lsblk \u67e5\u770b\u6548\u679c","title":"\u65b9\u6cd5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/kernel/","text":"linux\u5185\u6838 \u5347\u7ea7\u7248\u672c # \u79bb\u7ebf\u5347\u7ea7\uff0c\u5927\u90e8\u5206\u955c\u50cf\u53ea\u6709\u6700\u65b0\u7248 wget http://\u63d0\u4f9b\u4e0b\u8f7d\u7684\u955c\u50cf\u7f51\u7ad9/kernel-ml-4.11.1-1.el7.elrepo.x86_64.rpm rpm -ivh kernel-ml-4.11.1-1.el7.elrepo.x86_64.rpm grub2-set-default 0 grub2-mkconfig -o /boot/grub2/grub.cfg reboot","title":"linux\u5185\u6838"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/kernel/#linux","text":"","title":"linux\u5185\u6838"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/kernel/#_1","text":"# \u79bb\u7ebf\u5347\u7ea7\uff0c\u5927\u90e8\u5206\u955c\u50cf\u53ea\u6709\u6700\u65b0\u7248 wget http://\u63d0\u4f9b\u4e0b\u8f7d\u7684\u955c\u50cf\u7f51\u7ad9/kernel-ml-4.11.1-1.el7.elrepo.x86_64.rpm rpm -ivh kernel-ml-4.11.1-1.el7.elrepo.x86_64.rpm grub2-set-default 0 grub2-mkconfig -o /boot/grub2/grub.cfg reboot","title":"\u5347\u7ea7\u7248\u672c"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/mutt/","text":"Mutt \u547d\u4ee4\u884c\u90ae\u4ef6\u5ba2\u6237\u7aef \u73af\u5883\uff1aMac \u5b89\u88c5 brew install mutt msmtp getmail \u53d1\u90ae\u4ef6\u914d\u7f6e msmtp --host=smtp.163.com --port=25 --serverinfo \u67e5\u8be2smtp\u670d\u52a1\u652f\u6301\u7684\u767b\u5165\u65b9\u5f0f \u7f16\u8f91\u53d1\u90ae\u4ef6\u914d\u7f6e ~/.msmtprc account wy163 # \u81ea\u5b9a\u4e49\u8d26\u53f7 host smtp.163.com # \u53d1\u9001smtp\u670d\u52a1\u5668\u57df\u540d from chenqing24@163.com # \u53d1\u9001\u8005 auth login # \u767b\u5165\u65b9\u5f0f\uff0c\u5bf9\u5e94\u4e0a\u9762\u67e5\u5230\u7684 user xxx@163.com # \u767b\u5165\u670d\u52a1\u5668\u7684\u8d26\u53f7 password ******** # \u4e0a\u9762\u8d26\u53f7\u5bf9\u5e94\u7684\u5bc6\u7801 account default : wy163 # \u9ed8\u8ba4\u53d1\u9001\u8d26\u53f7 chmod 600 ~/.msmtprc which msmtp \u786e\u8ba4\u53d1\u90ae\u4ef6\u4ee3\u7406\u7684\u8def\u5f84 \u7f16\u8f91\u90ae\u4ef6\u5ba2\u6237\u7aef\u914d\u7f6e ~/.muttrc set sendmail=\"/usr/local/bin/msmtp\" set realname=\"xxx\" # \u53d1\u4fe1\u4eba\u540d\u79f0 set from=\"xxx@163.com\" # \u9ed8\u8ba4\u7684\u53d1\u4fe1\u5730\u5740 set envelope_from=yes # \u4f7f\u7528from\u57df\u4f5c\u4e3asender, \u5426\u5219\u4f7f\u7528user@localhost set use_from=yes # \u81ea\u52a8\u751f\u6210from\u5730\u5740 set editor=\"vim -nw\" # \u8bbe\u7f6e\u4f7f\u7528\u7684\u7f16\u8f91\u5668 echo \"hello world\" | mutt -s \"mail title\" -- xxx@yyy.com \u6d4b\u8bd5\u53d1\u9001\u90ae\u4ef6\u7ed9xxx@yyy.com \u6536\u90ae\u4ef6\u914d\u7f6e mkdir -p ~/Mail/inbox/{cur,new,tmp} \u521b\u5efa\u6536\u4ef6\u7bb1\u76f8\u5173\u76ee\u5f55 \u7f16\u8f91\u6536\u90ae\u4ef6\u914d\u7f6e ~/.getmail/getmailrc [retriever] # \u90ae\u7bb1\u7684\u8d26\u6237\u4fe1\u606f\uff0c\u7528\u4e8e\u6536\u53d6\u90ae\u4ef6. type = SimplePOP3SSLRetriever server = pop.163.com username = xxx@163.com port = 995 password = ******** [destination] # \u5982\u4f55\u5904\u7406\u5df2\u7ecf\u6536\u53d6\u5230\u7684\u90ae\u4ef6 type = Maildir path = ~/Mail/inbox/ [option] # \u9ed8\u8ba4\u4e3aTrue, \u6bcf\u6b21\u6267\u884cgetmail\u6536\u53d6\u5168\u90e8\u90ae\u4ef6, False\u8868\u793a\u53ea\u6536\u53d6\u672a\u6536\u53d6\u8fc7\u7684\u90ae\u4ef6 read_all = False # \u672c\u5730\u5220\u9664\u670d\u52a1\u5668\u662f\u5426\u4e5f\u5220\u9664\u90ae\u4ef6 delete = False message_log = ~/.getmail/getmail.log getmail -n \u6536\u90ae\u4ef6\u6d4b\u8bd5 \u7f16\u8f91\u90ae\u4ef6\u5ba2\u6237\u7aef\u914d\u7f6e ~/.muttrc # \u6536\u4fe1\u914d\u7f6e set mbox_type=Maildir set folder=~/Mail/inbox set spoolfile=~/Mail/inbox/ set header_cache=~/Mail/.hcache \u4f7f\u7528 Mutt\u547d\u4ee4 mutt [-nx] [-e cmd] [-F file] [-s subj] [-b addr] [-c addr] [-a file [...] --] addr [...] < message \u53c2\u6570\uff1a -a <\u6587\u4ef6> \u90ae\u4ef6\u9644\u52a0\u6587\u4ef6 -b <\u5730\u5740> BCC\u5bc6\u9001 -c <\u5730\u5740> CC\u6284\u9001 -F <\u914d\u7f6e\u6587\u4ef6> \u6307\u5b9a.muttrc\u6587\u4ef6 -m <\u7c7b\u578b> \u6307\u5b9a\u9884\u8bbe\u7684\u90ae\u4ef6\u4fe1\u7bb1\u7c7b\u578b -p \u90ae\u4ef6\u6682\u7f13\u5bc4\u51fa -R \u4ee5\u53ea\u8bfb\u7684\u65b9\u5f0f\u5f00\u542f\u90ae\u4ef6 -s <\u4e3b\u9898> \u6307\u5b9a\u90ae\u4ef6\u7684\u4e3b\u9898","title":"Mutt \u547d\u4ee4\u884c\u90ae\u4ef6\u5ba2\u6237\u7aef"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/mutt/#mutt","text":"\u73af\u5883\uff1aMac","title":"Mutt \u547d\u4ee4\u884c\u90ae\u4ef6\u5ba2\u6237\u7aef"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/mutt/#_1","text":"brew install mutt msmtp getmail","title":"\u5b89\u88c5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/mutt/#_2","text":"msmtp --host=smtp.163.com --port=25 --serverinfo \u67e5\u8be2smtp\u670d\u52a1\u652f\u6301\u7684\u767b\u5165\u65b9\u5f0f \u7f16\u8f91\u53d1\u90ae\u4ef6\u914d\u7f6e ~/.msmtprc account wy163 # \u81ea\u5b9a\u4e49\u8d26\u53f7 host smtp.163.com # \u53d1\u9001smtp\u670d\u52a1\u5668\u57df\u540d from chenqing24@163.com # \u53d1\u9001\u8005 auth login # \u767b\u5165\u65b9\u5f0f\uff0c\u5bf9\u5e94\u4e0a\u9762\u67e5\u5230\u7684 user xxx@163.com # \u767b\u5165\u670d\u52a1\u5668\u7684\u8d26\u53f7 password ******** # \u4e0a\u9762\u8d26\u53f7\u5bf9\u5e94\u7684\u5bc6\u7801 account default : wy163 # \u9ed8\u8ba4\u53d1\u9001\u8d26\u53f7 chmod 600 ~/.msmtprc which msmtp \u786e\u8ba4\u53d1\u90ae\u4ef6\u4ee3\u7406\u7684\u8def\u5f84 \u7f16\u8f91\u90ae\u4ef6\u5ba2\u6237\u7aef\u914d\u7f6e ~/.muttrc set sendmail=\"/usr/local/bin/msmtp\" set realname=\"xxx\" # \u53d1\u4fe1\u4eba\u540d\u79f0 set from=\"xxx@163.com\" # \u9ed8\u8ba4\u7684\u53d1\u4fe1\u5730\u5740 set envelope_from=yes # \u4f7f\u7528from\u57df\u4f5c\u4e3asender, \u5426\u5219\u4f7f\u7528user@localhost set use_from=yes # \u81ea\u52a8\u751f\u6210from\u5730\u5740 set editor=\"vim -nw\" # \u8bbe\u7f6e\u4f7f\u7528\u7684\u7f16\u8f91\u5668 echo \"hello world\" | mutt -s \"mail title\" -- xxx@yyy.com \u6d4b\u8bd5\u53d1\u9001\u90ae\u4ef6\u7ed9xxx@yyy.com","title":"\u53d1\u90ae\u4ef6\u914d\u7f6e"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/mutt/#_3","text":"mkdir -p ~/Mail/inbox/{cur,new,tmp} \u521b\u5efa\u6536\u4ef6\u7bb1\u76f8\u5173\u76ee\u5f55 \u7f16\u8f91\u6536\u90ae\u4ef6\u914d\u7f6e ~/.getmail/getmailrc [retriever] # \u90ae\u7bb1\u7684\u8d26\u6237\u4fe1\u606f\uff0c\u7528\u4e8e\u6536\u53d6\u90ae\u4ef6. type = SimplePOP3SSLRetriever server = pop.163.com username = xxx@163.com port = 995 password = ******** [destination] # \u5982\u4f55\u5904\u7406\u5df2\u7ecf\u6536\u53d6\u5230\u7684\u90ae\u4ef6 type = Maildir path = ~/Mail/inbox/ [option] # \u9ed8\u8ba4\u4e3aTrue, \u6bcf\u6b21\u6267\u884cgetmail\u6536\u53d6\u5168\u90e8\u90ae\u4ef6, False\u8868\u793a\u53ea\u6536\u53d6\u672a\u6536\u53d6\u8fc7\u7684\u90ae\u4ef6 read_all = False # \u672c\u5730\u5220\u9664\u670d\u52a1\u5668\u662f\u5426\u4e5f\u5220\u9664\u90ae\u4ef6 delete = False message_log = ~/.getmail/getmail.log getmail -n \u6536\u90ae\u4ef6\u6d4b\u8bd5 \u7f16\u8f91\u90ae\u4ef6\u5ba2\u6237\u7aef\u914d\u7f6e ~/.muttrc # \u6536\u4fe1\u914d\u7f6e set mbox_type=Maildir set folder=~/Mail/inbox set spoolfile=~/Mail/inbox/ set header_cache=~/Mail/.hcache","title":"\u6536\u90ae\u4ef6\u914d\u7f6e"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/mutt/#_4","text":"Mutt\u547d\u4ee4 mutt [-nx] [-e cmd] [-F file] [-s subj] [-b addr] [-c addr] [-a file [...] --] addr [...] < message \u53c2\u6570\uff1a -a <\u6587\u4ef6> \u90ae\u4ef6\u9644\u52a0\u6587\u4ef6 -b <\u5730\u5740> BCC\u5bc6\u9001 -c <\u5730\u5740> CC\u6284\u9001 -F <\u914d\u7f6e\u6587\u4ef6> \u6307\u5b9a.muttrc\u6587\u4ef6 -m <\u7c7b\u578b> \u6307\u5b9a\u9884\u8bbe\u7684\u90ae\u4ef6\u4fe1\u7bb1\u7c7b\u578b -p \u90ae\u4ef6\u6682\u7f13\u5bc4\u51fa -R \u4ee5\u53ea\u8bfb\u7684\u65b9\u5f0f\u5f00\u542f\u90ae\u4ef6 -s <\u4e3b\u9898> \u6307\u5b9a\u90ae\u4ef6\u7684\u4e3b\u9898","title":"\u4f7f\u7528"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/netrc/","text":".netrc \u514d\u5bc6\u767b\u5165 \u5efa\u7acb ~/.netrc \u6587\u4ef6\uff0c\u53ef\u4ee5\u5728*nux\u7cfbOS\u4e2d\u5b9e\u73b0\u514d\u5bc6\u767b\u5165\uff0c\u683c\u5f0f machine {\u9700\u8981\u8bbf\u95ee\u7684git/ftp\u7b49\u57df\u540d} login {\u4e2a\u4eba\u7684\u7528\u6237\u540d} password {\u5bf9\u5e94\u5bc6\u7801} \u6ce8\u610f\uff1a \u660e\u6587\u4fdd\u5b58\uff0c\u9002\u7528\u4e2a\u4eba","title":".netrc \u514d\u5bc6\u767b\u5165"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/netrc/#netrc","text":"\u5efa\u7acb ~/.netrc \u6587\u4ef6\uff0c\u53ef\u4ee5\u5728*nux\u7cfbOS\u4e2d\u5b9e\u73b0\u514d\u5bc6\u767b\u5165\uff0c\u683c\u5f0f machine {\u9700\u8981\u8bbf\u95ee\u7684git/ftp\u7b49\u57df\u540d} login {\u4e2a\u4eba\u7684\u7528\u6237\u540d} password {\u5bf9\u5e94\u5bc6\u7801} \u6ce8\u610f\uff1a \u660e\u6587\u4fdd\u5b58\uff0c\u9002\u7528\u4e2a\u4eba","title":".netrc \u514d\u5bc6\u767b\u5165"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ops_bash/","text":"\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4 \u67e5\u8be2\u4fe1\u606f grep 'processor' /proc/cpuinfo | sort -u | wc -l \u67e5\u8be2\u4e3b\u673a\u903b\u8f91CPU\u603b\u6838\u6570 ifconfig | grep 'inet' | grep -v '127.0.0.1' | awk '{print $2}' \u4e3b\u673aip free -m \u5185\u5b58\u72b6\u6001\uff08\u5355\u4f4dM\uff09 hostname \u4e3b\u673a\u540d cat /etc/system-release OS\u7248\u672c uname -r \u5185\u6838\u7248\u672c ps aux|grep java|grep -v grep|wc -l \u5f53\u524djava\u8fdb\u7a0b\u603b\u6570\uff0c\u6392\u9664grep\u5e72\u6270 ifconfig eth0 | grep \"inet addr:\" | awk '{print $2}' | cut -c 6- \u67e5\u8be2\u4e3b\u673aeth0\u4e0a\u7684IP netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u6309\u72b6\u6001\u67e5\u8be2\u4e3b\u673a\u4e0aTCP\u8fde\u63a5\u6570 du -s * | sort -nr | head \u9009\u51fa\u6587\u4ef6\u5939\u5927\u5c0f\uff0c\u5e76\u6309\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\uff0c\u524d\u9762\u768410\u4e2a watch -n 60 -d 'ls -l -rt | tail' \u627e\u5230\u5f53\u524d\u76ee\u5f55\u6700\u65b0\u768410\u4e2a\u6587\u4ef6\uff0c1\u5206\u949f\u5237\u65b0\u4e00\u6b21 dd if=/dev/zero of=test bs=1M count=10000 oflag=direct \u6d4b\u8bd5\u78c1\u76d8IO\uff0c\u5199test,1\u4e2aM\u4e00\u6b21\uff0c10000\u6b21\uff0c\u91c7\u7528\u76f4\u63a5IO\u65b9\u5f0f find . -name '*.tmp' ! -newermt '5 day ago' \u627e\u5f53\u524d\u8def\u5f84\u4e0b.tmp\u540e\u7f00\u540d\uff0c5\u5929\u4ee5\u524d\u521b\u5efa\u7684 tree -L 2 \u6811\u5f62\u5c55\u793a2\u5c42\u76ee\u5f55 \u5feb\u901f\u6267\u884c for i in `find /opt/*/bin/nohup.out`; do cat /dev/null > $i; done \u627e\u5230\u6279\u91cfnohup.out\uff0c\u5e76\u6e05\u9664\u5185\u5bb9 find /opt/ -ctime +7 -name \"trace*.log\" | xargs rm -f \u627e\u52307\u5929\u4ee5\u524d\u7684log\u6587\u4ef6\uff0c\u5e76\u5220\u9664 \u968f\u673a\u5bc6\u7801\u751f\u6210 \u6700\u7b80\u5355\u751f\u6210\u65b9\u6cd5 date | md5sum \uff0c\u7f3a\u70b9\uff1a\u53ea\u6709\u82f1\u6570\u5b57 \u751f\u6210\u5e26\u7279\u6b8a\u5b57\u7b26\u7684 openssl rand -base64 32 \u88c5\u903c \u4e00\u53e5\u8bdd\u8ba1\u7b97\u5706\u5468\u7387\u03c0 bc -l <<< \"scale=10000;4*a(1)\"","title":"\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ops_bash/#_1","text":"","title":"\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ops_bash/#_2","text":"grep 'processor' /proc/cpuinfo | sort -u | wc -l \u67e5\u8be2\u4e3b\u673a\u903b\u8f91CPU\u603b\u6838\u6570 ifconfig | grep 'inet' | grep -v '127.0.0.1' | awk '{print $2}' \u4e3b\u673aip free -m \u5185\u5b58\u72b6\u6001\uff08\u5355\u4f4dM\uff09 hostname \u4e3b\u673a\u540d cat /etc/system-release OS\u7248\u672c uname -r \u5185\u6838\u7248\u672c ps aux|grep java|grep -v grep|wc -l \u5f53\u524djava\u8fdb\u7a0b\u603b\u6570\uff0c\u6392\u9664grep\u5e72\u6270 ifconfig eth0 | grep \"inet addr:\" | awk '{print $2}' | cut -c 6- \u67e5\u8be2\u4e3b\u673aeth0\u4e0a\u7684IP netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u6309\u72b6\u6001\u67e5\u8be2\u4e3b\u673a\u4e0aTCP\u8fde\u63a5\u6570 du -s * | sort -nr | head \u9009\u51fa\u6587\u4ef6\u5939\u5927\u5c0f\uff0c\u5e76\u6309\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\uff0c\u524d\u9762\u768410\u4e2a watch -n 60 -d 'ls -l -rt | tail' \u627e\u5230\u5f53\u524d\u76ee\u5f55\u6700\u65b0\u768410\u4e2a\u6587\u4ef6\uff0c1\u5206\u949f\u5237\u65b0\u4e00\u6b21 dd if=/dev/zero of=test bs=1M count=10000 oflag=direct \u6d4b\u8bd5\u78c1\u76d8IO\uff0c\u5199test,1\u4e2aM\u4e00\u6b21\uff0c10000\u6b21\uff0c\u91c7\u7528\u76f4\u63a5IO\u65b9\u5f0f find . -name '*.tmp' ! -newermt '5 day ago' \u627e\u5f53\u524d\u8def\u5f84\u4e0b.tmp\u540e\u7f00\u540d\uff0c5\u5929\u4ee5\u524d\u521b\u5efa\u7684 tree -L 2 \u6811\u5f62\u5c55\u793a2\u5c42\u76ee\u5f55","title":"\u67e5\u8be2\u4fe1\u606f"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ops_bash/#_3","text":"for i in `find /opt/*/bin/nohup.out`; do cat /dev/null > $i; done \u627e\u5230\u6279\u91cfnohup.out\uff0c\u5e76\u6e05\u9664\u5185\u5bb9 find /opt/ -ctime +7 -name \"trace*.log\" | xargs rm -f \u627e\u52307\u5929\u4ee5\u524d\u7684log\u6587\u4ef6\uff0c\u5e76\u5220\u9664","title":"\u5feb\u901f\u6267\u884c"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ops_bash/#_4","text":"\u6700\u7b80\u5355\u751f\u6210\u65b9\u6cd5 date | md5sum \uff0c\u7f3a\u70b9\uff1a\u53ea\u6709\u82f1\u6570\u5b57 \u751f\u6210\u5e26\u7279\u6b8a\u5b57\u7b26\u7684 openssl rand -base64 32","title":"\u968f\u673a\u5bc6\u7801\u751f\u6210"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ops_bash/#_5","text":"\u4e00\u53e5\u8bdd\u8ba1\u7b97\u5706\u5468\u7387\u03c0 bc -l <<< \"scale=10000;4*a(1)\"","title":"\u88c5\u903c"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/rsyslog/","text":"Rsyslog \u7cfb\u7edf\u65e5\u5fd7 syslog\u7684\u5347\u7ea7\u7248\uff0clinux\u4e00\u822c\u9ed8\u8ba4\u5b89\u88c5\uff0c\u652f\u6301\u591a\u79cd\u534f\u8bae\u8f6c\u53d1\uff0c\u5de5\u4e1a\u6807\u51c6\u3002 \u4f7f\u7528 \u4ee5 Ubuntu 18 \u4e3e\u4f8b \u914d\u7f6e \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6 /etc/rsyslog.conf \u548c /etc/rsyslog.d \u76ee\u5f55 \u7b2c\u4e00\u884c\uff1a\u6240\u6709 auth,authpriv.* \u76f8\u5173log\u5199\u5165 /var/log/auth.log \u591a\u4e2a\u65e5\u5fd7\u6765\u6e90\u7528 , \u53f7\u9694\u5f00 \u7b2c\u4e8c\u884c\uff1a\u6240\u6709log\uff0c\u9664\u4e86 auth,authpriv.none ( ; \u540e\u9762)\u5f02\u6b65\u7684(\u5f00\u5934 - \u6307\u5b9a)\u5199\u5165 /var/log/syslog \u7b2c\u516d\u884c\uff1a\u6240\u6709 emerg \u7ea7\u522b\uff08\u5bfc\u81f4\u7cfb\u7edf\u4e0d\u53ef\u7528\uff09\u7684\u4fe1\u606f\uff0c\u4f7f\u7528\u5185\u7f6e\u6a21\u5757 omusrmsg \u901a\u77e5\u7ed9\u6240\u6709\u7528\u6237 * \u9ed8\u8ba4\u683c\u5f0f\uff08RSYSLOG_TraditionalFileFormat\uff09 \"%TIMESTAMP% %HOSTNAME% %syslogtag%%msg:::sp-if-no-1st-sp%%msg:::drop-last-lf%\\n\" TIMESTAMP: timereported\u7684\u522b\u540d\uff0c\u63a5\u6536\u6d88\u606f\u65f6\u7684\u65f6\u95f4\u6233 HOSTNAME: \u6765\u81ea\u6d88\u606f\u7684\u4e3b\u673a\u540d msg: \u5373\u6d88\u606f\u6e90\u8fdb\u7a0b\u8c03\u7528syslog\u5bb6\u65cf\u51fd\u6570\uff0c\u6240\u4f20\u9012\u7684\u6587\u672c\u4fe1\u606f syslogtag: \u6765\u81ea\u6d88\u606f\u7684\u6807\u7b7e\uff0c\u6d88\u606f\u6e90\u8fdb\u7a0b\u7684\u7528\u6237\u540d sp-if-no-1st-sp: \u6709\u70b9\u50cf if \u8bed\u53e5\u3002\u5982\u679c\u5b58\u5728\u7a7a\u683c\uff0c\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002\u5426\u5219\uff0c\u5219\u6dfb\u52a0\u4e00\u4e2a\u7a7a\u683c\u3002\u7528\u4e8e\u8f93\u51fa\u591a\u884c\u7684msg drop-last-lf: \u4e22\u5f03\u6700\u540e\u7684LF \u5e38\u89c1facility\uff08\u8bbe\u65bd\uff09\uff1a\u6807\u8bc6\u7cfb\u7edf\u9700\u8981\u8bb0\u5f55\u65e5\u5fd7\u7684\u5b50\u7cfb\u7edf auth #PAM\u8ba4\u8bc1\u76f8\u5173\u65e5\u5fd7\uff1b authpriv #SSH\u3001FTP\u767b\u5f55\u76f8\u5173\u65e5\u5fd7\uff1b cron #\u4efb\u52a1\u8ba1\u5212\u76f8\u5173\u65e5\u5fd7\uff1b daemon #\u5b88\u62a4\u8fdb\u7a0b\u76f8\u5173\u65e5\u5fd7\uff1b kern #\u5185\u6838\u76f8\u5173\u65e5\u5fd7\uff1b mail #\u90ae\u4ef6\u76f8\u5173\u65e5\u5fd7\uff1b security #\u5b89\u5168\u76f8\u5173\u65e5\u5fd7\u4e0eauth\u7c7b\u4f3c\uff1b syslog #Rsyslog\u81ea\u5df1\u7684\u65e5\u5fd7\uff1b user #\u7528\u6237\u76f8\u5173\u65e5\u5fd7\uff1b * #\u8868\u793a\u6240\u6709\u7684facility\uff1b priority\uff08\u7ea7\u522b\uff09\uff1a\u7ea7\u522b\u8d8a\u4f4e\u4fe1\u606f\u8d8a\u8be6\u7ec6 debug #\u7a0b\u5e8f\u6216\u7cfb\u7edf\u8c03\u8bd5\u4fe1\u606f\uff1b info #\u4e00\u822c\u4fe1\u606f\uff1b notice #\u4e0d\u5f71\u54cd\u6b63\u5e38\u529f\u80fd\u9700\u8981\u6ce8\u610f\u7684\u4fe1\u606f\uff1b warning #\u53ef\u80fd\u5f71\u54cd\u7cfb\u7edf\u529f\u80fd\u63d0\u9192\u7528\u6237\u7684\u91cd\u8981\u4e8b\u4ef6\uff1b error #\u9519\u8bef\u4fe1\u606f\uff1b crit #\u6bd4\u8f83\u4e25\u91cd\u7684\u4fe1\u606f\uff1b alert #\u5fc5\u987b\u9a6c\u4e0a\u5904\u7406\u7684\u8b66\u544a\u4fe1\u606f\uff1b emerg/panic #\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u4e0d\u53ef\u7528\u7684\u4e25\u91cd\u4fe1\u606f\uff1b * #\u8868\u793a\u6240\u6709\u65e5\u5fd7\u7ea7\u522b\uff1b none #\u8ddf*\u76f8\u53cd\u8868\u793a\u4ec0\u4e48\u90fd\u6ca1\u6709\uff1b action\uff08\u52a8\u4f5c\uff09\uff1a\u8bbe\u7f6e\u65e5\u5fd7\u8bb0\u5f55\u7684\u4f4d\u7f6e /var/log/file.log \u8bb0\u5f55\u5230\u666e\u901a\u6587\u4ef6\u6216\u8bbe\u5907\u6587\u4ef6 @192.168.10.1 \u65e5\u5fd7\u53d1\u9001\u5230\u7279\u5b9a\u7684\u4e3b\u673a * \u65e5\u5fd7\u53d1\u9001\u6240\u6709\u767b\u5f55\u5230\u7cfb\u7edf\u4e0a\u7684\u7528\u6237 \u8fde\u63a5\u7b26\u53f7 . #\u8868\u793a\u5927\u4e8e\u7b49\u4e8exxx\u7ea7\u522b\u7684\u4fe1\u606f\uff1b .= #\u8868\u793a\u7b49\u4e8exxx\u7ea7\u522b\u7684\u4fe1\u606f\uff1b .! #\u8868\u793a\u5728xxx\u4e4b\u5916\u7684\u7b49\u7ea7\u7684\u4fe1\u606f\uff1b \u53c2\u8003 \u5b98\u7f51 https://www.rsyslog.com/ \u6587\u6863 https://rsyslog-doc.readthedocs.io/ \u6e90\u7801 https://github.com/rsyslog/rsyslog","title":"Rsyslog \u7cfb\u7edf\u65e5\u5fd7"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/rsyslog/#rsyslog","text":"syslog\u7684\u5347\u7ea7\u7248\uff0clinux\u4e00\u822c\u9ed8\u8ba4\u5b89\u88c5\uff0c\u652f\u6301\u591a\u79cd\u534f\u8bae\u8f6c\u53d1\uff0c\u5de5\u4e1a\u6807\u51c6\u3002","title":"Rsyslog \u7cfb\u7edf\u65e5\u5fd7"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/rsyslog/#_1","text":"\u4ee5 Ubuntu 18 \u4e3e\u4f8b","title":"\u4f7f\u7528"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/rsyslog/#_2","text":"\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6 /etc/rsyslog.conf \u548c /etc/rsyslog.d \u76ee\u5f55 \u7b2c\u4e00\u884c\uff1a\u6240\u6709 auth,authpriv.* \u76f8\u5173log\u5199\u5165 /var/log/auth.log \u591a\u4e2a\u65e5\u5fd7\u6765\u6e90\u7528 , \u53f7\u9694\u5f00 \u7b2c\u4e8c\u884c\uff1a\u6240\u6709log\uff0c\u9664\u4e86 auth,authpriv.none ( ; \u540e\u9762)\u5f02\u6b65\u7684(\u5f00\u5934 - \u6307\u5b9a)\u5199\u5165 /var/log/syslog \u7b2c\u516d\u884c\uff1a\u6240\u6709 emerg \u7ea7\u522b\uff08\u5bfc\u81f4\u7cfb\u7edf\u4e0d\u53ef\u7528\uff09\u7684\u4fe1\u606f\uff0c\u4f7f\u7528\u5185\u7f6e\u6a21\u5757 omusrmsg \u901a\u77e5\u7ed9\u6240\u6709\u7528\u6237 * \u9ed8\u8ba4\u683c\u5f0f\uff08RSYSLOG_TraditionalFileFormat\uff09 \"%TIMESTAMP% %HOSTNAME% %syslogtag%%msg:::sp-if-no-1st-sp%%msg:::drop-last-lf%\\n\" TIMESTAMP: timereported\u7684\u522b\u540d\uff0c\u63a5\u6536\u6d88\u606f\u65f6\u7684\u65f6\u95f4\u6233 HOSTNAME: \u6765\u81ea\u6d88\u606f\u7684\u4e3b\u673a\u540d msg: \u5373\u6d88\u606f\u6e90\u8fdb\u7a0b\u8c03\u7528syslog\u5bb6\u65cf\u51fd\u6570\uff0c\u6240\u4f20\u9012\u7684\u6587\u672c\u4fe1\u606f syslogtag: \u6765\u81ea\u6d88\u606f\u7684\u6807\u7b7e\uff0c\u6d88\u606f\u6e90\u8fdb\u7a0b\u7684\u7528\u6237\u540d sp-if-no-1st-sp: \u6709\u70b9\u50cf if \u8bed\u53e5\u3002\u5982\u679c\u5b58\u5728\u7a7a\u683c\uff0c\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002\u5426\u5219\uff0c\u5219\u6dfb\u52a0\u4e00\u4e2a\u7a7a\u683c\u3002\u7528\u4e8e\u8f93\u51fa\u591a\u884c\u7684msg drop-last-lf: \u4e22\u5f03\u6700\u540e\u7684LF \u5e38\u89c1facility\uff08\u8bbe\u65bd\uff09\uff1a\u6807\u8bc6\u7cfb\u7edf\u9700\u8981\u8bb0\u5f55\u65e5\u5fd7\u7684\u5b50\u7cfb\u7edf auth #PAM\u8ba4\u8bc1\u76f8\u5173\u65e5\u5fd7\uff1b authpriv #SSH\u3001FTP\u767b\u5f55\u76f8\u5173\u65e5\u5fd7\uff1b cron #\u4efb\u52a1\u8ba1\u5212\u76f8\u5173\u65e5\u5fd7\uff1b daemon #\u5b88\u62a4\u8fdb\u7a0b\u76f8\u5173\u65e5\u5fd7\uff1b kern #\u5185\u6838\u76f8\u5173\u65e5\u5fd7\uff1b mail #\u90ae\u4ef6\u76f8\u5173\u65e5\u5fd7\uff1b security #\u5b89\u5168\u76f8\u5173\u65e5\u5fd7\u4e0eauth\u7c7b\u4f3c\uff1b syslog #Rsyslog\u81ea\u5df1\u7684\u65e5\u5fd7\uff1b user #\u7528\u6237\u76f8\u5173\u65e5\u5fd7\uff1b * #\u8868\u793a\u6240\u6709\u7684facility\uff1b priority\uff08\u7ea7\u522b\uff09\uff1a\u7ea7\u522b\u8d8a\u4f4e\u4fe1\u606f\u8d8a\u8be6\u7ec6 debug #\u7a0b\u5e8f\u6216\u7cfb\u7edf\u8c03\u8bd5\u4fe1\u606f\uff1b info #\u4e00\u822c\u4fe1\u606f\uff1b notice #\u4e0d\u5f71\u54cd\u6b63\u5e38\u529f\u80fd\u9700\u8981\u6ce8\u610f\u7684\u4fe1\u606f\uff1b warning #\u53ef\u80fd\u5f71\u54cd\u7cfb\u7edf\u529f\u80fd\u63d0\u9192\u7528\u6237\u7684\u91cd\u8981\u4e8b\u4ef6\uff1b error #\u9519\u8bef\u4fe1\u606f\uff1b crit #\u6bd4\u8f83\u4e25\u91cd\u7684\u4fe1\u606f\uff1b alert #\u5fc5\u987b\u9a6c\u4e0a\u5904\u7406\u7684\u8b66\u544a\u4fe1\u606f\uff1b emerg/panic #\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u4e0d\u53ef\u7528\u7684\u4e25\u91cd\u4fe1\u606f\uff1b * #\u8868\u793a\u6240\u6709\u65e5\u5fd7\u7ea7\u522b\uff1b none #\u8ddf*\u76f8\u53cd\u8868\u793a\u4ec0\u4e48\u90fd\u6ca1\u6709\uff1b action\uff08\u52a8\u4f5c\uff09\uff1a\u8bbe\u7f6e\u65e5\u5fd7\u8bb0\u5f55\u7684\u4f4d\u7f6e /var/log/file.log \u8bb0\u5f55\u5230\u666e\u901a\u6587\u4ef6\u6216\u8bbe\u5907\u6587\u4ef6 @192.168.10.1 \u65e5\u5fd7\u53d1\u9001\u5230\u7279\u5b9a\u7684\u4e3b\u673a * \u65e5\u5fd7\u53d1\u9001\u6240\u6709\u767b\u5f55\u5230\u7cfb\u7edf\u4e0a\u7684\u7528\u6237 \u8fde\u63a5\u7b26\u53f7 . #\u8868\u793a\u5927\u4e8e\u7b49\u4e8exxx\u7ea7\u522b\u7684\u4fe1\u606f\uff1b .= #\u8868\u793a\u7b49\u4e8exxx\u7ea7\u522b\u7684\u4fe1\u606f\uff1b .! #\u8868\u793a\u5728xxx\u4e4b\u5916\u7684\u7b49\u7ea7\u7684\u4fe1\u606f\uff1b","title":"\u914d\u7f6e"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/rsyslog/#_3","text":"\u5b98\u7f51 https://www.rsyslog.com/ \u6587\u6863 https://rsyslog-doc.readthedocs.io/ \u6e90\u7801 https://github.com/rsyslog/rsyslog","title":"\u53c2\u8003"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/smtp_docker/","text":"\u4f7f\u7528Docker\u642d\u5efaSMTP\u670d\u52a1\u5668 \u53c2\u8003 \u5b98\u7f51: https://github.com/namshi/docker-smtp \u77e5\u4e4e\u6559\u7a0b: https://zhuanlan.zhihu.com/p/34162708 \u5b89\u88c5 # \u4e0b\u8f7dimg docker pull namshi/smtp # \u542f\u52a8\u670d\u52a1 docker run --restart=always -d \\ -e \"RELAY_NETWORKS=:0.0.0.0/0\" \\ # \u4efb\u610f\u5ba2\u6237\u7aef\u7686\u53ef\u53d1 --name smtp \\ -p 10025:25 \\ # \u5bf9\u5916\u670d\u52a1\u7684\u7aef\u53e3 namshi/smtp \u6d4b\u8bd5 #!/usr/bin/python # -*- coding: UTF-8 -*- # another: Jeff.Chen # \u53d1smtp\u6d4b\u8bd5 import smtplib from email.message import EmailMessage sender = 'me@sender.com' receivers = ['user1@receiver.com', 'user2@receiver.com'] # \u63a5\u6536\u90ae\u4ef6\uff0c\u53ef\u8bbe\u7f6e\u4e3a\u4f60\u7684QQ\u90ae\u7bb1\u6216\u8005\u5176\u4ed6\u90ae\u7bb1 msg = EmailMessage() msg.set_content('Python \u90ae\u4ef6\u53d1\u9001\u6d4b\u8bd5...5') msg['Subject'] = 'Python SMTP \u90ae\u4ef6\u6d4b\u8bd5' msg['From'] = sender msg['To'] = receivers try: smtpObj = smtplib.SMTP() smtpObj.connect(\"0.0.0.0\", 10025) smtpObj.send_message(msg) smtpObj.quit() print (\"\u90ae\u4ef6\u53d1\u9001\u6210\u529f\") except smtplib.SMTPException as e: print (\"Error: \u65e0\u6cd5\u53d1\u9001\u90ae\u4ef6: {}\".format(str(e))) \u6ce8\u610f\u4e8b\u9879 \u7531\u4e8e\u662f\u672a\u8ba4\u8bc1\u7684smtp\u670d\u52a1\uff0c\u53ef\u80fd\u88ab\u63a5\u6536\u65b9\u7684mail\u670d\u52a1\u8fc7\u6ee4\uff0c\u9700\u8981\u63a5\u6536\u65b9\u52a0\u767d\u540d\u5355\u3002","title":"\u4f7f\u7528Docker\u642d\u5efaSMTP\u670d\u52a1\u5668"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/smtp_docker/#dockersmtp","text":"","title":"\u4f7f\u7528Docker\u642d\u5efaSMTP\u670d\u52a1\u5668"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/smtp_docker/#_1","text":"\u5b98\u7f51: https://github.com/namshi/docker-smtp \u77e5\u4e4e\u6559\u7a0b: https://zhuanlan.zhihu.com/p/34162708","title":"\u53c2\u8003"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/smtp_docker/#_2","text":"# \u4e0b\u8f7dimg docker pull namshi/smtp # \u542f\u52a8\u670d\u52a1 docker run --restart=always -d \\ -e \"RELAY_NETWORKS=:0.0.0.0/0\" \\ # \u4efb\u610f\u5ba2\u6237\u7aef\u7686\u53ef\u53d1 --name smtp \\ -p 10025:25 \\ # \u5bf9\u5916\u670d\u52a1\u7684\u7aef\u53e3 namshi/smtp","title":"\u5b89\u88c5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/smtp_docker/#_3","text":"#!/usr/bin/python # -*- coding: UTF-8 -*- # another: Jeff.Chen # \u53d1smtp\u6d4b\u8bd5 import smtplib from email.message import EmailMessage sender = 'me@sender.com' receivers = ['user1@receiver.com', 'user2@receiver.com'] # \u63a5\u6536\u90ae\u4ef6\uff0c\u53ef\u8bbe\u7f6e\u4e3a\u4f60\u7684QQ\u90ae\u7bb1\u6216\u8005\u5176\u4ed6\u90ae\u7bb1 msg = EmailMessage() msg.set_content('Python \u90ae\u4ef6\u53d1\u9001\u6d4b\u8bd5...5') msg['Subject'] = 'Python SMTP \u90ae\u4ef6\u6d4b\u8bd5' msg['From'] = sender msg['To'] = receivers try: smtpObj = smtplib.SMTP() smtpObj.connect(\"0.0.0.0\", 10025) smtpObj.send_message(msg) smtpObj.quit() print (\"\u90ae\u4ef6\u53d1\u9001\u6210\u529f\") except smtplib.SMTPException as e: print (\"Error: \u65e0\u6cd5\u53d1\u9001\u90ae\u4ef6: {}\".format(str(e)))","title":"\u6d4b\u8bd5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/smtp_docker/#_4","text":"\u7531\u4e8e\u662f\u672a\u8ba4\u8bc1\u7684smtp\u670d\u52a1\uff0c\u53ef\u80fd\u88ab\u63a5\u6536\u65b9\u7684mail\u670d\u52a1\u8fc7\u6ee4\uff0c\u9700\u8981\u63a5\u6536\u65b9\u52a0\u767d\u540d\u5355\u3002","title":"\u6ce8\u610f\u4e8b\u9879"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/","text":"supervisord\u540e\u53f0\u8fdb\u7a0b\u7ba1\u7406 \u53c2\u8003 \u5b98\u7f51\u6587\u6863\uff1ahttp://supervisord.org/ \u670d\u52a1\u7ed3\u6784 supervisord\uff1a\u670d\u52a1\u540e\u53f0\u8fdb\u7a0b\uff0c\u5c06\u6240\u7ba1\u7406\u7684\u8fdb\u7a0b\u4f5c\u4e3a\u81ea\u5df1\u7684\u5b50\u8fdb\u7a0b\u6765\u542f\u52a8\uff0c\u53ef\u4ee5\u5728\u5b50\u8fdb\u7a0b\u5d29\u6e83\u65f6\u81ea\u52a8\u91cd\u542f\u4e4b\u3002 supervisorctl\uff1a\u547d\u4ee4\u884c\u7ba1\u7406\u5de5\u5177\uff0c\u6267\u884c stop\u3001start\u3001restart \u7b49\u547d\u4ee4\uff0c\u6765\u7ba1\u7406\u5b50\u8fdb\u7a0b\u3002 \u5b89\u88c5\u548c\u914d\u7f6e pip\u5b89\u88c5 pip install supervisor \u4ee5root\u89d2\u8272\u5b89\u88c5 echo_supervisord_conf > /opt/supervisor/supervisord.conf \u5efa\u8bae\u4ee5\u666e\u901a\u7528\u6237\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u4ee5\u7075\u6d3b\u7f16\u8f91\u6269\u5c55 supervisord -u op -c /opt/supervisor/supervisord.conf \u4ee5\u666e\u901a\u7528\u6237op\u542f\u52a8supervisord\uff0c\u8bfb\u53d6\u6307\u5b9a\u914d\u7f6e \u539f\u751f\u5b89\u88c5 Ubuntu: apt install supervisor \u5f00\u673a\u542f\u52a8supervisord CentOS\u7684systemd \u65b0\u5efa\u6587\u4ef6supervisord.service [Unit] Description=Supervisord [Service] Type=forking ExecStart=/usr/bin/supervisord -u op -c /opt/supervisor/supervisord.conf ExecStop=/usr/bin/supervisorctl shutdown ExecReload=/usr/bin/supervisorctl reload KillMode=process Restart=on-failure RestartSec=42s [Install] WantedBy=multi-user.target \u6587\u4ef6\u62f7\u8d1d\u5230 /usr/lib/systemd/system/ chmod 766 supervisord.service \u6743\u9650\u8bbe\u5b9a systemctl enable supervisord \u542f\u52a8\u670d\u52a1 systemctl is-enabled supervisord \u9a8c\u8bc1\u662f\u5426\u4e3a\u5f00\u673a\u542f\u52a8 Ubuntu\u7684\u539f\u751f\u5b89\u88c5 cd /etc/supervisor/conf.d \uff0c\u6309\u5bf9\u5e94\u7684\u9879\u76ee\u8fdb\u7a0b\uff0c\u5efa\u7acb\u81ea\u5df1\u7684conf ; devops-cms.conf [program:devops-cms] directory =/opt/devops-cms command =yarn develop autostart =true autorestart =true startretries=10 redirect_stderr=true ; \u4e0d\u8981\u653e\u5728yarn\u9879\u76ee\u8def\u5f84\u4e0b\uff0clog\u7684\u53d8\u5316\u4f1a\u5bfc\u81f4yarn\u4e0d\u65ad\u91cd\u542f stdout_logfile=/tmp/supervisor-devops-cms.log ; \u5982\u679c\u662fpython\u9700\u8981\u6307\u5b9avenv ; command=/opt/devops-cms/ENV/bin/python /opt/devops-cms/app.py ; environment=PATH=\"/opt/devops-cms/ENV/bin:%(ENV_PATH)s\" supervisorctl reload \uff0c\u52a0\u8f7d\u6700\u65b0\u914d\u7f6e \u5e38\u7528cli #program_name \u4e3a [groupworker:program_name] \u91cc\u7684 program_name # \u505c\u6b62\u67d0\u4e00\u4e2a\u8fdb\u7a0b supervisorctl stop program_name # \u542f\u52a8\u67d0\u4e2a\u8fdb\u7a0b supervisorctl start program_name # \u91cd\u542f\u67d0\u4e2a\u8fdb\u7a0b supervisorctl restart program_name # \u7ed3\u675f\u6240\u6709\u5c5e\u4e8e\u540d\u4e3a groupworker \u8fd9\u4e2a\u5206\u7ec4\u7684\u8fdb\u7a0b (start\uff0crestart \u540c\u7406) supervisorctl stop groupworker: # \u7ed3\u675f groupworker:name1 \u8fd9\u4e2a\u8fdb\u7a0b (start\uff0crestart \u540c\u7406) supervisorctl stop groupworker:name1 # \u505c\u6b62\u5168\u90e8\u8fdb\u7a0b\uff0c\u6ce8\uff1astart\u3001restart\u3001stop \u90fd\u4e0d\u4f1a\u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6 supervisorctl stop all # \u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u505c\u6b62\u539f\u6709\u8fdb\u7a0b\u5e76\u6309\u65b0\u7684\u914d\u7f6e\u542f\u52a8\u3001\u7ba1\u7406\u6240\u6709\u8fdb\u7a0b supervisorctl reload # \u6839\u636e\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u542f\u52a8\u65b0\u914d\u7f6e\u6216\u6709\u6539\u52a8\u7684\u8fdb\u7a0b\uff0c\u914d\u7f6e\u6ca1\u6709\u6539\u52a8\u7684\u8fdb\u7a0b\u4e0d\u4f1a\u53d7\u5f71\u54cd\u800c\u91cd\u542f supervisorctl update supervisord.conf\u914d\u7f6e\u8be6\u89e3 ; \u6ce8\u610f\uff1a ; - \u73af\u5883\u53d8\u91cf\u652f\u6301\u6a21\u5f0f\uff1a %(ENV_HOME)s ; - \u4e0d\u652f\u6301value\u5957\u5f15\u53f7 ; - ;\u6ce8\u91ca\u4e4b\u524d\u9700\u8981\u5e26\u7a7a\u683c ; - Command\u4e2d;\u540e\u9762\u7684\u5185\u5bb9\u4f1a\u88ab\u5ffd\u7565 [unix_http_server] file=/tmp/supervisor.sock ; supervisorctl\u7528XML_RPC\u548csupervisord\u901a\u4fe1\u5c31\u662f\u901a\u8fc7\u5b83\u8fdb\u884c\u7684\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\u7684\u8bdd\uff0csupervisorctl\u5c31\u4e0d\u80fd\u7528\uff0c\u9ed8\u8ba4\u4e3anone\u3002\u975e\u5fc5\u987b ;chmod=0700 ; socket file mode (default 0700) ;chown=nobody:nogroup ; socket file uid:gid owner ;username=user ; \u4f7f\u7528supervisorctl\u8fde\u63a5\u7684\u65f6\u5019\u7684\u7528\u6237\u540d\uff0c\u9ed8\u8ba4\u4e3a\u4e0d\u9700\u8981\u8ba4\u8bc1\u3002 \u975e\u5fc5\u987b ;password=123 ; \u5bf9\u5e94\u7684\u5bc6\u7801\uff0c\u53ef\u660e\u7801\uff0c\u4e5f\u53ef\u7528SHA\u52a0\u5bc6\u5982\uff1a{SHA}82ab876d1387bfafe46cc1c8a2ef074eae50cb1d\uff0c\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u3002\u975e\u5fc5\u987b ;[inet_http_server] ; \u4fa6\u542c\u7684socket\uff0cWeb Server\u548c\u8fdc\u7a0b\u7684supervisorctl\u8981\u7528\u5230\uff0c\u9ed8\u8ba4\u4e0d\u5f00\u542f\u3002\u975e\u5fc5\u987b ;port=127.0.0.1:9001 ; ip_address:port specifier, *:port for all iface ;username=user ; default is no username (open server) ;password=123 ; default is no password (open server) [supervisord] ; \u5b9a\u4e49supervisord\u670d\u52a1\u7aef\u8fdb\u7a0b\u53c2\u6570\uff0c\u5fc5\u987b\u8bbe\u7f6e logfile=/tmp/supervisord.log ; main log file; default $CWD/supervisord.log logfile_maxbytes=50MB ; max main logfile bytes b4 rotation; default 50MB logfile_backups=10 ; # of main logfile backups; 0 means none, default 10 loglevel=info ; log level; default info; others: debug,warn,trace pidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid nodaemon=false ; \u540e\u53f0\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u8fd0\u884c\uff0c\u5982\u679ctrue\uff0csupervisord\u8fdb\u7a0b\u5c06\u5728\u524d\u53f0\u8fd0\u884c\uff0c\u975e\u5fc5\u987b minfds=1024 ; \u6700\u5c11\u7cfb\u7edf\u7a7a\u95f2\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08/proc/sys/fs/file-max\uff09\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u503c\u670d\u52a1\u4e0d\u4f1a\u542f\u52a8\uff0c\u975e\u5fc5\u987b minprocs=200 ; \u6700\u5c0f\u53ef\u7528\u7684\u8fdb\u7a0b\u6570\uff08ulimit -u\uff09\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u503c\u670d\u52a1\u4e0d\u4f1a\u6b63\u5e38\u542f\u52a8\u3002\u9ed8\u8ba4200\u3002\u975e\u5fc5\u987b ;umask=022 ; process file creation umask; default 022 user=op ; \u4ee5root\u542f\u52a8supervisord\u540e\u3002\u8fd9\u4e2a\u7528\u6237\u4e5f\u53ef\u4ee5\u5bf9supervisord\u8fdb\u884c\u7ba1\u7406\u3002\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u3002\u975e\u5fc5\u987b ;identifier=supervisor ; supervisord\u7684\u6807\u8bc6\u7b26\uff0c\u7ed9XML_RPC\u7528\u7684\u3002\u5f53\u6709\u591a\u4e2asupervisor\u7684\u65f6\u5019\uff0c\u4e14\u60f3\u7528XML_RPC\u7edf\u4e00\u7ba1\u7406\uff0c\u9700\u8981\u4e3a\u6bcf\u4e2asupervisor\u8bbe\u7f6e\u4e0d\u540c\u7684\u6807\u8bc6\u7b26\u3002\u9ed8\u8ba4\u662fsupervisord\u3002\u975e\u5fc5\u987b ;directory=/tmp ; default is not to cd during start ;nocleanup=true ; don't clean up tempfiles at start; default false ;childlogdir=/tmp ; \u5f53\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u8def\u5f84\u4e3aAUTO\u7684\u65f6\u5019\uff0c\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u6587\u4ef6\u7684\u5b58\u653e\u8def\u5f84(python -c \"import tempfile;print tempfile.gettempdir()\") ;environment=KEY=\"value\" ; supervisord\u5728\u542f\u52a8\u65f6\uff0c\u9ed8\u8ba4\u7ee7\u627flinux\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u8bbe\u7f6esupervisord\u8fdb\u7a0b\u7279\u6709\u7684\u5176\u4ed6\u73af\u5883\u53d8\u91cf\u3002supervisord\u542f\u52a8\u5b50\u8fdb\u7a0b\u65f6\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u62f7\u8d1d\u7236\u8fdb\u7a0b\u7684\u5185\u5b58\u7a7a\u95f4\u5185\u5bb9\u3002 \u6240\u4ee5\u8bbe\u7f6e\u7684\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u4e5f\u4f1a\u88ab\u5b50\u8fdb\u7a0b\u7ee7\u627f\u3002\u4f8b\uff1aenvironment=name=\"haha\",age=\"hehe\" ;strip_ansi=false ; \u6e05\u9664\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u4e2d\u7684\u6240\u6709ANSI\u5e8f\u5217\uff08\u4f8b\u5982\\n,\\t\uff09 [rpcinterface:supervisor] ; \u7ed9XML_RPC\u7528\u7684\uff0c\u5982\u679c\u60f3\u4f7f\u7528supervisord\u6216\u8005web server\uff0c\u8be5\u9009\u9879\u5fc5\u987b\u8981\u5f00\u542f supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface [supervisorctl] serverurl=unix:///tmp/supervisor.sock ; supervisorctl\u672c\u5730\u8fde\u63a5supervisord\u65f6\uff0c\u672c\u5730UNIX socket\u8def\u5f84\uff0c\u548c\u524d\u9762\u7684[unix_http_server]\u5bf9\u5e94\u7684\uff0c\u9ed8\u8ba4\u503c\u5c31\u662funix:///tmp/supervisor.sock\uff0c\u975e\u5fc5\u987b ;serverurl=http://127.0.0.1:9001 ; supervisorctl\u8fdc\u7a0b\u8fde\u63a5supervisord\u7684\u65f6\u5019\uff0c\u7528\u5230\u7684TCP socket\u8def\u5f84\uff0c\u6ce8\u610f\u8fd9\u548c\u524d\u9762\u7684[inet_http_server]\u5bf9\u5e94\uff0c\u975e\u5fc5\u987b ;username=chris ; should be same as in [*_http_server] if set ;password=123 ; should be same as in [*_http_server] if set ;prompt=mysupervisor ; \u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\u65f6\u5019\u7684\u63d0\u793a\u7b26 ;history_file=~/.sc_history ; \u548cshell\u4e2dhistory\u7c7b\u4f3c\uff0c\u53ef\u7528\u4e0a\u4e0b\u952e\u6765\u67e5\u627e\u524d\u9762\u6267\u884c\u8fc7\u7684\u547d\u4ee4\uff0c\u9ed8\u8ba4\u662fno file\u3002\u975e\u5fc5\u987b ;[program:theprogramname] ; \u8981\u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\uff0c\":\"\u540e\u9762\u7684\u662f\u540d\u5b57\uff0cprogram\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2a\uff0c\u4e00\u4e2aprogram\u5c31\u662f\u8981\u88ab\u7ba1\u7406\u7684\u4e00\u4e2a\u8fdb\u7a0b ;command=/bin/cat ; \u8981\u542f\u52a8\u8fdb\u7a0b\u7684\u547d\u4ee4\u8def\u5f84\uff0c\u53ef\u5e26\u53c2\u6570\uff0c\u4f8b\u5b50\uff1a/home/test.py -a 'hehe'\u3002\u6ce8\u610f\uff1acommand\u4e0d\u80fd\u662f\u5b88\u62a4\u8fdb\u7a0b\u3002\u5fc5\u987b\u9879 ;process_name=%(program_name)s ; \u8fdb\u7a0b\u540d\uff0c\u5982\u679c\u4e0b\u9762\u7684numprocs=1\u7684\u8bdd\uff0c\u5c31\u4e0d\u7528\u7ba1\u3002\u9ed8\u8ba4\u503c%(program_name)s\uff0c\u4e5f\u5c31\u662f\u4e0a\u9762\u7684\u90a3\u4e2aprogram\u5192\u53f7\u540e\u9762\u7684\u540d\u5b57\uff0c\u4f46\u5982\u679cnumprocs\u4e3a\u591a\u4e2a\u65f6\uff0c\u9700\u8981\u914d\u7f6e\u3002 ;numprocs=1 ; \u542f\u52a8\u8fdb\u7a0b\u6570\u3002\u5f53\u4e0d\u4e3a1\u65f6\uff0c\u5c31\u662f\u8fdb\u7a0b\u6c60\u3002\u6ce8\u610fprocess_name\u7684\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u4e3a1\u3002\u975e\u5fc5\u987b ;directory=/tmp ; \u8fdb\u7a0b\u8fd0\u884c\u524d\uff0c\u4f1a\u524d\u5207\u6362\u5230\u8be5\u76ee\u5f55 ;umask=022 ; umask for process (default None) ;priority=999 ; \u5b50\u8fdb\u7a0b\u542f\u52a8\u5173\u95ed\u4f18\u5148\u7ea7\uff0c\u4f18\u5148\u7ea7\u4f4e\u7684\uff0c\u6700\u5148\u542f\u52a8\uff0c\u6700\u540e\u5173\u95ed ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; \u5b50\u8fdb\u7a0b\u542f\u52a8\u591a\u5c11\u79d2\u4e4b\u540e\uff0c\u72b6\u6001\u5982\u679c\u662frunning\uff0c\u5219\u8ba4\u4e3a\u542f\u52a8\u6210\u529f ;startretries=3 ; \u5f53\u8fdb\u7a0b\u542f\u52a8\u5931\u8d25\u540e\uff0c\u6700\u5927\u5c1d\u8bd5\u542f\u52a8\u7684\u6b21\u6570\uff0c\u5f53\u8d85\u8fc7\u540e\uff0csupervisor\u628a\u6b64\u8fdb\u7a0b\u7684\u72b6\u6001\u7f6e\u4e3aFAIL ;autorestart=unexpected ; \u8bbe\u7f6e\u5b50\u8fdb\u7a0b\u6302\u6389\u540e\u81ea\u52a8\u91cd\u542f\u7684\u60c5\u51b5\uff0c\u6709\u4e09\u4e2a\u9009\u9879\uff1afalse,unexpected\u548ctrue ; false\uff0c\u65e0\u8bba\u4ec0\u4e48\u60c5\u51b5\u4e0b\uff0c\u90fd\u4e0d\u4f1a\u88ab\u91cd\u65b0\u542f\u52a8 ; unexpected\uff0c\u5f53\u8fdb\u7a0b\u7684\u9000\u51fa\u7801\u4e0d\u5728exitcodes\u91cc\u9762\u5b9a\u4e49\u65f6\uff0c\u624d\u4f1a\u88ab\u81ea\u52a8\u91cd\u542f ; true\uff0c\u53ea\u8981\u5b50\u8fdb\u7a0b\u6302\u6389\uff0c\u5c06\u4f1a\u88ab\u65e0\u6761\u4ef6\u7684\u91cd\u542f ;exitcodes=0,2 ; 'expected' exit codes used with autorestart (default 0,2) ;stopsignal=QUIT ; \u8fdb\u7a0b\u505c\u6b62\u4fe1\u53f7\uff0c\u53ef\u4ee5\u4e3aTERM, HUP, INT, QUIT, KILL, USR1, or USR2\u7b49\u4fe1\u53f7 ;stopwaitsecs=10 ; \u5411\u5b50\u8fdb\u7a0b\u53d1\u9001stopsignal\u4fe1\u53f7\u540e\uff0c\u5230\u7cfb\u7edf\u8fd4\u56de\u4fe1\u606f\uff0c\u6240\u7b49\u5f85\u7684\u6700\u5927\u65f6\u95f4\u3002\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u95f4\uff0c\u4f1a\u5411\u8be5\u5b50\u8fdb\u7a0b\u53d1\u9001\u4e00\u4e2a\u5f3a\u5236kill\u7684\u4fe1\u53f7 ;stopasgroup=false ; \u7528\u4e8e\u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\u672c\u8eab\u8fd8\u6709\u5b50\u8fdb\u7a0b\u3002\u5982\u679c\u4ec5\u4ec5\u5e72\u6389\u5b50\u8fdb\u7a0b\u7684\u8bdd\uff0c\u5b50\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\u6709\u53ef\u80fd\u53d8\u6210\u5b64\u513f\u8fdb\u7a0b\u3002\u8be5\u9009\u9879true\u65f6\uff0c\u628a\u8be5\u5b50\u8fdb\u7a0b\u7684\u6574\u4e2a\u8fdb\u7a0b\u7ec4\u90fd\u5e72\u6389\u3002\u6ce8\u610f\uff0c\u8be5\u9009\u9879\u53d1\u9001\u7684\u662fstop\u4fe1\u53f7\uff0c\u9ed8\u8ba4false\u3002\u975e\u5fc5\u987b ;killasgroup=false ; \u548cstopasgroup\u7c7b\u4f3c\uff0c\u53d1\u9001\u7684\u662fkill\u4fe1\u53f7 ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=true ; true\u65f6\uff0cstderr\u65e5\u5fd7\u88ab\u5199\u5165stdout\u65e5\u5fd7\u6587\u4ef6\u4e2d\u3002\u9ed8\u8ba4\u4e3afalse\uff0c\u975e\u5fc5\u987b ;stdout_logfile=/a/path ; \u5b50\u8fdb\u7a0b\u7684stdout\u7684\u65e5\u5fd7\u8def\u5f84\uff0c\u53ef\u4ee5\u6307\u5b9a\u8def\u5f84\uff0cAUTO\uff0cnone\u4e09\u4e2a\u9009\u9879 ; AUTO\u65f6\uff0c\u968f\u673a\u627e\u4e00\u4e2a\u5730\u65b9\u751f\u6210\u65e5\u5fd7\uff0c\u800c\u5f53supervisord\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u4ee5\u524d\u65e5\u5fd7\u4f1a\u6e05\u7a7a ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_capture_maxbytes=1MB ; \u8bbe\u5b9acapture\u7ba1\u9053\u7684\u5927\u5c0f\uff0c\u5f53\u503c\u4e0d\u4e3a0\u7684\u65f6\u5019\uff0c\u5b50\u8fdb\u7a0b\u53ef\u4ee5\u4ecestdout\u53d1\u9001\u4fe1\u606f\uff0c\u800csupervisor\u53ef\u4ee5\u6839\u636e\u4fe1\u606f\uff0c\u53d1\u9001\u76f8\u5e94\u7684event\u3002\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u8fbe\u5173\u95ed\u7ba1\u9053\u3002\u975e\u5fc5\u987b ;stdout_events_enabled=false ; \u4e3ature\u65f6\uff0c\u5f53\u5b50\u8fdb\u7a0b\u7531stdout\u5411\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e2d\u5199\u65e5\u5fd7\u65f6\uff0c\u5c06\u89e6\u53d1supervisord\u53d1\u9001PROCESS_LOG_STDOUT\u7c7b\u578b\u7684event\u3002\u8ba4\u4e3afalse\u3002\u975e\u5fc5\u987b ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_capture_maxbytes=1MB ; number of bytes in 'capturemode' (default 0) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A=\"1\",B=\"2\" ; \u8be5\u5b50\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u548c\u522b\u7684\u5b50\u8fdb\u7a0b\u662f\u4e0d\u5171\u4eab ;serverurl=AUTO ; override serverurl computation (childutils) ;[eventlistener:theeventlistenername] ; \u8ba2\u9605supervisord\u53d1\u9001\u7684event\u3002\u53ef\u5728listener\u91cc\u9762\u505a\u4e00\u7cfb\u5217\u5904\u7406\uff0c\u6bd4\u5982\u62a5\u8b66\u7b49 ;command=/bin/eventlistener ; the program (relative uses PATH, can take args) ;process_name=%(program_name)s ; process_name expr (default %(program_name)s) ;numprocs=1 ; number of processes copies to start (def 1) ;events=EVENT ; \u4e8b\u4ef6\u7684\u7c7b\u578b\uff0c\u53ea\u6709\u8be5\u4e8b\u4ef6\u7c7b\u578b\u3002\u624d\u4f1a\u88ab\u53d1\u9001(req'd) ;buffer_size=10 ; event\u961f\u5217\u7f13\u5b58\u5927\u5c0f (default 10) ;directory=/tmp ; directory to cwd to before exec (def no cwd) ;umask=022 ; umask for process (default None) ;priority=-1 ; the relative start priority (default -1) ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; # of secs prog must stay up to be running (def. 1) ;startretries=3 ; max # of serial start failures when starting (default 3) ;autorestart=unexpected ; autorestart if exited after running (def: unexpected) ;exitcodes=0,2 ; 'expected' exit codes used with autorestart (default 0,2) ;stopsignal=QUIT ; signal used to kill process (default TERM) ;stopwaitsecs=10 ; max num secs to wait b4 SIGKILL (default 10) ;stopasgroup=false ; send stop signal to the UNIX process group (default false) ;killasgroup=false ; SIGKILL the UNIX process group (def false) ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=false ; redirect_stderr=true is not allowed for eventlisteners ;stdout_logfile=/a/path ; stdout log path, NONE for none; default AUTO ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_events_enabled=false ; emit events on stdout writes (default false) ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A=\"1\",B=\"2\" ; process environment additions ;serverurl=AUTO ; override serverurl computation (childutils) ;[group:thegroupname] ; \u7ed9programs\u5206\u7ec4\uff0c\u5212\u5206\u5230\u7ec4\u91cc\u9762\u7684program\u3002\u53ef\u4ee5\u5bf9\u7ec4\u540d\u8fdb\u884c\u7edf\u4e00\u7684\u64cd\u4f5c\u3002\u6ce8\u610f\uff1aprogram\u88ab\u5212\u5206\u5230\u7ec4\u91cc\u9762\u4e4b\u540e\uff0c\u76f8\u5f53\u4e8e\u539f\u6765\u7684\u914d\u7f6e\u5931\u6548\u3002supervisor\u53ea\u5bf9\u7ec4\u8fdb\u884c\u7ba1\u7406\uff0c\u800c\u4e0d\u518d\u5bf9\u7ec4\u91cc\u9762\u7684\u5355\u4e2aprogram\u8fdb\u884c\u7ba1\u7406 ;programs=progname1,progname2 ; each refers to 'x' in [program:x] definitions ;priority=999 ; the relative start priority (default 999) ; The [include] section can just contain the \"files\" setting. This ; setting can list multiple files (separated by whitespace or ; newlines). It can also contain wildcards. The filenames are ; interpreted as relative to this file. Included files *cannot* ; include files themselves. ;[include] ; \u5f53\u6211\u4eec\u8981\u7ba1\u7406\u7684\u8fdb\u7a0b\u5f88\u591a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u628a\u914d\u7f6e\u4fe1\u606f\u5199\u5230\u591a\u4e2a\u6587\u4ef6\u4e2d\uff0c\u7136\u540einclude\u8fc7\u6765 ;files = relative/directory/*.ini","title":"supervisord\u540e\u53f0\u8fdb\u7a0b\u7ba1\u7406"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#supervisord","text":"","title":"supervisord\u540e\u53f0\u8fdb\u7a0b\u7ba1\u7406"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#_1","text":"\u5b98\u7f51\u6587\u6863\uff1ahttp://supervisord.org/","title":"\u53c2\u8003"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#_2","text":"supervisord\uff1a\u670d\u52a1\u540e\u53f0\u8fdb\u7a0b\uff0c\u5c06\u6240\u7ba1\u7406\u7684\u8fdb\u7a0b\u4f5c\u4e3a\u81ea\u5df1\u7684\u5b50\u8fdb\u7a0b\u6765\u542f\u52a8\uff0c\u53ef\u4ee5\u5728\u5b50\u8fdb\u7a0b\u5d29\u6e83\u65f6\u81ea\u52a8\u91cd\u542f\u4e4b\u3002 supervisorctl\uff1a\u547d\u4ee4\u884c\u7ba1\u7406\u5de5\u5177\uff0c\u6267\u884c stop\u3001start\u3001restart \u7b49\u547d\u4ee4\uff0c\u6765\u7ba1\u7406\u5b50\u8fdb\u7a0b\u3002","title":"\u670d\u52a1\u7ed3\u6784"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#_3","text":"","title":"\u5b89\u88c5\u548c\u914d\u7f6e"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#pip","text":"pip install supervisor \u4ee5root\u89d2\u8272\u5b89\u88c5 echo_supervisord_conf > /opt/supervisor/supervisord.conf \u5efa\u8bae\u4ee5\u666e\u901a\u7528\u6237\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u4ee5\u7075\u6d3b\u7f16\u8f91\u6269\u5c55 supervisord -u op -c /opt/supervisor/supervisord.conf \u4ee5\u666e\u901a\u7528\u6237op\u542f\u52a8supervisord\uff0c\u8bfb\u53d6\u6307\u5b9a\u914d\u7f6e","title":"pip\u5b89\u88c5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#_4","text":"Ubuntu: apt install supervisor","title":"\u539f\u751f\u5b89\u88c5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#supervisord_1","text":"","title":"\u5f00\u673a\u542f\u52a8supervisord"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#centossystemd","text":"\u65b0\u5efa\u6587\u4ef6supervisord.service [Unit] Description=Supervisord [Service] Type=forking ExecStart=/usr/bin/supervisord -u op -c /opt/supervisor/supervisord.conf ExecStop=/usr/bin/supervisorctl shutdown ExecReload=/usr/bin/supervisorctl reload KillMode=process Restart=on-failure RestartSec=42s [Install] WantedBy=multi-user.target \u6587\u4ef6\u62f7\u8d1d\u5230 /usr/lib/systemd/system/ chmod 766 supervisord.service \u6743\u9650\u8bbe\u5b9a systemctl enable supervisord \u542f\u52a8\u670d\u52a1 systemctl is-enabled supervisord \u9a8c\u8bc1\u662f\u5426\u4e3a\u5f00\u673a\u542f\u52a8","title":"CentOS\u7684systemd"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#ubuntu","text":"cd /etc/supervisor/conf.d \uff0c\u6309\u5bf9\u5e94\u7684\u9879\u76ee\u8fdb\u7a0b\uff0c\u5efa\u7acb\u81ea\u5df1\u7684conf ; devops-cms.conf [program:devops-cms] directory =/opt/devops-cms command =yarn develop autostart =true autorestart =true startretries=10 redirect_stderr=true ; \u4e0d\u8981\u653e\u5728yarn\u9879\u76ee\u8def\u5f84\u4e0b\uff0clog\u7684\u53d8\u5316\u4f1a\u5bfc\u81f4yarn\u4e0d\u65ad\u91cd\u542f stdout_logfile=/tmp/supervisor-devops-cms.log ; \u5982\u679c\u662fpython\u9700\u8981\u6307\u5b9avenv ; command=/opt/devops-cms/ENV/bin/python /opt/devops-cms/app.py ; environment=PATH=\"/opt/devops-cms/ENV/bin:%(ENV_PATH)s\" supervisorctl reload \uff0c\u52a0\u8f7d\u6700\u65b0\u914d\u7f6e","title":"Ubuntu\u7684\u539f\u751f\u5b89\u88c5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#cli","text":"#program_name \u4e3a [groupworker:program_name] \u91cc\u7684 program_name # \u505c\u6b62\u67d0\u4e00\u4e2a\u8fdb\u7a0b supervisorctl stop program_name # \u542f\u52a8\u67d0\u4e2a\u8fdb\u7a0b supervisorctl start program_name # \u91cd\u542f\u67d0\u4e2a\u8fdb\u7a0b supervisorctl restart program_name # \u7ed3\u675f\u6240\u6709\u5c5e\u4e8e\u540d\u4e3a groupworker \u8fd9\u4e2a\u5206\u7ec4\u7684\u8fdb\u7a0b (start\uff0crestart \u540c\u7406) supervisorctl stop groupworker: # \u7ed3\u675f groupworker:name1 \u8fd9\u4e2a\u8fdb\u7a0b (start\uff0crestart \u540c\u7406) supervisorctl stop groupworker:name1 # \u505c\u6b62\u5168\u90e8\u8fdb\u7a0b\uff0c\u6ce8\uff1astart\u3001restart\u3001stop \u90fd\u4e0d\u4f1a\u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6 supervisorctl stop all # \u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u505c\u6b62\u539f\u6709\u8fdb\u7a0b\u5e76\u6309\u65b0\u7684\u914d\u7f6e\u542f\u52a8\u3001\u7ba1\u7406\u6240\u6709\u8fdb\u7a0b supervisorctl reload # \u6839\u636e\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u542f\u52a8\u65b0\u914d\u7f6e\u6216\u6709\u6539\u52a8\u7684\u8fdb\u7a0b\uff0c\u914d\u7f6e\u6ca1\u6709\u6539\u52a8\u7684\u8fdb\u7a0b\u4e0d\u4f1a\u53d7\u5f71\u54cd\u800c\u91cd\u542f supervisorctl update","title":"\u5e38\u7528cli"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/supervisor/#supervisordconf","text":"; \u6ce8\u610f\uff1a ; - \u73af\u5883\u53d8\u91cf\u652f\u6301\u6a21\u5f0f\uff1a %(ENV_HOME)s ; - \u4e0d\u652f\u6301value\u5957\u5f15\u53f7 ; - ;\u6ce8\u91ca\u4e4b\u524d\u9700\u8981\u5e26\u7a7a\u683c ; - Command\u4e2d;\u540e\u9762\u7684\u5185\u5bb9\u4f1a\u88ab\u5ffd\u7565 [unix_http_server] file=/tmp/supervisor.sock ; supervisorctl\u7528XML_RPC\u548csupervisord\u901a\u4fe1\u5c31\u662f\u901a\u8fc7\u5b83\u8fdb\u884c\u7684\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\u7684\u8bdd\uff0csupervisorctl\u5c31\u4e0d\u80fd\u7528\uff0c\u9ed8\u8ba4\u4e3anone\u3002\u975e\u5fc5\u987b ;chmod=0700 ; socket file mode (default 0700) ;chown=nobody:nogroup ; socket file uid:gid owner ;username=user ; \u4f7f\u7528supervisorctl\u8fde\u63a5\u7684\u65f6\u5019\u7684\u7528\u6237\u540d\uff0c\u9ed8\u8ba4\u4e3a\u4e0d\u9700\u8981\u8ba4\u8bc1\u3002 \u975e\u5fc5\u987b ;password=123 ; \u5bf9\u5e94\u7684\u5bc6\u7801\uff0c\u53ef\u660e\u7801\uff0c\u4e5f\u53ef\u7528SHA\u52a0\u5bc6\u5982\uff1a{SHA}82ab876d1387bfafe46cc1c8a2ef074eae50cb1d\uff0c\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u3002\u975e\u5fc5\u987b ;[inet_http_server] ; \u4fa6\u542c\u7684socket\uff0cWeb Server\u548c\u8fdc\u7a0b\u7684supervisorctl\u8981\u7528\u5230\uff0c\u9ed8\u8ba4\u4e0d\u5f00\u542f\u3002\u975e\u5fc5\u987b ;port=127.0.0.1:9001 ; ip_address:port specifier, *:port for all iface ;username=user ; default is no username (open server) ;password=123 ; default is no password (open server) [supervisord] ; \u5b9a\u4e49supervisord\u670d\u52a1\u7aef\u8fdb\u7a0b\u53c2\u6570\uff0c\u5fc5\u987b\u8bbe\u7f6e logfile=/tmp/supervisord.log ; main log file; default $CWD/supervisord.log logfile_maxbytes=50MB ; max main logfile bytes b4 rotation; default 50MB logfile_backups=10 ; # of main logfile backups; 0 means none, default 10 loglevel=info ; log level; default info; others: debug,warn,trace pidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid nodaemon=false ; \u540e\u53f0\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u8fd0\u884c\uff0c\u5982\u679ctrue\uff0csupervisord\u8fdb\u7a0b\u5c06\u5728\u524d\u53f0\u8fd0\u884c\uff0c\u975e\u5fc5\u987b minfds=1024 ; \u6700\u5c11\u7cfb\u7edf\u7a7a\u95f2\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08/proc/sys/fs/file-max\uff09\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u503c\u670d\u52a1\u4e0d\u4f1a\u542f\u52a8\uff0c\u975e\u5fc5\u987b minprocs=200 ; \u6700\u5c0f\u53ef\u7528\u7684\u8fdb\u7a0b\u6570\uff08ulimit -u\uff09\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u503c\u670d\u52a1\u4e0d\u4f1a\u6b63\u5e38\u542f\u52a8\u3002\u9ed8\u8ba4200\u3002\u975e\u5fc5\u987b ;umask=022 ; process file creation umask; default 022 user=op ; \u4ee5root\u542f\u52a8supervisord\u540e\u3002\u8fd9\u4e2a\u7528\u6237\u4e5f\u53ef\u4ee5\u5bf9supervisord\u8fdb\u884c\u7ba1\u7406\u3002\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u3002\u975e\u5fc5\u987b ;identifier=supervisor ; supervisord\u7684\u6807\u8bc6\u7b26\uff0c\u7ed9XML_RPC\u7528\u7684\u3002\u5f53\u6709\u591a\u4e2asupervisor\u7684\u65f6\u5019\uff0c\u4e14\u60f3\u7528XML_RPC\u7edf\u4e00\u7ba1\u7406\uff0c\u9700\u8981\u4e3a\u6bcf\u4e2asupervisor\u8bbe\u7f6e\u4e0d\u540c\u7684\u6807\u8bc6\u7b26\u3002\u9ed8\u8ba4\u662fsupervisord\u3002\u975e\u5fc5\u987b ;directory=/tmp ; default is not to cd during start ;nocleanup=true ; don't clean up tempfiles at start; default false ;childlogdir=/tmp ; \u5f53\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u8def\u5f84\u4e3aAUTO\u7684\u65f6\u5019\uff0c\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u6587\u4ef6\u7684\u5b58\u653e\u8def\u5f84(python -c \"import tempfile;print tempfile.gettempdir()\") ;environment=KEY=\"value\" ; supervisord\u5728\u542f\u52a8\u65f6\uff0c\u9ed8\u8ba4\u7ee7\u627flinux\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u8bbe\u7f6esupervisord\u8fdb\u7a0b\u7279\u6709\u7684\u5176\u4ed6\u73af\u5883\u53d8\u91cf\u3002supervisord\u542f\u52a8\u5b50\u8fdb\u7a0b\u65f6\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u62f7\u8d1d\u7236\u8fdb\u7a0b\u7684\u5185\u5b58\u7a7a\u95f4\u5185\u5bb9\u3002 \u6240\u4ee5\u8bbe\u7f6e\u7684\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u4e5f\u4f1a\u88ab\u5b50\u8fdb\u7a0b\u7ee7\u627f\u3002\u4f8b\uff1aenvironment=name=\"haha\",age=\"hehe\" ;strip_ansi=false ; \u6e05\u9664\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u4e2d\u7684\u6240\u6709ANSI\u5e8f\u5217\uff08\u4f8b\u5982\\n,\\t\uff09 [rpcinterface:supervisor] ; \u7ed9XML_RPC\u7528\u7684\uff0c\u5982\u679c\u60f3\u4f7f\u7528supervisord\u6216\u8005web server\uff0c\u8be5\u9009\u9879\u5fc5\u987b\u8981\u5f00\u542f supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface [supervisorctl] serverurl=unix:///tmp/supervisor.sock ; supervisorctl\u672c\u5730\u8fde\u63a5supervisord\u65f6\uff0c\u672c\u5730UNIX socket\u8def\u5f84\uff0c\u548c\u524d\u9762\u7684[unix_http_server]\u5bf9\u5e94\u7684\uff0c\u9ed8\u8ba4\u503c\u5c31\u662funix:///tmp/supervisor.sock\uff0c\u975e\u5fc5\u987b ;serverurl=http://127.0.0.1:9001 ; supervisorctl\u8fdc\u7a0b\u8fde\u63a5supervisord\u7684\u65f6\u5019\uff0c\u7528\u5230\u7684TCP socket\u8def\u5f84\uff0c\u6ce8\u610f\u8fd9\u548c\u524d\u9762\u7684[inet_http_server]\u5bf9\u5e94\uff0c\u975e\u5fc5\u987b ;username=chris ; should be same as in [*_http_server] if set ;password=123 ; should be same as in [*_http_server] if set ;prompt=mysupervisor ; \u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\u65f6\u5019\u7684\u63d0\u793a\u7b26 ;history_file=~/.sc_history ; \u548cshell\u4e2dhistory\u7c7b\u4f3c\uff0c\u53ef\u7528\u4e0a\u4e0b\u952e\u6765\u67e5\u627e\u524d\u9762\u6267\u884c\u8fc7\u7684\u547d\u4ee4\uff0c\u9ed8\u8ba4\u662fno file\u3002\u975e\u5fc5\u987b ;[program:theprogramname] ; \u8981\u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\uff0c\":\"\u540e\u9762\u7684\u662f\u540d\u5b57\uff0cprogram\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2a\uff0c\u4e00\u4e2aprogram\u5c31\u662f\u8981\u88ab\u7ba1\u7406\u7684\u4e00\u4e2a\u8fdb\u7a0b ;command=/bin/cat ; \u8981\u542f\u52a8\u8fdb\u7a0b\u7684\u547d\u4ee4\u8def\u5f84\uff0c\u53ef\u5e26\u53c2\u6570\uff0c\u4f8b\u5b50\uff1a/home/test.py -a 'hehe'\u3002\u6ce8\u610f\uff1acommand\u4e0d\u80fd\u662f\u5b88\u62a4\u8fdb\u7a0b\u3002\u5fc5\u987b\u9879 ;process_name=%(program_name)s ; \u8fdb\u7a0b\u540d\uff0c\u5982\u679c\u4e0b\u9762\u7684numprocs=1\u7684\u8bdd\uff0c\u5c31\u4e0d\u7528\u7ba1\u3002\u9ed8\u8ba4\u503c%(program_name)s\uff0c\u4e5f\u5c31\u662f\u4e0a\u9762\u7684\u90a3\u4e2aprogram\u5192\u53f7\u540e\u9762\u7684\u540d\u5b57\uff0c\u4f46\u5982\u679cnumprocs\u4e3a\u591a\u4e2a\u65f6\uff0c\u9700\u8981\u914d\u7f6e\u3002 ;numprocs=1 ; \u542f\u52a8\u8fdb\u7a0b\u6570\u3002\u5f53\u4e0d\u4e3a1\u65f6\uff0c\u5c31\u662f\u8fdb\u7a0b\u6c60\u3002\u6ce8\u610fprocess_name\u7684\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u4e3a1\u3002\u975e\u5fc5\u987b ;directory=/tmp ; \u8fdb\u7a0b\u8fd0\u884c\u524d\uff0c\u4f1a\u524d\u5207\u6362\u5230\u8be5\u76ee\u5f55 ;umask=022 ; umask for process (default None) ;priority=999 ; \u5b50\u8fdb\u7a0b\u542f\u52a8\u5173\u95ed\u4f18\u5148\u7ea7\uff0c\u4f18\u5148\u7ea7\u4f4e\u7684\uff0c\u6700\u5148\u542f\u52a8\uff0c\u6700\u540e\u5173\u95ed ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; \u5b50\u8fdb\u7a0b\u542f\u52a8\u591a\u5c11\u79d2\u4e4b\u540e\uff0c\u72b6\u6001\u5982\u679c\u662frunning\uff0c\u5219\u8ba4\u4e3a\u542f\u52a8\u6210\u529f ;startretries=3 ; \u5f53\u8fdb\u7a0b\u542f\u52a8\u5931\u8d25\u540e\uff0c\u6700\u5927\u5c1d\u8bd5\u542f\u52a8\u7684\u6b21\u6570\uff0c\u5f53\u8d85\u8fc7\u540e\uff0csupervisor\u628a\u6b64\u8fdb\u7a0b\u7684\u72b6\u6001\u7f6e\u4e3aFAIL ;autorestart=unexpected ; \u8bbe\u7f6e\u5b50\u8fdb\u7a0b\u6302\u6389\u540e\u81ea\u52a8\u91cd\u542f\u7684\u60c5\u51b5\uff0c\u6709\u4e09\u4e2a\u9009\u9879\uff1afalse,unexpected\u548ctrue ; false\uff0c\u65e0\u8bba\u4ec0\u4e48\u60c5\u51b5\u4e0b\uff0c\u90fd\u4e0d\u4f1a\u88ab\u91cd\u65b0\u542f\u52a8 ; unexpected\uff0c\u5f53\u8fdb\u7a0b\u7684\u9000\u51fa\u7801\u4e0d\u5728exitcodes\u91cc\u9762\u5b9a\u4e49\u65f6\uff0c\u624d\u4f1a\u88ab\u81ea\u52a8\u91cd\u542f ; true\uff0c\u53ea\u8981\u5b50\u8fdb\u7a0b\u6302\u6389\uff0c\u5c06\u4f1a\u88ab\u65e0\u6761\u4ef6\u7684\u91cd\u542f ;exitcodes=0,2 ; 'expected' exit codes used with autorestart (default 0,2) ;stopsignal=QUIT ; \u8fdb\u7a0b\u505c\u6b62\u4fe1\u53f7\uff0c\u53ef\u4ee5\u4e3aTERM, HUP, INT, QUIT, KILL, USR1, or USR2\u7b49\u4fe1\u53f7 ;stopwaitsecs=10 ; \u5411\u5b50\u8fdb\u7a0b\u53d1\u9001stopsignal\u4fe1\u53f7\u540e\uff0c\u5230\u7cfb\u7edf\u8fd4\u56de\u4fe1\u606f\uff0c\u6240\u7b49\u5f85\u7684\u6700\u5927\u65f6\u95f4\u3002\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u95f4\uff0c\u4f1a\u5411\u8be5\u5b50\u8fdb\u7a0b\u53d1\u9001\u4e00\u4e2a\u5f3a\u5236kill\u7684\u4fe1\u53f7 ;stopasgroup=false ; \u7528\u4e8e\u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\u672c\u8eab\u8fd8\u6709\u5b50\u8fdb\u7a0b\u3002\u5982\u679c\u4ec5\u4ec5\u5e72\u6389\u5b50\u8fdb\u7a0b\u7684\u8bdd\uff0c\u5b50\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\u6709\u53ef\u80fd\u53d8\u6210\u5b64\u513f\u8fdb\u7a0b\u3002\u8be5\u9009\u9879true\u65f6\uff0c\u628a\u8be5\u5b50\u8fdb\u7a0b\u7684\u6574\u4e2a\u8fdb\u7a0b\u7ec4\u90fd\u5e72\u6389\u3002\u6ce8\u610f\uff0c\u8be5\u9009\u9879\u53d1\u9001\u7684\u662fstop\u4fe1\u53f7\uff0c\u9ed8\u8ba4false\u3002\u975e\u5fc5\u987b ;killasgroup=false ; \u548cstopasgroup\u7c7b\u4f3c\uff0c\u53d1\u9001\u7684\u662fkill\u4fe1\u53f7 ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=true ; true\u65f6\uff0cstderr\u65e5\u5fd7\u88ab\u5199\u5165stdout\u65e5\u5fd7\u6587\u4ef6\u4e2d\u3002\u9ed8\u8ba4\u4e3afalse\uff0c\u975e\u5fc5\u987b ;stdout_logfile=/a/path ; \u5b50\u8fdb\u7a0b\u7684stdout\u7684\u65e5\u5fd7\u8def\u5f84\uff0c\u53ef\u4ee5\u6307\u5b9a\u8def\u5f84\uff0cAUTO\uff0cnone\u4e09\u4e2a\u9009\u9879 ; AUTO\u65f6\uff0c\u968f\u673a\u627e\u4e00\u4e2a\u5730\u65b9\u751f\u6210\u65e5\u5fd7\uff0c\u800c\u5f53supervisord\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u4ee5\u524d\u65e5\u5fd7\u4f1a\u6e05\u7a7a ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_capture_maxbytes=1MB ; \u8bbe\u5b9acapture\u7ba1\u9053\u7684\u5927\u5c0f\uff0c\u5f53\u503c\u4e0d\u4e3a0\u7684\u65f6\u5019\uff0c\u5b50\u8fdb\u7a0b\u53ef\u4ee5\u4ecestdout\u53d1\u9001\u4fe1\u606f\uff0c\u800csupervisor\u53ef\u4ee5\u6839\u636e\u4fe1\u606f\uff0c\u53d1\u9001\u76f8\u5e94\u7684event\u3002\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u8fbe\u5173\u95ed\u7ba1\u9053\u3002\u975e\u5fc5\u987b ;stdout_events_enabled=false ; \u4e3ature\u65f6\uff0c\u5f53\u5b50\u8fdb\u7a0b\u7531stdout\u5411\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e2d\u5199\u65e5\u5fd7\u65f6\uff0c\u5c06\u89e6\u53d1supervisord\u53d1\u9001PROCESS_LOG_STDOUT\u7c7b\u578b\u7684event\u3002\u8ba4\u4e3afalse\u3002\u975e\u5fc5\u987b ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_capture_maxbytes=1MB ; number of bytes in 'capturemode' (default 0) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A=\"1\",B=\"2\" ; \u8be5\u5b50\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u548c\u522b\u7684\u5b50\u8fdb\u7a0b\u662f\u4e0d\u5171\u4eab ;serverurl=AUTO ; override serverurl computation (childutils) ;[eventlistener:theeventlistenername] ; \u8ba2\u9605supervisord\u53d1\u9001\u7684event\u3002\u53ef\u5728listener\u91cc\u9762\u505a\u4e00\u7cfb\u5217\u5904\u7406\uff0c\u6bd4\u5982\u62a5\u8b66\u7b49 ;command=/bin/eventlistener ; the program (relative uses PATH, can take args) ;process_name=%(program_name)s ; process_name expr (default %(program_name)s) ;numprocs=1 ; number of processes copies to start (def 1) ;events=EVENT ; \u4e8b\u4ef6\u7684\u7c7b\u578b\uff0c\u53ea\u6709\u8be5\u4e8b\u4ef6\u7c7b\u578b\u3002\u624d\u4f1a\u88ab\u53d1\u9001(req'd) ;buffer_size=10 ; event\u961f\u5217\u7f13\u5b58\u5927\u5c0f (default 10) ;directory=/tmp ; directory to cwd to before exec (def no cwd) ;umask=022 ; umask for process (default None) ;priority=-1 ; the relative start priority (default -1) ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; # of secs prog must stay up to be running (def. 1) ;startretries=3 ; max # of serial start failures when starting (default 3) ;autorestart=unexpected ; autorestart if exited after running (def: unexpected) ;exitcodes=0,2 ; 'expected' exit codes used with autorestart (default 0,2) ;stopsignal=QUIT ; signal used to kill process (default TERM) ;stopwaitsecs=10 ; max num secs to wait b4 SIGKILL (default 10) ;stopasgroup=false ; send stop signal to the UNIX process group (default false) ;killasgroup=false ; SIGKILL the UNIX process group (def false) ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=false ; redirect_stderr=true is not allowed for eventlisteners ;stdout_logfile=/a/path ; stdout log path, NONE for none; default AUTO ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_events_enabled=false ; emit events on stdout writes (default false) ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A=\"1\",B=\"2\" ; process environment additions ;serverurl=AUTO ; override serverurl computation (childutils) ;[group:thegroupname] ; \u7ed9programs\u5206\u7ec4\uff0c\u5212\u5206\u5230\u7ec4\u91cc\u9762\u7684program\u3002\u53ef\u4ee5\u5bf9\u7ec4\u540d\u8fdb\u884c\u7edf\u4e00\u7684\u64cd\u4f5c\u3002\u6ce8\u610f\uff1aprogram\u88ab\u5212\u5206\u5230\u7ec4\u91cc\u9762\u4e4b\u540e\uff0c\u76f8\u5f53\u4e8e\u539f\u6765\u7684\u914d\u7f6e\u5931\u6548\u3002supervisor\u53ea\u5bf9\u7ec4\u8fdb\u884c\u7ba1\u7406\uff0c\u800c\u4e0d\u518d\u5bf9\u7ec4\u91cc\u9762\u7684\u5355\u4e2aprogram\u8fdb\u884c\u7ba1\u7406 ;programs=progname1,progname2 ; each refers to 'x' in [program:x] definitions ;priority=999 ; the relative start priority (default 999) ; The [include] section can just contain the \"files\" setting. This ; setting can list multiple files (separated by whitespace or ; newlines). It can also contain wildcards. The filenames are ; interpreted as relative to this file. Included files *cannot* ; include files themselves. ;[include] ; \u5f53\u6211\u4eec\u8981\u7ba1\u7406\u7684\u8fdb\u7a0b\u5f88\u591a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u628a\u914d\u7f6e\u4fe1\u606f\u5199\u5230\u591a\u4e2a\u6587\u4ef6\u4e2d\uff0c\u7136\u540einclude\u8fc7\u6765 ;files = relative/directory/*.ini","title":"supervisord.conf\u914d\u7f6e\u8be6\u89e3"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/tmux/","text":"Tmux\u7b80\u4ecb Linux\u73af\u5883\u591asession\u7ba1\u7406\u5de5\u5177 \u5b89\u88c5 yum install tmux \u4f7f\u7528 tmux new -s your-session-name \u5f00\u542f\u4e2a\u4eba\u7684\u65b0session tmux a -t your-session-name \u8fdb\u5165\u6307\u5b9a\u7684session tmux ls \u5217\u51fa\u6240\u6709session tmux kill-session -t your-session-name \u5f3a\u5236\u5173\u95ed\u6307\u5b9a\u7684session \u5728tmux\u4e2d\u4f7f\u7528\u7684\u6307\u4ee4 \u6bcf\u6b21\u8981\u5148\u6309\u6fc0\u6d3b\u952e\uff08\u9ed8\u8ba4 ctrl+b\uff09\uff0c\u544a\u8bc9tmux\u51c6\u5907\u63a5\u6536\u6307\u4ee4 c \u65b0\u5efa\u7a97\u53e3 w \u5217\u51fa\u5f53\u524dsession\u4e0b\u6240\u6709\u7684\u7a97\u53e3 , \u91cd\u547d\u540d\u5f53\u524d\u7a97\u53e3\u540d x+y \u5173\u95ed\u5f53\u524d\u7a97\u53e3\uff08\u5148\u6309x\u51fa\u73b0\u786e\u8ba4\u63d0\u793a\uff0c\u518d\u6309y\uff09 % \u5782\u76f4\u5206\u7a97 \u201d \u6c34\u5e73\u5206\u7a97 [\u6570\u5b57\u952e] \u5feb\u901f\u8df3\u5230\u6570\u5b57\u4ee3\u8868\u7684\u7a97\u53e3 \u4fdd\u5b58\u548c\u6062\u590d\u5f53\u524dsession \u7528\u4e8e\u4fdd\u5b58\u5f53\u524d\u7684session\u914d\u7f6e\uff0c\u4e0b\u6b21\u76f4\u63a5\u6253\u5f00\uff08\u6bd4\u5982\u91cd\u542f\u540e\uff09\uff0c\u975e\u5e38\u723d\u3002 Tmux Plugin Manager\u514b\u9686\u5230\u672c\u5730 git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm \u66f4\u65b0 ~/.tmux.conf # List of plugins set -g @plugin 'tmux-plugins/tpm' set -g @plugin 'tmux-plugins/tmux-sensible' set -g @plugin 'tmux-plugins/tmux-resurrect' # Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf) run '~/.tmux/plugins/tpm/tpm' \u5728Tmux\u91cc\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e tmux source ~/.tmux.conf \u5728Tmux\u4e2d\u4f7f\u7528\u5feb\u6377prefix + I\u5b89\u88c5\u914d\u7f6e \u6fc0\u6d3b\u952e ctrl+s \u4fdd\u5b58\u5f53\u524dsession \u6fc0\u6d3b\u952e ctrl+r reload\u4e0a\u4e00\u6b21\u4fdd\u5b58\u7684session","title":"Tmux\u7b80\u4ecb"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/tmux/#tmux","text":"Linux\u73af\u5883\u591asession\u7ba1\u7406\u5de5\u5177","title":"Tmux\u7b80\u4ecb"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/tmux/#_1","text":"yum install tmux","title":"\u5b89\u88c5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/tmux/#_2","text":"tmux new -s your-session-name \u5f00\u542f\u4e2a\u4eba\u7684\u65b0session tmux a -t your-session-name \u8fdb\u5165\u6307\u5b9a\u7684session tmux ls \u5217\u51fa\u6240\u6709session tmux kill-session -t your-session-name \u5f3a\u5236\u5173\u95ed\u6307\u5b9a\u7684session","title":"\u4f7f\u7528"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/tmux/#tmux_1","text":"\u6bcf\u6b21\u8981\u5148\u6309\u6fc0\u6d3b\u952e\uff08\u9ed8\u8ba4 ctrl+b\uff09\uff0c\u544a\u8bc9tmux\u51c6\u5907\u63a5\u6536\u6307\u4ee4 c \u65b0\u5efa\u7a97\u53e3 w \u5217\u51fa\u5f53\u524dsession\u4e0b\u6240\u6709\u7684\u7a97\u53e3 , \u91cd\u547d\u540d\u5f53\u524d\u7a97\u53e3\u540d x+y \u5173\u95ed\u5f53\u524d\u7a97\u53e3\uff08\u5148\u6309x\u51fa\u73b0\u786e\u8ba4\u63d0\u793a\uff0c\u518d\u6309y\uff09 % \u5782\u76f4\u5206\u7a97 \u201d \u6c34\u5e73\u5206\u7a97 [\u6570\u5b57\u952e] \u5feb\u901f\u8df3\u5230\u6570\u5b57\u4ee3\u8868\u7684\u7a97\u53e3","title":"\u5728tmux\u4e2d\u4f7f\u7528\u7684\u6307\u4ee4"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/tmux/#session","text":"\u7528\u4e8e\u4fdd\u5b58\u5f53\u524d\u7684session\u914d\u7f6e\uff0c\u4e0b\u6b21\u76f4\u63a5\u6253\u5f00\uff08\u6bd4\u5982\u91cd\u542f\u540e\uff09\uff0c\u975e\u5e38\u723d\u3002 Tmux Plugin Manager\u514b\u9686\u5230\u672c\u5730 git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm \u66f4\u65b0 ~/.tmux.conf # List of plugins set -g @plugin 'tmux-plugins/tpm' set -g @plugin 'tmux-plugins/tmux-sensible' set -g @plugin 'tmux-plugins/tmux-resurrect' # Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf) run '~/.tmux/plugins/tpm/tpm' \u5728Tmux\u91cc\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e tmux source ~/.tmux.conf \u5728Tmux\u4e2d\u4f7f\u7528\u5feb\u6377prefix + I\u5b89\u88c5\u914d\u7f6e \u6fc0\u6d3b\u952e ctrl+s \u4fdd\u5b58\u5f53\u524dsession \u6fc0\u6d3b\u952e ctrl+r reload\u4e0a\u4e00\u6b21\u4fdd\u5b58\u7684session","title":"\u4fdd\u5b58\u548c\u6062\u590d\u5f53\u524dsession"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/","text":"Ubuntu\u5e38\u7528\u8bbe\u7f6e \u7cfb\u7edf \u8bbe\u7f6e\u65f6\u533a tzselect \u6309\u7167\u5411\u5bfc\u9009\u62e9 \u4e9a\u6d32-\u4e2d\u56fd-\u5317\u4eac timedatectl set-timezone \"Asia/Shanghai\" \u6307\u5b9a\u663e\u793a\u65f6\u533a \u66f4\u6362hostname vim /etc/hostname \u78c1\u76d8 \u6302\u8f7d\u65b0\u78c1\u76d8\uff0c\u5f00\u673a\u81ea\u542f fdisk -l \u67e5\u770b\u8bc6\u522b\u5230\u7684\u78c1\u76d8 mkdir /data \u65b0\u5efa\u6302\u8f7d\u7684\u76ee\u6807\u76ee\u5f55 mkfs.ext4 /dev/sdb \u683c\u5f0f\u5316 mount /dev/sdb /data \u6302\u8f7d\u76ee\u5f55 cat /etc/mtab | grep /data >> /etc/fstab \u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d lsblk \u67e5\u770b\u6548\u679c \u5148\u5220\u9664 /etc/fstab \u91cc\u5bf9\u5e94\u8bb0\u5f55\uff0c\u518d\u5378\u8f7d\u76ee\u5f55 umount /data \u7f51\u7edc \u67e5\u8be2\u672c\u5730DNS cat /etc/resolv.conf nslookup www.baidu.com \u7684\u7b2c\u4e00\u884c\u7684server\u7684IP \u67e5\u770bGateway netstat -rn \u4e2d0.0.0.0\u5bf9\u5e94\u7684gateway\u5730\u5740 \u4f7f\u7528\u56fa\u5b9a\u9759\u6001IP ubuntu18\uff0c\u4e0d\u518d\u7ef4\u62a4 /etc/network/interfaces \u91cc\u7684\u56fa\u5b9aIP\uff0c\u800c\u662f\u6539\u6210 /etc/netplan/*.yaml \u7c7b\u4f3c\u540d\u79f0\u7684yaml\u91cc \u4fee\u6539 /etc/netplan/50-cloud-init.yaml # This file is generated from information provided by # the datasource. Changes to it will not persist across an instance. # To disable cloud-init's network configuration capabilities, write a file # /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following: # network: {config: disabled} network: ethernets: ens18: dhcp4: false # \u5173\u95ed\u81ea\u52a8dhcp addresses: [192.168.0.20/23] # \u53c2\u8003 ip a\u4e2d\u5bf9\u5e94\u7f51\u5361\u7684ip\u5730\u5740\u548c\u63a9\u7801 optional: true gateway4: 192.168.0.1 # \u7f51\u5173\u5730\u5740 nameservers: addresses: [8.8.8.8,114.114.114.114] # \u591a\u4e2aDNS\u5730\u5740 version: 2 netplan apply \u914d\u7f6e\u751f\u6548 ping www.baidu.com \u6d4b\u8bd5","title":"Ubuntu\u5e38\u7528\u8bbe\u7f6e"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#ubuntu","text":"","title":"Ubuntu\u5e38\u7528\u8bbe\u7f6e"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#_1","text":"","title":"\u7cfb\u7edf"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#_2","text":"tzselect \u6309\u7167\u5411\u5bfc\u9009\u62e9 \u4e9a\u6d32-\u4e2d\u56fd-\u5317\u4eac timedatectl set-timezone \"Asia/Shanghai\" \u6307\u5b9a\u663e\u793a\u65f6\u533a","title":"\u8bbe\u7f6e\u65f6\u533a"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#hostname","text":"vim /etc/hostname","title":"\u66f4\u6362hostname"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#_3","text":"","title":"\u78c1\u76d8"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#_4","text":"fdisk -l \u67e5\u770b\u8bc6\u522b\u5230\u7684\u78c1\u76d8 mkdir /data \u65b0\u5efa\u6302\u8f7d\u7684\u76ee\u6807\u76ee\u5f55 mkfs.ext4 /dev/sdb \u683c\u5f0f\u5316 mount /dev/sdb /data \u6302\u8f7d\u76ee\u5f55 cat /etc/mtab | grep /data >> /etc/fstab \u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d lsblk \u67e5\u770b\u6548\u679c \u5148\u5220\u9664 /etc/fstab \u91cc\u5bf9\u5e94\u8bb0\u5f55\uff0c\u518d\u5378\u8f7d\u76ee\u5f55 umount /data","title":"\u6302\u8f7d\u65b0\u78c1\u76d8\uff0c\u5f00\u673a\u81ea\u542f"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#_5","text":"","title":"\u7f51\u7edc"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#dns","text":"cat /etc/resolv.conf nslookup www.baidu.com \u7684\u7b2c\u4e00\u884c\u7684server\u7684IP","title":"\u67e5\u8be2\u672c\u5730DNS"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#gateway","text":"netstat -rn \u4e2d0.0.0.0\u5bf9\u5e94\u7684gateway\u5730\u5740","title":"\u67e5\u770bGateway"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/ubuntu/#ip","text":"ubuntu18\uff0c\u4e0d\u518d\u7ef4\u62a4 /etc/network/interfaces \u91cc\u7684\u56fa\u5b9aIP\uff0c\u800c\u662f\u6539\u6210 /etc/netplan/*.yaml \u7c7b\u4f3c\u540d\u79f0\u7684yaml\u91cc \u4fee\u6539 /etc/netplan/50-cloud-init.yaml # This file is generated from information provided by # the datasource. Changes to it will not persist across an instance. # To disable cloud-init's network configuration capabilities, write a file # /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following: # network: {config: disabled} network: ethernets: ens18: dhcp4: false # \u5173\u95ed\u81ea\u52a8dhcp addresses: [192.168.0.20/23] # \u53c2\u8003 ip a\u4e2d\u5bf9\u5e94\u7f51\u5361\u7684ip\u5730\u5740\u548c\u63a9\u7801 optional: true gateway4: 192.168.0.1 # \u7f51\u5173\u5730\u5740 nameservers: addresses: [8.8.8.8,114.114.114.114] # \u591a\u4e2aDNS\u5730\u5740 version: 2 netplan apply \u914d\u7f6e\u751f\u6548 ping www.baidu.com \u6d4b\u8bd5","title":"\u4f7f\u7528\u56fa\u5b9a\u9759\u6001IP"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/vim/","text":"Vim\u7f16\u8f91\u5668 \u5e38\u7528\u65b9\u6cd5 :g/^$/d \u5220\u9664\u7a7a\u884c :g/^\\s*#/d \u5220\u9664\u4ee5 # \u5f00\u5934\u6216 \u7a7a\u683c# \u6216 tab#\u5f00\u5934\u7684\u884c :b# \u8fd4\u56de\u5230\u201c\u5148\u524d\u7f16\u8f91\u7684\u7f13\u51b2\u533a\u201d\uff0c\u6bd4\u5982\u4ece\u6587\u4ef6\u9000\u56de\u5230\u76ee\u5f55","title":"Vim\u7f16\u8f91\u5668 \u5e38\u7528\u65b9\u6cd5"},{"location":"tech_tutorial/linux%E5%B7%A5%E5%85%B7/vim/#vim","text":":g/^$/d \u5220\u9664\u7a7a\u884c :g/^\\s*#/d \u5220\u9664\u4ee5 # \u5f00\u5934\u6216 \u7a7a\u683c# \u6216 tab#\u5f00\u5934\u7684\u884c :b# \u8fd4\u56de\u5230\u201c\u5148\u524d\u7f16\u8f91\u7684\u7f13\u51b2\u533a\u201d\uff0c\u6bd4\u5982\u4ece\u6587\u4ef6\u9000\u56de\u5230\u76ee\u5f55","title":"Vim\u7f16\u8f91\u5668 \u5e38\u7528\u65b9\u6cd5"},{"location":"tech_tutorial/project_manage/wekan/","text":"Wekan \u654f\u6377\u770b\u677f [toc] \u53c2\u8003 GitHub\u5b98\u7f51: https://github.com/wekan/wekan \u5b89\u88c5\uff08docker\u7248\uff09 \u914d\u7f6e \u4fee\u6539 docker-compose-yml ports \u5bf9\u5916\u7aef\u53e3 ROOT_URL \u672c\u5730\u94fe\u63a5\u6839\u8def\u5f84\uff0c\u7528\u4e8e\u5185\u90e8\u9875\u9762\u8f6c\u8df3","title":"Wekan \u654f\u6377\u770b\u677f"},{"location":"tech_tutorial/project_manage/wekan/#wekan","text":"[toc]","title":"Wekan \u654f\u6377\u770b\u677f"},{"location":"tech_tutorial/project_manage/wekan/#_1","text":"GitHub\u5b98\u7f51: https://github.com/wekan/wekan","title":"\u53c2\u8003"},{"location":"tech_tutorial/project_manage/wekan/#docker","text":"","title":"\u5b89\u88c5\uff08docker\u7248\uff09"},{"location":"tech_tutorial/project_manage/wekan/#_2","text":"\u4fee\u6539 docker-compose-yml ports \u5bf9\u5916\u7aef\u53e3 ROOT_URL \u672c\u5730\u94fe\u63a5\u6839\u8def\u5f84\uff0c\u7528\u4e8e\u5185\u90e8\u9875\u9762\u8f6c\u8df3","title":"\u914d\u7f6e"},{"location":"tech_tutorial/py%E5%BA%93/json-logic-py/","text":"json-logic-py \u57fa\u4e8ejson\u7684\u903b\u8f91\u5f15\u64ce \u57fa\u4e8ejson\uff0c\u5c06\u89c4\u5219\u89e3\u6790\u4e3aAST\uff0c\u901a\u8fc7\u81ea\u5df1\u7684\u89e3\u91ca\u5668\uff0c\u53cd\u9988\u6267\u884c\u7ed3\u679c \u7531\u4e8e\u662fjson\uff0c\u6240\u4ee5\u524d\u540e\u7aef\u5bf9\u89c4\u5219\u7684\u89e3\u91ca\u662f\u4e00\u81f4\u7684 \u8fd8\u6709js\u3001php\u548cruby\u7248 \u53c2\u8003 GitHub\u5b98\u7f51 https://github.com/qubitproducts/json-logic-py \u5b89\u88c5 \u5728py3.7\u6d4b\u8bd5\u901a\u8fc7 pip install json-logic-qubit \u4f7f\u7528 from json_logic import jsonLogic # \u6700\u7b80\u5355\u76841=1\u5224\u65ad jsonLogic( { \"==\" : [1, 1] } ) # True # \u81ea\u5b9a\u4e49\u89c4\u5219 rules = { \"and\" : [{\"<\" : [ { \"var\" : \"temp\" }, 110 ]}, {\"==\" : [ { \"var\" : \"pie.filling\" }, \"apple\" ] } ] } # \u83b7\u53d6\u6570\u636e data = { \"temp\" : 100, \"pie\" : { \"filling\" : \"apple\" } } # \u6267\u884c\u89c4\u5219\uff0c\u5f97\u51fa\u7ed3\u679c jsonLogic(rules, data) # True # \u89c4\u5219\u548c\u6570\u636e\u4e00\u8d77\u6765\uff0c\u652f\u6301var\u8bfb\u6570\u7ec4 jsonLogic( {\"var\" : 1 }, [ \"apple\", \"banana\", \"carrot\" ] ) # 'banana'","title":"json-logic-py \u57fa\u4e8ejson\u7684\u903b\u8f91\u5f15\u64ce"},{"location":"tech_tutorial/py%E5%BA%93/json-logic-py/#json-logic-py-json","text":"\u57fa\u4e8ejson\uff0c\u5c06\u89c4\u5219\u89e3\u6790\u4e3aAST\uff0c\u901a\u8fc7\u81ea\u5df1\u7684\u89e3\u91ca\u5668\uff0c\u53cd\u9988\u6267\u884c\u7ed3\u679c \u7531\u4e8e\u662fjson\uff0c\u6240\u4ee5\u524d\u540e\u7aef\u5bf9\u89c4\u5219\u7684\u89e3\u91ca\u662f\u4e00\u81f4\u7684 \u8fd8\u6709js\u3001php\u548cruby\u7248","title":"json-logic-py \u57fa\u4e8ejson\u7684\u903b\u8f91\u5f15\u64ce"},{"location":"tech_tutorial/py%E5%BA%93/json-logic-py/#_1","text":"GitHub\u5b98\u7f51 https://github.com/qubitproducts/json-logic-py","title":"\u53c2\u8003"},{"location":"tech_tutorial/py%E5%BA%93/json-logic-py/#_2","text":"\u5728py3.7\u6d4b\u8bd5\u901a\u8fc7 pip install json-logic-qubit","title":"\u5b89\u88c5"},{"location":"tech_tutorial/py%E5%BA%93/json-logic-py/#_3","text":"from json_logic import jsonLogic # \u6700\u7b80\u5355\u76841=1\u5224\u65ad jsonLogic( { \"==\" : [1, 1] } ) # True # \u81ea\u5b9a\u4e49\u89c4\u5219 rules = { \"and\" : [{\"<\" : [ { \"var\" : \"temp\" }, 110 ]}, {\"==\" : [ { \"var\" : \"pie.filling\" }, \"apple\" ] } ] } # \u83b7\u53d6\u6570\u636e data = { \"temp\" : 100, \"pie\" : { \"filling\" : \"apple\" } } # \u6267\u884c\u89c4\u5219\uff0c\u5f97\u51fa\u7ed3\u679c jsonLogic(rules, data) # True # \u89c4\u5219\u548c\u6570\u636e\u4e00\u8d77\u6765\uff0c\u652f\u6301var\u8bfb\u6570\u7ec4 jsonLogic( {\"var\" : 1 }, [ \"apple\", \"banana\", \"carrot\" ] ) # 'banana'","title":"\u4f7f\u7528"},{"location":"tech_tutorial/py%E5%BA%93/peewee/","text":"Peewee python\u7684ORM\u6846\u67b6 \u5b89\u88c5 pip install peewee \u4f7f\u7528 \u6839\u636e\u5df2\u6709DB\u751f\u6210Model # pwiz\u811a\u672c -e\u6570\u636e\u5e93\u7c7b\u578b -H\u6570\u636e\u5e93\u5730\u5740 -p\u7aef\u53e3 -u\u7528\u6237\u540d -P\u7528\u6237\u5bc6\u7801 -t\u8868\u540d,\u5206\u9694 \u6570\u636e\u5e93\u540d python -m pwiz -e mysql -H 10.0.1.1 -p 3306 -u zmchatgpt -P -t chatgpt_finetune_answer,chatgpt_finetune_code,chatgpt_finetune_question,chatgpt_finetune_uploadfile,chatgpt_qa_history zmchatgpt > model.py","title":"Peewee python\u7684ORM\u6846\u67b6"},{"location":"tech_tutorial/py%E5%BA%93/peewee/#peewee-pythonorm","text":"","title":"Peewee python\u7684ORM\u6846\u67b6"},{"location":"tech_tutorial/py%E5%BA%93/peewee/#_1","text":"pip install peewee","title":"\u5b89\u88c5"},{"location":"tech_tutorial/py%E5%BA%93/peewee/#_2","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/py%E5%BA%93/peewee/#dbmodel","text":"# pwiz\u811a\u672c -e\u6570\u636e\u5e93\u7c7b\u578b -H\u6570\u636e\u5e93\u5730\u5740 -p\u7aef\u53e3 -u\u7528\u6237\u540d -P\u7528\u6237\u5bc6\u7801 -t\u8868\u540d,\u5206\u9694 \u6570\u636e\u5e93\u540d python -m pwiz -e mysql -H 10.0.1.1 -p 3306 -u zmchatgpt -P -t chatgpt_finetune_answer,chatgpt_finetune_code,chatgpt_finetune_question,chatgpt_finetune_uploadfile,chatgpt_qa_history zmchatgpt > model.py","title":"\u6839\u636e\u5df2\u6709DB\u751f\u6210Model"},{"location":"tech_tutorial/py%E5%BA%93/pip/","text":"pip\u4f7f\u7528\u6307\u5357 \u4f7f\u7528\u56fd\u5185\u955c\u50cf\u52a0\u901f pip install -r requirement.txt -i https://pypi.tuna.tsinghua.edu.cn/simple","title":"pip\u4f7f\u7528\u6307\u5357"},{"location":"tech_tutorial/py%E5%BA%93/pip/#pip","text":"","title":"pip\u4f7f\u7528\u6307\u5357"},{"location":"tech_tutorial/py%E5%BA%93/pip/#_1","text":"pip install -r requirement.txt -i https://pypi.tuna.tsinghua.edu.cn/simple","title":"\u4f7f\u7528\u56fd\u5185\u955c\u50cf\u52a0\u901f"},{"location":"tech_tutorial/py%E5%BA%93/spiff_workflow/","text":"SpiffWorkflow \u5de5\u4f5c\u6d41\u5f15\u64ce \u7279\u6027 \u9075\u5faa\u7f16\u5236BPMN\u89c4\u8303 \u63d0\u4f9bPy API \u5f00\u6e90\u6388\u6743\uff1aLGPL-3.0 \u5b89\u88c5 pip install SpiffWorkflow \u5b9a\u4e49\u4e00\u4e2a\u5de5\u4f5c\u6d41 Task\u7684\u72b6\u6001\u6d41\u8f6c MAYBE: Task\u5728\u672a\u6765\u53ef\u80fd\u6267\u884c\uff0c\u53d6\u51b3\u4e8e\u67d0\u4e2aExclusiveChoice Task\u7684\u8f93\u51fa\u7ed3\u679c LIKELY: \u7c7b\u4f3cMAYBE\uff0c\u662fExclusiveChoice Task\u7684\u9ed8\u8ba4\u9009\u62e9 FUTURE: \u8be5Task\u786e\u5b9a\u5728\u67d0\u4e2a\u70b9\u4f1a\u8fd0\u884c\uff08\u9664\u975e\u8be5\u5b9e\u4f8b\u5728Task\u6267\u884c\u524d\uff0c\u88ab\u660e\u786eCANCELLED\u4e86\uff09 WAITING: (\u53ef\u9009\u7684)Task\u5728\u6267\u884c\u4e2d\uff0c\u8fd8\u672a\u5b8c\u6210\uff1b\u5b8c\u6210\u540e\u8f6c\u4e3aREADY READY: \u5f53\u524dTask\u7684\u524d\u63d0\u6761\u4ef6\u5df2\u7ecf\u5168\u90e8\u6ee1\u8db3\uff0c\u51c6\u5907\u6267\u884c COMPLETED: Task\u6267\u884c\u5b8c\u6210 CANCELLED: Task\u88ab\u660e\u786e\u53d6\u6d88 \u5de5\u4f5c\u6d41\u7684\u6570\u636e\u5b58\u50a8 TaskSpec\u5bf9\u8c61 : \u5b58\u6d41\u7a0b\u89c4\u5219\uff0c\u5982\u679c\u53d8\u5316\uff0c\u5219\u5f71\u54cd\u6240\u6709\u6d41\u7a0b\u5b9e\u4f8b Task\u5bf9\u8c61 : \u6d41\u7a0b\u4e2d\u6bcf\u4e2aTask\u8282\u70b9\u7684\u6570\u636e","title":"SpiffWorkflow \u5de5\u4f5c\u6d41\u5f15\u64ce"},{"location":"tech_tutorial/py%E5%BA%93/spiff_workflow/#spiffworkflow","text":"","title":"SpiffWorkflow \u5de5\u4f5c\u6d41\u5f15\u64ce"},{"location":"tech_tutorial/py%E5%BA%93/spiff_workflow/#_1","text":"\u9075\u5faa\u7f16\u5236BPMN\u89c4\u8303 \u63d0\u4f9bPy API \u5f00\u6e90\u6388\u6743\uff1aLGPL-3.0","title":"\u7279\u6027"},{"location":"tech_tutorial/py%E5%BA%93/spiff_workflow/#_2","text":"pip install SpiffWorkflow","title":"\u5b89\u88c5"},{"location":"tech_tutorial/py%E5%BA%93/spiff_workflow/#_3","text":"","title":"\u5b9a\u4e49\u4e00\u4e2a\u5de5\u4f5c\u6d41"},{"location":"tech_tutorial/py%E5%BA%93/spiff_workflow/#task","text":"MAYBE: Task\u5728\u672a\u6765\u53ef\u80fd\u6267\u884c\uff0c\u53d6\u51b3\u4e8e\u67d0\u4e2aExclusiveChoice Task\u7684\u8f93\u51fa\u7ed3\u679c LIKELY: \u7c7b\u4f3cMAYBE\uff0c\u662fExclusiveChoice Task\u7684\u9ed8\u8ba4\u9009\u62e9 FUTURE: \u8be5Task\u786e\u5b9a\u5728\u67d0\u4e2a\u70b9\u4f1a\u8fd0\u884c\uff08\u9664\u975e\u8be5\u5b9e\u4f8b\u5728Task\u6267\u884c\u524d\uff0c\u88ab\u660e\u786eCANCELLED\u4e86\uff09 WAITING: (\u53ef\u9009\u7684)Task\u5728\u6267\u884c\u4e2d\uff0c\u8fd8\u672a\u5b8c\u6210\uff1b\u5b8c\u6210\u540e\u8f6c\u4e3aREADY READY: \u5f53\u524dTask\u7684\u524d\u63d0\u6761\u4ef6\u5df2\u7ecf\u5168\u90e8\u6ee1\u8db3\uff0c\u51c6\u5907\u6267\u884c COMPLETED: Task\u6267\u884c\u5b8c\u6210 CANCELLED: Task\u88ab\u660e\u786e\u53d6\u6d88","title":"Task\u7684\u72b6\u6001\u6d41\u8f6c"},{"location":"tech_tutorial/py%E5%BA%93/spiff_workflow/#_4","text":"TaskSpec\u5bf9\u8c61 : \u5b58\u6d41\u7a0b\u89c4\u5219\uff0c\u5982\u679c\u53d8\u5316\uff0c\u5219\u5f71\u54cd\u6240\u6709\u6d41\u7a0b\u5b9e\u4f8b Task\u5bf9\u8c61 : \u6d41\u7a0b\u4e2d\u6bcf\u4e2aTask\u8282\u70b9\u7684\u6570\u636e","title":"\u5de5\u4f5c\u6d41\u7684\u6570\u636e\u5b58\u50a8"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/bottle_rest/","text":"Bottle Rest Web\u811a\u624b\u67b6 \u642d\u5efa\u987a\u5e8f # \u51c6\u5907env virtualenv ENV source ENV/bin/activate # \u5b89\u88c5\u4f9d\u8d56 pip install cookiecutter # \u6784\u5efaweb\u6846\u67b6\u6a21\u677f\uff0c\u4ea4\u4e92\u4e00\u4e9b\u95ee\u9898\uff0c\u4ee5webapi\u9879\u76ee\u4e3a\u4f8b cookiecutter https://github.com/avelino/cookiecutter-bottle.git cd webapi pip install -r requirements.txt # \u8fd0\u884c\u65b9\u5f0f\uff1apython manage.py runserver [--port 9000] # \u53ef\u9009\uff0c\u90e8\u7f72swagger ui # https://github.com/swagger-api/swagger-ui/tree/master/dist \u5230webapi\u76ee\u5f55\u4e0b open https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/swagger-api/swagger-ui/tree/master/dist unzip dist.zip -d webapi/ # \u5c06\u751f\u6210\u7684swagger.json\u653e\u5165\u8be5\u76ee\u5f55\uff0c\u4fee\u6539index.html\u4e2d\u7684SwaggerUIBundle.url\u4e3a\u76f8\u5bf9\u8def\u5f84\"./swagger.json\" \u6dfb\u52a0log\u8f93\u51fa # settings.py\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u65b9\u6cd5 import logging import logging.handlers from functools import wraps from bottle import * ################### # log\u914d\u7f6e ################### logger = logging.getLogger('app') logger.setLevel(logging.INFO) LOG_PATH = PROJECT_PATH + '/../log/' if not os.path.exists(LOG_PATH): os.mkdir(LOG_PATH) LOG_FILE = LOG_PATH + 'app.log' file_handler = logging.handlers.RotatingFileHandler( LOG_FILE, maxBytes=50*1024*1024, backupCount=10) formatter = logging.Formatter('%(msg)s') file_handler.setLevel(logging.DEBUG) file_handler.setFormatter(formatter) logger.addHandler(file_handler) def log_to_logger(fn): ''' Wrap a Bottle request so that a log line is emitted after it's handled. (This decorator can be extended to take the desired logger as a param.) ''' @wraps(fn) def _log_to_logger(*args, **kwargs): request_time = datetime.now() actual_response = fn(*args, **kwargs) # modify this to log exactly what you need: logger.info('%s %s %s %s %s' % (request.remote_addr, request_time, request.method, request.url, response.status)) return actual_response return _log_to_logger # \u5728\u9700\u8981\u52a0\u8f7dlog\u7684controller\u4e2d\u52a0\u4ee5\u4e0bcode from ..settings import * # \u52a0\u8f7dlog home_app.install(log_to_logger) # \u8bbe\u5b9aresponse\u53cd\u9988json response.content_type = 'application/json' \u591acontroller\u7684\u8def\u7531\u52a0\u8f7d # \u5728controllers\u4e0b\u65b0\u5efapy\uff0c\u5b9a\u4e49bottle\u7684app from bottle import Bottle ################### # \u521d\u59cb\u5316app ################### collector_app = Bottle() @collector_app.route('/execute') def execute(): '''\u6267\u884c\u4e00\u6b21\u91c7\u96c6''' return dict(health=True) # \u5728routes.py\u4e2d\u7ed1\u5b9a\u5bf9\u5e94\u7684\u4e8c\u7ea7\u76ee\u5f55\uff0c\u5982\uff1ahttp://0.0.0.0:8000/collector/execute from .controllers.collector import collector_app # Routes = Bottle()\u7684\u540e\u9762 Routes.mount('/collector', collector_app)","title":"Bottle Rest Web\u811a\u624b\u67b6"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/bottle_rest/#bottle-rest-web","text":"","title":"Bottle Rest Web\u811a\u624b\u67b6"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/bottle_rest/#_1","text":"# \u51c6\u5907env virtualenv ENV source ENV/bin/activate # \u5b89\u88c5\u4f9d\u8d56 pip install cookiecutter # \u6784\u5efaweb\u6846\u67b6\u6a21\u677f\uff0c\u4ea4\u4e92\u4e00\u4e9b\u95ee\u9898\uff0c\u4ee5webapi\u9879\u76ee\u4e3a\u4f8b cookiecutter https://github.com/avelino/cookiecutter-bottle.git cd webapi pip install -r requirements.txt # \u8fd0\u884c\u65b9\u5f0f\uff1apython manage.py runserver [--port 9000] # \u53ef\u9009\uff0c\u90e8\u7f72swagger ui # https://github.com/swagger-api/swagger-ui/tree/master/dist \u5230webapi\u76ee\u5f55\u4e0b open https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/swagger-api/swagger-ui/tree/master/dist unzip dist.zip -d webapi/ # \u5c06\u751f\u6210\u7684swagger.json\u653e\u5165\u8be5\u76ee\u5f55\uff0c\u4fee\u6539index.html\u4e2d\u7684SwaggerUIBundle.url\u4e3a\u76f8\u5bf9\u8def\u5f84\"./swagger.json\"","title":"\u642d\u5efa\u987a\u5e8f"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/bottle_rest/#log","text":"# settings.py\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u65b9\u6cd5 import logging import logging.handlers from functools import wraps from bottle import * ################### # log\u914d\u7f6e ################### logger = logging.getLogger('app') logger.setLevel(logging.INFO) LOG_PATH = PROJECT_PATH + '/../log/' if not os.path.exists(LOG_PATH): os.mkdir(LOG_PATH) LOG_FILE = LOG_PATH + 'app.log' file_handler = logging.handlers.RotatingFileHandler( LOG_FILE, maxBytes=50*1024*1024, backupCount=10) formatter = logging.Formatter('%(msg)s') file_handler.setLevel(logging.DEBUG) file_handler.setFormatter(formatter) logger.addHandler(file_handler) def log_to_logger(fn): ''' Wrap a Bottle request so that a log line is emitted after it's handled. (This decorator can be extended to take the desired logger as a param.) ''' @wraps(fn) def _log_to_logger(*args, **kwargs): request_time = datetime.now() actual_response = fn(*args, **kwargs) # modify this to log exactly what you need: logger.info('%s %s %s %s %s' % (request.remote_addr, request_time, request.method, request.url, response.status)) return actual_response return _log_to_logger # \u5728\u9700\u8981\u52a0\u8f7dlog\u7684controller\u4e2d\u52a0\u4ee5\u4e0bcode from ..settings import * # \u52a0\u8f7dlog home_app.install(log_to_logger) # \u8bbe\u5b9aresponse\u53cd\u9988json response.content_type = 'application/json'","title":"\u6dfb\u52a0log\u8f93\u51fa"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/bottle_rest/#controller","text":"# \u5728controllers\u4e0b\u65b0\u5efapy\uff0c\u5b9a\u4e49bottle\u7684app from bottle import Bottle ################### # \u521d\u59cb\u5316app ################### collector_app = Bottle() @collector_app.route('/execute') def execute(): '''\u6267\u884c\u4e00\u6b21\u91c7\u96c6''' return dict(health=True) # \u5728routes.py\u4e2d\u7ed1\u5b9a\u5bf9\u5e94\u7684\u4e8c\u7ea7\u76ee\u5f55\uff0c\u5982\uff1ahttp://0.0.0.0:8000/collector/execute from .controllers.collector import collector_app # Routes = Bottle()\u7684\u540e\u9762 Routes.mount('/collector', collector_app)","title":"\u591acontroller\u7684\u8def\u7531\u52a0\u8f7d"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/flask_rest/","text":"Flask Restful Web\u5fae\u670d\u52a1 \u529f\u80fd \u5fae\u578bWeb\u6846\u67b6 \u652f\u6301Restful API\uff0c\u7c7bSwagger \u5b89\u88c5 # pip\u5b89\u88c5 pip install Flask flask-restplus \u53c2\u8003 Flask\u5b98\u7f51 http://flask.pocoo.org/ Flask\u4e2d\u6587\u6559\u7a0b http://docs.jinkan.org/docs/flask/ Flask-RESTPlus https://flask-restplus.readthedocs.io/","title":"Flask Restful Web\u5fae\u670d\u52a1"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/flask_rest/#flask-restful-web","text":"","title":"Flask Restful Web\u5fae\u670d\u52a1"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/flask_rest/#_1","text":"\u5fae\u578bWeb\u6846\u67b6 \u652f\u6301Restful API\uff0c\u7c7bSwagger","title":"\u529f\u80fd"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/flask_rest/#_2","text":"# pip\u5b89\u88c5 pip install Flask flask-restplus","title":"\u5b89\u88c5"},{"location":"tech_tutorial/web%E8%84%9A%E6%89%8B%E6%9E%B6/flask_rest/#_3","text":"Flask\u5b98\u7f51 http://flask.pocoo.org/ Flask\u4e2d\u6587\u6559\u7a0b http://docs.jinkan.org/docs/flask/ Flask-RESTPlus https://flask-restplus.readthedocs.io/","title":"\u53c2\u8003"},{"location":"tech_tutorial/workflow/activiti/","text":"Activiti \u57fa\u4e8e\u539f\u751fActiviti 6 \u7684Rest API\u670d\u52a1 \u53c2\u8003 \u4e2d\u6587\u7528\u6237\u624b\u518c v5 https://tkjohn.github.io/activiti-userguide/ \u5b89\u88c5 MySQL 5.7 \u7528\u4e8e\u5b58\u50a8\u6570\u636e\u7684db docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -p 3306:3306 -d mysql:5.7 \u7528\u6237: root \u5bc6\u7801: my-secret-pw \u8bbf\u95ee\u7aef\u53e3: 3306 \u65b0\u5efadatabase: workflow, utf8\u7f16\u7801 Tomcat 7 \u8fd0\u884cActiviti\u7684web\u5bb9\u5668 \u53c2\u8003Dockerfile: FROM tomcat:7 # \u66b4\u9732weapps VOLUME [ \"/usr/local/tomcat/webapps\" ] EXPOSE 8080 CMD [\"catalina.sh\", \"run\"] docker run --name=tomcat7 --volume=$(pwd)/webapps:/usr/local/tomcat/webapps -p 8080:8080 -d tomcat7-jdk8:latest Activiti 6 \u5b98\u7f51\u4e0b\u8f7d\u5730\u5740 \u590d\u5236 activiti-6.0.0/wars/{activiti-app.war, activiti-rest.war} \u8fdb\u6302\u8f7d\u7684webapps\u76ee\u5f55 \u4fee\u6539\u89e3\u538b\u540e\u7684 activiti-app/WEB-INF/classes/META-INF/activiti-app/activiti-app.properties \u4fee\u6539\u6570\u636e\u5e93\u4e3aMySQL\uff0c\u6307\u5b9a\u65b9\u8a00\uff0c\u8fde\u63a5\u5730\u5740\uff08\u4e4b\u524d\u914d\u7f6e\u7684db\uff09,\u5982 \u7c7b\u4f3c\uff0cRest API\u670d\u52a1\u6539 activiti-rest/WEB-INF/classes/db.properties \uff0c\u5982 Rest API\u670d\u52a1\u9700\u8981\u5c06MySQL\u9a71\u52a8(mysql-connector-java-*.jar)\u52a0\u5165 activiti-rest/WEB-INF/lib 2\u8005\u6307\u5411\u540c\u4e00\u4e2adb\uff0c\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4 \u4f7f\u7528 \u65b0\u5efa\u5de5\u4f5c\u6d41\u7684\u6b65\u9aa4 \u4ee5\u672c\u5730\u542f\u52a8\u7684 http://localhost:8080/activiti-app/ \u4e3a\u4f8b: \u5728 Kickstart App-Processes \u91cc Create Process \u5b9a\u4e49Process Model\u7684name\u548ckey \u753b\u5e03\u4e0a\u62d6\u62fd\u5143\u7d20\uff08\u542f\u505c\u4e8b\u4ef6\u3001Task\u3001Gateway\u7b49\uff09\uff0c\u5efa\u7acb\u5173\u8054\u7ebf\u6761 \u6bcf\u4e2a\u5143\u7d20\u586b\u5199\u5c5e\u6027Id\u548cName\u7b49 UserTask\u8bbe\u7f6e\u8ba4\u9886\u89d2\u8272Assignment Task\u8bbe\u7f6e\u7ed1\u5b9a\u7684\u8868\u5355Referenced form \u4fdd\u5b58 \u5728 Kickstart App-Apps \u91cc Create App \u5b9a\u4e49App\u7684name\u548ckey \u9009\u62e9App\u4e0b\u5c5e\u7684Models \u4fdd\u5b58 \u53d1\u5e03App==\u53d1\u5e03\u5de5\u4f5c\u6d41 \u70b9\u8fdb\u4e4b\u524d\u5b9a\u4e49\u7684App \u9009\u62e9 Publish \u8c03\u7528\u5de5\u4f5c\u6d41\u5b9e\u4f8b \u5728 Task App-Processes \u91cc Start a process \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ece\u9996\u9875\u70b9\u51fb\u76f8\u5173App\u76f4\u63a5\u8fdb\u5165\uff0c\u9009\u62e9Processes Tab\u5f00\u59cb\u65b0\u6d41\u7a0b\uff0c\u4f8b\u5982: http://localhost:8080/activiti-app/workflow/#/apps/{\u53d1\u5e03\u7684App}/processes \u70b9 Show diagram \u67e5\u770b\u5f53\u524d\u5de5\u4f5c\u6d41\u7684\u6267\u884c\u72b6\u6001\u56fe Rest API \u901a\u7528\u8bf4\u660e \u8bbf\u95ee\u8ba4\u8bc1 \u6240\u6709\u7684HTTP API\u7684\u8bbf\u95ee\u90fd\u9700\u8981\u5b89\u5168\u8ba4\u8bc1 \u9ed8\u8ba4\u4f7f\u7528 HTTP Basic Auth\u65b9\u6848 \u65b9\u68481: \u5e26(\u7528\u6237\u540d:\u5bc6\u7801)\u8bbf\u95ee\uff0c\u56e0\u4e3a\u660e\u6587\uff0c\u4e0d\u63a8\u8350\uff0c\u4e3e\u4f8b: http://admin:test@localhost:8080/activiti-rest/service/repository/deployments (\u6d41\u7a0b\u5b9a\u4e49\u4e00\u89c8) \u65b9\u68482: \u4f7f\u7528Header: Authorization\uff0c\u4e3e\u4f8b: bash curl -X GET \\ http://localhost:8080/activiti-rest/service/repository/deployments \\ -H 'Authorization: Basic YWRtaW46dGVzdA==' \\ # YWRtaW46dGVzdA== \u662fBase64(admin:test) -H 'cache-control: no-cache' Swagger\u63a5\u53e3\u6587\u6863\u5730\u5740\uff0c\u4ee5\u672c\u5730\u670d\u52a1\u4e3a\u4f8b: http://localhost:8080/activiti-rest/docs/ Rest HTTP API\u7684Base URL: http://localhost:8080/activiti-rest/service/ \u5e38\u7528\u65b9\u6cd5 \u5de5\u4f5c\u6d41 \u6309\u6d41\u7a0b\u540d\u68c0\u7d22: GET repository/deployments?name={\u7cbe\u786e\u6d41\u7a0b\u540d} \u53d1\u5e03\u65b0\u6d41\u7a0b: ```bash curl -X POST \\ http://localhost:8080/activiti-rest/service/repository/deployments \\ -H 'Authorization: Basic YWRtaW46dGVzdA==' \\ # \u6309\u5b9e\u9645\u7528\u6237\u5bc6\u7801\u52a0\u5bc6 -H 'cache-control: no-cache' \\ -H 'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW' \\ -F demo.bpmn20.xml=@/Users/jeff.chen/Downloads/Process_demo.bpmn20-v2.xml # demo.bpmn20.xml\u662f\u6d41\u7a0b\u540d\uff0c=\u540e\u8ddf\u7528\u6237\u672c\u5730bpmn\u5b9a\u4e49 # \u53ea\u63a5\u6536.bpmn20.xml, .bpmn, .bar or .zip\u540e\u7f00 ``` \u83b7\u53d6\u5de5\u4f5c\u6d41\u5b9a\u4e49\u4e00\u89c8: GET repository/process-definitions \u6fc0\u6d3b\u6307\u5b9a\u5de5\u4f5c\u6d41: PUT repository/process-definitions/{processDefinitionId} \u6d41\u7a0b\u8fd0\u884c\u5b9e\u4f8b \u5f53\u524d\u8fd0\u884c\u7684\u6d41\u7a0b\u8fd0\u884c\u5b9e\u4f8b\u4e00\u89c8: GET /runtime/process-instances \u901a\u8fc7\u6d41\u7a0bkey\uff0c\uff08bpmn\u6587\u4ef6\u4e2d\u7684process.id\uff09\uff0c\u542f\u52a8\u65b0\u6d41\u7a0b\u5b9e\u4f8b\uff0c : ```bash curl -X POST \\ http://localhost:8080/activiti-rest/service/runtime/process-instances \\ -H 'Authorization: Basic YWRtaW46dGVzdA==' \\ -H 'Content-Type: application/json' \\ -H 'cache-control: no-cache' \\ -d '{ \"processDefinitionKey\":\"Process_one_step_demo_id\" }' # \u83b7\u53d6\u8fd4\u56dejson\uff0c\u5176\u4e2d\u6709\u540e\u7eedTask\u9700\u8981\u7684\u4fe1\u606f { \"id\": \"7532\", # \u6838\u5fc3\u53c2\u6570\uff0c\u5f53\u524d\u6d41\u7a0b\u5b9e\u4f8bid \"url\": \"http://localhost:8080/activiti-rest/service/runtime/process-instances/7532\", \"businessKey\": null, \"suspended\": false, \"ended\": false, \"processDefinitionId\": \"Process_one_step_demo_id:1:5045\", \"processDefinitionUrl\": \"http://localhost:8080/activiti-rest/service/repository/process-definitions/Process_one_step_demo_id:1:5045\", \"processDefinitionKey\": \"Process_one_step_demo_id\", \"activityId\": null, \"variables\": [], \"tenantId\": \"\", \"name\": null, \"completed\": false } ``` \u83b7\u53d6\u6307\u5b9a\u6d41\u7a0bid\u7684\u6d41\u8f6c\u72b6\u6001\u56fe: GET runtime/process-instances/7532/diagram \u7ea2\u6846\u4ee3\u8868\u6d41\u7a0b\u6267\u884c\u5230\u7684Task \u4efb\u52a1 \u83b7\u53d6\u6307\u5b9a\u6d41\u7a0b\u5b9e\u4f8b\u4e0b\u5f85\u5904\u7406\u4efb\u52a1\u5217\u8868: GET runtime/tasks?processInstanceId=7532 \uff0c\u53cd\u9988json\u5982\u4e0b: js { \"data\": [ { \"id\": \"7539\", // \u6838\u5fc3\u53c2\u6570\uff0c\u5f85\u5904\u7406\u7684Task.id \"url\": \"http://localhost:8080/activiti-rest/service/runtime/tasks/7539\", \"owner\": null, \"assignee\": \"admin\", \"delegationState\": null, \"name\": \"Write monthly financial report\", \"description\": \"Write monthly financial report for publication to shareholders.\", \"createTime\": \"2019-08-09T09:01:55.610Z\", \"dueDate\": null, \"priority\": 50, \"suspended\": false, \"taskDefinitionKey\": \"writeReportTask\", \"tenantId\": \"\", \"category\": null, \"formKey\": \"UserInputMessage\", \"parentTaskId\": null, \"parentTaskUrl\": null, \"executionId\": \"7536\", \"executionUrl\": \"http://localhost:8080/activiti-rest/service/runtime/executions/7536\", \"processInstanceId\": \"7532\", \"processInstanceUrl\": \"http://localhost:8080/activiti-rest/service/runtime/process-instances/7532\", \"processDefinitionId\": \"Process_one_step_demo_id:1:5045\", \"processDefinitionUrl\": \"http://localhost:8080/activiti-rest/service/repository/process-definitions/Process_one_step_demo_id:1:5045\", \"variables\": [] } ], \"total\": 1, \"start\": 0, \"sort\": \"id\", \"order\": \"asc\", \"size\": 1 } \u5b8c\u6210\u6307\u5b9a\u4efb\u52a1: ```bash curl -X POST \\ http://localhost:8080/activiti-rest/service/runtime/tasks/7539 \\ -H 'Authorization: Basic YWRtaW46dGVzdA==' \\ -H 'Content-Type: application/json' \\ -H 'cache-control: no-cache' \\ -d '{ \"action\": \"complete\", # \u6267\u884c\u4efb\u52a1\u7684\u884c\u4e3a\u201d\u5b8c\u6210\u201c\uff0c\u53ef\u6709\u5176\u4ed6Action\u7c7b\u578b\uff0c\u8be6\u60c5\u770b\u5b98\u65b9\u6587\u6863 \"variables\": [{ # \u9700\u8981\u586b\u5199\u7684\u8868\u5355\u53c2\u6570 \"name\": \"message\", # \u8868\u5355input\u5143\u7d20\u7684id\uff0c\u53c2\u8003\u4e0b\u56fe \"value\": \"This is a User Input Message\" # \u5728input\u4e2d\u7684\u586b\u5199 }] }' \u5982\u679c\u53cd\u9988HTTP\u72b6\u6001\u7801\u4e3a200\uff0c\u8868\u793a\u66f4\u65b0\u6210\u529f ``` \u5f15\u7528\u7684input\u5143\u7d20\u5bf9\u5e94","title":"Activiti"},{"location":"tech_tutorial/workflow/activiti/#activiti","text":"\u57fa\u4e8e\u539f\u751fActiviti 6 \u7684Rest API\u670d\u52a1","title":"Activiti"},{"location":"tech_tutorial/workflow/activiti/#_1","text":"\u4e2d\u6587\u7528\u6237\u624b\u518c v5 https://tkjohn.github.io/activiti-userguide/","title":"\u53c2\u8003"},{"location":"tech_tutorial/workflow/activiti/#_2","text":"","title":"\u5b89\u88c5"},{"location":"tech_tutorial/workflow/activiti/#mysql-57","text":"\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u7684db docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -p 3306:3306 -d mysql:5.7 \u7528\u6237: root \u5bc6\u7801: my-secret-pw \u8bbf\u95ee\u7aef\u53e3: 3306 \u65b0\u5efadatabase: workflow, utf8\u7f16\u7801","title":"MySQL 5.7"},{"location":"tech_tutorial/workflow/activiti/#tomcat-7","text":"\u8fd0\u884cActiviti\u7684web\u5bb9\u5668 \u53c2\u8003Dockerfile: FROM tomcat:7 # \u66b4\u9732weapps VOLUME [ \"/usr/local/tomcat/webapps\" ] EXPOSE 8080 CMD [\"catalina.sh\", \"run\"] docker run --name=tomcat7 --volume=$(pwd)/webapps:/usr/local/tomcat/webapps -p 8080:8080 -d tomcat7-jdk8:latest","title":"Tomcat 7"},{"location":"tech_tutorial/workflow/activiti/#activiti-6","text":"\u5b98\u7f51\u4e0b\u8f7d\u5730\u5740 \u590d\u5236 activiti-6.0.0/wars/{activiti-app.war, activiti-rest.war} \u8fdb\u6302\u8f7d\u7684webapps\u76ee\u5f55 \u4fee\u6539\u89e3\u538b\u540e\u7684 activiti-app/WEB-INF/classes/META-INF/activiti-app/activiti-app.properties \u4fee\u6539\u6570\u636e\u5e93\u4e3aMySQL\uff0c\u6307\u5b9a\u65b9\u8a00\uff0c\u8fde\u63a5\u5730\u5740\uff08\u4e4b\u524d\u914d\u7f6e\u7684db\uff09,\u5982 \u7c7b\u4f3c\uff0cRest API\u670d\u52a1\u6539 activiti-rest/WEB-INF/classes/db.properties \uff0c\u5982 Rest API\u670d\u52a1\u9700\u8981\u5c06MySQL\u9a71\u52a8(mysql-connector-java-*.jar)\u52a0\u5165 activiti-rest/WEB-INF/lib 2\u8005\u6307\u5411\u540c\u4e00\u4e2adb\uff0c\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4","title":"Activiti 6"},{"location":"tech_tutorial/workflow/activiti/#_3","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/workflow/activiti/#_4","text":"\u4ee5\u672c\u5730\u542f\u52a8\u7684 http://localhost:8080/activiti-app/ \u4e3a\u4f8b: \u5728 Kickstart App-Processes \u91cc Create Process \u5b9a\u4e49Process Model\u7684name\u548ckey \u753b\u5e03\u4e0a\u62d6\u62fd\u5143\u7d20\uff08\u542f\u505c\u4e8b\u4ef6\u3001Task\u3001Gateway\u7b49\uff09\uff0c\u5efa\u7acb\u5173\u8054\u7ebf\u6761 \u6bcf\u4e2a\u5143\u7d20\u586b\u5199\u5c5e\u6027Id\u548cName\u7b49 UserTask\u8bbe\u7f6e\u8ba4\u9886\u89d2\u8272Assignment Task\u8bbe\u7f6e\u7ed1\u5b9a\u7684\u8868\u5355Referenced form \u4fdd\u5b58 \u5728 Kickstart App-Apps \u91cc Create App \u5b9a\u4e49App\u7684name\u548ckey \u9009\u62e9App\u4e0b\u5c5e\u7684Models \u4fdd\u5b58 \u53d1\u5e03App==\u53d1\u5e03\u5de5\u4f5c\u6d41 \u70b9\u8fdb\u4e4b\u524d\u5b9a\u4e49\u7684App \u9009\u62e9 Publish","title":"\u65b0\u5efa\u5de5\u4f5c\u6d41\u7684\u6b65\u9aa4"},{"location":"tech_tutorial/workflow/activiti/#_5","text":"\u5728 Task App-Processes \u91cc Start a process \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ece\u9996\u9875\u70b9\u51fb\u76f8\u5173App\u76f4\u63a5\u8fdb\u5165\uff0c\u9009\u62e9Processes Tab\u5f00\u59cb\u65b0\u6d41\u7a0b\uff0c\u4f8b\u5982: http://localhost:8080/activiti-app/workflow/#/apps/{\u53d1\u5e03\u7684App}/processes \u70b9 Show diagram \u67e5\u770b\u5f53\u524d\u5de5\u4f5c\u6d41\u7684\u6267\u884c\u72b6\u6001\u56fe","title":"\u8c03\u7528\u5de5\u4f5c\u6d41\u5b9e\u4f8b"},{"location":"tech_tutorial/workflow/activiti/#rest-api","text":"","title":"Rest API"},{"location":"tech_tutorial/workflow/activiti/#_6","text":"","title":"\u901a\u7528\u8bf4\u660e"},{"location":"tech_tutorial/workflow/activiti/#_7","text":"\u6240\u6709\u7684HTTP API\u7684\u8bbf\u95ee\u90fd\u9700\u8981\u5b89\u5168\u8ba4\u8bc1 \u9ed8\u8ba4\u4f7f\u7528 HTTP Basic Auth\u65b9\u6848 \u65b9\u68481: \u5e26(\u7528\u6237\u540d:\u5bc6\u7801)\u8bbf\u95ee\uff0c\u56e0\u4e3a\u660e\u6587\uff0c\u4e0d\u63a8\u8350\uff0c\u4e3e\u4f8b: http://admin:test@localhost:8080/activiti-rest/service/repository/deployments (\u6d41\u7a0b\u5b9a\u4e49\u4e00\u89c8) \u65b9\u68482: \u4f7f\u7528Header: Authorization\uff0c\u4e3e\u4f8b: bash curl -X GET \\ http://localhost:8080/activiti-rest/service/repository/deployments \\ -H 'Authorization: Basic YWRtaW46dGVzdA==' \\ # YWRtaW46dGVzdA== \u662fBase64(admin:test) -H 'cache-control: no-cache' Swagger\u63a5\u53e3\u6587\u6863\u5730\u5740\uff0c\u4ee5\u672c\u5730\u670d\u52a1\u4e3a\u4f8b: http://localhost:8080/activiti-rest/docs/ Rest HTTP API\u7684Base URL: http://localhost:8080/activiti-rest/service/","title":"\u8bbf\u95ee\u8ba4\u8bc1"},{"location":"tech_tutorial/workflow/activiti/#_8","text":"\u5de5\u4f5c\u6d41 \u6309\u6d41\u7a0b\u540d\u68c0\u7d22: GET repository/deployments?name={\u7cbe\u786e\u6d41\u7a0b\u540d} \u53d1\u5e03\u65b0\u6d41\u7a0b: ```bash curl -X POST \\ http://localhost:8080/activiti-rest/service/repository/deployments \\ -H 'Authorization: Basic YWRtaW46dGVzdA==' \\ # \u6309\u5b9e\u9645\u7528\u6237\u5bc6\u7801\u52a0\u5bc6 -H 'cache-control: no-cache' \\ -H 'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW' \\ -F demo.bpmn20.xml=@/Users/jeff.chen/Downloads/Process_demo.bpmn20-v2.xml # demo.bpmn20.xml\u662f\u6d41\u7a0b\u540d\uff0c=\u540e\u8ddf\u7528\u6237\u672c\u5730bpmn\u5b9a\u4e49 # \u53ea\u63a5\u6536.bpmn20.xml, .bpmn, .bar or .zip\u540e\u7f00 ``` \u83b7\u53d6\u5de5\u4f5c\u6d41\u5b9a\u4e49\u4e00\u89c8: GET repository/process-definitions \u6fc0\u6d3b\u6307\u5b9a\u5de5\u4f5c\u6d41: PUT repository/process-definitions/{processDefinitionId} \u6d41\u7a0b\u8fd0\u884c\u5b9e\u4f8b \u5f53\u524d\u8fd0\u884c\u7684\u6d41\u7a0b\u8fd0\u884c\u5b9e\u4f8b\u4e00\u89c8: GET /runtime/process-instances \u901a\u8fc7\u6d41\u7a0bkey\uff0c\uff08bpmn\u6587\u4ef6\u4e2d\u7684process.id\uff09\uff0c\u542f\u52a8\u65b0\u6d41\u7a0b\u5b9e\u4f8b\uff0c : ```bash curl -X POST \\ http://localhost:8080/activiti-rest/service/runtime/process-instances \\ -H 'Authorization: Basic YWRtaW46dGVzdA==' \\ -H 'Content-Type: application/json' \\ -H 'cache-control: no-cache' \\ -d '{ \"processDefinitionKey\":\"Process_one_step_demo_id\" }' # \u83b7\u53d6\u8fd4\u56dejson\uff0c\u5176\u4e2d\u6709\u540e\u7eedTask\u9700\u8981\u7684\u4fe1\u606f { \"id\": \"7532\", # \u6838\u5fc3\u53c2\u6570\uff0c\u5f53\u524d\u6d41\u7a0b\u5b9e\u4f8bid \"url\": \"http://localhost:8080/activiti-rest/service/runtime/process-instances/7532\", \"businessKey\": null, \"suspended\": false, \"ended\": false, \"processDefinitionId\": \"Process_one_step_demo_id:1:5045\", \"processDefinitionUrl\": \"http://localhost:8080/activiti-rest/service/repository/process-definitions/Process_one_step_demo_id:1:5045\", \"processDefinitionKey\": \"Process_one_step_demo_id\", \"activityId\": null, \"variables\": [], \"tenantId\": \"\", \"name\": null, \"completed\": false } ``` \u83b7\u53d6\u6307\u5b9a\u6d41\u7a0bid\u7684\u6d41\u8f6c\u72b6\u6001\u56fe: GET runtime/process-instances/7532/diagram \u7ea2\u6846\u4ee3\u8868\u6d41\u7a0b\u6267\u884c\u5230\u7684Task \u4efb\u52a1 \u83b7\u53d6\u6307\u5b9a\u6d41\u7a0b\u5b9e\u4f8b\u4e0b\u5f85\u5904\u7406\u4efb\u52a1\u5217\u8868: GET runtime/tasks?processInstanceId=7532 \uff0c\u53cd\u9988json\u5982\u4e0b: js { \"data\": [ { \"id\": \"7539\", // \u6838\u5fc3\u53c2\u6570\uff0c\u5f85\u5904\u7406\u7684Task.id \"url\": \"http://localhost:8080/activiti-rest/service/runtime/tasks/7539\", \"owner\": null, \"assignee\": \"admin\", \"delegationState\": null, \"name\": \"Write monthly financial report\", \"description\": \"Write monthly financial report for publication to shareholders.\", \"createTime\": \"2019-08-09T09:01:55.610Z\", \"dueDate\": null, \"priority\": 50, \"suspended\": false, \"taskDefinitionKey\": \"writeReportTask\", \"tenantId\": \"\", \"category\": null, \"formKey\": \"UserInputMessage\", \"parentTaskId\": null, \"parentTaskUrl\": null, \"executionId\": \"7536\", \"executionUrl\": \"http://localhost:8080/activiti-rest/service/runtime/executions/7536\", \"processInstanceId\": \"7532\", \"processInstanceUrl\": \"http://localhost:8080/activiti-rest/service/runtime/process-instances/7532\", \"processDefinitionId\": \"Process_one_step_demo_id:1:5045\", \"processDefinitionUrl\": \"http://localhost:8080/activiti-rest/service/repository/process-definitions/Process_one_step_demo_id:1:5045\", \"variables\": [] } ], \"total\": 1, \"start\": 0, \"sort\": \"id\", \"order\": \"asc\", \"size\": 1 } \u5b8c\u6210\u6307\u5b9a\u4efb\u52a1: ```bash curl -X POST \\ http://localhost:8080/activiti-rest/service/runtime/tasks/7539 \\ -H 'Authorization: Basic YWRtaW46dGVzdA==' \\ -H 'Content-Type: application/json' \\ -H 'cache-control: no-cache' \\ -d '{ \"action\": \"complete\", # \u6267\u884c\u4efb\u52a1\u7684\u884c\u4e3a\u201d\u5b8c\u6210\u201c\uff0c\u53ef\u6709\u5176\u4ed6Action\u7c7b\u578b\uff0c\u8be6\u60c5\u770b\u5b98\u65b9\u6587\u6863 \"variables\": [{ # \u9700\u8981\u586b\u5199\u7684\u8868\u5355\u53c2\u6570 \"name\": \"message\", # \u8868\u5355input\u5143\u7d20\u7684id\uff0c\u53c2\u8003\u4e0b\u56fe \"value\": \"This is a User Input Message\" # \u5728input\u4e2d\u7684\u586b\u5199 }] }'","title":"\u5e38\u7528\u65b9\u6cd5"},{"location":"tech_tutorial/workflow/activiti/#http200","text":"``` \u5f15\u7528\u7684input\u5143\u7d20\u5bf9\u5e94","title":"\u5982\u679c\u53cd\u9988HTTP\u72b6\u6001\u7801\u4e3a200\uff0c\u8868\u793a\u66f4\u65b0\u6210\u529f"},{"location":"tech_tutorial/workflow/bpmn/","text":"BPMN 2.0 \u7b80\u4ecb \u4e1a\u52a1\u6d41\u7a0b\u6a21\u578b\u548c\u6807\u8bb0\u6cd5\uff08Business Process Model and Notation\uff09\u662f\u4e00\u5957\u56fe\u5f62\u5316\u8868\u793a\u6cd5\uff0c\u7528\u4e8e\u4ee5\u4e1a\u52a1\u6d41\u7a0b\u6a21\u578b\u8be6\u7ec6\u8bf4\u660e\u5404\u79cd\u4e1a\u52a1\u6d41\u7a0b\uff0c\u662f\u5bf9\u8c61\u7ba1\u7406\u7ec4\u7ec7\uff08Object Management Group\uff09\u7ef4\u62a4\u7684\u884c\u4e1a\u6027\u6807\u51c6\u3002 \u8981\u7d20 \u6d41\u5bf9\u8c61\uff08Flow Object\uff09 \u4e8b\u4ef6\uff08Events\uff09\u4ee5\u5706\u73af\u8868\u793a\uff0c\u5e38\u89c1\uff1a\u5f00\u59cb\u4e8b\u4ef6\uff08\u53ea\u80fdcatch\uff09\uff0c\u7ed3\u675f\u4e8b\u4ef6\uff08\u53ea\u80fdthrow\uff09 \u6d3b\u52a8\uff08Activities\uff09\u7528\u5706\u89d2\u77e9\u5f62\u8868\u793a\uff1a\u4efb\u52a1\uff0c\u5b50\u6d41\u7a0b\uff0c\u4e8b\u52a1 \u5173\u53e3\uff08Gateways\uff09\u83f1\u5f62\u8868\u793a \u8fde\u63a5\u5bf9\u8c61\uff08Connecting Objects\uff09 \u987a\u5e8f\u6d41\uff08Sequence Flow\uff09\u5b9e\u5fc3\u7ebf\u548c\u7bad\u5934 \u6d88\u606f\u6d41\uff08Message Flow\uff09\u865a\u7ebf\u7bad\u5934\uff0c\u8868\u660e\u8de8\u8d8a\u6c60\u8fb9\u754c\u7684\u6d88\u606f \u5173\u8054\uff08Association\uff09\u70b9\u7ebf\uff0c\u8fde\u63a5\u9644\u52a0\u7269\u548c\u6d41\u5bf9\u8c61 \u6cf3\u9053\uff08Swimlanes\uff09 \u6c60\uff08Pool\uff09\u533a\u5206\u7ec4\u7ec7\uff0c\u53ef\u6709\u591a\u4e2a\u9053 \u9053\uff08Lane\uff09\u533a\u5206\u804c\u80fd \u9644\u52a0\u7269\uff08Artifacts\uff09 \u6570\u636e\u5bf9\u8c61\uff08Data Object\uff09 \u7ec4\uff08Group\uff09\u865a\u7ebf\u7684\u5706\u89d2\u77e9\u5f62\uff0c\u7528\u4e8e\u6d3b\u52a8\u5206\u7ec4\uff0c\u4e0d\u5f71\u54cd\u6d41 \u6ce8\u91ca\uff08Annotation\uff09","title":"BPMN 2.0 \u7b80\u4ecb"},{"location":"tech_tutorial/workflow/bpmn/#bpmn-20","text":"\u4e1a\u52a1\u6d41\u7a0b\u6a21\u578b\u548c\u6807\u8bb0\u6cd5\uff08Business Process Model and Notation\uff09\u662f\u4e00\u5957\u56fe\u5f62\u5316\u8868\u793a\u6cd5\uff0c\u7528\u4e8e\u4ee5\u4e1a\u52a1\u6d41\u7a0b\u6a21\u578b\u8be6\u7ec6\u8bf4\u660e\u5404\u79cd\u4e1a\u52a1\u6d41\u7a0b\uff0c\u662f\u5bf9\u8c61\u7ba1\u7406\u7ec4\u7ec7\uff08Object Management Group\uff09\u7ef4\u62a4\u7684\u884c\u4e1a\u6027\u6807\u51c6\u3002","title":"BPMN 2.0 \u7b80\u4ecb"},{"location":"tech_tutorial/workflow/bpmn/#_1","text":"\u6d41\u5bf9\u8c61\uff08Flow Object\uff09 \u4e8b\u4ef6\uff08Events\uff09\u4ee5\u5706\u73af\u8868\u793a\uff0c\u5e38\u89c1\uff1a\u5f00\u59cb\u4e8b\u4ef6\uff08\u53ea\u80fdcatch\uff09\uff0c\u7ed3\u675f\u4e8b\u4ef6\uff08\u53ea\u80fdthrow\uff09 \u6d3b\u52a8\uff08Activities\uff09\u7528\u5706\u89d2\u77e9\u5f62\u8868\u793a\uff1a\u4efb\u52a1\uff0c\u5b50\u6d41\u7a0b\uff0c\u4e8b\u52a1 \u5173\u53e3\uff08Gateways\uff09\u83f1\u5f62\u8868\u793a \u8fde\u63a5\u5bf9\u8c61\uff08Connecting Objects\uff09 \u987a\u5e8f\u6d41\uff08Sequence Flow\uff09\u5b9e\u5fc3\u7ebf\u548c\u7bad\u5934 \u6d88\u606f\u6d41\uff08Message Flow\uff09\u865a\u7ebf\u7bad\u5934\uff0c\u8868\u660e\u8de8\u8d8a\u6c60\u8fb9\u754c\u7684\u6d88\u606f \u5173\u8054\uff08Association\uff09\u70b9\u7ebf\uff0c\u8fde\u63a5\u9644\u52a0\u7269\u548c\u6d41\u5bf9\u8c61 \u6cf3\u9053\uff08Swimlanes\uff09 \u6c60\uff08Pool\uff09\u533a\u5206\u7ec4\u7ec7\uff0c\u53ef\u6709\u591a\u4e2a\u9053 \u9053\uff08Lane\uff09\u533a\u5206\u804c\u80fd \u9644\u52a0\u7269\uff08Artifacts\uff09 \u6570\u636e\u5bf9\u8c61\uff08Data Object\uff09 \u7ec4\uff08Group\uff09\u865a\u7ebf\u7684\u5706\u89d2\u77e9\u5f62\uff0c\u7528\u4e8e\u6d3b\u52a8\u5206\u7ec4\uff0c\u4e0d\u5f71\u54cd\u6d41 \u6ce8\u91ca\uff08Annotation\uff09","title":"\u8981\u7d20"},{"location":"tech_tutorial/workflow/jsonlogic/","text":"JsonLogic \u57fa\u4e8ejson\u7684\u89c4\u5219\u5f15\u64ce \u89c4\u5219\u5f15\u64ce\u53ef\u4ee5\u5c06\u5f00\u53d1\u8005\u4ece\u590d\u6742\u7684if\u5730\u72f1\u4e2d\u89e3\u8131\u51fa\u6765\uff0c\u53ef\u6709\u5f88\u591a\u79cd\u73a9\u6cd5\u3002 JsonLogic\u5c31\u662f\u4e00\u79cd\u4ee5json\u683c\u5f0f\u6765\u5b9a\u4e49\u89c4\u5219\u7684\u7b80\u6613\u7684\u89c4\u5219\u5f15\u64ce\uff0c\u6709\u591a\u79cd\u8bed\u8a00\u7684\u5b9e\u73b0\uff0c\u672c\u6587\u4ee5Python\u5b9e\u73b0\u6765\u4ecb\u7ecd\u3002 \u5b89\u88c5 pip install json-logic-qubit \u622a\u6b62\u672c\u6587\u5199\u4f5c\u65e5\u524d\uff0c\u7248\u672c\u662f0.9.1 \u4f7f\u7528 # \u5bfc\u5165\u89c4\u5219\u5f15\u64ce from json_logic import jsonLogic, add_operation # json\u89c4\u5219\u5f00\u5934\u7684key\u662f\u64cd\u4f5c\u7b26\uff0c\u652f\u6301\u7684\u7b26\u53f7\u8bf7\u53c2\u8003\u5b98\u7f51\uff0c\u652f\u6301\u591a\u79cd\u7b26\u53f7\u5d4c\u5957 rules = {\"and\": [ {\"<\": [{\"var\": \"temp\"}, 110]}, {\"==\": [{\"var\": \"pie.filling\"}, \"apple\"]} ]} data = {\"temp\": 100, \"pie\": {\"filling\": \"apple\"}} # jsonLogic\u662f\u5c06\u89c4\u5219\u548c\u6570\u636e\u540c\u65f6\u5bfc\u5165\u5185\u5b58\uff0c\u8fdb\u884cAST\u8bed\u6cd5\u6811\u7684\u8ba1\u7b97\uff0c\u5b9e\u9645\u4e0a\u5b83\u5c31\u662f\u4e00\u79cd\u51c6\u8ba1\u7b97\u673a\u8bed\u8a00\u7684\u5b9e\u73b0 result = jsonLogic(rules, data) print(\"json_logic result: {}\".format(str(result))) # \u6d4b\u8bd5\uff1a\u81ea\u5b9a\u4e49\u64cd\u4f5c\u7b26 def plus(x, y): return x+y ops_plus = plus # \u5c06\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\uff08\u5373\u64cd\u4f5c\u7b26\u53f7\uff09\u52a0\u5165\u5230jsonlogic\u7684\u8bed\u6cd5\u6811\u4e2d\uff0c\u6ce8\u610f\uff1a\u7b26\u53f7\u662f\u5168\u5c40\u7684\uff0c\u4f1a\u8986\u76d6\u539f\u7531\u5b9a\u4e49 add_operation(\"plus\", ops_plus) result = jsonLogic({ \"plus\": [2, 20] }) print(\"json_logic result: {}\".format(str(result))) # \u6d4b\u8bd5\u903b\u8f91\u63a7\u5236\uff1a\u5982\u679c\u662f3\u7684\u500d\u6570\u8f93\u51fafizz\uff0c5\u7684\u500d\u6570\u8f93\u51fabuzz\uff0c\u5426\u5219\u8f93\u51fa\u539f\u503c rules = { \"if\": [ {\"==\": [{\"%\": [{\"var\": \"i\"}, 15]}, 0]}, \"fizzbuzz\", {\"==\": [{\"%\": [{\"var\": \"i\"}, 3]}, 0]}, \"fizz\", {\"==\": [{\"%\": [{\"var\": \"i\"}, 5]}, 0]}, \"buzz\", {\"var\": \"i\"} ] } for i in range(30): print(\"when i={}, return {}\".format( str(i), jsonLogic(rules, {\"i\": i}))) \u5b9e\u4f8bDemo \b\u76ee\u6807\uff1a\u4ece\u4e00\u5806\u6df7\u5408\u7684\u544a\u8b66\u6570\u636e\u4e2d\uff0c\u5224\u65ad\u6765\u81eaZabbix\u7684\u544a\u8b66\u6570\u91cf\u662f\u5426\u8d85\u8fc7\u9608\u503c // \u6a21\u62df\u7684\u539f\u59cb\u6570\u636e { \"data\": [{ \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"EMC\",\"no\": 1}, { \"source\": \"ELK\",\"no\": 1}] } // \u89c4\u5219\u8868\u8fbe\uff1a\u5982\u679czabbix\u8bb0\u5f55\u6570\u91cf>3\u6b21\uff0c\u89e6\u53d1\u53cd\u9988True { \">\": [ { \"reduce\": [ { \"filter\": [ { \"var\": \"data\" }, { \"==\": [{ \"var\": \"source\"}, \"Zabbix\"] } ] }, {\"+\":[{\"var\":\"current.no\"}, {\"var\":\"accumulator\"}]}, 0 ] }, 3 ] } Python\u4ee3\u7801\uff0c\u57fa\u4e8eMug\u6846\u67b6\uff0c\u7701\u7565\u90e8\u5206\u7ec6\u8282 # \u4e3b\u63a7\u5236 def exec_rule(): '''\u6267\u884c\u89c4\u5219''' try: # \u6570\u636e\u9884\u5904\u7406\uff1a\u4ecedb\u4e2d\u8bfb\u53d6\u6240\u6709\u6570\u636e\uff0c\u7ec4\u6210\u5927\u7684json\uff0c\u4f5c\u4e3adata json_data = dict() all_data = rule_engine_util.get_all_data_json() # \u9884\u5904\u74061\uff0c\u5728\u6bcf\u4e2adata\u4e2d\uff0c\u8865\u5145{\"no\": 1}\uff0c\u4f5c\u4e3a\u8ba1\u6570\u5668 _new_datas = [] for _data in all_data: _data['no'] = 1 _new_datas.append(_data) json_data['data'] = _new_datas # \u52a0\u8f7d\u89c4\u5219\u8868 all_rule = rule_engine_util.get_all_rule() # \u904d\u5386\u6267\u884c\u89c4\u5219\uff0c\u53ea\u8981\u67091\u4e2a\u89e6\u53d1\uff0c\u5c31\u6267\u884c\u540e\u8df3\u51fa for _rule in all_rule: if rule_engine_util.exec_rule(rule=_rule, data=json_data): _msg = '\u89e6\u53d1\u89c4\u5219: {}'.format(_rule.rule_name) return dict(code=200, message=_msg) return dict(code=200, message='\u6ca1\u6709\u89e6\u53d1\u4efb\u4f55\u89c4\u5219') except Exception as e: logger.exception(e) abort(400, str(e)) # rule_engine_util\u90e8\u5206 import json from json_logic import jsonLogic def get_all_data_json(): '''\u8bfb\u53d6\u6240\u6709\u6570\u636e\u7684json''' data = [] query = TestData.select() for row in query: data.append(json.loads(row.data_json)) return data def get_all_rule(): '''\u8bfb\u53d6\u6240\u6709\u89c4\u5219''' data = [] query = Rule.select() for row in query: data.append(row) return data def exec_rule(rule, data): '''\u6267\u884c\u6307\u5b9a\u89c4\u5219''' # \u662f\u5426\u89e6\u53d1 fired_flg = False if not isinstance(rule, Rule): raise TypeError(\"\u53c2\u6570rule\u7684\u7c7b\u578b\u9519\u8bef\") try: _rule = json.loads(rule.rule_json) result = jsonLogic(_rule, data) if isinstance(result, bool): fired_flg = result else: # TODO \u53ef\u4ee5\u62d3\u5c55\u591a\u79cd\u53cd\u9988\u7c7b\u578b\uff0c\u521d\u671fdemo\u53ea\u8981bool pass except Exception as e: logger.exception(e) print(e) return fired_flg \u53c2\u8003 \u5b98\u7f51 https://jsonlogic.com/ \u53ef\u7528\u7684Py\u7248\u5b9e\u73b0 https://github.com/QubitProducts/json-logic-py","title":"JsonLogic \u57fa\u4e8ejson\u7684\u89c4\u5219\u5f15\u64ce"},{"location":"tech_tutorial/workflow/jsonlogic/#jsonlogic-json","text":"\u89c4\u5219\u5f15\u64ce\u53ef\u4ee5\u5c06\u5f00\u53d1\u8005\u4ece\u590d\u6742\u7684if\u5730\u72f1\u4e2d\u89e3\u8131\u51fa\u6765\uff0c\u53ef\u6709\u5f88\u591a\u79cd\u73a9\u6cd5\u3002 JsonLogic\u5c31\u662f\u4e00\u79cd\u4ee5json\u683c\u5f0f\u6765\u5b9a\u4e49\u89c4\u5219\u7684\u7b80\u6613\u7684\u89c4\u5219\u5f15\u64ce\uff0c\u6709\u591a\u79cd\u8bed\u8a00\u7684\u5b9e\u73b0\uff0c\u672c\u6587\u4ee5Python\u5b9e\u73b0\u6765\u4ecb\u7ecd\u3002","title":"JsonLogic \u57fa\u4e8ejson\u7684\u89c4\u5219\u5f15\u64ce"},{"location":"tech_tutorial/workflow/jsonlogic/#_1","text":"pip install json-logic-qubit \u622a\u6b62\u672c\u6587\u5199\u4f5c\u65e5\u524d\uff0c\u7248\u672c\u662f0.9.1","title":"\u5b89\u88c5"},{"location":"tech_tutorial/workflow/jsonlogic/#_2","text":"# \u5bfc\u5165\u89c4\u5219\u5f15\u64ce from json_logic import jsonLogic, add_operation # json\u89c4\u5219\u5f00\u5934\u7684key\u662f\u64cd\u4f5c\u7b26\uff0c\u652f\u6301\u7684\u7b26\u53f7\u8bf7\u53c2\u8003\u5b98\u7f51\uff0c\u652f\u6301\u591a\u79cd\u7b26\u53f7\u5d4c\u5957 rules = {\"and\": [ {\"<\": [{\"var\": \"temp\"}, 110]}, {\"==\": [{\"var\": \"pie.filling\"}, \"apple\"]} ]} data = {\"temp\": 100, \"pie\": {\"filling\": \"apple\"}} # jsonLogic\u662f\u5c06\u89c4\u5219\u548c\u6570\u636e\u540c\u65f6\u5bfc\u5165\u5185\u5b58\uff0c\u8fdb\u884cAST\u8bed\u6cd5\u6811\u7684\u8ba1\u7b97\uff0c\u5b9e\u9645\u4e0a\u5b83\u5c31\u662f\u4e00\u79cd\u51c6\u8ba1\u7b97\u673a\u8bed\u8a00\u7684\u5b9e\u73b0 result = jsonLogic(rules, data) print(\"json_logic result: {}\".format(str(result))) # \u6d4b\u8bd5\uff1a\u81ea\u5b9a\u4e49\u64cd\u4f5c\u7b26 def plus(x, y): return x+y ops_plus = plus # \u5c06\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\uff08\u5373\u64cd\u4f5c\u7b26\u53f7\uff09\u52a0\u5165\u5230jsonlogic\u7684\u8bed\u6cd5\u6811\u4e2d\uff0c\u6ce8\u610f\uff1a\u7b26\u53f7\u662f\u5168\u5c40\u7684\uff0c\u4f1a\u8986\u76d6\u539f\u7531\u5b9a\u4e49 add_operation(\"plus\", ops_plus) result = jsonLogic({ \"plus\": [2, 20] }) print(\"json_logic result: {}\".format(str(result))) # \u6d4b\u8bd5\u903b\u8f91\u63a7\u5236\uff1a\u5982\u679c\u662f3\u7684\u500d\u6570\u8f93\u51fafizz\uff0c5\u7684\u500d\u6570\u8f93\u51fabuzz\uff0c\u5426\u5219\u8f93\u51fa\u539f\u503c rules = { \"if\": [ {\"==\": [{\"%\": [{\"var\": \"i\"}, 15]}, 0]}, \"fizzbuzz\", {\"==\": [{\"%\": [{\"var\": \"i\"}, 3]}, 0]}, \"fizz\", {\"==\": [{\"%\": [{\"var\": \"i\"}, 5]}, 0]}, \"buzz\", {\"var\": \"i\"} ] } for i in range(30): print(\"when i={}, return {}\".format( str(i), jsonLogic(rules, {\"i\": i})))","title":"\u4f7f\u7528"},{"location":"tech_tutorial/workflow/jsonlogic/#demo","text":"\b\u76ee\u6807\uff1a\u4ece\u4e00\u5806\u6df7\u5408\u7684\u544a\u8b66\u6570\u636e\u4e2d\uff0c\u5224\u65ad\u6765\u81eaZabbix\u7684\u544a\u8b66\u6570\u91cf\u662f\u5426\u8d85\u8fc7\u9608\u503c // \u6a21\u62df\u7684\u539f\u59cb\u6570\u636e { \"data\": [{ \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"Zabbix\",\"no\": 1}, { \"source\": \"EMC\",\"no\": 1}, { \"source\": \"ELK\",\"no\": 1}] } // \u89c4\u5219\u8868\u8fbe\uff1a\u5982\u679czabbix\u8bb0\u5f55\u6570\u91cf>3\u6b21\uff0c\u89e6\u53d1\u53cd\u9988True { \">\": [ { \"reduce\": [ { \"filter\": [ { \"var\": \"data\" }, { \"==\": [{ \"var\": \"source\"}, \"Zabbix\"] } ] }, {\"+\":[{\"var\":\"current.no\"}, {\"var\":\"accumulator\"}]}, 0 ] }, 3 ] } Python\u4ee3\u7801\uff0c\u57fa\u4e8eMug\u6846\u67b6\uff0c\u7701\u7565\u90e8\u5206\u7ec6\u8282 # \u4e3b\u63a7\u5236 def exec_rule(): '''\u6267\u884c\u89c4\u5219''' try: # \u6570\u636e\u9884\u5904\u7406\uff1a\u4ecedb\u4e2d\u8bfb\u53d6\u6240\u6709\u6570\u636e\uff0c\u7ec4\u6210\u5927\u7684json\uff0c\u4f5c\u4e3adata json_data = dict() all_data = rule_engine_util.get_all_data_json() # \u9884\u5904\u74061\uff0c\u5728\u6bcf\u4e2adata\u4e2d\uff0c\u8865\u5145{\"no\": 1}\uff0c\u4f5c\u4e3a\u8ba1\u6570\u5668 _new_datas = [] for _data in all_data: _data['no'] = 1 _new_datas.append(_data) json_data['data'] = _new_datas # \u52a0\u8f7d\u89c4\u5219\u8868 all_rule = rule_engine_util.get_all_rule() # \u904d\u5386\u6267\u884c\u89c4\u5219\uff0c\u53ea\u8981\u67091\u4e2a\u89e6\u53d1\uff0c\u5c31\u6267\u884c\u540e\u8df3\u51fa for _rule in all_rule: if rule_engine_util.exec_rule(rule=_rule, data=json_data): _msg = '\u89e6\u53d1\u89c4\u5219: {}'.format(_rule.rule_name) return dict(code=200, message=_msg) return dict(code=200, message='\u6ca1\u6709\u89e6\u53d1\u4efb\u4f55\u89c4\u5219') except Exception as e: logger.exception(e) abort(400, str(e)) # rule_engine_util\u90e8\u5206 import json from json_logic import jsonLogic def get_all_data_json(): '''\u8bfb\u53d6\u6240\u6709\u6570\u636e\u7684json''' data = [] query = TestData.select() for row in query: data.append(json.loads(row.data_json)) return data def get_all_rule(): '''\u8bfb\u53d6\u6240\u6709\u89c4\u5219''' data = [] query = Rule.select() for row in query: data.append(row) return data def exec_rule(rule, data): '''\u6267\u884c\u6307\u5b9a\u89c4\u5219''' # \u662f\u5426\u89e6\u53d1 fired_flg = False if not isinstance(rule, Rule): raise TypeError(\"\u53c2\u6570rule\u7684\u7c7b\u578b\u9519\u8bef\") try: _rule = json.loads(rule.rule_json) result = jsonLogic(_rule, data) if isinstance(result, bool): fired_flg = result else: # TODO \u53ef\u4ee5\u62d3\u5c55\u591a\u79cd\u53cd\u9988\u7c7b\u578b\uff0c\u521d\u671fdemo\u53ea\u8981bool pass except Exception as e: logger.exception(e) print(e) return fired_flg","title":"\u5b9e\u4f8bDemo"},{"location":"tech_tutorial/workflow/jsonlogic/#_3","text":"\u5b98\u7f51 https://jsonlogic.com/ \u53ef\u7528\u7684Py\u7248\u5b9e\u73b0 https://github.com/QubitProducts/json-logic-py","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/apisix/","text":"APISix API\u7f51\u5173 \u5b89\u88c5 docker-compose\u7248 git clone https://github.com/apache/apisix-docker.git cd apisix-docker/example docker-compose -p docker-apisix up -d \u5982\u679c\u8981\u5b9e\u9645\u4f7f\u7528\uff0c\u5efa\u8bae\u4fee\u6539 example \u76ee\u5f55\u5185\u70b9\u4ee5\u4e0b\u914d\u7f6e\uff1a docker-compose.yml \u91ccapisix\u7684 9080\u548c9443 \u7aef\u53e3\uff0c\u6539\u4e3a 80\u548c443 dashboard_conf/conf.yaml \u7684 authentication.users.password \u4fee\u6539\u65b0\u503c \u53c2\u8003 Github\u5b98\u7f51 https://github.com/apache/apisix","title":"APISix API\u7f51\u5173"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/apisix/#apisix-api","text":"","title":"APISix API\u7f51\u5173"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/apisix/#_1","text":"","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/apisix/#docker-compose","text":"git clone https://github.com/apache/apisix-docker.git cd apisix-docker/example docker-compose -p docker-apisix up -d \u5982\u679c\u8981\u5b9e\u9645\u4f7f\u7528\uff0c\u5efa\u8bae\u4fee\u6539 example \u76ee\u5f55\u5185\u70b9\u4ee5\u4e0b\u914d\u7f6e\uff1a docker-compose.yml \u91ccapisix\u7684 9080\u548c9443 \u7aef\u53e3\uff0c\u6539\u4e3a 80\u548c443 dashboard_conf/conf.yaml \u7684 authentication.users.password \u4fee\u6539\u65b0\u503c","title":"docker-compose\u7248"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/apisix/#_2","text":"Github\u5b98\u7f51 https://github.com/apache/apisix","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/confd/","text":"Confd \u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3 \u67b6\u6784 \u914d\u7f6e\u670d\u52a1\u4e2d\u5fc3\u7684\u6a21\u578b confd\u5de5\u4f5c\u6d41\u7a0b \u5b89\u88c5 \u5728\u672c\u5730mac\u4e0a\u9a8c\u8bc1\u901a\u8fc7 # \u4e0b\u8f7d\u5230\u4e13\u7528\u76ee\u5f55 cd /Users/jeff.chen/opt/confd wget https://github.com/kelseyhightower/confd/releases/download/v0.16.0/confd-0.16.0-darwin-amd64 mv confd-0.16.0-darwin-amd64 confd # \u8bbe\u7f6e\u73af\u5883 export PATH=\"/Users/jeff.chen/opt/confd:$PATH\" # \u9a8c\u8bc1 confd -help \u4f7f\u7528 # \u6784\u5efa\u76f8\u5173\u76ee\u5f55 cd /Users/jeff.chen/opt/confd mkdir -p ./{conf.d,templates} \u7f16\u8f91conf.d/ops-event-web.toml\u914d\u7f6e [template] # \u6a21\u677f\u6587\u4ef6 src = \"ops-event-web.tmpl\" # \u751f\u6210\u76ee\u6807\u914d\u7f6e\u76ee\u5f55\u6587\u4ef6 dest = \"/Users/jeff.chen/opt/confd/setting.py\" # \u76d1\u63a7KEY\u7684\u6539\u53d8\uff0c\u6539\u53d8\u4f1a\u81ea\u52a8\u91cd\u65b0\u751f\u6210\u914d\u7f6e\u5e76\u91cd\u542f keys = [ \"/ops-event-web/DB_CONNECT_DB\", \"/ops-event-web/DB_CONNECT_HOST\", \"/ops-event-web/DB_CONNECT_PASSWORD\", \"/ops-event-web/DB_CONNECT_PORT\", \"/ops-event-web/DB_CONNECT_USER\", ] # \u6267\u884c\u52a8\u4f5c\u7684\u7528\u6237\u548c\u6587\u4ef6\u6743\u9650 owner = \"jeff.chen\" mode = \"0644\" # \u6267\u884c\u9a8c\u8bc1\u547d\u4ee4\u548c\u670d\u52a1\u91cd\u542f check_cmd = \"echo 'exec check'\" reload_cmd = \"echo 'exec restart'\" \u751f\u6210ops-event-web.tmpl\uff0c\u57fa\u4e8ego\u7684\u5b57\u7b26\u4e32\u6a21\u677f ################### # db\u76f8\u5173 ################### # \u6570\u636e\u5e93\u8fde\u63a5 DB_CONNECT_DB = '{{getv \"/ops-event-web/DB_CONNECT_DB\"}}' DB_CONNECT_USER = '{{getv \"/ops-event-web/DB_CONNECT_USER\"}}' DB_CONNECT_PASSWORD = '{{getv \"/ops-event-web/DB_CONNECT_PASSWORD\"}}' DB_CONNECT_HOST = '{{getv \"/ops-event-web/DB_CONNECT_HOST\"}}' DB_CONNECT_PORT = {{getv \"/ops-event-web/DB_CONNECT_PORT\"}} # \u8fd0\u884c1\u6b21 confd -confdir . -onetime -backend etcd -node http://127.0.0.1:2379 # \u6301\u7eed\u8fd0\u884c\uff0c\u6bcf\u969410s\u76d1\u63a7key\u662f\u5426\u53d8\u66f4 confd -confdir . -backend=\"etcd\" -node=http://127.0.0.1:2379 -interval=10 \u6267\u884c\u6548\u679c \u53c2\u8003 github\u5b98\u7f51 Etcd\u7b80\u4ecb","title":"Confd \u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/confd/#confd","text":"","title":"Confd \u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/confd/#_1","text":"\u914d\u7f6e\u670d\u52a1\u4e2d\u5fc3\u7684\u6a21\u578b confd\u5de5\u4f5c\u6d41\u7a0b","title":"\u67b6\u6784"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/confd/#_2","text":"\u5728\u672c\u5730mac\u4e0a\u9a8c\u8bc1\u901a\u8fc7 # \u4e0b\u8f7d\u5230\u4e13\u7528\u76ee\u5f55 cd /Users/jeff.chen/opt/confd wget https://github.com/kelseyhightower/confd/releases/download/v0.16.0/confd-0.16.0-darwin-amd64 mv confd-0.16.0-darwin-amd64 confd # \u8bbe\u7f6e\u73af\u5883 export PATH=\"/Users/jeff.chen/opt/confd:$PATH\" # \u9a8c\u8bc1 confd -help","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/confd/#_3","text":"# \u6784\u5efa\u76f8\u5173\u76ee\u5f55 cd /Users/jeff.chen/opt/confd mkdir -p ./{conf.d,templates} \u7f16\u8f91conf.d/ops-event-web.toml\u914d\u7f6e [template] # \u6a21\u677f\u6587\u4ef6 src = \"ops-event-web.tmpl\" # \u751f\u6210\u76ee\u6807\u914d\u7f6e\u76ee\u5f55\u6587\u4ef6 dest = \"/Users/jeff.chen/opt/confd/setting.py\" # \u76d1\u63a7KEY\u7684\u6539\u53d8\uff0c\u6539\u53d8\u4f1a\u81ea\u52a8\u91cd\u65b0\u751f\u6210\u914d\u7f6e\u5e76\u91cd\u542f keys = [ \"/ops-event-web/DB_CONNECT_DB\", \"/ops-event-web/DB_CONNECT_HOST\", \"/ops-event-web/DB_CONNECT_PASSWORD\", \"/ops-event-web/DB_CONNECT_PORT\", \"/ops-event-web/DB_CONNECT_USER\", ] # \u6267\u884c\u52a8\u4f5c\u7684\u7528\u6237\u548c\u6587\u4ef6\u6743\u9650 owner = \"jeff.chen\" mode = \"0644\" # \u6267\u884c\u9a8c\u8bc1\u547d\u4ee4\u548c\u670d\u52a1\u91cd\u542f check_cmd = \"echo 'exec check'\" reload_cmd = \"echo 'exec restart'\" \u751f\u6210ops-event-web.tmpl\uff0c\u57fa\u4e8ego\u7684\u5b57\u7b26\u4e32\u6a21\u677f ################### # db\u76f8\u5173 ################### # \u6570\u636e\u5e93\u8fde\u63a5 DB_CONNECT_DB = '{{getv \"/ops-event-web/DB_CONNECT_DB\"}}' DB_CONNECT_USER = '{{getv \"/ops-event-web/DB_CONNECT_USER\"}}' DB_CONNECT_PASSWORD = '{{getv \"/ops-event-web/DB_CONNECT_PASSWORD\"}}' DB_CONNECT_HOST = '{{getv \"/ops-event-web/DB_CONNECT_HOST\"}}' DB_CONNECT_PORT = {{getv \"/ops-event-web/DB_CONNECT_PORT\"}} # \u8fd0\u884c1\u6b21 confd -confdir . -onetime -backend etcd -node http://127.0.0.1:2379 # \u6301\u7eed\u8fd0\u884c\uff0c\u6bcf\u969410s\u76d1\u63a7key\u662f\u5426\u53d8\u66f4 confd -confdir . -backend=\"etcd\" -node=http://127.0.0.1:2379 -interval=10 \u6267\u884c\u6548\u679c","title":"\u4f7f\u7528"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/confd/#_4","text":"github\u5b98\u7f51 Etcd\u7b80\u4ecb","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/","text":"Kafka\u96c6\u7fa4\u5b89\u88c5\u914d\u7f6e\u624b\u518c\uff08Docker\u7248\uff09 \u53c2\u8003 \u5b98\u7f51 \u5f00\u6e90kafka\u96c6\u7fa4\u955c\u50cfGitHub \u5f00\u6e90CMAK\u955c\u50cfGitHub \u5b89\u88c5 Kafka git clone https://github.com/wurstmeister/kafka-docker.git cd kafka-docker # \u4fee\u6539docker-compose.yml\u7684KAFKA_ADVERTISED_HOST_NAME\u4e3a\u5bbf\u4e3b\u673aIP # \u4e0d\u5efa\u8bae\u6539kafka.ports\uff0c\u56e0\u4e3ascale\u547d\u4ee4\u4f1a\u542f\u52a8\u591a\u4e2a\u5bb9\u5668\uff0c\u90fd\u6620\u5c049092 # \u4fee\u6539Dockerfile\uff1akafka_version=2.1.1\uff1bscala_version=2.12 # \u6216\u8005docker-compose.yml\u7684kafka.build\u76f4\u63a5\u6539\u4e3aimage: wurstmeister/kafka:2.12-2.1.1 docker-compose up -d # (\u53ef\u9009\u6269\u5bb9)up\u540e\uff0c\u542f\u52a82\u4e2abroker\uff1adocker-compose scale kafka=2 # \u9a8c\u8bc1 docker-compose ps # docker-compose.yml version: '2' services: zookeeper: image: wurstmeister/zookeeper ports: - \"2181:2181\" kafka: # build: . image: wurstmeister/kafka:2.12-2.1.1 ports: - \"9092\" # - \"9092:9092\" # \u5982\u679c\u7ed1\u5b9a9092\uff0c\u5c31\u4e0d\u80fd\u901a\u8fc7scale\u6269\u5bb9 environment: KAFKA_ADVERTISED_HOST_NAME: \u5bbf\u4e3b\u673aIP KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181 KAFKA_JMX_OPTS: \"-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=127.0.0.1 -Dcom.sun.management.jmxremote.rmi.port=1099\" JMX_PORT: 1099 volumes: - /var/run/docker.sock:/var/run/docker.sock CMAK\uff0c\u539fKafka Manager git clone https://github.com/hleb-albau/kafka-manager-docker.git cd kafka-manager-docker # \u65b0\u5efadocker-compose.yml version: '3.6' services: kafka_manager: image: hlebalbau/kafka-manager:stable container_name: kafka-manager restart: always ports: - \"9000:9000\" environment: ZK_HOSTS: \"\u4e4b\u524dkafka\u7684zk\u4e3b\u673aip:2181\" APPLICATION_SECRET: \"random-secret\" KAFKA_MANAGER_AUTH_ENABLED: \"true\" # \u5f00\u542f\u767b\u5165\u8ba4\u8bc1 KAFKA_MANAGER_USERNAME: username KAFKA_MANAGER_PASSWORD: password command: -Dpidfile.path=/dev/null \u8bbf\u95ee http://CMAK\u4e3b\u673a:9000 \u4f7f\u7528 \u586b\u5751\u8bb0\u5f55 \u7b2c\u4e00\u6b21\u52a0cluster\uff0c\u9875\u9762\u62a5 KeeperErrorCode = Unimplemented for /kafka-manager/mutex \u539f\u56e0\uff1a\u5728zk\u4e2d\u6ca1\u6709\u521d\u59cb\u76f8\u5173key \u89e3\u51b3\u65b9\u6848\uff1a\u8fdbdocker\u5185\uff0c\u7528zkCli\u624b\u5de5\u5efa\u76f8\u5173key\uff0c\u53c2\u8003 https://github.com/yahoo/CMAK/issues/731 docker exec -it zookeeper bash # docker\u5185\u64cd\u4f5c ./bin/zkCli.sh # \u8fdb\u5165zk\u540e\u64cd\u4f5c [zk: localhost:2181(CONNECTED) 0] ls /kafka-manager [configs, deleteClusters, clusters] [zk: localhost:2181(CONNECTED) 1] create /kafka-manager/mutex \"\" Created /kafka-manager/mutex [zk: localhost:2181(CONNECTED) 2] create /kafka-manager/mutex/locks \"\" Created /kafka-manager/mutex/locks [zk: localhost:2181(CONNECTED) 3] create /kafka-manager/mutex/leases \"\" Created /kafka-manager/mutex/leases \u957f\u65f6\u95f4\u8fd0\u884c\u540e\uff0c\u78c1\u76d8\u544a\u8b66\uff0c\u5927\u91cf\u6301\u4e45\u5316log \u539f\u56e0\uff1a\u5728\u5efatopic\u65f6\uff0c\u6ca1\u6709\u6307\u5b9a\u6301\u4e45\u5316\u7b56\u7565 \u89e3\u51b3\u65b9\u6848\uff1a\u65b0\u5efatopic\u65f6\uff0c\u8bbe\u7f6e retention.ms \u4e3a43200000\uff0c\u5355\u4f4d\u6beb\u79d2","title":"Kafka\u96c6\u7fa4\u5b89\u88c5\u914d\u7f6e\u624b\u518c\uff08Docker\u7248\uff09"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/#kafkadocker","text":"","title":"Kafka\u96c6\u7fa4\u5b89\u88c5\u914d\u7f6e\u624b\u518c\uff08Docker\u7248\uff09"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/#_1","text":"\u5b98\u7f51 \u5f00\u6e90kafka\u96c6\u7fa4\u955c\u50cfGitHub \u5f00\u6e90CMAK\u955c\u50cfGitHub","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/#_2","text":"","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/#kafka","text":"git clone https://github.com/wurstmeister/kafka-docker.git cd kafka-docker # \u4fee\u6539docker-compose.yml\u7684KAFKA_ADVERTISED_HOST_NAME\u4e3a\u5bbf\u4e3b\u673aIP # \u4e0d\u5efa\u8bae\u6539kafka.ports\uff0c\u56e0\u4e3ascale\u547d\u4ee4\u4f1a\u542f\u52a8\u591a\u4e2a\u5bb9\u5668\uff0c\u90fd\u6620\u5c049092 # \u4fee\u6539Dockerfile\uff1akafka_version=2.1.1\uff1bscala_version=2.12 # \u6216\u8005docker-compose.yml\u7684kafka.build\u76f4\u63a5\u6539\u4e3aimage: wurstmeister/kafka:2.12-2.1.1 docker-compose up -d # (\u53ef\u9009\u6269\u5bb9)up\u540e\uff0c\u542f\u52a82\u4e2abroker\uff1adocker-compose scale kafka=2 # \u9a8c\u8bc1 docker-compose ps # docker-compose.yml version: '2' services: zookeeper: image: wurstmeister/zookeeper ports: - \"2181:2181\" kafka: # build: . image: wurstmeister/kafka:2.12-2.1.1 ports: - \"9092\" # - \"9092:9092\" # \u5982\u679c\u7ed1\u5b9a9092\uff0c\u5c31\u4e0d\u80fd\u901a\u8fc7scale\u6269\u5bb9 environment: KAFKA_ADVERTISED_HOST_NAME: \u5bbf\u4e3b\u673aIP KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181 KAFKA_JMX_OPTS: \"-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=127.0.0.1 -Dcom.sun.management.jmxremote.rmi.port=1099\" JMX_PORT: 1099 volumes: - /var/run/docker.sock:/var/run/docker.sock","title":"Kafka"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/#cmakkafka-manager","text":"git clone https://github.com/hleb-albau/kafka-manager-docker.git cd kafka-manager-docker # \u65b0\u5efadocker-compose.yml version: '3.6' services: kafka_manager: image: hlebalbau/kafka-manager:stable container_name: kafka-manager restart: always ports: - \"9000:9000\" environment: ZK_HOSTS: \"\u4e4b\u524dkafka\u7684zk\u4e3b\u673aip:2181\" APPLICATION_SECRET: \"random-secret\" KAFKA_MANAGER_AUTH_ENABLED: \"true\" # \u5f00\u542f\u767b\u5165\u8ba4\u8bc1 KAFKA_MANAGER_USERNAME: username KAFKA_MANAGER_PASSWORD: password command: -Dpidfile.path=/dev/null \u8bbf\u95ee http://CMAK\u4e3b\u673a:9000 \u4f7f\u7528","title":"CMAK\uff0c\u539fKafka Manager"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/#_3","text":"\u7b2c\u4e00\u6b21\u52a0cluster\uff0c\u9875\u9762\u62a5 KeeperErrorCode = Unimplemented for /kafka-manager/mutex \u539f\u56e0\uff1a\u5728zk\u4e2d\u6ca1\u6709\u521d\u59cb\u76f8\u5173key \u89e3\u51b3\u65b9\u6848\uff1a\u8fdbdocker\u5185\uff0c\u7528zkCli\u624b\u5de5\u5efa\u76f8\u5173key\uff0c\u53c2\u8003 https://github.com/yahoo/CMAK/issues/731 docker exec -it zookeeper bash # docker\u5185\u64cd\u4f5c ./bin/zkCli.sh # \u8fdb\u5165zk\u540e\u64cd\u4f5c [zk: localhost:2181(CONNECTED) 0] ls /kafka-manager [configs, deleteClusters, clusters] [zk: localhost:2181(CONNECTED) 1] create /kafka-manager/mutex \"\" Created /kafka-manager/mutex [zk: localhost:2181(CONNECTED) 2] create /kafka-manager/mutex/locks \"\" Created /kafka-manager/mutex/locks [zk: localhost:2181(CONNECTED) 3] create /kafka-manager/mutex/leases \"\" Created /kafka-manager/mutex/leases \u957f\u65f6\u95f4\u8fd0\u884c\u540e\uff0c\u78c1\u76d8\u544a\u8b66\uff0c\u5927\u91cf\u6301\u4e45\u5316log \u539f\u56e0\uff1a\u5728\u5efatopic\u65f6\uff0c\u6ca1\u6709\u6307\u5b9a\u6301\u4e45\u5316\u7b56\u7565 \u89e3\u51b3\u65b9\u6848\uff1a\u65b0\u5efatopic\u65f6\uff0c\u8bbe\u7f6e retention.ms \u4e3a43200000\uff0c\u5355\u4f4d\u6beb\u79d2","title":"\u586b\u5751\u8bb0\u5f55"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/nginx/","text":"Nginx \u53cd\u5411\u4ee3\u7406Web\u670d\u52a1\u5668 \u5e38\u7528\u914d\u7f6e\u8bf4\u660e","title":"Nginx \u53cd\u5411\u4ee3\u7406Web\u670d\u52a1\u5668"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/nginx/#nginx-web","text":"","title":"Nginx \u53cd\u5411\u4ee3\u7406Web\u670d\u52a1\u5668"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/nginx/#_1","text":"","title":"\u5e38\u7528\u914d\u7f6e\u8bf4\u660e"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rabbitmq/","text":"RabbitMQ\u6d88\u606f\u4e2d\u95f4\u4ef6 \u5e38\u7528cli \u67e5\u8be2 rabbitmqctl status \u5f53\u524d\u8282\u70b9\u72b6\u6001 rabbitmqctl cluster_status \u96c6\u7fa4\u72b6\u6001 \u53d8\u66f4\u64cd\u4f5c","title":"RabbitMQ\u6d88\u606f\u4e2d\u95f4\u4ef6"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rabbitmq/#rabbitmq","text":"","title":"RabbitMQ\u6d88\u606f\u4e2d\u95f4\u4ef6"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rabbitmq/#cli","text":"","title":"\u5e38\u7528cli"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rabbitmq/#_1","text":"rabbitmqctl status \u5f53\u524d\u8282\u70b9\u72b6\u6001 rabbitmqctl cluster_status \u96c6\u7fa4\u72b6\u6001","title":"\u67e5\u8be2"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rabbitmq/#_2","text":"","title":"\u53d8\u66f4\u64cd\u4f5c"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/","text":"RocketMQ \u5206\u5e03\u5f0fMQ\u548c\u6d41\u5e73\u53f0 \u7b80\u4ecb \u5f00\u6e90\uff0cApache2.0 Pull\u6a21\u5f0f \u4f4e\u5ef6\u65f6\uff0c\u4ebf\u7ea7 \u9ad8\u53ef\u9760\uff0c\u78c1\u76d8\u6570\u636e\u56fa\u5316 \u6613\u6269\u5bb9 \u652f\u6301Scheduled \u652f\u6301\u5e7f\u64ad \u652f\u6301\u6761\u4ef6\u8fc7\u6ee4 \u5b89\u88c5\uff08docker\u7248\uff09 \u5b89\u88c5\u9700\u6c42 \uff1a 64\u4f4d\uff0c\u7c7bUnix\u7cfb\u7edf JDK 1.8\u4ee5\u4e0a Broker\u8282\u70b9\u9700\u89814G\u4ee5\u4e0a\u786c\u76d8 git clone https://github.com/apache/rocketmq-externals.git cd rocketmq-externals/rocketmq-docker/4.4.0 ./play-docker.sh # \u7f16\u8bd1\u5e76\u542f\u52a8\u955c\u50cf\uff0c\u975e\u5e38\u7b80\u5355\u4eba\u6027\u5316 # \u6d4b\u8bd5\u751f\u4ea7\u8005 docker exec -ti rmqbroker sh ./tools.sh org.apache.rocketmq.example.quickstart.Producer # \u6d4b\u8bd5\u6d88\u8d39 docker exec -ti rmqbroker sh ./tools.sh org.apache.rocketmq.example.quickstart.Consumer \u542f\u52a8\u53c2\u6570 \uff1a -e \"MAX_POSSIBLE_HEAP=100000000\" \u6307\u5b9ajvm\u5185\u5b58heap \u8fd0\u884c\u6548\u679c: \u4f18\u96c5\u5173\u673a \uff1a docker exec -ti rmqbroker sh ./mqshutdown broker \u5148\u5173broker The mqbroker(28) is running... Send shutdown request to mqbroker(28) OK docker exec -ti rmqnamesrv sh ./mqshutdown namesrv \u518d\u5173namesrv The mqnamesrv(27) is running... Send shutdown request to mqnamesrv(27) OK \u6838\u5fc3 \u67b6\u6784\u56fe \u4f7f\u7528\uff08CLI\uff09 \u7528\u6cd5\uff1a bin/mqadmin <\u547d\u4ee4> <\u53c2\u6570> \u547d\u4ee4\u5982\u4e0b\uff1a updateTopic Update or create topic deleteTopic Delete topic from broker and NameServer. updateSubGroup Update or create subscription group deleteSubGroup Delete subscription group from broker. updateBrokerConfig Update broker's config updateTopicPerm Update topic perm topicRoute Examine topic route info topicStatus Examine topic Status info topicClusterList get cluster info for topic brokerStatus Fetch broker runtime status data queryMsgById Query Message by Id queryMsgByKey Query Message by Key queryMsgByUniqueKey Query Message by Unique key queryMsgByOffset Query Message by offset printMsg Print Message Detail printMsgByQueue Print Message Detail sendMsgStatus send msg to broker. brokerConsumeStats Fetch broker consume stats data producerConnection Query producer's socket connection and client version consumerConnection Query consumer's socket connection, client version and subscription consumerProgress Query consumers's progress, speed consumerStatus Query consumer's internal data structure cloneGroupOffset clone offset from other group. clusterList List all of clusters topicList Fetch all topic list from name server updateKvConfig Create or update KV config. deleteKvConfig Delete KV config. wipeWritePerm Wipe write perm of broker in all name server resetOffsetByTime Reset consumer offset by timestamp(without client restart). updateOrderConf Create or update or delete order conf cleanExpiredCQ Clean expired ConsumeQueue on broker. cleanUnusedTopic Clean unused topic on broker. startMonitoring Start Monitoring statsAll Topic and Consumer tps stats allocateMQ Allocate MQ checkMsgSendRT check message send response time clusterRT List All clusters Message Send RT getNamesrvConfig Get configs of name server. updateNamesrvConfig Update configs of name server. getBrokerConfig Get broker config by cluster or special broker! queryCq Query cq command. sendMessage Send a message consumeMessage Consume message \u53c2\u8003 \u5b98\u7f51 github\u6e90\u7801 \u5b98\u65b9docker \u5b98\u65b9Python\u5ba2\u6237\u7aef","title":"RocketMQ \u5206\u5e03\u5f0fMQ\u548c\u6d41\u5e73\u53f0"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/#rocketmq-mq","text":"","title":"RocketMQ \u5206\u5e03\u5f0fMQ\u548c\u6d41\u5e73\u53f0"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/#_1","text":"\u5f00\u6e90\uff0cApache2.0 Pull\u6a21\u5f0f \u4f4e\u5ef6\u65f6\uff0c\u4ebf\u7ea7 \u9ad8\u53ef\u9760\uff0c\u78c1\u76d8\u6570\u636e\u56fa\u5316 \u6613\u6269\u5bb9 \u652f\u6301Scheduled \u652f\u6301\u5e7f\u64ad \u652f\u6301\u6761\u4ef6\u8fc7\u6ee4","title":"\u7b80\u4ecb"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/#docker","text":"\u5b89\u88c5\u9700\u6c42 \uff1a 64\u4f4d\uff0c\u7c7bUnix\u7cfb\u7edf JDK 1.8\u4ee5\u4e0a Broker\u8282\u70b9\u9700\u89814G\u4ee5\u4e0a\u786c\u76d8 git clone https://github.com/apache/rocketmq-externals.git cd rocketmq-externals/rocketmq-docker/4.4.0 ./play-docker.sh # \u7f16\u8bd1\u5e76\u542f\u52a8\u955c\u50cf\uff0c\u975e\u5e38\u7b80\u5355\u4eba\u6027\u5316 # \u6d4b\u8bd5\u751f\u4ea7\u8005 docker exec -ti rmqbroker sh ./tools.sh org.apache.rocketmq.example.quickstart.Producer # \u6d4b\u8bd5\u6d88\u8d39 docker exec -ti rmqbroker sh ./tools.sh org.apache.rocketmq.example.quickstart.Consumer \u542f\u52a8\u53c2\u6570 \uff1a -e \"MAX_POSSIBLE_HEAP=100000000\" \u6307\u5b9ajvm\u5185\u5b58heap \u8fd0\u884c\u6548\u679c: \u4f18\u96c5\u5173\u673a \uff1a docker exec -ti rmqbroker sh ./mqshutdown broker \u5148\u5173broker The mqbroker(28) is running... Send shutdown request to mqbroker(28) OK docker exec -ti rmqnamesrv sh ./mqshutdown namesrv \u518d\u5173namesrv The mqnamesrv(27) is running... Send shutdown request to mqnamesrv(27) OK","title":"\u5b89\u88c5\uff08docker\u7248\uff09"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/#_2","text":"","title":"\u6838\u5fc3"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/#_3","text":"","title":"\u67b6\u6784\u56fe"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/#cli","text":"\u7528\u6cd5\uff1a bin/mqadmin <\u547d\u4ee4> <\u53c2\u6570> \u547d\u4ee4\u5982\u4e0b\uff1a updateTopic Update or create topic deleteTopic Delete topic from broker and NameServer. updateSubGroup Update or create subscription group deleteSubGroup Delete subscription group from broker. updateBrokerConfig Update broker's config updateTopicPerm Update topic perm topicRoute Examine topic route info topicStatus Examine topic Status info topicClusterList get cluster info for topic brokerStatus Fetch broker runtime status data queryMsgById Query Message by Id queryMsgByKey Query Message by Key queryMsgByUniqueKey Query Message by Unique key queryMsgByOffset Query Message by offset printMsg Print Message Detail printMsgByQueue Print Message Detail sendMsgStatus send msg to broker. brokerConsumeStats Fetch broker consume stats data producerConnection Query producer's socket connection and client version consumerConnection Query consumer's socket connection, client version and subscription consumerProgress Query consumers's progress, speed consumerStatus Query consumer's internal data structure cloneGroupOffset clone offset from other group. clusterList List all of clusters topicList Fetch all topic list from name server updateKvConfig Create or update KV config. deleteKvConfig Delete KV config. wipeWritePerm Wipe write perm of broker in all name server resetOffsetByTime Reset consumer offset by timestamp(without client restart). updateOrderConf Create or update or delete order conf cleanExpiredCQ Clean expired ConsumeQueue on broker. cleanUnusedTopic Clean unused topic on broker. startMonitoring Start Monitoring statsAll Topic and Consumer tps stats allocateMQ Allocate MQ checkMsgSendRT check message send response time clusterRT List All clusters Message Send RT getNamesrvConfig Get configs of name server. updateNamesrvConfig Update configs of name server. getBrokerConfig Get broker config by cluster or special broker! queryCq Query cq command. sendMessage Send a message consumeMessage Consume message","title":"\u4f7f\u7528\uff08CLI\uff09"},{"location":"tech_tutorial/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/#_4","text":"\u5b98\u7f51 github\u6e90\u7801 \u5b98\u65b9docker \u5b98\u65b9Python\u5ba2\u6237\u7aef","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/acr/","text":"Alibaba Cloud Container Registry(ACR) \u963f\u91cc\u4e91\u5bb9\u5668\u955c\u50cf\u670d\u52a1 \u963f\u91cc\u5bf9\u4e2a\u4eba\u6709\u9650\u514d\u8d39\u7684\u5bb9\u5668\u955c\u50cf\u670d\u52a1\uff0c\u503c\u5f97\u5f00\u53d1\u8005\u62e5\u6709\uff5e \u5f00\u901a \u767b\u5f55\u5bb9\u5668\u955c\u50cf\u670d\u52a1\u63a7\u5236\u53f0\uff0c\u5b9e\u4f8b\u5217\u8868 \u521b\u5efa\u4e2a\u4eba\u7248 \u8bbe\u7f6e\u955c\u50cf\u4ed3\u5e93\u767b\u5f55\u5bc6\u7801 \uff08\u53ef\u9009\uff09\u8bbf\u95ee\u51ed\u8bc1\u91cc\u521b\u5efa\u56fa\u5b9a\u5bc6\u7801 \u521b\u5efa\u547d\u540d\u7a7a\u95f4\uff0c\u540d\u5b57\u5168\u5c40\u552f\u4e00 \u521b\u5efa\u955c\u50cf\u4ed3\u5e93\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2agit\u9879\u76ee \uff08\u53ef\u9009\uff09\u7ed1\u5b9a\u591a\u79cdgit\u670d\u52a1\u5546\uff0c\u5b9e\u73b0commit\u81ea\u52a8\u6784\u5efa \u4f7f\u7528 # \u65e0\u8bbapull\uff5cpush\uff0c\u90fd\u8981\u5148\u767b\u5165docker\u4ed3\u5e93\uff0c\u4f7f\u7528\u56fa\u5b9a\u5bc6\u7801 docker login --username=<\u4f60\u7684\u963f\u91cc\u4e91\u8d26\u53f7> registry.cn-shanghai.aliyuncs.com # \u5bf9\u8981\u63a8\u9001\u7684\u955c\u50cf\u6253tag\uff0c\u683c\u5f0f\uff1aregist\u57df\u540d/\u547d\u540d\u7a7a\u95f4/\u4ed3\u5e93\u540d\uff08\u5373\u5e94\u7528\u540d\uff09:\u955c\u50cf\u7248\u672c docker tag 532c4733c665 registry.cn-shanghai.aliyuncs.com/cyan-thinker/inf-etcd:v3.4.16 # \u6267\u884c\u63a8\u9001 docker push registry.cn-shanghai.aliyuncs.com/cyan-thinker/inf-etcd:v3.4.16","title":"Alibaba Cloud Container Registry(ACR) \u963f\u91cc\u4e91\u5bb9\u5668\u955c\u50cf\u670d\u52a1"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/acr/#alibaba-cloud-container-registryacr","text":"\u963f\u91cc\u5bf9\u4e2a\u4eba\u6709\u9650\u514d\u8d39\u7684\u5bb9\u5668\u955c\u50cf\u670d\u52a1\uff0c\u503c\u5f97\u5f00\u53d1\u8005\u62e5\u6709\uff5e","title":"Alibaba Cloud Container Registry(ACR) \u963f\u91cc\u4e91\u5bb9\u5668\u955c\u50cf\u670d\u52a1"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/acr/#_1","text":"\u767b\u5f55\u5bb9\u5668\u955c\u50cf\u670d\u52a1\u63a7\u5236\u53f0\uff0c\u5b9e\u4f8b\u5217\u8868 \u521b\u5efa\u4e2a\u4eba\u7248 \u8bbe\u7f6e\u955c\u50cf\u4ed3\u5e93\u767b\u5f55\u5bc6\u7801 \uff08\u53ef\u9009\uff09\u8bbf\u95ee\u51ed\u8bc1\u91cc\u521b\u5efa\u56fa\u5b9a\u5bc6\u7801 \u521b\u5efa\u547d\u540d\u7a7a\u95f4\uff0c\u540d\u5b57\u5168\u5c40\u552f\u4e00 \u521b\u5efa\u955c\u50cf\u4ed3\u5e93\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2agit\u9879\u76ee \uff08\u53ef\u9009\uff09\u7ed1\u5b9a\u591a\u79cdgit\u670d\u52a1\u5546\uff0c\u5b9e\u73b0commit\u81ea\u52a8\u6784\u5efa","title":"\u5f00\u901a"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/acr/#_2","text":"# \u65e0\u8bbapull\uff5cpush\uff0c\u90fd\u8981\u5148\u767b\u5165docker\u4ed3\u5e93\uff0c\u4f7f\u7528\u56fa\u5b9a\u5bc6\u7801 docker login --username=<\u4f60\u7684\u963f\u91cc\u4e91\u8d26\u53f7> registry.cn-shanghai.aliyuncs.com # \u5bf9\u8981\u63a8\u9001\u7684\u955c\u50cf\u6253tag\uff0c\u683c\u5f0f\uff1aregist\u57df\u540d/\u547d\u540d\u7a7a\u95f4/\u4ed3\u5e93\u540d\uff08\u5373\u5e94\u7528\u540d\uff09:\u955c\u50cf\u7248\u672c docker tag 532c4733c665 registry.cn-shanghai.aliyuncs.com/cyan-thinker/inf-etcd:v3.4.16 # \u6267\u884c\u63a8\u9001 docker push registry.cn-shanghai.aliyuncs.com/cyan-thinker/inf-etcd:v3.4.16","title":"\u4f7f\u7528"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/","text":"ossftp \u57fa\u4e8e\u963f\u91cc\u4e91\u5bf9\u8c61\u5b58\u50a8\u7684FTP\u670d\u52a1 \u7279\u70b9 \u63d0\u4f9b\u7ed9\u5185\u90e8\u7528\u6237\u80fd\u5feb\u901f\u4e0a\u4f20\u5927\u6587\u4ef6\u7684\u5b58\u50a8\u670d\u52a1 \u65e0\u9700\u9891\u7e41\u5f00\u901a\u4e91\u8d26\u53f7 \u517c\u5bb9FTP\u534f\u8bae \u5b89\u88c5 curl https://gosspublic.alicdn.com/ossftp/ossftp-1.2.0-linux-mac.zip -o ossftp.zip unzip ossftp.zip cd ossftp-1.2.0-linux-mac # \u53ef\u9009\uff0c\u5efa\u8bae\u4f7f\u7528virtualenv # \u6309\u5b9e\u9645\u9700\u6c42\u4fee\u6539config.json\uff0c\u53c2\u8003 <https://help.aliyun.com/document_detail/197500.html> # \u542f\u52a8 bash start.sh \u4f7f\u7528 \u672c\u5730desktop\u4f7f\u7528FileZilla\u4e0a\u4f20\u5927\u6587\u4ef6 FileZilla\u7ad9\u70b9\u8bbe\u7f6e \u4e0a\u4f20\u6548\u679c \u8fdc\u7a0b\u670d\u52a1\u5668\u4f7f\u7528\u5185\u7f6eftp\u547d\u4ee4\u4e0b\u8f7d\u6307\u5b9a\u6587\u4ef6 linux\u4e3b\u673a\u4e0b\u8f7d \u6ce8\u610f \u8fd9\u662f\u5185\u90e8\u529e\u516c\u65b9\u6848\uff0c\u4e0d\u9002\u5408\u90e8\u7f72\u5728\u516c\u7f51\u4e0a log\u6240\u5728\u8def\u5f84 ossftp\u5b89\u88c5\u76ee\u5f55/data/ossftp \u53c2\u8003 \u5b98\u65b9\u624b\u518c https://help.aliyun.com/document_detail/32189.html ftp\u547d\u4ee4\u8be6\u89e3 https://zh.wikipedia.org/wiki/FTP%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8","title":"ossftp \u57fa\u4e8e\u963f\u91cc\u4e91\u5bf9\u8c61\u5b58\u50a8\u7684FTP\u670d\u52a1"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/#ossftp-ftp","text":"","title":"ossftp \u57fa\u4e8e\u963f\u91cc\u4e91\u5bf9\u8c61\u5b58\u50a8\u7684FTP\u670d\u52a1"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/#_1","text":"\u63d0\u4f9b\u7ed9\u5185\u90e8\u7528\u6237\u80fd\u5feb\u901f\u4e0a\u4f20\u5927\u6587\u4ef6\u7684\u5b58\u50a8\u670d\u52a1 \u65e0\u9700\u9891\u7e41\u5f00\u901a\u4e91\u8d26\u53f7 \u517c\u5bb9FTP\u534f\u8bae","title":"\u7279\u70b9"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/#_2","text":"curl https://gosspublic.alicdn.com/ossftp/ossftp-1.2.0-linux-mac.zip -o ossftp.zip unzip ossftp.zip cd ossftp-1.2.0-linux-mac # \u53ef\u9009\uff0c\u5efa\u8bae\u4f7f\u7528virtualenv # \u6309\u5b9e\u9645\u9700\u6c42\u4fee\u6539config.json\uff0c\u53c2\u8003 <https://help.aliyun.com/document_detail/197500.html> # \u542f\u52a8 bash start.sh","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/#_3","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/#desktopfilezilla","text":"FileZilla\u7ad9\u70b9\u8bbe\u7f6e \u4e0a\u4f20\u6548\u679c","title":"\u672c\u5730desktop\u4f7f\u7528FileZilla\u4e0a\u4f20\u5927\u6587\u4ef6"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/#ftp","text":"linux\u4e3b\u673a\u4e0b\u8f7d","title":"\u8fdc\u7a0b\u670d\u52a1\u5668\u4f7f\u7528\u5185\u7f6eftp\u547d\u4ee4\u4e0b\u8f7d\u6307\u5b9a\u6587\u4ef6"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/#_4","text":"\u8fd9\u662f\u5185\u90e8\u529e\u516c\u65b9\u6848\uff0c\u4e0d\u9002\u5408\u90e8\u7f72\u5728\u516c\u7f51\u4e0a log\u6240\u5728\u8def\u5f84 ossftp\u5b89\u88c5\u76ee\u5f55/data/ossftp","title":"\u6ce8\u610f"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossftp/#_5","text":"\u5b98\u65b9\u624b\u518c https://help.aliyun.com/document_detail/32189.html ftp\u547d\u4ee4\u8be6\u89e3 https://zh.wikipedia.org/wiki/FTP%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossutil/","text":"ossutil \u963f\u91cc\u4e91\u5bf9\u8c61\u5b58\u50a8\u5de5\u5177 \u5b89\u88c5 wget http://gosspublic.alicdn.com/ossutil/1.7.6/ossutil64 chmod 755 ossutil64 ./ossutil64 config \u751f\u6210\u7684\u914d\u7f6e\u5982 \u4f7f\u7528 # ls ./ossutil64 ls # \u6279\u91cf\u4e0b\u8f7d ./ossutil64 cp -r oss://your_dir . --update","title":"ossutil \u963f\u91cc\u4e91\u5bf9\u8c61\u5b58\u50a8\u5de5\u5177"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossutil/#ossutil","text":"","title":"ossutil \u963f\u91cc\u4e91\u5bf9\u8c61\u5b58\u50a8\u5de5\u5177"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossutil/#_1","text":"wget http://gosspublic.alicdn.com/ossutil/1.7.6/ossutil64 chmod 755 ossutil64 ./ossutil64 config \u751f\u6210\u7684\u914d\u7f6e\u5982","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/ossutil/#_2","text":"# ls ./ossutil64 ls # \u6279\u91cf\u4e0b\u8f7d ./ossutil64 cp -r oss://your_dir . --update","title":"\u4f7f\u7528"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/seafile/","text":"Seafile \u5f00\u6e90\u7f51\u76d8 \u53c2\u8003 \u5b98\u7f51: https://www.seafile.com/home/ \u6587\u6863: https://cloud.seafile.com/published/seafile-manual-cn/docker/%E7%94%A8Docker%E9%83%A8%E7%BD%B2Seafile.md \u5b89\u88c5\u670d\u52a1\u7aef\uff08\u57fa\u4e8edocker\uff09 \u5b89\u88c5docker\uff0cdocker-compose \u65b0\u5efa\u76ee\u5f55 /opt/seafile \uff0c\u5728\u5176\u4e2d\u65b0\u5efa\u4ee5\u4e0b docker-compose.yml services: db: image: mariadb:10.11 container_name: seafile-mysql environment: - MYSQL_ROOT_PASSWORD=db_dev # Requested, set the root's password of MySQL service. - MYSQL_LOG_CONSOLE=true volumes: - /opt/seafile-mysql/db:/var/lib/mysql # Requested, specifies the path to MySQL data persistent store. networks: - seafile-net memcached: image: memcached:1.6 container_name: seafile-memcached entrypoint: memcached -m 256 networks: - seafile-net seafile: image: seafileltd/seafile-mc:10.0.1 container_name: seafile ports: - \"18888:80\" # \u4e00\u822c80\u7aef\u53e3\u88ab\u5c01\u7684\u5389\u5bb3\uff0c\u81ea\u5df1\u5f00\u4e00\u4e2a\u559c\u6b22\u7684http\u7aef\u53e3 # - \"443:443\" # If https is enabled, cancel the comment. volumes: - /opt/seafile-data:/shared # Requested, specifies the path to Seafile data persistent store. environment: - DB_HOST=db - DB_ROOT_PASSWD=db_dev # Requested, the value shuold be root's password of MySQL service. - TIME_ZONE=Asia/Shanghai # Optional, default is UTC. Should be uncomment and set to your local time zone. - SEAFILE_ADMIN_EMAIL=me@example.com # Specifies Seafile admin user, default is 'me@example.com'. - SEAFILE_ADMIN_PASSWORD=asecret # Specifies Seafile admin password, default is 'asecret'. - SEAFILE_SERVER_LETSENCRYPT=false # Whether use letsencrypt to generate cert. - SEAFILE_SERVER_HOSTNAME=seafile.example.com # Specifies your host name. depends_on: - db - memcached networks: - seafile-net networks: seafile-net: \u542f\u52a8 docker compose up -d \u8bbf\u95ee http://{\u4f60\u7684\u5916\u7f51IP}:18888 \uff0c\u7528SEAFILE_ADMIN_EMAIL\u767b\u5f55 \u5b89\u88c5\u5ba2\u670d\u7aef \u4e0b\u8f7d\u5b98\u65b9\u5ba2\u6237\u7aef https://www.seafile.com/download/","title":"Seafile \u5f00\u6e90\u7f51\u76d8"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/seafile/#seafile","text":"","title":"Seafile \u5f00\u6e90\u7f51\u76d8"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/seafile/#_1","text":"\u5b98\u7f51: https://www.seafile.com/home/ \u6587\u6863: https://cloud.seafile.com/published/seafile-manual-cn/docker/%E7%94%A8Docker%E9%83%A8%E7%BD%B2Seafile.md","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/seafile/#docker","text":"\u5b89\u88c5docker\uff0cdocker-compose \u65b0\u5efa\u76ee\u5f55 /opt/seafile \uff0c\u5728\u5176\u4e2d\u65b0\u5efa\u4ee5\u4e0b docker-compose.yml services: db: image: mariadb:10.11 container_name: seafile-mysql environment: - MYSQL_ROOT_PASSWORD=db_dev # Requested, set the root's password of MySQL service. - MYSQL_LOG_CONSOLE=true volumes: - /opt/seafile-mysql/db:/var/lib/mysql # Requested, specifies the path to MySQL data persistent store. networks: - seafile-net memcached: image: memcached:1.6 container_name: seafile-memcached entrypoint: memcached -m 256 networks: - seafile-net seafile: image: seafileltd/seafile-mc:10.0.1 container_name: seafile ports: - \"18888:80\" # \u4e00\u822c80\u7aef\u53e3\u88ab\u5c01\u7684\u5389\u5bb3\uff0c\u81ea\u5df1\u5f00\u4e00\u4e2a\u559c\u6b22\u7684http\u7aef\u53e3 # - \"443:443\" # If https is enabled, cancel the comment. volumes: - /opt/seafile-data:/shared # Requested, specifies the path to Seafile data persistent store. environment: - DB_HOST=db - DB_ROOT_PASSWD=db_dev # Requested, the value shuold be root's password of MySQL service. - TIME_ZONE=Asia/Shanghai # Optional, default is UTC. Should be uncomment and set to your local time zone. - SEAFILE_ADMIN_EMAIL=me@example.com # Specifies Seafile admin user, default is 'me@example.com'. - SEAFILE_ADMIN_PASSWORD=asecret # Specifies Seafile admin password, default is 'asecret'. - SEAFILE_SERVER_LETSENCRYPT=false # Whether use letsencrypt to generate cert. - SEAFILE_SERVER_HOSTNAME=seafile.example.com # Specifies your host name. depends_on: - db - memcached networks: - seafile-net networks: seafile-net: \u542f\u52a8 docker compose up -d \u8bbf\u95ee http://{\u4f60\u7684\u5916\u7f51IP}:18888 \uff0c\u7528SEAFILE_ADMIN_EMAIL\u767b\u5f55","title":"\u5b89\u88c5\u670d\u52a1\u7aef\uff08\u57fa\u4e8edocker\uff09"},{"location":"tech_tutorial/%E4%BA%91%E5%8E%9F%E7%94%9F/seafile/#_2","text":"\u4e0b\u8f7d\u5b98\u65b9\u5ba2\u6237\u7aef https://www.seafile.com/download/","title":"\u5b89\u88c5\u5ba2\u670d\u7aef"},{"location":"tech_tutorial/%E5%A4%A7%E6%95%B0%E6%8D%AE/cdh_install/","text":"Cloudera Distribution Hadoop\uff08CDH\uff09\u5b89\u88c5\u6559\u7a0b \u57fa\u4e8e6.1.1\u7248\u672c\uff0c\u5c0f\u578b\u96c6\u7fa4\uff0820\u4e2a\u8282\u70b9\uff09 \u53c2\u8003 \u5b98\u65b9\u624b\u518c\uff1a https://www.cloudera.com/documentation/enterprise/6/6.1/topics/installation.html \u73af\u5883\u8981\u6c42 \u786c\u4ef6 \u5b58\u50a8 /usr 1GB /var > 200GB /opt > 15GB / > 100 GB \u6302\u8f7d\u786c\u76d8\u5206\u533a < 12 * 8TB\uff08\u5355\u4e2aDN < 100TB\uff0c\u5355\u5206\u533a < 8TB\uff09 \u6587\u4ef6\u683c\u5f0f ext3, ext4 CPU > 4Core\uff0c\u5efa\u8bae 16Core\u4ee5\u4e0a \u5185\u5b58 > 32GB\uff0c\u5efa\u8bae 60GB\u4ee5\u4e0a \u8f6f\u4ef6 OS CentOS 7.2~7.6; Ubuntu 16.04 /etc/fstab\u7981\u7528atime\uff0c\u5982 /dev/sdb1 /data1 ext4 defaults,noatime 0 \u91cd\u542f\u81ea\u52a8\u6302\u8f7d mount -o remount /data1 /etc/security/limits.d/20-nproc.conf\u653e\u5927 * soft nproc 655350 /etc/hosts\u652f\u6301\u591a\u57df\u540d\uff0c\u5c0f\u5199\uff0c\u5982 192.168.1.1 cluster-01 \u5173\u95edSELinux \u5173\u95ed\u9632\u706b\u5899\uff0c\u5982iptables /etc/sysconfig/network\u7ed1\u5b9ahostname\uff0c\u5982 HOSTNAME=cluster-01 DB MySQL 5.7; PostgreSQL 9.4+; Oracle 12.2 JDK 1.8u31+ \u5806\u5185\u5b58 20GB \uff08HDFS|YARN\uff1a200\u4e3b\u673a\uff0c4000\u5b9e\u4f8b\uff1bHBase|Kafka\uff1a100\u4e3b\u673a\uff0c3w\u5b9e\u4f8b\uff09 \u975e\u5806\u5185\u5b58 12GB Python 2.7 python-psycopg2 iproute-3.10 \u5b89\u88c5 \u4e3b\u673a\u9884\u521d\u59cb\u5316 # yum\u5b89\u88c5 yum -y install epel-release yum -y install vim unzip zip lrzsz tmux httpd zabbix-agent # py\u5b89\u88c5\uff0c\u955c\u50cf\u52a0\u901f easy_install -i https://pypi.tuna.tsinghua.edu.cn/simple pip #################### # \u7ed1\u5b9ahostname hostname {\u6309\u5b9e\u9645\u66ff\u6362\u4e3a\u5185\u90e8hostname} export hname=$(hostname) export ip=$(ifconfig | grep inet | grep -v '127.0.0.1' | awk '{print $2}') echo \"$ip $hname\" >> /etc/hosts sed -i \"s/^HOSTNAME.*$/HOSTNAME=$hname/g\" /etc/sysconfig/network echo -e \"`hostname`\" # \u4fee\u6539/etc/hosts\uff0c\u52a0\u5165\u96c6\u7fa4\u76f8\u5173ip\u548c\u5bf9\u5e94\u5185\u90e8\u57df\u540d \u7565 # ulimit # ulimit -HSn 65535 # echo \"ulimit -HSn 65535\" >> /etc/rc.local # \u9002\u7528centos7 sed -i \"s/4096/65535/g\" /etc/security/limits.d/20-nproc.conf # \u7edf\u4e00\u65f6\u533a\uff1a\u4e1c8\u533a (date -R) # ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime # ntp\u65f6\u949f echo \"*/10 * * * * /usr/sbin/ntpdate -u {\u4f60\u7684ntp\u670d\u52a1\u5730\u5740} > /dev/null 2>&1\" >> /var/spool/cron/root # \u5b89\u88c5\u76d1\u63a7 # \u5173\u95ed\u9632\u706b\u5899 systemctl stop firewalld.service systemctl disable firewalld.service # \u4fee\u6539/etc/selinux/config\uff0c\u5173\u95edSELinux\uff08SELINUX=disabled\uff09\u7565 # yum install -y zabbix-agent sed -i 's!Server=.*!Server={\u4f60\u7684zabbix\u670d\u52a1ip}!' /usr/local/zabbix/etc/zabbix_agentd.conf sed -i 's!ServerActive=.*!ServerActive={\u4f60\u7684zabbix\u670d\u52a1ip}!' /usr/local/zabbix/etc/zabbix_agentd.conf service zabbix_agentd restart # \u4e0azabbix\u5e73\u53f0\uff0c\u786e\u8ba4\u4e3b\u673a\u81ea\u52a8\u53d1\u73b0 # \u8bbe\u7f6eswap\uff08/proc/sys/vm/swappiness \u9ed8\u8ba460 => 10\uff09\u4e3a\u79ef\u6781\u4f7f\u7528\u7269\u7406\u5185\u5b58 echo \"vm.swappiness = 10\" >> /etc/sysctl.conf # \u7981\u7528\u900f\u660e\u5927\u9875\uff08rh6\u5f15\u5165\uff0c\u7ba1\u7406\u5185\u5b58\u662f\u52a8\u6001\u5206\u914d\u7684\u65b9\u5f0f\uff0c\u5728real application clusters\u73af\u5883\u4e0b\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u5f02\u5e38\u7684\u6027\u80fd\u95ee\u9898\uff09 echo never > /sys/kernel/mm/transparent_hugepage/defrag echo never > /sys/kernel/mm/transparent_hugepage/enabled # \u7f16\u8f91/etc/rc.d/rc.local\uff0c\u52a0\u5165 if test -f /sys/kernel/mm/transparent_hugepage/enabled; then echo never > /sys/kernel/mm/transparent_hugepage/enabled fi if test -f /sys/kernel/mm/transparent_hugepage/defrag; then echo never > /sys/kernel/mm/transparent_hugepage/defrag fi # \u786e\u8ba4/etc/rc.d/rc.local\u53ef\u6267\u884c chmod +x /etc/rc.d/rc.local # httpd\u5f00\u673a\u542f\u52a8 systemctl start httpd systemctl enable httpd.service #################### # \u6dfb\u52a0\u64cd\u4f5c\u7528\u6237cdhtool\u8fdbroot\u7ec4 adduser cdhtool usermod -a -G root cdhtool echo -e \"`id cdhtool`\" # \u5f00cdhtool\u514d\u5bc6 vim /etc/sudoers # \u6700\u540e\u884c\u6dfb\u52a0\uff0cwq!\u4fdd\u5b58 cdhtool ALL=(ALL) NOPASSWD:ALL # \u8bbe\u7f6e\u76ee\u5f55\u6743\u9650 mkdir -p /opt/software chown cdhtool:cdhtool -R /opt/software/ # datanode\u4e0a\uff0c\u6570\u636e\u76d8\u505araid0\uff0c\u5e76\u6302\u8f7d/data # \u91cd\u542f reboot #################### \u540e\u7eed\u5b89\u88c5\u4ee5cdhtool\u4e3a\u4e3b su - cdhtool # \u4e2d\u63a7key\u590d\u5236\u5230\u6bcf\u4e2a\u8282\u70b9\u4e3b\u673a\u4e0a mkdir .ssh echo '{\u4f60\u7684\u4e2d\u63a7\u516c\u94a5}' >> ~/.ssh/authorized_keys chmod 700 ~/.ssh/ chmod 600 ~/.ssh/authorized_keys #################### # \u4e0b\u8f7d\u76f8\u5173\u8f6f\u4ef6 mkdir -p /opt/software cd /opt/software # mysql5.7 wget https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz # cloudera manager wget https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-agent-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-server-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-daemons-6.1.1-853290.el7.x86_64.rpm https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-server-db-2-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/enterprise-debuginfo-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm wget https://archive.cloudera.com/cm6/6.1.1/allkeys.asc # cdh6 wget https://archive.cloudera.com/cdh6/6.1.1/parcels/CDH-6.1.1-1.cdh6.1.1.p0.875250-el7.parcel \\ https://archive.cloudera.com/cdh6/6.1.1/parcels/CDH-6.1.1-1.cdh6.1.1.p0.875250-el7.parcel.sha256 \\ https://archive.cloudera.com/cdh6/6.1.1/parcels/manifest.json #################### \u6240\u6709\u8282\u70b9\u5b89\u88c5jdk # \u4ee5root\u5b89\u88c5jkd8 rpm -ivh jdk-8u181-linux-x64.rpm echo '# jdk8' >> /etc/profile && echo 'export JAVA_HOME=/usr/java/jdk1.8.0_181-amd64' >> /etc/profile && echo 'export JRE_HOME=${JAVA_HOME}/jre' >> /etc/profile && echo 'export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib:$CLASSPATH' >> /etc/profile && echo 'export JAVA_PATH=${JAVA_HOME}/bin:${JRE_HOME}/bin' >> /etc/profile && echo 'export PATH=$PATH:${JAVA_PATH}' >> /etc/profile && source /etc/profile # \u9a8c\u8bc1\u7248\u672c javac -version #################### namenode\u5b89\u88c5mysql # \u51c6\u5907\u76ee\u5f55 mkdir -p /usr/local/mysql /data/mysql/mysql3306 /data/log/mysql/mysql3306/mysql-bin /data/log/mysql/mysql3306/tmp touch /data/log/mysql/mysql3306/error.log touch /data/log/mysql/mysql3306/slow.log # \u5b89\u88c5 tar -xzvf mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz -C /usr/local/mysql --strip-components 1 tree /usr/local/mysql/ -C -L 2 # \u52a0\u7528\u6237\u548c\u6388\u6743 groupadd mysql useradd -r -s /sbin/nologin -g mysql mysql -d /usr/local/mysql chown -R mysql:mysql /usr/local/mysql /data/mysql /data/log/mysql # \u521d\u59cb\u5316\u5e93\uff0c\u4fdd\u5b58\u5bc6\u7801 /usr/local/mysql/bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/data/mysql/mysql3306 # \u5982\u679c\u62a5\u9519\uff0c\u5982\uff1amysqld: error while loading shared libraries: libnuma.so.1: cannot open shared object file: No such file or directory\uff0c\u8bf7\u5b89\u88c5\u76f8\u5173\u7ec4\u4ef6\uff0c\u5982\u4e0b yum install numactl \u914d\u7f6eMySQL # mysql\u5f00\u673a\u542f\u52a8 cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql # \u7f16\u8f91/etc/init.d/mysql\uff0c\u6307\u5b9a\u76f8\u5173\u76ee\u5f55\uff0c\u5982\u4e0b\uff1a basedir=/usr/local/mysql datadir=/data/mysql/mysql3306 # end # \u7f16\u8f91/etc/my.cnf\uff0c\u5982\u4e0b\uff1a [client] port=3306 socket=/tmp/mysql.sock [mysql] prompt=\"\\\\u@\\\\h [\\\\d]>\" [mysqld] datadir=/data/mysql/mysql3306 tmpdir=/data/log/mysql/mysql3306/tmp socket=/tmp/mysql.sock character-set-server=utf8 # db\u670d\u52a1\u96c6\u7fa4\u4e2d\u552f\u4e00id\uff0c\u5907\u673a\u6ce8\u610f\u4fee\u6539 server-id=13306 # binlog gtid_mode=off enforce_gtid_consistency=off master_info_repository=table log_slave_updates=on log-bin=/data/log/mysql/mysql3306/mysql-bin log-error=/data/log/mysql/mysql3306/error.log binlog_format=MIXED # \u5907\u5e93\u65e0\u9700\u672c\u884c # slow sql slow_query_log=1 slow_query_log_file=/data/log/mysql/mysql3306/slow.log long_query_time=0.1 lower_case_table_names=0 sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES # \u914d\u7f6e\u4e2d\u51fa\u73b0mariadb\u7684\u5730\u65b9\uff0c\u6ce8\u610f\u5bf9\u5e94\u4fee\u6539 # end # \u73af\u5883\u53d8\u91cf echo \"export PATH=$PATH:/usr/local/mysql/bin\" >> /etc/profile source /etc/profile # \u81ea\u542f service mysql start chkconfig --add mysql chkconfig --level 345 mysql on # \u6388\u6743 mysql -hlocalhost -uroot -p # \u8f93\u5165\u521d\u59cb\u5bc6\u7801 MySQL\u4e2d\u64cd\u4f5c\uff1a -- \u66f4\u65b0root\u5bc6\u7801 set password=password('{\u65b0root\u5bc6\u7801}'); grant all privileges on *.* to 'root'@'%' identified by '{\u65b0root\u5bc6\u7801}'; flush privileges;","title":"Cloudera Distribution Hadoop\uff08CDH\uff09\u5b89\u88c5\u6559\u7a0b"},{"location":"tech_tutorial/%E5%A4%A7%E6%95%B0%E6%8D%AE/cdh_install/#cloudera-distribution-hadoopcdh","text":"\u57fa\u4e8e6.1.1\u7248\u672c\uff0c\u5c0f\u578b\u96c6\u7fa4\uff0820\u4e2a\u8282\u70b9\uff09","title":"Cloudera Distribution Hadoop\uff08CDH\uff09\u5b89\u88c5\u6559\u7a0b"},{"location":"tech_tutorial/%E5%A4%A7%E6%95%B0%E6%8D%AE/cdh_install/#_1","text":"\u5b98\u65b9\u624b\u518c\uff1a https://www.cloudera.com/documentation/enterprise/6/6.1/topics/installation.html","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E5%A4%A7%E6%95%B0%E6%8D%AE/cdh_install/#_2","text":"\u786c\u4ef6 \u5b58\u50a8 /usr 1GB /var > 200GB /opt > 15GB / > 100 GB \u6302\u8f7d\u786c\u76d8\u5206\u533a < 12 * 8TB\uff08\u5355\u4e2aDN < 100TB\uff0c\u5355\u5206\u533a < 8TB\uff09 \u6587\u4ef6\u683c\u5f0f ext3, ext4 CPU > 4Core\uff0c\u5efa\u8bae 16Core\u4ee5\u4e0a \u5185\u5b58 > 32GB\uff0c\u5efa\u8bae 60GB\u4ee5\u4e0a \u8f6f\u4ef6 OS CentOS 7.2~7.6; Ubuntu 16.04 /etc/fstab\u7981\u7528atime\uff0c\u5982 /dev/sdb1 /data1 ext4 defaults,noatime 0 \u91cd\u542f\u81ea\u52a8\u6302\u8f7d mount -o remount /data1 /etc/security/limits.d/20-nproc.conf\u653e\u5927 * soft nproc 655350 /etc/hosts\u652f\u6301\u591a\u57df\u540d\uff0c\u5c0f\u5199\uff0c\u5982 192.168.1.1 cluster-01 \u5173\u95edSELinux \u5173\u95ed\u9632\u706b\u5899\uff0c\u5982iptables /etc/sysconfig/network\u7ed1\u5b9ahostname\uff0c\u5982 HOSTNAME=cluster-01 DB MySQL 5.7; PostgreSQL 9.4+; Oracle 12.2 JDK 1.8u31+ \u5806\u5185\u5b58 20GB \uff08HDFS|YARN\uff1a200\u4e3b\u673a\uff0c4000\u5b9e\u4f8b\uff1bHBase|Kafka\uff1a100\u4e3b\u673a\uff0c3w\u5b9e\u4f8b\uff09 \u975e\u5806\u5185\u5b58 12GB Python 2.7 python-psycopg2 iproute-3.10","title":"\u73af\u5883\u8981\u6c42"},{"location":"tech_tutorial/%E5%A4%A7%E6%95%B0%E6%8D%AE/cdh_install/#_3","text":"","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E5%A4%A7%E6%95%B0%E6%8D%AE/cdh_install/#_4","text":"# yum\u5b89\u88c5 yum -y install epel-release yum -y install vim unzip zip lrzsz tmux httpd zabbix-agent # py\u5b89\u88c5\uff0c\u955c\u50cf\u52a0\u901f easy_install -i https://pypi.tuna.tsinghua.edu.cn/simple pip #################### # \u7ed1\u5b9ahostname hostname {\u6309\u5b9e\u9645\u66ff\u6362\u4e3a\u5185\u90e8hostname} export hname=$(hostname) export ip=$(ifconfig | grep inet | grep -v '127.0.0.1' | awk '{print $2}') echo \"$ip $hname\" >> /etc/hosts sed -i \"s/^HOSTNAME.*$/HOSTNAME=$hname/g\" /etc/sysconfig/network echo -e \"`hostname`\" # \u4fee\u6539/etc/hosts\uff0c\u52a0\u5165\u96c6\u7fa4\u76f8\u5173ip\u548c\u5bf9\u5e94\u5185\u90e8\u57df\u540d \u7565 # ulimit # ulimit -HSn 65535 # echo \"ulimit -HSn 65535\" >> /etc/rc.local # \u9002\u7528centos7 sed -i \"s/4096/65535/g\" /etc/security/limits.d/20-nproc.conf # \u7edf\u4e00\u65f6\u533a\uff1a\u4e1c8\u533a (date -R) # ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime # ntp\u65f6\u949f echo \"*/10 * * * * /usr/sbin/ntpdate -u {\u4f60\u7684ntp\u670d\u52a1\u5730\u5740} > /dev/null 2>&1\" >> /var/spool/cron/root # \u5b89\u88c5\u76d1\u63a7 # \u5173\u95ed\u9632\u706b\u5899 systemctl stop firewalld.service systemctl disable firewalld.service # \u4fee\u6539/etc/selinux/config\uff0c\u5173\u95edSELinux\uff08SELINUX=disabled\uff09\u7565 # yum install -y zabbix-agent sed -i 's!Server=.*!Server={\u4f60\u7684zabbix\u670d\u52a1ip}!' /usr/local/zabbix/etc/zabbix_agentd.conf sed -i 's!ServerActive=.*!ServerActive={\u4f60\u7684zabbix\u670d\u52a1ip}!' /usr/local/zabbix/etc/zabbix_agentd.conf service zabbix_agentd restart # \u4e0azabbix\u5e73\u53f0\uff0c\u786e\u8ba4\u4e3b\u673a\u81ea\u52a8\u53d1\u73b0 # \u8bbe\u7f6eswap\uff08/proc/sys/vm/swappiness \u9ed8\u8ba460 => 10\uff09\u4e3a\u79ef\u6781\u4f7f\u7528\u7269\u7406\u5185\u5b58 echo \"vm.swappiness = 10\" >> /etc/sysctl.conf # \u7981\u7528\u900f\u660e\u5927\u9875\uff08rh6\u5f15\u5165\uff0c\u7ba1\u7406\u5185\u5b58\u662f\u52a8\u6001\u5206\u914d\u7684\u65b9\u5f0f\uff0c\u5728real application clusters\u73af\u5883\u4e0b\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u5f02\u5e38\u7684\u6027\u80fd\u95ee\u9898\uff09 echo never > /sys/kernel/mm/transparent_hugepage/defrag echo never > /sys/kernel/mm/transparent_hugepage/enabled # \u7f16\u8f91/etc/rc.d/rc.local\uff0c\u52a0\u5165 if test -f /sys/kernel/mm/transparent_hugepage/enabled; then echo never > /sys/kernel/mm/transparent_hugepage/enabled fi if test -f /sys/kernel/mm/transparent_hugepage/defrag; then echo never > /sys/kernel/mm/transparent_hugepage/defrag fi # \u786e\u8ba4/etc/rc.d/rc.local\u53ef\u6267\u884c chmod +x /etc/rc.d/rc.local # httpd\u5f00\u673a\u542f\u52a8 systemctl start httpd systemctl enable httpd.service #################### # \u6dfb\u52a0\u64cd\u4f5c\u7528\u6237cdhtool\u8fdbroot\u7ec4 adduser cdhtool usermod -a -G root cdhtool echo -e \"`id cdhtool`\" # \u5f00cdhtool\u514d\u5bc6 vim /etc/sudoers # \u6700\u540e\u884c\u6dfb\u52a0\uff0cwq!\u4fdd\u5b58 cdhtool ALL=(ALL) NOPASSWD:ALL # \u8bbe\u7f6e\u76ee\u5f55\u6743\u9650 mkdir -p /opt/software chown cdhtool:cdhtool -R /opt/software/ # datanode\u4e0a\uff0c\u6570\u636e\u76d8\u505araid0\uff0c\u5e76\u6302\u8f7d/data # \u91cd\u542f reboot #################### \u540e\u7eed\u5b89\u88c5\u4ee5cdhtool\u4e3a\u4e3b su - cdhtool # \u4e2d\u63a7key\u590d\u5236\u5230\u6bcf\u4e2a\u8282\u70b9\u4e3b\u673a\u4e0a mkdir .ssh echo '{\u4f60\u7684\u4e2d\u63a7\u516c\u94a5}' >> ~/.ssh/authorized_keys chmod 700 ~/.ssh/ chmod 600 ~/.ssh/authorized_keys #################### # \u4e0b\u8f7d\u76f8\u5173\u8f6f\u4ef6 mkdir -p /opt/software cd /opt/software # mysql5.7 wget https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz # cloudera manager wget https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-agent-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-server-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-daemons-6.1.1-853290.el7.x86_64.rpm https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-server-db-2-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/enterprise-debuginfo-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm wget https://archive.cloudera.com/cm6/6.1.1/allkeys.asc # cdh6 wget https://archive.cloudera.com/cdh6/6.1.1/parcels/CDH-6.1.1-1.cdh6.1.1.p0.875250-el7.parcel \\ https://archive.cloudera.com/cdh6/6.1.1/parcels/CDH-6.1.1-1.cdh6.1.1.p0.875250-el7.parcel.sha256 \\ https://archive.cloudera.com/cdh6/6.1.1/parcels/manifest.json #################### \u6240\u6709\u8282\u70b9\u5b89\u88c5jdk # \u4ee5root\u5b89\u88c5jkd8 rpm -ivh jdk-8u181-linux-x64.rpm echo '# jdk8' >> /etc/profile && echo 'export JAVA_HOME=/usr/java/jdk1.8.0_181-amd64' >> /etc/profile && echo 'export JRE_HOME=${JAVA_HOME}/jre' >> /etc/profile && echo 'export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib:$CLASSPATH' >> /etc/profile && echo 'export JAVA_PATH=${JAVA_HOME}/bin:${JRE_HOME}/bin' >> /etc/profile && echo 'export PATH=$PATH:${JAVA_PATH}' >> /etc/profile && source /etc/profile # \u9a8c\u8bc1\u7248\u672c javac -version #################### namenode\u5b89\u88c5mysql # \u51c6\u5907\u76ee\u5f55 mkdir -p /usr/local/mysql /data/mysql/mysql3306 /data/log/mysql/mysql3306/mysql-bin /data/log/mysql/mysql3306/tmp touch /data/log/mysql/mysql3306/error.log touch /data/log/mysql/mysql3306/slow.log # \u5b89\u88c5 tar -xzvf mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz -C /usr/local/mysql --strip-components 1 tree /usr/local/mysql/ -C -L 2 # \u52a0\u7528\u6237\u548c\u6388\u6743 groupadd mysql useradd -r -s /sbin/nologin -g mysql mysql -d /usr/local/mysql chown -R mysql:mysql /usr/local/mysql /data/mysql /data/log/mysql # \u521d\u59cb\u5316\u5e93\uff0c\u4fdd\u5b58\u5bc6\u7801 /usr/local/mysql/bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/data/mysql/mysql3306 # \u5982\u679c\u62a5\u9519\uff0c\u5982\uff1amysqld: error while loading shared libraries: libnuma.so.1: cannot open shared object file: No such file or directory\uff0c\u8bf7\u5b89\u88c5\u76f8\u5173\u7ec4\u4ef6\uff0c\u5982\u4e0b yum install numactl \u914d\u7f6eMySQL # mysql\u5f00\u673a\u542f\u52a8 cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql # \u7f16\u8f91/etc/init.d/mysql\uff0c\u6307\u5b9a\u76f8\u5173\u76ee\u5f55\uff0c\u5982\u4e0b\uff1a basedir=/usr/local/mysql datadir=/data/mysql/mysql3306 # end # \u7f16\u8f91/etc/my.cnf\uff0c\u5982\u4e0b\uff1a [client] port=3306 socket=/tmp/mysql.sock [mysql] prompt=\"\\\\u@\\\\h [\\\\d]>\" [mysqld] datadir=/data/mysql/mysql3306 tmpdir=/data/log/mysql/mysql3306/tmp socket=/tmp/mysql.sock character-set-server=utf8 # db\u670d\u52a1\u96c6\u7fa4\u4e2d\u552f\u4e00id\uff0c\u5907\u673a\u6ce8\u610f\u4fee\u6539 server-id=13306 # binlog gtid_mode=off enforce_gtid_consistency=off master_info_repository=table log_slave_updates=on log-bin=/data/log/mysql/mysql3306/mysql-bin log-error=/data/log/mysql/mysql3306/error.log binlog_format=MIXED # \u5907\u5e93\u65e0\u9700\u672c\u884c # slow sql slow_query_log=1 slow_query_log_file=/data/log/mysql/mysql3306/slow.log long_query_time=0.1 lower_case_table_names=0 sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES # \u914d\u7f6e\u4e2d\u51fa\u73b0mariadb\u7684\u5730\u65b9\uff0c\u6ce8\u610f\u5bf9\u5e94\u4fee\u6539 # end # \u73af\u5883\u53d8\u91cf echo \"export PATH=$PATH:/usr/local/mysql/bin\" >> /etc/profile source /etc/profile # \u81ea\u542f service mysql start chkconfig --add mysql chkconfig --level 345 mysql on # \u6388\u6743 mysql -hlocalhost -uroot -p # \u8f93\u5165\u521d\u59cb\u5bc6\u7801 MySQL\u4e2d\u64cd\u4f5c\uff1a -- \u66f4\u65b0root\u5bc6\u7801 set password=password('{\u65b0root\u5bc6\u7801}'); grant all privileges on *.* to 'root'@'%' identified by '{\u65b0root\u5bc6\u7801}'; flush privileges;","title":"\u4e3b\u673a\u9884\u521d\u59cb\u5316"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/chrome/","text":"Chrome\u6d4f\u89c8\u5668 \u5e38\u7528\u8bbe\u7f6e \u5173\u95ed\u8be5\u6b7b\u7684\u81ea\u52a8\u66f4\u65b0\u63d0\u793a \u4f5c\u4e3a\u6709\u70b9\u5f3a\u8feb\u75c7\u503e\u5411\u7684\u5de5\u7a0b\u5e08\uff0c\u770b\u5230\u6d4f\u89c8\u5668\u53f3\u4e0a\u89d2\u7684\u66f4\u65b0\u7ea2\u8272\u63d0\u793a\uff0c\u5c31\u4e0d\u660e\u7684\u70e6\u8e81\uff0c\u8fd9\u91cc\u8bf4\u660e\u5982\u4f55\u5728Mac\u91cc\u5e72\u6389ta \u8fdb\u5165 ~/Library/Google/GoogleSoftwareUpdate \u76ee\u5f55 mv GoogleSoftwareUpdate.bundle/ GoogleSoftwareUpdate.bundle.bak \u91cd\u547d\u540d\u6216\u8005\u5220\u6389\u8be5\u5b50\u76ee\u5f55 \u91cd\u542fChrome\uff0c\u8fd9\u4e2a\u4e16\u754c\u6e05\u51c0\u4e86 ;-)","title":"Chrome\u6d4f\u89c8\u5668"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/chrome/#chrome","text":"","title":"Chrome\u6d4f\u89c8\u5668"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/chrome/#_1","text":"","title":"\u5e38\u7528\u8bbe\u7f6e"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/chrome/#_2","text":"\u4f5c\u4e3a\u6709\u70b9\u5f3a\u8feb\u75c7\u503e\u5411\u7684\u5de5\u7a0b\u5e08\uff0c\u770b\u5230\u6d4f\u89c8\u5668\u53f3\u4e0a\u89d2\u7684\u66f4\u65b0\u7ea2\u8272\u63d0\u793a\uff0c\u5c31\u4e0d\u660e\u7684\u70e6\u8e81\uff0c\u8fd9\u91cc\u8bf4\u660e\u5982\u4f55\u5728Mac\u91cc\u5e72\u6389ta \u8fdb\u5165 ~/Library/Google/GoogleSoftwareUpdate \u76ee\u5f55 mv GoogleSoftwareUpdate.bundle/ GoogleSoftwareUpdate.bundle.bak \u91cd\u547d\u540d\u6216\u8005\u5220\u6389\u8be5\u5b50\u76ee\u5f55 \u91cd\u542fChrome\uff0c\u8fd9\u4e2a\u4e16\u754c\u6e05\u51c0\u4e86 ;-)","title":"\u5173\u95ed\u8be5\u6b7b\u7684\u81ea\u52a8\u66f4\u65b0\u63d0\u793a"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/cloudnote/","text":"\u4e91\u7b14\u8bb0\u65b9\u6848 \u5728\u7ebf\u670d\u52a1 \u5370\u8c61\u7b14\u8bb0 : \u8001\u724c\uff0c\u8de8\u5e73\u53f0\uff0c\u652f\u6301\u5bfc\u51fa\uff0c\u56fd\u5185\u7248\u5403\u76f8\u6bd4\u8f83\u96be\u770b \u81ea\u5efa Joplin + iCloud GitHub\u5b98\u7f51(https://github.com/laurent22/joplin)\u4e0b\u8f7d\u6700\u65b0dmg\uff0c\u5e76\u5b89\u88c5 \u663e\u793a\u4e2d\u6587 \u9996\u9009\u9879-\u901a\u7528-\u8bed\u8a00 \u540c\u6b65\u6307\u5b9aiCloud\u76ee\u5f55","title":"\u4e91\u7b14\u8bb0\u65b9\u6848"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/cloudnote/#_1","text":"","title":"\u4e91\u7b14\u8bb0\u65b9\u6848"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/cloudnote/#_2","text":"\u5370\u8c61\u7b14\u8bb0 : \u8001\u724c\uff0c\u8de8\u5e73\u53f0\uff0c\u652f\u6301\u5bfc\u51fa\uff0c\u56fd\u5185\u7248\u5403\u76f8\u6bd4\u8f83\u96be\u770b","title":"\u5728\u7ebf\u670d\u52a1"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/cloudnote/#_3","text":"","title":"\u81ea\u5efa"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/cloudnote/#joplin-icloud","text":"GitHub\u5b98\u7f51(https://github.com/laurent22/joplin)\u4e0b\u8f7d\u6700\u65b0dmg\uff0c\u5e76\u5b89\u88c5 \u663e\u793a\u4e2d\u6587 \u9996\u9009\u9879-\u901a\u7528-\u8bed\u8a00 \u540c\u6b65\u6307\u5b9aiCloud\u76ee\u5f55","title":"Joplin + iCloud"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/git_rel/","text":"Git\u4f7f\u7528\u76f8\u5173 \u57fa\u7840\uff08\u7565\uff09 \u9ad8\u9636\u573a\u666f \u4e00\u6b21\u63a8\u9001\u591a\u4e2a\u8fdc\u7a0bgit repo \u4ee5\u63a8\u9001github\u4e3a\u4f8b\uff0c\u5148\u5728github\u5efa\u7acb\u7a7arepo\uff0c\u83b7\u53d6\u5bf9\u5e94git\u5730\u5740\uff0c\u5982 https://github.com/your-github-account/your-new-project.git # \u67e5\u770b\u5f53\u524d\u63a8\u9001\u7684\u8fdc\u7a0b\u5e93 git remote -v # \u6dfb\u52a0\u65b0git repo\u4f5c\u4e3a\u63a8\u9001\u5bf9\u8c61 git remote set-url --add origin https://github.com/your-github-account/your-new-project.git cli\u7684\u5b9e\u8d28\u662f\u5728 .git/config \u7684 [remote \"origin\"] \u4e0b\u6dfb\u52a0\u4e00\u4e2a\u65b0url \u8bbe\u7f6e\u4ee3\u7406 # \u6dfb\u52a0\u4ee3\u7406 git config --global http.proxy 'socks://localhost:7070' # \u53d6\u6d88\u4ee3\u7406 git config --global --unset http.proxy","title":"Git\u4f7f\u7528\u76f8\u5173"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/git_rel/#git","text":"","title":"Git\u4f7f\u7528\u76f8\u5173"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/git_rel/#_1","text":"","title":"\u57fa\u7840\uff08\u7565\uff09"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/git_rel/#_2","text":"","title":"\u9ad8\u9636\u573a\u666f"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/git_rel/#git-repo","text":"\u4ee5\u63a8\u9001github\u4e3a\u4f8b\uff0c\u5148\u5728github\u5efa\u7acb\u7a7arepo\uff0c\u83b7\u53d6\u5bf9\u5e94git\u5730\u5740\uff0c\u5982 https://github.com/your-github-account/your-new-project.git # \u67e5\u770b\u5f53\u524d\u63a8\u9001\u7684\u8fdc\u7a0b\u5e93 git remote -v # \u6dfb\u52a0\u65b0git repo\u4f5c\u4e3a\u63a8\u9001\u5bf9\u8c61 git remote set-url --add origin https://github.com/your-github-account/your-new-project.git cli\u7684\u5b9e\u8d28\u662f\u5728 .git/config \u7684 [remote \"origin\"] \u4e0b\u6dfb\u52a0\u4e00\u4e2a\u65b0url","title":"\u4e00\u6b21\u63a8\u9001\u591a\u4e2a\u8fdc\u7a0bgit repo"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/git_rel/#_3","text":"# \u6dfb\u52a0\u4ee3\u7406 git config --global http.proxy 'socks://localhost:7070' # \u53d6\u6d88\u4ee3\u7406 git config --global --unset http.proxy","title":"\u8bbe\u7f6e\u4ee3\u7406"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/mrdoc/","text":"MrDoc \u89c5\u601d\u6587\u6863 \uff08\u8bed\u96c0\u7684\u5e73\u66ff\uff09 \u9002\u5408\u4e8e\u4e2a\u4eba\u548c\u4e2d\u5c0f\u578b\u56e2\u961f\u7684\u5728\u7ebf\u6587\u6863\u3001\u77e5\u8bc6\u5e93\u7cfb\u7edf \u5b89\u88c5 # \u5f00\u6e90\u7248 \u57fa\u4e8edocker git clone https://github.com/zmister2016/MrDoc.git docker run -d \\ --name mrdoc \\ -p 10086:10086 \\ -v $(pwd)/MrDoc:/app/MrDoc zmister/mrdoc:v5 # \u521b\u5efa\u7ba1\u7406\u5458\u8d26\u53f7 docker exec -it mrdoc python manage.py createsuperuser \u53c2\u8003 \u5b98\u7f51 https://www.mrdoc.pro/ \u5f00\u6e90\u6e90\u7801 https://github.com/zmister2016/MrDoc.git","title":"MrDoc \u89c5\u601d\u6587\u6863 \uff08\u8bed\u96c0\u7684\u5e73\u66ff\uff09"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/mrdoc/#mrdoc","text":"\u9002\u5408\u4e8e\u4e2a\u4eba\u548c\u4e2d\u5c0f\u578b\u56e2\u961f\u7684\u5728\u7ebf\u6587\u6863\u3001\u77e5\u8bc6\u5e93\u7cfb\u7edf","title":"MrDoc \u89c5\u601d\u6587\u6863 \uff08\u8bed\u96c0\u7684\u5e73\u66ff\uff09"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/mrdoc/#_1","text":"# \u5f00\u6e90\u7248 \u57fa\u4e8edocker git clone https://github.com/zmister2016/MrDoc.git docker run -d \\ --name mrdoc \\ -p 10086:10086 \\ -v $(pwd)/MrDoc:/app/MrDoc zmister/mrdoc:v5 # \u521b\u5efa\u7ba1\u7406\u5458\u8d26\u53f7 docker exec -it mrdoc python manage.py createsuperuser","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/mrdoc/#_2","text":"\u5b98\u7f51 https://www.mrdoc.pro/ \u5f00\u6e90\u6e90\u7801 https://github.com/zmister2016/MrDoc.git","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/docker/","text":"Docker\u5bb9\u5668 \u5b89\u88c5 # \u5b98\u65b9\u6e90\u8f83\u6162\uff0c\u4f7f\u7528\u56fd\u5185\u963f\u91cc\u6e90 yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo # \u5b89\u88c5\u7edf\u4e00\u7248\u672c18.09.6 yum install docker-ce-18.09.6 docker-ce-cli-18.09.6 containerd.io # docker\u542f\u52a8 systemctl start docker # \u914d\u5f00\u673a\u542f\u52a8 systemctl enable docker \u4f7f\u7528 \u9650\u5236log docker run -d \\ --log-opt max-size=10m \\ --log-opt max-file=3 \\ image\u540d \u4e00\u952e\u6e05\u7406 \u955c\u50cf docker rmi -f `docker images | grep '<none>' | awk '{print $3}'` \u5f3a\u5236\u91cd\u5efadocker-compose\u4e2d\u6307\u5b9a\u670d\u52a1 docker-compose up --force-recreate --no-deps service-name","title":"Docker\u5bb9\u5668"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/docker/#docker","text":"","title":"Docker\u5bb9\u5668"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/docker/#_1","text":"# \u5b98\u65b9\u6e90\u8f83\u6162\uff0c\u4f7f\u7528\u56fd\u5185\u963f\u91cc\u6e90 yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo # \u5b89\u88c5\u7edf\u4e00\u7248\u672c18.09.6 yum install docker-ce-18.09.6 docker-ce-cli-18.09.6 containerd.io # docker\u542f\u52a8 systemctl start docker # \u914d\u5f00\u673a\u542f\u52a8 systemctl enable docker","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/docker/#_2","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/docker/#log","text":"docker run -d \\ --log-opt max-size=10m \\ --log-opt max-file=3 \\ image\u540d \u4e00\u952e\u6e05\u7406 \u955c\u50cf docker rmi -f `docker images | grep '<none>' | awk '{print $3}'`","title":"\u9650\u5236log"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/docker/#docker-compose","text":"docker-compose up --force-recreate --no-deps service-name","title":"\u5f3a\u5236\u91cd\u5efadocker-compose\u4e2d\u6307\u5b9a\u670d\u52a1"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/","text":"KubeSphere \u5bb9\u5668\u5e73\u53f0 \u4f7f\u7528\u5efa\u8bae \u9002\u5408\u65e0\u72b6\u6001\u670d\u52a1\u7684\u5feb\u901f\u3001\u6807\u51c6\u5316\u90e8\u7f72\uff1b\u4e0d\u9002\u5408\u6709\u72b6\u6001\u7684\u670d\u52a1 \u65b0\u72483.2.0\u5b58\u5728api\u4e0d\u517c\u5bb9\u95ee\u9898\uff0c\u5efa\u8bae\u4f7f\u75283.1.1 \u53ef\u4ee5\u5bfc\u5165\u591a\u79cd\u4e91\u4e3b\u673a\uff08\u57fa\u4e8e\u4ee3\u7406\uff09 \u81ea\u5e26\u76d1\u63a7\uff08\u57fa\u4e8eprometheus\uff09\u548c\u65e5\u5fd7\u91c7\u96c6\uff08elk\uff09\uff0c\u9002\u5408\u6807\u51c6\u5316\u76d1\u63a7\u5feb\u901f\u843d\u5730 \u81ea\u5e26\u57fa\u4e8ejenkeins\u7684\u6d41\u6c34\u7ebf\uff0c\u5982\u679c\u7528\u6807\u51c6\u6d41\u7a0b\u8f83\u65b9\u4fbf\uff0c\u4f46\u8981\u81ea\u5b9a\u4e49\u6a21\u5757\u8f83\u9ebb\u70e6 \u6709api\uff0c\u66f4\u9002\u7528\u57fa\u4e8ehelm\u7684gitops \u5b89\u88c5 linux\u4e0a\u5355\u8282\u70b9all-in-one \u57fa\u4e8eubuntu 18\u73af\u5883\u6d4b\u8bd5\uff0c\u786c\u4ef6\u914d\u7f6e4C-8G-100G \u5b89\u88c5\u5bb9\u5668runtime apt install docker.io \u786e\u8ba4dns\u53ef\u7528 nslookup www.baidu.com \uff0c\u53cd\u9988\u5b9e\u9645Address\u4ee3\u8868\u6b63\u5e38 \u5173\u95ed\u9632\u706b\u5899 ufw disable \u53ef\u9009\uff1a\u6dfb\u52a0\u963f\u91cc\u4e91 \u5bb9\u5668\u955c\u50cf\u670d\u52a1/\u955c\u50cf\u52a0\u901f\u5668 \u5b89\u88c5\u4f9d\u8d56\u7ec4\u4ef6 apt install socat apt install conntrack apt install ipset -y \u6307\u5b9a\u73af\u5883\u53c2\u6570 export KKZONE=cn \uff0c\u4e0b\u8f7dkk curl -sfL https://get-kk.kubesphere.io | VERSION=v1.2.0 sh - chmod +x kk \u540e\u6267\u884c\u5b89\u88c5 ./kk create cluster --with-kubernetes v1.21.5 --with-kubesphere v3.2.0 \uff0c \u5b89\u88c5\u9a8c\u8bc1 kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l app=ks-install -o jsonpath='{.items[0].metadata.name}') -f \uff0c \u7b2c\u4e00\u6b21\u767b\u5165\u4f1a\u8981\u6c42\u6539admin\u5bc6\u7801 admin\u8bbf\u95ee\u7ba1\u7406\u754c\u9762\uff0c \u542f\u7528\u63d2\u4ef6 DevOps\u7cfb\u7edf \u4ee5 admin \u7528\u6237\u8bbf\u95ee \u5e73\u53f0\u7ba1\u7406-\u96c6\u7fa4\u7ba1\u7406-CRD \u9875\u9762\uff0c\u641c\u7d22 clusterconfiguration \u8fdb\u5165\u8be6\u60c5\u9875\uff0c \u7f16\u8f91 YAML \u6539 spec.devops.enabled \u4e3atrue\uff0c\u5e76\u786e\u5b9a\u4fdd\u5b58 \u7b49\u5f85\u51e0\u5206\u949f\uff0c\u96c6\u7fa4\u7ec4\u4ef6\u4f1a\u91cd\u542f\uff0c\u9a8c\u8bc1\u5b89\u88c5\u7ed3\u679c kubectl get pod -n kubesphere-devops-system Istio\u670d\u52a1\u7f51\u683c [TODO] \u4f7f\u7528 \u521b\u5efa\u4f01\u4e1a\u7a7a\u95f4\u3001\u9879\u76ee\u3001\u7528\u6237\u548c\u89d2\u8272 \u521b\u5efa\u7528\u6237 \u5e73\u53f0\u7ba1\u7406-\u8bbf\u95ee\u63a7\u5236-\u7528\u6237 \uff0c \u521b\u5efa \u65b0\u7528\u6237\u7ba1\u7406\u5458 \u4f9d\u6b21\u65b0\u589e\u7528\u6237 \u4f01\u4e1a\u7a7a\u95f4\u7ba1\u7406\u5458(ws-manager) \u3001 \u666e\u901a\u9879\u76ee\u7528\u6237(project-regular) \u7b49 \u521b\u5efa\u4f01\u4e1a\u7a7a\u95f4 \u4ee5 ws-manager \u8eab\u4efd\u767b\u5f55\uff0c\u8fdb\u5165 \u4f01\u4e1a\u7a7a\u95f4 \uff0c \u521b\u5efa \u65b0\u7a7a\u95f4 demo-workspace \uff0c\u6307\u5b9a\u666e\u901a\u7528\u6237 ws-admin \u4e3a\u8be5\u7a7a\u95f4\u7ba1\u7406\u5458 \u4ee5 ws-admin \u767b\u5165\uff0c\u9080\u8bf7\u666e\u901a\u7528\u6237 project-admin \u548c project-regular \u8fdb\u5165\u8be5\u7a7a\u95f4\uff0c\u5e76\u6388\u6743 \u521b\u5efa\u9879\u76ee\uff08\u7b49\u540cNameSpace\uff09 \u4ee5 project-admin \u767b\u5165\uff0c\u8fdb\u5165 \u9879\u76ee \uff0c\u70b9 \u521b\u5efa \u65b0\u9879\u76ee demo-project \u70b9\u51fb\u8fdb\u5165\u9879\u76ee\u8be6\u60c5\uff0c\u8bbe\u7f6e\u8d44\u6e90\u9650\u5236 \u6ce8\u610f 1Gi == 1024MiB; 1G == 1000MB \u9080\u8bf7\u5df2\u6709\u7528\u6237\u4e3a\u9879\u76ee\u6210\u5458 \u5728 \u7f51\u5173\u8bbe\u7f6e \u521b\u5efa NodePort \u6a21\u5f0f\u7684\u7f51\u5173\uff0c\u4f9b\u5916\u90e8\u8bbf\u95ee \u9879\u76ee\u90e8\u7f72 \u4ee5\u7b80\u5355\u7684 dockerbogo/docker-nginx-hello-world \u4e3a\u4f8b \u521b\u5efa\u5e94\u7528\uff1a \u5e94\u7528\u8d1f\u8f7d-\u5e94\u7528-\u81ea\u5236\u5e94\u7528 \u4e2d\u521b\u5efa\u65b0\u5e94\u7528 nginx-hello-world \uff0c \u4e0b\u4e00\u6b65\u521b\u5efa \u65e0\u72b6\u6001\u670d\u52a1 \uff0c \uff0c \u5411\u5bfc \u5bb9\u5668\u955c\u50cf \u4e2d\uff0c\u70b9\u51fb \u6dfb\u52a0\u5bb9\u5668\u955c\u50cf \uff0c\u641c\u7d22 dockerbogo/docker-nginx-hello-world \uff0c\u70b9 \u4f7f\u7528\u9ed8\u8ba4\u7aef\u53e3 \u6ce8\u610f\uff1a\u8d44\u6e90\u9700\u8981\u9650\u5236\uff0c\u4e0d\u80fd\u5927\u4e8e\u9879\u76ee\u81ea\u8eab\u914d\u989d \u4e0b\u4e00\u6b65 \u6dfb\u52a0\u5b58\u50a8\u5377 \u5ffd\u7565 \u5728 \u9ad8\u7ea7\u8bbe\u7f6e \u53f3\u4e0b\u65b9\u70b9 \u521b\u5efa \uff0c\u5b8c\u6210\u5411\u5bfc \u6700\u540e\u70b9\u51fb \u4e0b\u4e00\u6b65 \u8def\u7531\u8bbe\u7f6e \u4e2d\uff0c\u70b9\u51fb \u521b\u5efa \uff0c\u4f7f\u7528\u9ed8\u8ba4\u89c4\u5219 \u5de5\u4f5c\u8d1f\u8f7d \u9875\u4e0b\u9a8c\u8bc1\u670d\u52a1 \u901a\u8fc7 NodePort \u8bbf\u95ee \u9009\u62e9 \uff0c\u5e76 \u786e\u5b9a \u8fdb\u5165\u670d\u52a1\u8be6\u60c5\u9875\uff0c\u53ef\u4ee5\u770b\u89c1\u66b4\u9732\u7684\u7aef\u53e3 \u8bbf\u95ee\u6548\u679c DevOps\u7ba1\u7406(CI/CD) \u524d\u63d0: \u5df2\u6709\u7528\u6237 project-admin \uff0c\u5177\u6709 admin \u6216 operator \u89d2\u8272 \u51ed\u8bc1\u7ba1\u7406 \u6dfb\u52a0git\u8d26\u53f7 gitlab-id \uff0c\u7528\u4e8e\u8bfb\u6e90\u7801repo \u7c7b\u4f3c\u4e0a\u6587\uff0c\u6dfb\u52a0docker\u955c\u50cf\u5e93\u8d26\u53f7 dockerhub-id \uff0c\u7528\u4e8e\u63a8\u9001\u955c\u50cf \u6dfb\u52a0kubeconfig\u7c7b\u8d26\u53f7 demo-kubeconfig \uff0c\u7528\u4e8e\u90e8\u7f72\u8d44\u6e90 \u4ee5\u4e0a\u8d26\u53f7\u8981\u7528\u4e8e\u5e94\u7528repo\u6839\u76ee\u5f55\u7684 Jenkinsfile \u5efa\u7acb\u6d41\u6c34\u7ebf \u8fdb \u6d41\u6c34\u7ebf \u70b9 \u521b\u5efa \uff0c\u8f93\u5165\u81ea\u5b9a\u4e49\u540d\u79f0\u540e\uff0c\u9009\u62e9\u4ee3\u7801\u4ed3\u5e93 \u9009 Git \uff0c\u586b\u5165\u5e94\u7528\u6240\u5728git\u5730\u5740\uff0c\u5e76\u9009\u62e9\u4e4b\u524d\u521b\u5efa\u7684git\u8d26\u53f7\u51ed\u8bc1\uff0c\u70b9\u52fe\u4fdd\u5b58 \uff08\u53ef\u9009\uff09\u70b9 \u4e0b\u4e00\u6b65 \uff0c\u5728 \u9ad8\u7ea7\u8bbe\u7f6e \u4e2d\u914d\u7f6e \u6b63\u5219\u8fc7\u6ee4 \u3001 Webhook \u548c \u5b9a\u65f6\u626b\u63cf \u7b49 \u70b9 \u521b\u5efa \u5b8c\u6210\u5411\u5bfc \u8fdb\u5165\u6d41\u6c34\u7ebf\u8be6\u60c5\u9875\u7684 \u5206\u652f \uff0c\u626b\u63cf\u4ed3\u5e93\uff0c\u5982\u679cgit\u8d26\u53f7\u6b63\u786e\u7684\u8bdd\uff0c\u4f1a\u8bfb\u53d6\u7b26\u5408\u6b63\u5219\u8fc7\u6ee4\u6761\u4ef6\u7684\u5206\u652f\u4fe1\u606f\uff0c\u81ea\u52a8\u5f00\u59cb\u7b2c\u4e00\u6b21\u6784\u5efa\uff08\u591a\u534a\u4ee5\u5931\u8d25\u544a\u7ec8\uff09 \u8fdb\u5165\u6d41\u6c34\u7ebf\u8be6\u60c5\u9875\u7684 \u8fd0\u884c\u8bb0\u5f55 \uff0c\u70b9\u51fb\u8bb0\u5f55\u8fdb\u5165\u8be6\u60c5\u9875 \u53ef\u4ee5\u70b9 \u67e5\u770b\u65e5\u5fd7 \u5b9a\u4f4d\u95ee\u9898 \u4e0d\u65ad\u8c03\u6574 Jenkinsfile \uff0c\u76f4\u5230\u6d41\u6c34\u7ebf\u6b63\u5e38\u8fd0\u884c\u3002 pipeline { agent { node { label 'base' } } environment { DOCKER_CREDENTIAL_ID = 'dockerhub-id' KUBECONFIG_CREDENTIAL_ID = 'demo-kubeconfig' REGISTRY = 'docker.io' DOCKERHUB_NAMESPACE = 'devops' APP_NAME = 'devops-python-sample' } parameters { string(name: 'BRANCH_NAME', defaultValue: 'master', description: '') } stages { stage('\u62c9\u53d6\u4ee3\u7801') { steps { checkout(scm) } } stage('\u63a8\u9001\u955c\u50cf') { steps { container('base') { withCredentials([usernamePassword(credentialsId : \"$DOCKER_CREDENTIAL_ID\" ,passwordVariable : 'DOCKER_PASSWORD' ,usernameVariable : 'DOCKER_USERNAME' ,)]) { sh 'echo \"$DOCKER_PASSWORD\" | docker login $REGISTRY -u \"$DOCKER_USERNAME\" --password-stdin' sh 'docker build -f Dockerfile -t $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:$BUILD_NUMBER .' sh 'docker push $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:$BUILD_NUMBER' } } } } stage('\u90e8\u7f72') { steps { kubernetesDeploy(configs: 'deploy/**', enableConfigSubstitution: true, kubeconfigId: \"$KUBECONFIG_CREDENTIAL_ID\") } } } } API\u4f7f\u7528 [TODO] \u8e29\u5751\u8bb0\u5f55 \u5c3d\u91cf\u4e0d\u8981\u8dd1\u6709\u72b6\u6001\u7684\u670d\u52a1\uff0c\u975e\u5e38\u5371\u9669\uff1a\u6709\u65f6\u5019db\u7c7b\u5e94\u7528\u4e00\u65e6\u6302\u4e86\uff0c\u6570\u636e\u5f88\u96be\u6062\u590d\u4e00\u81f4\uff1b\u53e6\u5916v3.2.0\u7684\u524d\u7aefjs\u6709bug\uff0c\u6709\u72b6\u6001\u7684\u670d\u52a1\u8be6\u60c5\u9875\u62a5\u9519 v3.2.0\u5bf9\u5e94\u7684k8s\u9ed8\u8ba4api\u5347\u7ea7\uff0c\u5bfc\u81f4\u76f8\u5173\u90e8\u7f72\u63d2\u4ef6\u8fc7\u671f\u4e0d\u53ef\u7528\uff0c\u53c2\u8003 https://github.com/kubesphere/website/issues/2096 \u53c2\u8003 \u4e2d\u6587\u5b98\u7f51 https://kubesphere.com.cn/ API\u6587\u6863 https://kubesphere.io/api/kubesphere/","title":"KubeSphere \u5bb9\u5668\u5e73\u53f0"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#kubesphere","text":"","title":"KubeSphere \u5bb9\u5668\u5e73\u53f0"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_1","text":"\u9002\u5408\u65e0\u72b6\u6001\u670d\u52a1\u7684\u5feb\u901f\u3001\u6807\u51c6\u5316\u90e8\u7f72\uff1b\u4e0d\u9002\u5408\u6709\u72b6\u6001\u7684\u670d\u52a1 \u65b0\u72483.2.0\u5b58\u5728api\u4e0d\u517c\u5bb9\u95ee\u9898\uff0c\u5efa\u8bae\u4f7f\u75283.1.1 \u53ef\u4ee5\u5bfc\u5165\u591a\u79cd\u4e91\u4e3b\u673a\uff08\u57fa\u4e8e\u4ee3\u7406\uff09 \u81ea\u5e26\u76d1\u63a7\uff08\u57fa\u4e8eprometheus\uff09\u548c\u65e5\u5fd7\u91c7\u96c6\uff08elk\uff09\uff0c\u9002\u5408\u6807\u51c6\u5316\u76d1\u63a7\u5feb\u901f\u843d\u5730 \u81ea\u5e26\u57fa\u4e8ejenkeins\u7684\u6d41\u6c34\u7ebf\uff0c\u5982\u679c\u7528\u6807\u51c6\u6d41\u7a0b\u8f83\u65b9\u4fbf\uff0c\u4f46\u8981\u81ea\u5b9a\u4e49\u6a21\u5757\u8f83\u9ebb\u70e6 \u6709api\uff0c\u66f4\u9002\u7528\u57fa\u4e8ehelm\u7684gitops","title":"\u4f7f\u7528\u5efa\u8bae"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_2","text":"","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#linuxall-in-one","text":"\u57fa\u4e8eubuntu 18\u73af\u5883\u6d4b\u8bd5\uff0c\u786c\u4ef6\u914d\u7f6e4C-8G-100G \u5b89\u88c5\u5bb9\u5668runtime apt install docker.io \u786e\u8ba4dns\u53ef\u7528 nslookup www.baidu.com \uff0c\u53cd\u9988\u5b9e\u9645Address\u4ee3\u8868\u6b63\u5e38 \u5173\u95ed\u9632\u706b\u5899 ufw disable \u53ef\u9009\uff1a\u6dfb\u52a0\u963f\u91cc\u4e91 \u5bb9\u5668\u955c\u50cf\u670d\u52a1/\u955c\u50cf\u52a0\u901f\u5668 \u5b89\u88c5\u4f9d\u8d56\u7ec4\u4ef6 apt install socat apt install conntrack apt install ipset -y \u6307\u5b9a\u73af\u5883\u53c2\u6570 export KKZONE=cn \uff0c\u4e0b\u8f7dkk curl -sfL https://get-kk.kubesphere.io | VERSION=v1.2.0 sh - chmod +x kk \u540e\u6267\u884c\u5b89\u88c5 ./kk create cluster --with-kubernetes v1.21.5 --with-kubesphere v3.2.0 \uff0c \u5b89\u88c5\u9a8c\u8bc1 kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l app=ks-install -o jsonpath='{.items[0].metadata.name}') -f \uff0c \u7b2c\u4e00\u6b21\u767b\u5165\u4f1a\u8981\u6c42\u6539admin\u5bc6\u7801 admin\u8bbf\u95ee\u7ba1\u7406\u754c\u9762\uff0c","title":"linux\u4e0a\u5355\u8282\u70b9all-in-one"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_3","text":"","title":"\u542f\u7528\u63d2\u4ef6"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#devops","text":"\u4ee5 admin \u7528\u6237\u8bbf\u95ee \u5e73\u53f0\u7ba1\u7406-\u96c6\u7fa4\u7ba1\u7406-CRD \u9875\u9762\uff0c\u641c\u7d22 clusterconfiguration \u8fdb\u5165\u8be6\u60c5\u9875\uff0c \u7f16\u8f91 YAML \u6539 spec.devops.enabled \u4e3atrue\uff0c\u5e76\u786e\u5b9a\u4fdd\u5b58 \u7b49\u5f85\u51e0\u5206\u949f\uff0c\u96c6\u7fa4\u7ec4\u4ef6\u4f1a\u91cd\u542f\uff0c\u9a8c\u8bc1\u5b89\u88c5\u7ed3\u679c kubectl get pod -n kubesphere-devops-system","title":"DevOps\u7cfb\u7edf"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#istio","text":"[TODO]","title":"Istio\u670d\u52a1\u7f51\u683c"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_4","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_5","text":"","title":"\u521b\u5efa\u4f01\u4e1a\u7a7a\u95f4\u3001\u9879\u76ee\u3001\u7528\u6237\u548c\u89d2\u8272"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_6","text":"\u5e73\u53f0\u7ba1\u7406-\u8bbf\u95ee\u63a7\u5236-\u7528\u6237 \uff0c \u521b\u5efa \u65b0\u7528\u6237\u7ba1\u7406\u5458 \u4f9d\u6b21\u65b0\u589e\u7528\u6237 \u4f01\u4e1a\u7a7a\u95f4\u7ba1\u7406\u5458(ws-manager) \u3001 \u666e\u901a\u9879\u76ee\u7528\u6237(project-regular) \u7b49","title":"\u521b\u5efa\u7528\u6237"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_7","text":"\u4ee5 ws-manager \u8eab\u4efd\u767b\u5f55\uff0c\u8fdb\u5165 \u4f01\u4e1a\u7a7a\u95f4 \uff0c \u521b\u5efa \u65b0\u7a7a\u95f4 demo-workspace \uff0c\u6307\u5b9a\u666e\u901a\u7528\u6237 ws-admin \u4e3a\u8be5\u7a7a\u95f4\u7ba1\u7406\u5458 \u4ee5 ws-admin \u767b\u5165\uff0c\u9080\u8bf7\u666e\u901a\u7528\u6237 project-admin \u548c project-regular \u8fdb\u5165\u8be5\u7a7a\u95f4\uff0c\u5e76\u6388\u6743","title":"\u521b\u5efa\u4f01\u4e1a\u7a7a\u95f4"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#namespace","text":"\u4ee5 project-admin \u767b\u5165\uff0c\u8fdb\u5165 \u9879\u76ee \uff0c\u70b9 \u521b\u5efa \u65b0\u9879\u76ee demo-project \u70b9\u51fb\u8fdb\u5165\u9879\u76ee\u8be6\u60c5\uff0c\u8bbe\u7f6e\u8d44\u6e90\u9650\u5236 \u6ce8\u610f 1Gi == 1024MiB; 1G == 1000MB \u9080\u8bf7\u5df2\u6709\u7528\u6237\u4e3a\u9879\u76ee\u6210\u5458 \u5728 \u7f51\u5173\u8bbe\u7f6e \u521b\u5efa NodePort \u6a21\u5f0f\u7684\u7f51\u5173\uff0c\u4f9b\u5916\u90e8\u8bbf\u95ee","title":"\u521b\u5efa\u9879\u76ee\uff08\u7b49\u540cNameSpace\uff09"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_8","text":"\u4ee5\u7b80\u5355\u7684 dockerbogo/docker-nginx-hello-world \u4e3a\u4f8b \u521b\u5efa\u5e94\u7528\uff1a \u5e94\u7528\u8d1f\u8f7d-\u5e94\u7528-\u81ea\u5236\u5e94\u7528 \u4e2d\u521b\u5efa\u65b0\u5e94\u7528 nginx-hello-world \uff0c \u4e0b\u4e00\u6b65\u521b\u5efa \u65e0\u72b6\u6001\u670d\u52a1 \uff0c \uff0c \u5411\u5bfc \u5bb9\u5668\u955c\u50cf \u4e2d\uff0c\u70b9\u51fb \u6dfb\u52a0\u5bb9\u5668\u955c\u50cf \uff0c\u641c\u7d22 dockerbogo/docker-nginx-hello-world \uff0c\u70b9 \u4f7f\u7528\u9ed8\u8ba4\u7aef\u53e3 \u6ce8\u610f\uff1a\u8d44\u6e90\u9700\u8981\u9650\u5236\uff0c\u4e0d\u80fd\u5927\u4e8e\u9879\u76ee\u81ea\u8eab\u914d\u989d \u4e0b\u4e00\u6b65 \u6dfb\u52a0\u5b58\u50a8\u5377 \u5ffd\u7565 \u5728 \u9ad8\u7ea7\u8bbe\u7f6e \u53f3\u4e0b\u65b9\u70b9 \u521b\u5efa \uff0c\u5b8c\u6210\u5411\u5bfc \u6700\u540e\u70b9\u51fb \u4e0b\u4e00\u6b65 \u8def\u7531\u8bbe\u7f6e \u4e2d\uff0c\u70b9\u51fb \u521b\u5efa \uff0c\u4f7f\u7528\u9ed8\u8ba4\u89c4\u5219 \u5de5\u4f5c\u8d1f\u8f7d \u9875\u4e0b\u9a8c\u8bc1\u670d\u52a1 \u901a\u8fc7 NodePort \u8bbf\u95ee \u9009\u62e9 \uff0c\u5e76 \u786e\u5b9a \u8fdb\u5165\u670d\u52a1\u8be6\u60c5\u9875\uff0c\u53ef\u4ee5\u770b\u89c1\u66b4\u9732\u7684\u7aef\u53e3 \u8bbf\u95ee\u6548\u679c","title":"\u9879\u76ee\u90e8\u7f72"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#devopscicd","text":"\u524d\u63d0: \u5df2\u6709\u7528\u6237 project-admin \uff0c\u5177\u6709 admin \u6216 operator \u89d2\u8272","title":"DevOps\u7ba1\u7406(CI/CD)"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_9","text":"\u6dfb\u52a0git\u8d26\u53f7 gitlab-id \uff0c\u7528\u4e8e\u8bfb\u6e90\u7801repo \u7c7b\u4f3c\u4e0a\u6587\uff0c\u6dfb\u52a0docker\u955c\u50cf\u5e93\u8d26\u53f7 dockerhub-id \uff0c\u7528\u4e8e\u63a8\u9001\u955c\u50cf \u6dfb\u52a0kubeconfig\u7c7b\u8d26\u53f7 demo-kubeconfig \uff0c\u7528\u4e8e\u90e8\u7f72\u8d44\u6e90 \u4ee5\u4e0a\u8d26\u53f7\u8981\u7528\u4e8e\u5e94\u7528repo\u6839\u76ee\u5f55\u7684 Jenkinsfile","title":"\u51ed\u8bc1\u7ba1\u7406"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_10","text":"\u8fdb \u6d41\u6c34\u7ebf \u70b9 \u521b\u5efa \uff0c\u8f93\u5165\u81ea\u5b9a\u4e49\u540d\u79f0\u540e\uff0c\u9009\u62e9\u4ee3\u7801\u4ed3\u5e93 \u9009 Git \uff0c\u586b\u5165\u5e94\u7528\u6240\u5728git\u5730\u5740\uff0c\u5e76\u9009\u62e9\u4e4b\u524d\u521b\u5efa\u7684git\u8d26\u53f7\u51ed\u8bc1\uff0c\u70b9\u52fe\u4fdd\u5b58 \uff08\u53ef\u9009\uff09\u70b9 \u4e0b\u4e00\u6b65 \uff0c\u5728 \u9ad8\u7ea7\u8bbe\u7f6e \u4e2d\u914d\u7f6e \u6b63\u5219\u8fc7\u6ee4 \u3001 Webhook \u548c \u5b9a\u65f6\u626b\u63cf \u7b49 \u70b9 \u521b\u5efa \u5b8c\u6210\u5411\u5bfc \u8fdb\u5165\u6d41\u6c34\u7ebf\u8be6\u60c5\u9875\u7684 \u5206\u652f \uff0c\u626b\u63cf\u4ed3\u5e93\uff0c\u5982\u679cgit\u8d26\u53f7\u6b63\u786e\u7684\u8bdd\uff0c\u4f1a\u8bfb\u53d6\u7b26\u5408\u6b63\u5219\u8fc7\u6ee4\u6761\u4ef6\u7684\u5206\u652f\u4fe1\u606f\uff0c\u81ea\u52a8\u5f00\u59cb\u7b2c\u4e00\u6b21\u6784\u5efa\uff08\u591a\u534a\u4ee5\u5931\u8d25\u544a\u7ec8\uff09 \u8fdb\u5165\u6d41\u6c34\u7ebf\u8be6\u60c5\u9875\u7684 \u8fd0\u884c\u8bb0\u5f55 \uff0c\u70b9\u51fb\u8bb0\u5f55\u8fdb\u5165\u8be6\u60c5\u9875 \u53ef\u4ee5\u70b9 \u67e5\u770b\u65e5\u5fd7 \u5b9a\u4f4d\u95ee\u9898 \u4e0d\u65ad\u8c03\u6574 Jenkinsfile \uff0c\u76f4\u5230\u6d41\u6c34\u7ebf\u6b63\u5e38\u8fd0\u884c\u3002 pipeline { agent { node { label 'base' } } environment { DOCKER_CREDENTIAL_ID = 'dockerhub-id' KUBECONFIG_CREDENTIAL_ID = 'demo-kubeconfig' REGISTRY = 'docker.io' DOCKERHUB_NAMESPACE = 'devops' APP_NAME = 'devops-python-sample' } parameters { string(name: 'BRANCH_NAME', defaultValue: 'master', description: '') } stages { stage('\u62c9\u53d6\u4ee3\u7801') { steps { checkout(scm) } } stage('\u63a8\u9001\u955c\u50cf') { steps { container('base') { withCredentials([usernamePassword(credentialsId : \"$DOCKER_CREDENTIAL_ID\" ,passwordVariable : 'DOCKER_PASSWORD' ,usernameVariable : 'DOCKER_USERNAME' ,)]) { sh 'echo \"$DOCKER_PASSWORD\" | docker login $REGISTRY -u \"$DOCKER_USERNAME\" --password-stdin' sh 'docker build -f Dockerfile -t $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:$BUILD_NUMBER .' sh 'docker push $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:$BUILD_NUMBER' } } } } stage('\u90e8\u7f72') { steps { kubernetesDeploy(configs: 'deploy/**', enableConfigSubstitution: true, kubeconfigId: \"$KUBECONFIG_CREDENTIAL_ID\") } } } }","title":"\u5efa\u7acb\u6d41\u6c34\u7ebf"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#api","text":"[TODO]","title":"API\u4f7f\u7528"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_11","text":"\u5c3d\u91cf\u4e0d\u8981\u8dd1\u6709\u72b6\u6001\u7684\u670d\u52a1\uff0c\u975e\u5e38\u5371\u9669\uff1a\u6709\u65f6\u5019db\u7c7b\u5e94\u7528\u4e00\u65e6\u6302\u4e86\uff0c\u6570\u636e\u5f88\u96be\u6062\u590d\u4e00\u81f4\uff1b\u53e6\u5916v3.2.0\u7684\u524d\u7aefjs\u6709bug\uff0c\u6709\u72b6\u6001\u7684\u670d\u52a1\u8be6\u60c5\u9875\u62a5\u9519 v3.2.0\u5bf9\u5e94\u7684k8s\u9ed8\u8ba4api\u5347\u7ea7\uff0c\u5bfc\u81f4\u76f8\u5173\u90e8\u7f72\u63d2\u4ef6\u8fc7\u671f\u4e0d\u53ef\u7528\uff0c\u53c2\u8003 https://github.com/kubesphere/website/issues/2096","title":"\u8e29\u5751\u8bb0\u5f55"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/kubesphere/#_12","text":"\u4e2d\u6587\u5b98\u7f51 https://kubesphere.com.cn/ API\u6587\u6863 https://kubesphere.io/api/kubesphere/","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/k8s/minikube/","text":"Minikube\u7b80\u8981\u6559\u7a0b \u5b89\u88c5 Ubuntu 18 \u4e0b\u5b89\u88c5 kubernetes v1.23.3\uff08\u6700\u540e\u539f\u751f\u652f\u6301docker\u9a71\u52a8\u7684\u7248\u672c\uff09 # root\u4e0b\u6267\u884c # \u63d0\u524d\u5b89\u88c5docker apt install docker.io # \u4e0b\u8f7d\u5b98\u65b9bin\u5b89\u88c5 minikube curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64 mv minikube-linux-amd64 minikube install minikube /usr/local/bin/ # \u67e5\u770b\u7248\u672c minikube version # \u5b89\u88c5 kubectl minikube kubectl # \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684k8s minikube start --force --driver=docker --kubernetes-version=v1.23.3 \u4f7f\u7528 \u63d0\u524d\u4f18\u5316 alias kubectl=\"minikube kubectl --\" \u52a0\u5165 .bashrc \u540e\u6267\u884csource source <(kubectl completion bash) \u5f00\u542fkubectl\u81ea\u52a8\u547d\u4ee4\u8865\u5168 \u5e38\u7528\u547d\u4ee4 # \u521b\u5efa\u4e00\u4e2angx\u7684pod kubectl run ngx --image=nginx:alpine # \u67e5\u770b\u6240\u6709pod kubectl get po -A # \u67e5\u770bk8s\u7cfb\u7edfpod kubectl get pod -n kube-system # ssh\u767b\u5165\u8282\u70b9\u540e\uff0c\u53ef\u4ee5\u6267\u884cdocker ps\u67e5\u770b\u96c6\u7fa4\u5185\u5bb9\u5668\u72b6\u6001 minikube ssh # \u5c55\u793a\u53ef\u7528\u63d2\u4ef6 minikube addons list # \u5f00\u542fdashboard\uff0c\u6307\u5b9a\u7aef\u53e3 minikube dashboard --url=true --port=8080 \u53c2\u8003 \u5b98\u65b9\u6559\u7a0b https://minikube.sigs.k8s.io/docs/start/ \u6e90\u7801 https://github.com/kubernetes/minikube","title":"Minikube\u7b80\u8981\u6559\u7a0b"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/k8s/minikube/#minikube","text":"","title":"Minikube\u7b80\u8981\u6559\u7a0b"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/k8s/minikube/#_1","text":"Ubuntu 18 \u4e0b\u5b89\u88c5 kubernetes v1.23.3\uff08\u6700\u540e\u539f\u751f\u652f\u6301docker\u9a71\u52a8\u7684\u7248\u672c\uff09 # root\u4e0b\u6267\u884c # \u63d0\u524d\u5b89\u88c5docker apt install docker.io # \u4e0b\u8f7d\u5b98\u65b9bin\u5b89\u88c5 minikube curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64 mv minikube-linux-amd64 minikube install minikube /usr/local/bin/ # \u67e5\u770b\u7248\u672c minikube version # \u5b89\u88c5 kubectl minikube kubectl # \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684k8s minikube start --force --driver=docker --kubernetes-version=v1.23.3","title":"\u5b89\u88c5"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/k8s/minikube/#_2","text":"","title":"\u4f7f\u7528"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/k8s/minikube/#_3","text":"alias kubectl=\"minikube kubectl --\" \u52a0\u5165 .bashrc \u540e\u6267\u884csource source <(kubectl completion bash) \u5f00\u542fkubectl\u81ea\u52a8\u547d\u4ee4\u8865\u5168","title":"\u63d0\u524d\u4f18\u5316"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/k8s/minikube/#_4","text":"# \u521b\u5efa\u4e00\u4e2angx\u7684pod kubectl run ngx --image=nginx:alpine # \u67e5\u770b\u6240\u6709pod kubectl get po -A # \u67e5\u770bk8s\u7cfb\u7edfpod kubectl get pod -n kube-system # ssh\u767b\u5165\u8282\u70b9\u540e\uff0c\u53ef\u4ee5\u6267\u884cdocker ps\u67e5\u770b\u96c6\u7fa4\u5185\u5bb9\u5668\u72b6\u6001 minikube ssh # \u5c55\u793a\u53ef\u7528\u63d2\u4ef6 minikube addons list # \u5f00\u542fdashboard\uff0c\u6307\u5b9a\u7aef\u53e3 minikube dashboard --url=true --port=8080","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/k8s/minikube/#_5","text":"\u5b98\u65b9\u6559\u7a0b https://minikube.sigs.k8s.io/docs/start/ \u6e90\u7801 https://github.com/kubernetes/minikube","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/pve/","text":"PVE\u5e38\u89c1\u8fd0\u7ef4\u6d41\u7a0b \u8fc1\u79fbVM qm importdisk 31001 /mnt/pve/sys-hdd/images/1001/vm-1001-disk-0.qcow2 sys-hdd --format qcow2","title":"PVE\u5e38\u89c1\u8fd0\u7ef4\u6d41\u7a0b"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/pve/#pve","text":"","title":"PVE\u5e38\u89c1\u8fd0\u7ef4\u6d41\u7a0b"},{"location":"tech_tutorial/%E8%99%9A%E6%8B%9F%E5%8C%96/pve/#vm","text":"qm importdisk 31001 /mnt/pve/sys-hdd/images/1001/vm-1001-disk-0.qcow2 sys-hdd --format qcow2","title":"\u8fc1\u79fbVM"},{"location":"tech_tutorial/%E8%B4%A8%E9%87%8F%E6%B5%8B%E8%AF%95/postwoman/","text":"Postwoman API\u7ba1\u7406 \u53c2\u8003 \u5b98\u7f51\u6e90\u7801 https://github.com/hoppscotch/hoppscotch \u5b89\u88c5","title":"Postwoman API\u7ba1\u7406"},{"location":"tech_tutorial/%E8%B4%A8%E9%87%8F%E6%B5%8B%E8%AF%95/postwoman/#postwoman-api","text":"","title":"Postwoman API\u7ba1\u7406"},{"location":"tech_tutorial/%E8%B4%A8%E9%87%8F%E6%B5%8B%E8%AF%95/postwoman/#_1","text":"\u5b98\u7f51\u6e90\u7801 https://github.com/hoppscotch/hoppscotch","title":"\u53c2\u8003"},{"location":"tech_tutorial/%E8%B4%A8%E9%87%8F%E6%B5%8B%E8%AF%95/postwoman/#_2","text":"","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/cmdbuild/","text":"CMDBuild\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0 \u53c2\u8003 \u955c\u50cf\uff1a https://hub.docker.com/r/quentinv/cmdbuild \u5b89\u88c5\uff08docker\u7248\uff09 # \u5b89\u88c5pgsql docker run --name pgsql9.4 \\ -p 0.0.0.0:5432:5432 \\ -e POSTGRES_PASSWORD=admin123 \\ -d postgres:9.4 # \uff08\u53ef\u9009\uff0c\u6570\u636e\u6062\u590d\uff09\u590d\u5236sql\u8fdb\u5bb9\u5668 docker cp ./cmdb_bak.sql pgsql9.4:/tmp/ # \u8fdb\u5165\u5bb9\u5668\u540e\u64cd\u4f5c docker exec -it pgsql9.4 /bin/bash # \u8fdbPostgresql\u8d26\u53f7 su postgres # \u5efa\u5e93 createdb -O postgres cmdbuild # \u5bfc\u6570\u636e psql -U postgres -d cmdbuild < /tmp/cmdb_bak.sql # \u9000\u51fa\u5bb9\u5668 # (\u53ef\u9009\uff0c\u6570\u636e\u5907\u4efd) /usr/bin/docker exec pgsql9.4 pg_dump -U postgres cmdbuild > /backup/cmdbuild_`date +\"%Y-%m-%d\"`.sql # \u542f\u52a8cmdb docker run --name cmdbuild2.4 -p 8080:8080 -d quentinv/cmdbuild:t7-2.4.2 API\u8c03\u7528 # \u8ba4\u8bc1 curl -X POST \\ http://0.0.0.0:8080/services/rest/v1/sessions/ \\ -H 'Content-Type: application/json' \\ -H 'cache-control: no-cache' \\ -d '{ \"username\": \"admin\", \"password\": \"admin123\" }' # \u83b7\u53d6\u6307\u5b9alookup\u7684\u4e0b\u5c5e\u5b9a\u4e49\u5217\u8868\uff0cServerUseType\u662flookup\u552f\u4e00\u82f1\u6587\u540d curl -X GET \\ http://0.0.0.0:8080/services/rest/v1/lookup_types/ServerUseType/values \\ -H 'cache-control: no-cache' \\ -H 'cmdbuild-authorization: oas2l48e16er6hapt6gjqb2hu6' \\ # \u8ba4\u8bc1API\u53cd\u9988\u7684_id -H 'content-type: application/json'","title":"CMDBuild\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/cmdbuild/#cmdbuild","text":"","title":"CMDBuild\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/cmdbuild/#_1","text":"\u955c\u50cf\uff1a https://hub.docker.com/r/quentinv/cmdbuild","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/cmdbuild/#docker","text":"# \u5b89\u88c5pgsql docker run --name pgsql9.4 \\ -p 0.0.0.0:5432:5432 \\ -e POSTGRES_PASSWORD=admin123 \\ -d postgres:9.4 # \uff08\u53ef\u9009\uff0c\u6570\u636e\u6062\u590d\uff09\u590d\u5236sql\u8fdb\u5bb9\u5668 docker cp ./cmdb_bak.sql pgsql9.4:/tmp/ # \u8fdb\u5165\u5bb9\u5668\u540e\u64cd\u4f5c docker exec -it pgsql9.4 /bin/bash # \u8fdbPostgresql\u8d26\u53f7 su postgres # \u5efa\u5e93 createdb -O postgres cmdbuild # \u5bfc\u6570\u636e psql -U postgres -d cmdbuild < /tmp/cmdb_bak.sql # \u9000\u51fa\u5bb9\u5668 # (\u53ef\u9009\uff0c\u6570\u636e\u5907\u4efd) /usr/bin/docker exec pgsql9.4 pg_dump -U postgres cmdbuild > /backup/cmdbuild_`date +\"%Y-%m-%d\"`.sql # \u542f\u52a8cmdb docker run --name cmdbuild2.4 -p 8080:8080 -d quentinv/cmdbuild:t7-2.4.2","title":"\u5b89\u88c5\uff08docker\u7248\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/cmdbuild/#api","text":"# \u8ba4\u8bc1 curl -X POST \\ http://0.0.0.0:8080/services/rest/v1/sessions/ \\ -H 'Content-Type: application/json' \\ -H 'cache-control: no-cache' \\ -d '{ \"username\": \"admin\", \"password\": \"admin123\" }' # \u83b7\u53d6\u6307\u5b9alookup\u7684\u4e0b\u5c5e\u5b9a\u4e49\u5217\u8868\uff0cServerUseType\u662flookup\u552f\u4e00\u82f1\u6587\u540d curl -X GET \\ http://0.0.0.0:8080/services/rest/v1/lookup_types/ServerUseType/values \\ -H 'cache-control: no-cache' \\ -H 'cmdbuild-authorization: oas2l48e16er6hapt6gjqb2hu6' \\ # \u8ba4\u8bc1API\u53cd\u9988\u7684_id -H 'content-type: application/json'","title":"API\u8c03\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/gitlab/","text":"Gitlab\u7248\u672c\u7ba1\u7406 \u53c2\u8003 \u4e2d\u6587\u793e\u533a\u7248github \u5b89\u88c5\uff08\u57fa\u4e8edocker\uff09 \u4ee510.2.8\u7248\u672c\u4e3a\u4f8b\uff0cdocker-compose.yml\u6587\u4ef6\u5982\u4e0b\uff1a version: '2' services: gitlab: container_name: gitlab image: twang2218/gitlab-ce-zh:10.2.8 # \u670d\u52a1\u786c\u4ef6\u9700\u6c42\uff0c500\u4eba\u4ee5\u4e0b\uff1a2Core\uff0c6G\u5185\u5b58\uff0c100G\u786c\u76d8 cpu_quota: 200000 mem_limit: 4G restart: unless-stopped # hostname: 'gitlab.example.com' environment: TZ: 'Asia/Shanghai' GITLAB_OMNIBUS_CONFIG: | gitlab_rails['time_zone'] = 'Asia/Shanghai' # external_url 'http://gitlab.example.com' # \u9700\u8981\u914d\u7f6e\u5230 gitlab.rb \u4e2d\u7684\u914d\u7f6e\u53ef\u4ee5\u5728\u8fd9\u91cc\u914d\u7f6e\uff0c\u6bcf\u4e2a\u914d\u7f6e\u4e00\u884c\uff0c\u6ce8\u610f\u7f29\u8fdb\u3002 # \u6bd4\u5982\u4e0b\u9762\u7684\u7535\u5b50\u90ae\u4ef6\u7684\u914d\u7f6e\uff1a # gitlab_rails['smtp_enable'] = true # gitlab_rails['smtp_address'] = \"smtp.exmail.qq.com\" # gitlab_rails['smtp_port'] = 465 # gitlab_rails['smtp_user_name'] = \"xxxx@xx.com\" # gitlab_rails['smtp_password'] = \"password\" # gitlab_rails['smtp_authentication'] = \"login\" # gitlab_rails['smtp_enable_starttls_auto'] = true # gitlab_rails['smtp_tls'] = true # gitlab_rails['gitlab_email_from'] = 'xxxx@xx.com' ports: - '22:22' - '80:80' - '443:443' volumes: # \u63d0\u524d\u5728\u5927\u78c1\u76d8/data\u4e0b\u5efa\u7acb\u76f8\u5173\u76ee\u5f55\uff1a/data/gitlab - /data/gitlab/etc/gitlab:/etc/gitlab - /data/gitlab/log/gitlab:/var/log/gitlab - /data/gitlab/opt/gitlab:/var/opt/gitlab # extra_hosts: # - \"gitlab.example.com:0.0.0.0\" docker-compose up -d \u542f\u52a8 \u7b2c\u4e00\u542f\u52a8\u65f6\uff0c\u91cd\u7f6eroot\u5bc6\u7801 docker-compose down \u505c\u6b62\u670d\u52a1 \u96c6\u6210ldap\u8ba4\u8bc1 \u914d\u7f6email\u670d\u52a1 \u5907\u4efd\u548c\u6062\u590d \u5b98\u65b9\u7248\uff1a # \u5907\u4efd\uff0c\u5728docker\u4e2d\u6267\u884c gitlab-rake gitlab:backup:create # \u5728/var/opt/gitlab/backups\u4e2d\u751f\u6210\u7c7b\u4f3c\uff1a1555502732_2019_04_17_10.2.8_gitlab_backup.tar # \u4ece\u5907\u4efd\u4e2d\u6062\u590d\uff0c\u5148\u505c\u6b62\u670d\u52a1 gitlab-ctl stop unicorn gitlab-ctl stop sidekiq # \u4ece\u6307\u5b9a\u7f16\u53f7\u5907\u4efd\u4e2d\u6062\u590d gitlab-rake gitlab:backup:restore BACKUP=1555502732_2019_04_17_10.2.8 # \u91cd\u542f\u670d\u52a1 gitlab-ctl start \u66b4\u529b\u7248\uff1a # \u505cdocker\uff0c\u5907\u4efd\uff0c\u76f4\u63a5\u628adata\u6253\u5305\uff0c\u751f\u6210\u7c7b\u4f3c\uff1agitback-2019-04-18.tar.gz tar -zcvf /backup/data/gitback-${DATE}.tar.gz -C /data/ # \u6062\u590d\uff0c\u518d\u91cd\u542fdocker tar -xf gitback-2019-04-18.tar.gz -C /data/ docker-compose up -d","title":"Gitlab\u7248\u672c\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/gitlab/#gitlab","text":"","title":"Gitlab\u7248\u672c\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/gitlab/#_1","text":"\u4e2d\u6587\u793e\u533a\u7248github","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/gitlab/#docker","text":"\u4ee510.2.8\u7248\u672c\u4e3a\u4f8b\uff0cdocker-compose.yml\u6587\u4ef6\u5982\u4e0b\uff1a version: '2' services: gitlab: container_name: gitlab image: twang2218/gitlab-ce-zh:10.2.8 # \u670d\u52a1\u786c\u4ef6\u9700\u6c42\uff0c500\u4eba\u4ee5\u4e0b\uff1a2Core\uff0c6G\u5185\u5b58\uff0c100G\u786c\u76d8 cpu_quota: 200000 mem_limit: 4G restart: unless-stopped # hostname: 'gitlab.example.com' environment: TZ: 'Asia/Shanghai' GITLAB_OMNIBUS_CONFIG: | gitlab_rails['time_zone'] = 'Asia/Shanghai' # external_url 'http://gitlab.example.com' # \u9700\u8981\u914d\u7f6e\u5230 gitlab.rb \u4e2d\u7684\u914d\u7f6e\u53ef\u4ee5\u5728\u8fd9\u91cc\u914d\u7f6e\uff0c\u6bcf\u4e2a\u914d\u7f6e\u4e00\u884c\uff0c\u6ce8\u610f\u7f29\u8fdb\u3002 # \u6bd4\u5982\u4e0b\u9762\u7684\u7535\u5b50\u90ae\u4ef6\u7684\u914d\u7f6e\uff1a # gitlab_rails['smtp_enable'] = true # gitlab_rails['smtp_address'] = \"smtp.exmail.qq.com\" # gitlab_rails['smtp_port'] = 465 # gitlab_rails['smtp_user_name'] = \"xxxx@xx.com\" # gitlab_rails['smtp_password'] = \"password\" # gitlab_rails['smtp_authentication'] = \"login\" # gitlab_rails['smtp_enable_starttls_auto'] = true # gitlab_rails['smtp_tls'] = true # gitlab_rails['gitlab_email_from'] = 'xxxx@xx.com' ports: - '22:22' - '80:80' - '443:443' volumes: # \u63d0\u524d\u5728\u5927\u78c1\u76d8/data\u4e0b\u5efa\u7acb\u76f8\u5173\u76ee\u5f55\uff1a/data/gitlab - /data/gitlab/etc/gitlab:/etc/gitlab - /data/gitlab/log/gitlab:/var/log/gitlab - /data/gitlab/opt/gitlab:/var/opt/gitlab # extra_hosts: # - \"gitlab.example.com:0.0.0.0\" docker-compose up -d \u542f\u52a8 \u7b2c\u4e00\u542f\u52a8\u65f6\uff0c\u91cd\u7f6eroot\u5bc6\u7801 docker-compose down \u505c\u6b62\u670d\u52a1","title":"\u5b89\u88c5\uff08\u57fa\u4e8edocker\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/gitlab/#ldap","text":"","title":"\u96c6\u6210ldap\u8ba4\u8bc1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/gitlab/#mail","text":"","title":"\u914d\u7f6email\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/gitlab/#_2","text":"\u5b98\u65b9\u7248\uff1a # \u5907\u4efd\uff0c\u5728docker\u4e2d\u6267\u884c gitlab-rake gitlab:backup:create # \u5728/var/opt/gitlab/backups\u4e2d\u751f\u6210\u7c7b\u4f3c\uff1a1555502732_2019_04_17_10.2.8_gitlab_backup.tar # \u4ece\u5907\u4efd\u4e2d\u6062\u590d\uff0c\u5148\u505c\u6b62\u670d\u52a1 gitlab-ctl stop unicorn gitlab-ctl stop sidekiq # \u4ece\u6307\u5b9a\u7f16\u53f7\u5907\u4efd\u4e2d\u6062\u590d gitlab-rake gitlab:backup:restore BACKUP=1555502732_2019_04_17_10.2.8 # \u91cd\u542f\u670d\u52a1 gitlab-ctl start \u66b4\u529b\u7248\uff1a # \u505cdocker\uff0c\u5907\u4efd\uff0c\u76f4\u63a5\u628adata\u6253\u5305\uff0c\u751f\u6210\u7c7b\u4f3c\uff1agitback-2019-04-18.tar.gz tar -zcvf /backup/data/gitback-${DATE}.tar.gz -C /data/ # \u6062\u590d\uff0c\u518d\u91cd\u542fdocker tar -xf gitback-2019-04-18.tar.gz -C /data/ docker-compose up -d","title":"\u5907\u4efd\u548c\u6062\u590d"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/","text":"Jenkins\u5b9e\u7528\u624b\u518c \u7248\u672c 2.336 \u5728Ubuntu 18 \u4e0a\u6d4b\u8bd5\u901a\u8fc7 \u5b89\u88c5 # \u8bbe\u5b9aJenkins\u5de5\u4f5c\u76ee\u5f55 mkdir -p /data/jenkins # docker\u542f\u52a8 docker run \\ --name=go_jenkins \\ --user=root \\ -v /data/jenkins:/var/jenkins_home \\ -v /etc/localtime:/etc/localtime \\ -p 8080:8080 \\ --restart=always \\ -d jenkins/jenkins:2.336 # \u663e\u793a\u5b89\u88c5\u7528\u7684admin\u5bc6\u7801 cat /data/jenkins/secrets/initialAdminPassword \u8bbf\u95ee http://\u4e3b\u673aIP:8080/ \u5f00\u59cb\u5b89\u88c5\u5411\u5bfc \u9009\u62e9\u5b89\u88c5\u63a8\u8350\u63d2\u4ef6\uff0c\u4e0b\u4e00\u6b65\u5927\u6982\u4f1a\u78b0\u5230\u5404\u79cd\u5931\u8d25 \u66f4\u65b0\u56fd\u5185\u5b89\u88c5\u6e90\uff0c\u8bbf\u95ee http://\u4e3b\u673aIP:8080/pluginManager/advanced \u826f\u5fc3\u56fd\u5185\u5f00\u6e90\u955c\u50cf\uff0c\u6e05\u534e\uff1a https://mirrors.tuna.tsinghua.edu.cn/jenkins/ \u914d\u7f6e\u7b2c\u4e00\u4e2a\u7528\u6237 \u914d\u7f6e\u5b9e\u4f8b\u7684\u57df\u540d \u542f\u52a8\u670d\u52a1 \u4f7f\u7528 \u5b89\u88c5\u63d2\u4ef6 \u5e38\u7528\u63d2\u4ef6\uff1a pipeline\u76f8\u5173: Pipeline: Nodes and Processes Pipeline: Groovy Pipeline: Model API Pipeline: Declarative Extension Points API Pipeline: Shared Groovy Libraries docker\u76f8\u5173: Docker Commons Docker Pipeline Docker Slaves git\u76f8\u5173: Git Git Parameter GitLab Gitlab Authentication Gitlab API webhook\u76f8\u5173: Generic Webhook Trigger \u4f20\u5305 Publish Over SSH \u5907\u4efd ThinBackup \u96c6\u6210gitlab \u5728 Jenkins -> \u7cfb\u7edf\u914d\u7f6e \u7684'Gitlab'\u4e0b\u914d\u7f6e\u5185\u90e8gitlab\u670d\u52a1\u5730\u5740 \u5728'\u51ed\u636e'\u91cc\u6dfb\u52a0gitlab\u7684token \u5728gitlab\u7684 \u7528\u6237\u8bbe\u7f6e -> \u8bbf\u95ee\u4ee4\u724c \u91cc\u751f\u6210token \u8fde\u63a5\u6d4b\u8bd5\u540e\u4fdd\u5b58 \u7531\u4e8e\u5899\u7684\u539f\u56e0\uff0c\u5efa\u8bae\u5728jenkins\u5b9e\u4f8b\u91cc\u63d0\u524d\u5b89\u88c5go \u914d\u7f6essh\u63a8\u9001\u670d\u52a1 \u5728jenkins\u5b9e\u4f8b\u4e2d\u751f\u6210ssh-key \u516c\u94a5\u52a0\u5165\u5305\u5e93\u6240\u5728\u4e3b\u673a\u6307\u5b9a\u7528\u6237\uff08\u5efa\u8bae\u975eroot\uff09\u7684 authorized_keys \u5728 Jenkins -> \u7cfb\u7edf\u914d\u7f6e \u4e0b\u914d\u7f6e Publish over SSH \u5728pipeline\u4e2d\u7684\u4f7f\u7528 \u914d\u7f6e\u90ae\u4ef6\u53d1\u9001 \u4ee5\u963f\u91cc\u4e91\u90ae\u4ef6\u670d\u52a1\u4e3a\u4f8b \u5728 \u7cfb\u7edf\u914d\u7f6e -> \u90ae\u4ef6\u901a\u77e5 \u914d\u7f6e \u6ce8\u610f\uff1a\u963f\u91cc\u4e91\u90ae\u4ef6\u670d\u52a1\u8981\u6c42\u586b Mail From \uff0c\u5728\u63d2\u4ef6\u4e2d\u662f\u627e\u4e0d\u5230\u5730\u65b9\u914d\u7f6e\u7684\uff0c\u5b9e\u9645\u4f7f\u7528\u7684\u5f53\u524d\u7528\u6237\u7684\u90ae\u4ef6\u5730\u5740 \u5b89\u88c5go\u7f16\u8bd1\u73af\u5883 \u7ba1\u7406Jenkins -> \u63d2\u4ef6\u7ba1\u7406 \u91cc\u5b89\u88c5'Go plugin' \u7ba1\u7406Jenkins -> \u5168\u5c40\u5de5\u5177\u914d\u7f6e \u91cc'\u65b0\u589e Go' pipeline \u8fdb\u5165 \u65b0\u5efaItem \uff0c\u8f93\u5165\u65b0\u4efb\u52a1\u540d\uff0c\u9009\u62e9 \u6d41\u6c34\u7ebf \u540e\uff0c\u786e\u5b9a \u5728 \u6d41\u6c34\u7ebf \u811a\u672c\u4e2d\u5199\u76f8\u5173code // \u4ee5\u67d0\u4e2ago\u5e94\u7528\u7f16\u8bd1\u4e3a\u4f8b pipeline { agent any tools { // env setup\uff0c\u5728\u5168\u5c40\u8bbe\u7f6e\u4e2d\u7684go\u73af\u5883\u540d go 'go1.16' } environment { // \u5f53\u524dws\u7528\u73af\u5883\u53d8\u91cf GOPATH = \"${JENKINS_HOME}/jobs/${JOB_NAME}/builds/${BUILD_ID}\" } stages { stage('Clone') { steps { echo '1.Clone Stage' git credentialsId: 'chenqing', url: 'https://gitlab.xxx.com/my-group/go-api.git' // \u663e\u793a\u63d0\u4ea4\u7684\u6700\u540e2\u6761git\u8bb0\u5f55 sh 'git log -2' script { // get last commit hash build_commit = sh (script: 'git rev-parse --short HEAD', returnStdout: true).trim() } } } stage('Build') { steps { echo \"2.Build Stage\" // \u6267\u884c\u7f16\u8bd1\u52a8\u4f5c\uff0c\u6839\u636e\u5b9e\u9645\u751f\u6210 sh 'make build' } } stage('Make Tar') { steps { echo \"3.Make Tar Stage\" // go-api\u662f\u7f16\u8bd1\u5b8c\u6210\u679c\uff0c\u8ba1\u7b97md5\uff0c\u5e76\u6253\u5305 sh 'md5sum go-api > go-api.md5' sh 'tar -cPf ${JOB_NAME}_${BUILD_NUMBER}.tar go-api go-api.md5' } } stage('cp to package repo') { steps { echo \"4.cp to package repo\" // package.com\u662f\u5305\u5e93\u7684ssh\u5730\u5740\uff0c\u6309\u5e94\u7528\u540d\u5206\u76ee\u5f55\u5b58\u50a8 sh 'ssh root@package.com mkdir -p /mnt/package/repo/${JOB_NAME}' sh 'scp ${JOB_NAME}_${BUILD_NUMBER}.tar root@package.com:/mnt/package/repo/${JOB_NAME}/${JOB_NAME}_${BUILD_NUMBER}.tar' } } stage('Clear Workspace') { steps { echo '9.Clear Workspace' cleanWs() } } } post { always { // \u90ae\u4ef6\u901a\u77e5\u7ed3\u679c emailext body: \"${currentBuild.currentResult}: Job ${env.JOB_NAME} build ${env.BUILD_NUMBER}\\n More info at: ${env.BUILD_URL}\", to: \"admin@163.cn\", subject: \"Jenkins Build ${currentBuild.currentResult}: Job ${env.JOB_NAME}\" } } } \u7b2c\u4e09\u65b9\u901a\u8fc7API\u8c03\u7528 \u5728\u5f53\u524d\u7528\u6237\u7684\u8bbe\u7f6e\u9875\u9762\uff0c\u6dfb\u52a0API Token \u901a\u8fc7Post\u53d1\u9001\u8bf7\u6c42 curl --location --request POST 'http://{\u7528\u6237\u540d}:{\u4e0a\u6587\u751f\u6210\u7684Token}@{jenkins\u57df\u540d\u6216IP:Port}/job/{\u552f\u4e00\u9879\u76ee\u540d}/build' \u6ce8\u610f\uff1a Error 403: No valid crumb was included in the request \u7684\u89e3\u51b3\u65b9\u6848\u548cJenkins\u7248\u672c\u6709\u5173\uff0c\u6211\u7684\u65b9\u6848\u5728v2.336\u4e0a\u6d4b\u8bd5\u901a\u8fc7 \u5b9a\u65f6\u4efb\u52a1 \u96c6\u6210docker \u6570\u636e\u8fc1\u79fb \u5176\u5b9e\u6838\u5fc3\u662f\u5907\u4efd jenkins_home \uff0c\u4e5f\u53ef\u4f7f\u7528\u63d2\u4ef6 ThinBackup ThinBackup \u8bbe\u7f6e \u5c06\u5bfc\u51fa\u7684\u5907\u4efd\u76ee\u5f55\uff0c\u590d\u5236\u89e3\u538b\u5230\u76ee\u6807jenkins\u7684 jenkins_home \u4e0b \u91cd\u542fJenkins\uff0c\u6ce8\u610f\u5c3d\u91cf\u4fdd\u6301\u7248\u672c\u4e00\u76f4\uff0c\u5426\u5219load\u4efb\u52a1\u548cplugin\u53ef\u80fd\u4f1a\u5931\u8d25 \u6269\u5c55slave\u8282\u70b9 \u7ba1\u7406Jenkins -> \u8282\u70b9\u7ba1\u7406 \u4e2d'\u65b0\u5efa\u8282\u70b9' \u914d\u7f6e\u76f8\u5173\u4fe1\u606f\uff0c\u5e76\u4fdd\u5b58 \u8282\u70b9\u5217\u8868 \u4e2d\u70b9\u51fb\u521a\u624d\u65b0\u5efa\u7684\u8282\u70b9\uff0c\u786e\u8ba4\u542f\u52a8\u547d\u4ee4\u548c\u4e0b\u8f7djar\u5305 \u5728slave\u4e3b\u673a\u4e0a\u5b89\u88c5java\uff0c\u5982 apt install default-jre \u4e0a\u4f20jar\uff0c\u5e76\u4f7f\u7528\u4e0a\u6587\u7684\u547d\u4ee4\u542f\u52a8 \u8bbf\u95ee \u8282\u70b9\u5217\u8868 \uff0c\u786e\u8ba4\u8282\u70b9\u63a5\u5165 \u53ef\u9009\uff1aslave\u4e0a\u4f7f\u7528supervisor\u5f00\u673a\u542f\u52a8jar \u6ce8\u610f\uff1a master\u4e0a\u4f9d\u8d56\u7684\u73af\u5883\u5728slave\u4e0a\u8981\u90e8\u7f72\u5728\u540c\u76ee\u5f55\uff0c\u5982go\uff0cssh-key\u7b49 \u5efa\u8baeagent.jar\u653e\u5728\u7528\u6237\u76ee\u5f55\u4e0b\uff0c\u56e0\u4e3a\u9700\u8981\u8bfbsh\u73af\u5883\u53d8\u91cf\uff08.bashrc\uff09 \u53c2\u8003 \u5b98\u7f51\u6587\u6863 https://www.jenkins.io/zh/doc/","title":"Jenkins\u5b9e\u7528\u624b\u518c"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#jenkins","text":"\u7248\u672c 2.336 \u5728Ubuntu 18 \u4e0a\u6d4b\u8bd5\u901a\u8fc7","title":"Jenkins\u5b9e\u7528\u624b\u518c"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#_1","text":"# \u8bbe\u5b9aJenkins\u5de5\u4f5c\u76ee\u5f55 mkdir -p /data/jenkins # docker\u542f\u52a8 docker run \\ --name=go_jenkins \\ --user=root \\ -v /data/jenkins:/var/jenkins_home \\ -v /etc/localtime:/etc/localtime \\ -p 8080:8080 \\ --restart=always \\ -d jenkins/jenkins:2.336 # \u663e\u793a\u5b89\u88c5\u7528\u7684admin\u5bc6\u7801 cat /data/jenkins/secrets/initialAdminPassword \u8bbf\u95ee http://\u4e3b\u673aIP:8080/ \u5f00\u59cb\u5b89\u88c5\u5411\u5bfc \u9009\u62e9\u5b89\u88c5\u63a8\u8350\u63d2\u4ef6\uff0c\u4e0b\u4e00\u6b65\u5927\u6982\u4f1a\u78b0\u5230\u5404\u79cd\u5931\u8d25 \u66f4\u65b0\u56fd\u5185\u5b89\u88c5\u6e90\uff0c\u8bbf\u95ee http://\u4e3b\u673aIP:8080/pluginManager/advanced \u826f\u5fc3\u56fd\u5185\u5f00\u6e90\u955c\u50cf\uff0c\u6e05\u534e\uff1a https://mirrors.tuna.tsinghua.edu.cn/jenkins/ \u914d\u7f6e\u7b2c\u4e00\u4e2a\u7528\u6237 \u914d\u7f6e\u5b9e\u4f8b\u7684\u57df\u540d \u542f\u52a8\u670d\u52a1","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#_2","text":"","title":"\u4f7f\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#_3","text":"\u5e38\u7528\u63d2\u4ef6\uff1a pipeline\u76f8\u5173: Pipeline: Nodes and Processes Pipeline: Groovy Pipeline: Model API Pipeline: Declarative Extension Points API Pipeline: Shared Groovy Libraries docker\u76f8\u5173: Docker Commons Docker Pipeline Docker Slaves git\u76f8\u5173: Git Git Parameter GitLab Gitlab Authentication Gitlab API webhook\u76f8\u5173: Generic Webhook Trigger \u4f20\u5305 Publish Over SSH \u5907\u4efd ThinBackup","title":"\u5b89\u88c5\u63d2\u4ef6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#gitlab","text":"\u5728 Jenkins -> \u7cfb\u7edf\u914d\u7f6e \u7684'Gitlab'\u4e0b\u914d\u7f6e\u5185\u90e8gitlab\u670d\u52a1\u5730\u5740 \u5728'\u51ed\u636e'\u91cc\u6dfb\u52a0gitlab\u7684token \u5728gitlab\u7684 \u7528\u6237\u8bbe\u7f6e -> \u8bbf\u95ee\u4ee4\u724c \u91cc\u751f\u6210token \u8fde\u63a5\u6d4b\u8bd5\u540e\u4fdd\u5b58 \u7531\u4e8e\u5899\u7684\u539f\u56e0\uff0c\u5efa\u8bae\u5728jenkins\u5b9e\u4f8b\u91cc\u63d0\u524d\u5b89\u88c5go","title":"\u96c6\u6210gitlab"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#ssh","text":"\u5728jenkins\u5b9e\u4f8b\u4e2d\u751f\u6210ssh-key \u516c\u94a5\u52a0\u5165\u5305\u5e93\u6240\u5728\u4e3b\u673a\u6307\u5b9a\u7528\u6237\uff08\u5efa\u8bae\u975eroot\uff09\u7684 authorized_keys \u5728 Jenkins -> \u7cfb\u7edf\u914d\u7f6e \u4e0b\u914d\u7f6e Publish over SSH \u5728pipeline\u4e2d\u7684\u4f7f\u7528","title":"\u914d\u7f6essh\u63a8\u9001\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#_4","text":"\u4ee5\u963f\u91cc\u4e91\u90ae\u4ef6\u670d\u52a1\u4e3a\u4f8b \u5728 \u7cfb\u7edf\u914d\u7f6e -> \u90ae\u4ef6\u901a\u77e5 \u914d\u7f6e \u6ce8\u610f\uff1a\u963f\u91cc\u4e91\u90ae\u4ef6\u670d\u52a1\u8981\u6c42\u586b Mail From \uff0c\u5728\u63d2\u4ef6\u4e2d\u662f\u627e\u4e0d\u5230\u5730\u65b9\u914d\u7f6e\u7684\uff0c\u5b9e\u9645\u4f7f\u7528\u7684\u5f53\u524d\u7528\u6237\u7684\u90ae\u4ef6\u5730\u5740","title":"\u914d\u7f6e\u90ae\u4ef6\u53d1\u9001"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#go","text":"\u7ba1\u7406Jenkins -> \u63d2\u4ef6\u7ba1\u7406 \u91cc\u5b89\u88c5'Go plugin' \u7ba1\u7406Jenkins -> \u5168\u5c40\u5de5\u5177\u914d\u7f6e \u91cc'\u65b0\u589e Go'","title":"\u5b89\u88c5go\u7f16\u8bd1\u73af\u5883"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#pipeline","text":"\u8fdb\u5165 \u65b0\u5efaItem \uff0c\u8f93\u5165\u65b0\u4efb\u52a1\u540d\uff0c\u9009\u62e9 \u6d41\u6c34\u7ebf \u540e\uff0c\u786e\u5b9a \u5728 \u6d41\u6c34\u7ebf \u811a\u672c\u4e2d\u5199\u76f8\u5173code // \u4ee5\u67d0\u4e2ago\u5e94\u7528\u7f16\u8bd1\u4e3a\u4f8b pipeline { agent any tools { // env setup\uff0c\u5728\u5168\u5c40\u8bbe\u7f6e\u4e2d\u7684go\u73af\u5883\u540d go 'go1.16' } environment { // \u5f53\u524dws\u7528\u73af\u5883\u53d8\u91cf GOPATH = \"${JENKINS_HOME}/jobs/${JOB_NAME}/builds/${BUILD_ID}\" } stages { stage('Clone') { steps { echo '1.Clone Stage' git credentialsId: 'chenqing', url: 'https://gitlab.xxx.com/my-group/go-api.git' // \u663e\u793a\u63d0\u4ea4\u7684\u6700\u540e2\u6761git\u8bb0\u5f55 sh 'git log -2' script { // get last commit hash build_commit = sh (script: 'git rev-parse --short HEAD', returnStdout: true).trim() } } } stage('Build') { steps { echo \"2.Build Stage\" // \u6267\u884c\u7f16\u8bd1\u52a8\u4f5c\uff0c\u6839\u636e\u5b9e\u9645\u751f\u6210 sh 'make build' } } stage('Make Tar') { steps { echo \"3.Make Tar Stage\" // go-api\u662f\u7f16\u8bd1\u5b8c\u6210\u679c\uff0c\u8ba1\u7b97md5\uff0c\u5e76\u6253\u5305 sh 'md5sum go-api > go-api.md5' sh 'tar -cPf ${JOB_NAME}_${BUILD_NUMBER}.tar go-api go-api.md5' } } stage('cp to package repo') { steps { echo \"4.cp to package repo\" // package.com\u662f\u5305\u5e93\u7684ssh\u5730\u5740\uff0c\u6309\u5e94\u7528\u540d\u5206\u76ee\u5f55\u5b58\u50a8 sh 'ssh root@package.com mkdir -p /mnt/package/repo/${JOB_NAME}' sh 'scp ${JOB_NAME}_${BUILD_NUMBER}.tar root@package.com:/mnt/package/repo/${JOB_NAME}/${JOB_NAME}_${BUILD_NUMBER}.tar' } } stage('Clear Workspace') { steps { echo '9.Clear Workspace' cleanWs() } } } post { always { // \u90ae\u4ef6\u901a\u77e5\u7ed3\u679c emailext body: \"${currentBuild.currentResult}: Job ${env.JOB_NAME} build ${env.BUILD_NUMBER}\\n More info at: ${env.BUILD_URL}\", to: \"admin@163.cn\", subject: \"Jenkins Build ${currentBuild.currentResult}: Job ${env.JOB_NAME}\" } } }","title":"pipeline"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#api","text":"\u5728\u5f53\u524d\u7528\u6237\u7684\u8bbe\u7f6e\u9875\u9762\uff0c\u6dfb\u52a0API Token \u901a\u8fc7Post\u53d1\u9001\u8bf7\u6c42 curl --location --request POST 'http://{\u7528\u6237\u540d}:{\u4e0a\u6587\u751f\u6210\u7684Token}@{jenkins\u57df\u540d\u6216IP:Port}/job/{\u552f\u4e00\u9879\u76ee\u540d}/build' \u6ce8\u610f\uff1a Error 403: No valid crumb was included in the request \u7684\u89e3\u51b3\u65b9\u6848\u548cJenkins\u7248\u672c\u6709\u5173\uff0c\u6211\u7684\u65b9\u6848\u5728v2.336\u4e0a\u6d4b\u8bd5\u901a\u8fc7","title":"\u7b2c\u4e09\u65b9\u901a\u8fc7API\u8c03\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#_5","text":"","title":"\u5b9a\u65f6\u4efb\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#docker","text":"","title":"\u96c6\u6210docker"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#_6","text":"\u5176\u5b9e\u6838\u5fc3\u662f\u5907\u4efd jenkins_home \uff0c\u4e5f\u53ef\u4f7f\u7528\u63d2\u4ef6 ThinBackup ThinBackup \u8bbe\u7f6e \u5c06\u5bfc\u51fa\u7684\u5907\u4efd\u76ee\u5f55\uff0c\u590d\u5236\u89e3\u538b\u5230\u76ee\u6807jenkins\u7684 jenkins_home \u4e0b \u91cd\u542fJenkins\uff0c\u6ce8\u610f\u5c3d\u91cf\u4fdd\u6301\u7248\u672c\u4e00\u76f4\uff0c\u5426\u5219load\u4efb\u52a1\u548cplugin\u53ef\u80fd\u4f1a\u5931\u8d25","title":"\u6570\u636e\u8fc1\u79fb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#slave","text":"\u7ba1\u7406Jenkins -> \u8282\u70b9\u7ba1\u7406 \u4e2d'\u65b0\u5efa\u8282\u70b9' \u914d\u7f6e\u76f8\u5173\u4fe1\u606f\uff0c\u5e76\u4fdd\u5b58 \u8282\u70b9\u5217\u8868 \u4e2d\u70b9\u51fb\u521a\u624d\u65b0\u5efa\u7684\u8282\u70b9\uff0c\u786e\u8ba4\u542f\u52a8\u547d\u4ee4\u548c\u4e0b\u8f7djar\u5305 \u5728slave\u4e3b\u673a\u4e0a\u5b89\u88c5java\uff0c\u5982 apt install default-jre \u4e0a\u4f20jar\uff0c\u5e76\u4f7f\u7528\u4e0a\u6587\u7684\u547d\u4ee4\u542f\u52a8 \u8bbf\u95ee \u8282\u70b9\u5217\u8868 \uff0c\u786e\u8ba4\u8282\u70b9\u63a5\u5165 \u53ef\u9009\uff1aslave\u4e0a\u4f7f\u7528supervisor\u5f00\u673a\u542f\u52a8jar \u6ce8\u610f\uff1a master\u4e0a\u4f9d\u8d56\u7684\u73af\u5883\u5728slave\u4e0a\u8981\u90e8\u7f72\u5728\u540c\u76ee\u5f55\uff0c\u5982go\uff0cssh-key\u7b49 \u5efa\u8baeagent.jar\u653e\u5728\u7528\u6237\u76ee\u5f55\u4e0b\uff0c\u56e0\u4e3a\u9700\u8981\u8bfbsh\u73af\u5883\u53d8\u91cf\uff08.bashrc\uff09","title":"\u6269\u5c55slave\u8282\u70b9"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/jenkins/#_7","text":"\u5b98\u7f51\u6587\u6863 https://www.jenkins.io/zh/doc/","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/redmine/","text":"Redmine\u9700\u6c42\u7ba1\u7406\u5e73\u53f0 \u53c2\u8003 Redmine\u5b98\u65b9\u955c\u50cf\uff1a https://github.com/docker-library/redmine MySQL\u5b98\u65b9\u955c\u50cf\uff1a https://hub.docker.com/_/mysql \u5b89\u88c5\uff08\u57fa\u4e8eDocker\uff09 \u4ee5Redmine-3.2.1 + MySQL-5\u4e3a\u4f8b\uff1a # \u5b89\u88c5MySQL mkdir -p /var/lib/mysql docker run --name mysql -e MYSQL_ROOT_PASSWORD=admin123 -p 3306:3306 -v /var/lib/mysql:/var/lib/mysql -d mysql:5 # \u8fdb\u5165\u5bb9\u5668\u540e\u7ef4\u62a4 docker exec -it mysql bash mysql -uroot -padmin123 \u6267\u884csql\uff1a -- \u5efa\u5e93 CREATE DATABASE redmine CHARACTER SET utf8; -- \u5efa\u7528\u6237 CREATE USER 'redmine'@'localhost' IDENTIFIED BY 'redmine'; -- \u6388\u6743 GRANT ALL PRIVILEGES ON redmine.* TO 'redmine'@'localhost'; \u9000\u51fadb\u540e\uff0c\u5728\u5bb9\u5668\u4e2d\u7ee7\u7eed\uff1a # \uff08\u53ef\u9009\uff0c\u6062\u590d\u6570\u636e\uff09\u5bfc\u5165\u539fsqldump\uff0c\u8981\u6c42\u5e93\u5148\u5b58\u5728 mysql -uroot -padmin123 redmine < ./redmine_bak.sql # \u542f\u52a8Redmine docker run \\ -d \\ --name redmine \\ --link mysql:mysql \\ -p 8080:3000 \\ redmine:3.2.1 # \uff08\u53ef\u9009\uff0c\u6570\u636e\u5907\u4efd\uff09 mysqldump -uroot -padmin123 redmine > /backup/redmine_`date +\"%Y-%m-%d\"`.sql","title":"Redmine\u9700\u6c42\u7ba1\u7406\u5e73\u53f0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/redmine/#redmine","text":"","title":"Redmine\u9700\u6c42\u7ba1\u7406\u5e73\u53f0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/redmine/#_1","text":"Redmine\u5b98\u65b9\u955c\u50cf\uff1a https://github.com/docker-library/redmine MySQL\u5b98\u65b9\u955c\u50cf\uff1a https://hub.docker.com/_/mysql","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/CICD/redmine/#docker","text":"\u4ee5Redmine-3.2.1 + MySQL-5\u4e3a\u4f8b\uff1a # \u5b89\u88c5MySQL mkdir -p /var/lib/mysql docker run --name mysql -e MYSQL_ROOT_PASSWORD=admin123 -p 3306:3306 -v /var/lib/mysql:/var/lib/mysql -d mysql:5 # \u8fdb\u5165\u5bb9\u5668\u540e\u7ef4\u62a4 docker exec -it mysql bash mysql -uroot -padmin123 \u6267\u884csql\uff1a -- \u5efa\u5e93 CREATE DATABASE redmine CHARACTER SET utf8; -- \u5efa\u7528\u6237 CREATE USER 'redmine'@'localhost' IDENTIFIED BY 'redmine'; -- \u6388\u6743 GRANT ALL PRIVILEGES ON redmine.* TO 'redmine'@'localhost'; \u9000\u51fadb\u540e\uff0c\u5728\u5bb9\u5668\u4e2d\u7ee7\u7eed\uff1a # \uff08\u53ef\u9009\uff0c\u6062\u590d\u6570\u636e\uff09\u5bfc\u5165\u539fsqldump\uff0c\u8981\u6c42\u5e93\u5148\u5b58\u5728 mysql -uroot -padmin123 redmine < ./redmine_bak.sql # \u542f\u52a8Redmine docker run \\ -d \\ --name redmine \\ --link mysql:mysql \\ -p 8080:3000 \\ redmine:3.2.1 # \uff08\u53ef\u9009\uff0c\u6570\u636e\u5907\u4efd\uff09 mysqldump -uroot -padmin123 redmine > /backup/redmine_`date +\"%Y-%m-%d\"`.sql","title":"\u5b89\u88c5\uff08\u57fa\u4e8eDocker\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/","text":"ChatOps\u65b9\u6848\u6982\u8ff0 \u9700\u6c42 \u5feb\u901f\u90e8\u7f72 \u652f\u6301\u7075\u6d3b\u6269\u5c55 \u901a\u8baf\u5b89\u5168 \u652f\u6301\u6279\u91cf\u5347\u7ea7 \u5b66\u4e60\u66f2\u7ebf\u5e73\u7f13 \u4e1a\u52a1\u573a\u666f \u4e3b\u673a\u521d\u59cb\u5316\uff0c\u6ce8\u518c\u5fc3\u8df3 1\u53f0\u65b0\u4e3b\u673a\u52a0\u5165\u8d44\u6e90\u6c60\uff0c\u9700\u8981\u81ea\u52a8\u6ce8\u518c\u81ea\u8eab\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u5982IP\u3001CPU\u3001\u5185\u5b58\u3001Hostname \u8fd0\u7ef4\u901a\u8fc7ansible\u63a8\u9001\u5e76\u6267\u884c\u5b89\u88c5\u811a\u672c \u4e3b\u673a\u5728/opt/zm_agent/\u5b89\u88c5\uff1avenv, errbot \u901a\u8fc7 curl ifconfig.me \u83b7\u53d6\u672c\u673aip\uff0c\u751f\u4ea7errbot\u7684config \u6267\u884cerrbot\uff0c\u8fdb\u5165\u6307\u5b9a\u5fc3\u8df3\u9891\u9053 \u5b89\u88c5\u76d1\u63a7\u7ec4\u4ef6 \u5347\u7ea7\u63d2\u4ef6\u7248\u672c \u7acb\u5373\u6267\u884c\u6307\u5b9a\u811a\u672c\uff0c\u4e0a\u62a5\u6267\u884c\u7ed3\u679c \u65b9\u6848 client\u5c42\uff1aerrbot+git \u4ea4\u4e92\u5c42\uff1airc\uff08inspircd\uff09 server\u5c42\uff1agitlab\uff08plugin repo\uff09\uff0c\u81ea\u7814api","title":"ChatOps\u65b9\u6848\u6982\u8ff0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/#chatops","text":"","title":"ChatOps\u65b9\u6848\u6982\u8ff0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/#_1","text":"\u5feb\u901f\u90e8\u7f72 \u652f\u6301\u7075\u6d3b\u6269\u5c55 \u901a\u8baf\u5b89\u5168 \u652f\u6301\u6279\u91cf\u5347\u7ea7 \u5b66\u4e60\u66f2\u7ebf\u5e73\u7f13","title":"\u9700\u6c42"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/#_2","text":"","title":"\u4e1a\u52a1\u573a\u666f"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/#_3","text":"1\u53f0\u65b0\u4e3b\u673a\u52a0\u5165\u8d44\u6e90\u6c60\uff0c\u9700\u8981\u81ea\u52a8\u6ce8\u518c\u81ea\u8eab\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u5982IP\u3001CPU\u3001\u5185\u5b58\u3001Hostname \u8fd0\u7ef4\u901a\u8fc7ansible\u63a8\u9001\u5e76\u6267\u884c\u5b89\u88c5\u811a\u672c \u4e3b\u673a\u5728/opt/zm_agent/\u5b89\u88c5\uff1avenv, errbot \u901a\u8fc7 curl ifconfig.me \u83b7\u53d6\u672c\u673aip\uff0c\u751f\u4ea7errbot\u7684config \u6267\u884cerrbot\uff0c\u8fdb\u5165\u6307\u5b9a\u5fc3\u8df3\u9891\u9053","title":"\u4e3b\u673a\u521d\u59cb\u5316\uff0c\u6ce8\u518c\u5fc3\u8df3"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/#_4","text":"","title":"\u5b89\u88c5\u76d1\u63a7\u7ec4\u4ef6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/#_5","text":"","title":"\u5347\u7ea7\u63d2\u4ef6\u7248\u672c"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/#_6","text":"","title":"\u7acb\u5373\u6267\u884c\u6307\u5b9a\u811a\u672c\uff0c\u4e0a\u62a5\u6267\u884c\u7ed3\u679c"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/#_7","text":"client\u5c42\uff1aerrbot+git \u4ea4\u4e92\u5c42\uff1airc\uff08inspircd\uff09 server\u5c42\uff1agitlab\uff08plugin repo\uff09\uff0c\u81ea\u7814api","title":"\u65b9\u6848"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/inspircd/","text":"inspircd IRC\u670d\u52a1 \u5b89\u88c5 # \u542f\u52a8\uff0c\u6307\u5b9a\u5bc6\u7801 docker run -d \\ --name ircd \\ --restart=always \\ -p 16667:6667 \\ -e \"INSP_CONNECT_PASSWORD=hmac-sha256\" \\ inspircd/inspircd-docker \u53c2\u8003 \u5b98\u7f51 https://github.com/inspircd/inspircd","title":"inspircd IRC\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/inspircd/#inspircd-irc","text":"","title":"inspircd IRC\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/inspircd/#_1","text":"# \u542f\u52a8\uff0c\u6307\u5b9a\u5bc6\u7801 docker run -d \\ --name ircd \\ --restart=always \\ -p 16667:6667 \\ -e \"INSP_CONNECT_PASSWORD=hmac-sha256\" \\ inspircd/inspircd-docker","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/chatops/inspircd/#_2","text":"\u5b98\u7f51 https://github.com/inspircd/inspircd","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/","text":"\u7b80\u4ecb \u652f\u6301\u516c\u53f8\u4e1a\u52a1\u7cfb\u7edf\u7684\u5e94\u7528\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u5e2e\u52a9\u4e1a\u52a1\u5b9e\u73b0\u4ef7\u503c\u6700\u5927\u5316\u3002 \"\u8d34\u8fd1\u4e1a\u52a1\uff0c\u7406\u89e3\u4e1a\u52a1\uff0c\u6316\u6398\u4e1a\u52a1\u7684\u4ef7\u503c\uff0c\u6269\u5c55\u670d\u52a1\u4ef7\u503c\u3002\" \u670d\u52a1\u4f53\u7cfb \u8fd0\u7ef4\u7814\u53d1\u5de5\u7a0b\u5e08\u4f1a\u8de8\u4e1a\u52a1\u751f\u547d\u5468\u671f\u7684\u4ecb\u5165\u5176\u4e2d\u3002 \u7814\u53d1\u671f \u8fd0\u8425\u671f \u9ad8\u53ef\u7528\u67b6\u6784\u8bbe\u8ba1 \u6301\u7eed\u96c6\u6210\u548c\u90e8\u7f72 \u9ad8\u53ef\u7528\u4fdd\u969c \u6570\u636e\u670d\u52a1 \u6210\u672c\u4f18\u5316 \u4ea7\u54c1\u8fd0\u8425\u652f\u6301 \u7528\u6237\u4f53\u9a8c\u4f18\u5316","title":"\u7b80\u4ecb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/#_1","text":"\u652f\u6301\u516c\u53f8\u4e1a\u52a1\u7cfb\u7edf\u7684\u5e94\u7528\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u5e2e\u52a9\u4e1a\u52a1\u5b9e\u73b0\u4ef7\u503c\u6700\u5927\u5316\u3002 \"\u8d34\u8fd1\u4e1a\u52a1\uff0c\u7406\u89e3\u4e1a\u52a1\uff0c\u6316\u6398\u4e1a\u52a1\u7684\u4ef7\u503c\uff0c\u6269\u5c55\u670d\u52a1\u4ef7\u503c\u3002\"","title":"\u7b80\u4ecb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/#_2","text":"\u8fd0\u7ef4\u7814\u53d1\u5de5\u7a0b\u5e08\u4f1a\u8de8\u4e1a\u52a1\u751f\u547d\u5468\u671f\u7684\u4ecb\u5165\u5176\u4e2d\u3002 \u7814\u53d1\u671f \u8fd0\u8425\u671f \u9ad8\u53ef\u7528\u67b6\u6784\u8bbe\u8ba1 \u6301\u7eed\u96c6\u6210\u548c\u90e8\u7f72 \u9ad8\u53ef\u7528\u4fdd\u969c \u6570\u636e\u670d\u52a1 \u6210\u672c\u4f18\u5316 \u4ea7\u54c1\u8fd0\u8425\u652f\u6301 \u7528\u6237\u4f53\u9a8c\u4f18\u5316","title":"\u670d\u52a1\u4f53\u7cfb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/alarm/","text":"\u544a\u8b66\u670d\u52a1","title":"\u544a\u8b66\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/alarm/#_1","text":"","title":"\u544a\u8b66\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/env_build/","text":"","title":"Env build"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/monitor/","text":"\u76d1\u63a7\u4f53\u7cfb \u76d1\u63a7\u662f\u4fdd\u969c\u4e1a\u52a1\u7a33\u5b9a\u6027\u7684\u6838\u5fc3\u4e1a\u52a1\u80fd\u529b\u4e4b\u4e00\uff0c\u4ece\u4f4e\u5230\u9ad8\u53ef\u5206\u7ea7\u4e3a\uff1a \u65e0\u5e8f\u6df7\u4e71\u7684\uff0c\u6551\u706b\u961f\u5f0f \u5efa\u7acb\u521d\u6b65\u7684\u6807\u51c6\u548c\u6545\u969c\u5904\u7406\u6d41\u7a0b \u5bf9\u4e1a\u52a1\u751f\u547d\u5468\u671f\u6709\u89c4\u8303\u7684\u7ba1\u7406\u80fd\u529b\uff0c\u63d0\u4f9b\u5e73\u53f0\u81ea\u52a9\u670d\u52a1 \u4f9d\u8d56\u6570\u636e\uff0c\u80fd\u9884\u6d4b\u7684\u505a\u8fd0\u7ef4\u51b3\u7b56 \u5e94\u7528\u76d1\u63a7\u80fd\u529b \u76d1\u63a7\u6570\u636e\u662f\u540e\u7eed\u5176\u4ed6\u670d\u52a1\u7684\u57fa\u77f3\uff0c\u9700\u8981\u4ece\u70b9\u5230\u9762\u9010\u6b65\u8986\u76d6\u3002 \u8d28\u91cf\u4f53\u7cfb\u6807\u51c6\u5316 \u4e8b\u4ef6\u54cd\u5e94\u548c\u5904\u7406 \u76d1\u63a7\u5e73\u53f0","title":"\u76d1\u63a7\u4f53\u7cfb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/monitor/#_1","text":"\u76d1\u63a7\u662f\u4fdd\u969c\u4e1a\u52a1\u7a33\u5b9a\u6027\u7684\u6838\u5fc3\u4e1a\u52a1\u80fd\u529b\u4e4b\u4e00\uff0c\u4ece\u4f4e\u5230\u9ad8\u53ef\u5206\u7ea7\u4e3a\uff1a \u65e0\u5e8f\u6df7\u4e71\u7684\uff0c\u6551\u706b\u961f\u5f0f \u5efa\u7acb\u521d\u6b65\u7684\u6807\u51c6\u548c\u6545\u969c\u5904\u7406\u6d41\u7a0b \u5bf9\u4e1a\u52a1\u751f\u547d\u5468\u671f\u6709\u89c4\u8303\u7684\u7ba1\u7406\u80fd\u529b\uff0c\u63d0\u4f9b\u5e73\u53f0\u81ea\u52a9\u670d\u52a1 \u4f9d\u8d56\u6570\u636e\uff0c\u80fd\u9884\u6d4b\u7684\u505a\u8fd0\u7ef4\u51b3\u7b56","title":"\u76d1\u63a7\u4f53\u7cfb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/monitor/#_2","text":"\u76d1\u63a7\u6570\u636e\u662f\u540e\u7eed\u5176\u4ed6\u670d\u52a1\u7684\u57fa\u77f3\uff0c\u9700\u8981\u4ece\u70b9\u5230\u9762\u9010\u6b65\u8986\u76d6\u3002","title":"\u5e94\u7528\u76d1\u63a7\u80fd\u529b"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/monitor/#_3","text":"","title":"\u8d28\u91cf\u4f53\u7cfb\u6807\u51c6\u5316"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/monitor/#_4","text":"","title":"\u4e8b\u4ef6\u54cd\u5e94\u548c\u5904\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/monitor/#_5","text":"","title":"\u76d1\u63a7\u5e73\u53f0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/","text":"\u5e38\u89c1\u8fd0\u7ef4\u9762\u8bd5\u9898\u76ee \u914d\u7ba1 \u73b0\u6709100\u53f0\u670d\u52a1\u5668\uff0c\u8be5\u5982\u4f55\u7ba1\u7406\uff1f * \u8bbe\u5b9a\u8df3\u677f\u673a\uff0c\u4f7f\u7528\u7edf\u4e00\u8d26\u53f7\u767b\u5f55\uff0c\u4fbf\u4e8e\u5b89\u5168 * \u4f7f\u7528ansiable\u3001puppet\u8fdb\u884c\u7cfb\u7edf\u7684\u7edf\u4e00\u8c03\u5ea6\u4e0e\u914d\u7f6e * \u5efa\u7acb\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u3001\u914d\u7f6e\u3001\u5e94\u7528\u7684cmdb\u4fe1\u606f\u7ba1\u7406\u3002\u4fbf\u4e8e\u67e5\u9605\u5404\u79cd\u4fe1\u606f\u8bb0\u5f55 \u8d1f\u8f7d\u5747\u8861 LVS\u3001Nginx\u3001HAproxy\u6709\u4ec0\u4e48\u533a\u522b\u548c\u9009\u62e9\uff1f * LVS\uff1a \u662f\u57fa\u4e8e\u56db\u5c42\u7684\u8f6c\u53d1\uff0c\u9650\u7aef\u53e3 * HAproxy\uff1a \u662f\u57fa\u4e8e\u56db\u5c42\u548c\u4e03\u5c42\u7684\u8f6c\u53d1 * Nginx\uff1a \u662fWEB\u670d\u52a1\u5668\uff0c\u7f13\u5b58\u670d\u52a1\u5668\uff0c\u53c8\u662f\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u505a\u4e03\u5c42\u7684\u8f6c\u53d1 * \u5927\u5e76\u53d1\u91cf\u7684\u65f6\u5019\u6211\u4eec\u5c31\u8981\u9009\u62e9LVS\uff1b\u5e76\u53d1\u91cf\u6ca1\u90a3\u4e48\u5927\u9009\u62e9HAproxy\u6216\u8005Nginx\u8db3\u5df2 Keepalived\u7684\u5de5\u4f5c\u539f\u7406\uff1f * \u4e00\u4e2a\u865a\u62df\u8def\u7531\u5668\u4e2d\uff0c\u53ea\u6709\u4f5c\u4e3aMASTER\u7684VRRP\u8def\u7531\u5668\u4f1a\u4e00\u76f4\u53d1\u9001VRRP\u901a\u544a * \u5f53MASTER\u4e0d\u53ef\u7528\u65f6(BACKUP\u6536\u4e0d\u5230\u901a\u544a\u4fe1\u606f)\uff0c\u591a\u53f0BACKUP\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u8fd9\u53f0\u4f1a\u88ab\u62a2\u5360\u4e3aMASTER(<1s)\uff0c\u4ee5\u4fdd\u8bc1\u670d\u52a1\u7684\u8fde\u7eed\u6027 * VRRP\u5305\u4f7f\u7528\u4e86\u52a0\u5bc6\u534f\u8bae\u8fdb\u884c\u52a0\u5bc6\u3002BACKUP\u4e0d\u4f1a\u53d1\u9001\u901a\u544a\u4fe1\u606f LVS\u4e09\u79cd\u6a21\u5f0f\uff1f * NAT\u6a21\u5f0f\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u6570\u636e\u5305\u7684IP\u5934\u7684\u76ee\u7684\u5730\u5740\uff0c\u5728\u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\u6362\u6210\u5176\u4e2d\u4e00\u53f0RS\u7684IP\u5730\u5740\uff0c\u5e76\u53d1\u81f3\u6b64RS\u6765\u5904\u7406\uff1bRS\u5904\u7406\u5b8c\u540e\u628a\u6570\u636e\u4ea4\u7ed9\u8d1f\u8f7d\u5747\u8861\u5668,\u8d1f\u8f7d\u5747\u8861\u5668\u518d\u628a\u6570\u636e\u5305\u539fIP\u5730\u5740\u6539\u4e3a\u81ea\u5df1\u7684IP * \u4f18\u70b9\uff1a\u53ea\u6709\u8d1f\u8f7d\u5747\u8861\u5668\u9700\u8981\u4e00\u4e2a\u5408\u6cd5\u7684IP\u5730\u5740 * \u7f3a\u70b9\uff1a\u6269\u5c55\u6027\u6709\u9650\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6210\u4e3a\u6574\u4e2a\u7cfb\u7edf\u7684\u74f6\u9888\uff08\u5927\u91cf\u7684\u6570\u636e\u5305\u90fd\u4ea4\u6c47\u5728\u8d1f\u8f7d\u5747\u8861\u5668\uff09 * TUN\u96a7\u9053\u6a21\u5f0f\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u6570\u636e\u5305\uff0c\u5c01\u88c5\u4e00\u4e2a\u65b0\u7684IP\u5934\u6807\u8bb0(\u4ec5\u76ee\u7684IP)\u53d1\u7ed9RS\uff1bRS\uff08\u5185\u6838\u5fc5\u987b\u652f\u6301IPTUNNEL\u534f\u8bae\uff09\u6536\u5230\u540e,\u5148\u628a\u6570\u636e\u5305\u7684\u5934\u89e3\u5f00,\u8fd8\u539f\u6570\u636e\u5305,\u5904\u7406\u540e,\u76f4\u63a5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef,\u4e0d\u9700\u8981\u518d\u7ecf\u8fc7LB * \u4f18\u70b9\uff1a\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\uff0cLB\u4e0d\u662f\u74f6\u9888 * \u7f3a\u70b9\uff1aRS\u8282\u70b9\u9700\u8981\u5408\u6cd5IP\uff0c\u6240\u6709\u7684\u670d\u52a1\u5668\u652f\u6301\u201dIP Tunneling\u201d\u534f\u8bae * DR\u76f4\u63a5\u8def\u7531\u6a21\u5f0f\uff1aLB\u548cRS\u90fd\u4f7f\u7528\u540c\u4e00\u4e2aIP\u5bf9\u5916\u670d\u52a1\uff0c\u53ea\u6709DR\u5bf9ARP\u8bf7\u6c42\u8fdb\u884c\u54cd\u5e94\uff08\u6240\u6709RS\u5bf9\u8fd9\u4e2aIP\u7684ARP\u8bf7\u6c42\u4fdd\u6301\u9759\u9ed8\uff09\uff1bDR\u6536\u5230\u6570\u636e\u5305\u540e\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5,\u627e\u51fa\u5bf9\u5e94\u7684RS,\u628a\u76ee\u7684MAC\u5730\u5740\u6539\u4e3aRS\u7684MAC\uff0c\u5e76\u5c06\u8bf7\u6c42\u5206\u53d1\u7ed9\u8fd9\u53f0RS\uff1bRS\u76f4\u63a5\u8fd4\u56de\u6570\u636e\uff08IP\u4e00\u6837\uff09\uff1bLB\u548cRS\u5728\u540c\u4e00\u53f0\u4ea4\u6362\u673a\u4e0b * \u4f18\u70b9\uff1a\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\uff0c\u5e94\u7b54\u5305\u901a\u8fc7\u5355\u72ec\u7684\u8def\u7531\u65b9\u6cd5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef * \u7f3a\u70b9\uff1aLB\u7684\u7f51\u5361\u5fc5\u987b\u4e0e\u7269\u7406\u7f51\u5361\u5728\u4e00\u4e2a\u7269\u7406\u7f51\u6bb5\u4e0a \u5e38\u7528\u7684Nginx\u6a21\u5757? * rewrite\u6a21\u5757\uff0c\u5b9e\u73b0\u91cd\u5199 * access\u6a21\u5757\uff1a\u6765\u6e90\u63a7\u5236 * ssl\u6a21\u5757\uff1a\u5b89\u5168\u52a0\u5bc6 * ngx_http_gzip_module\uff1a\u7f51\u7edc\u4f20\u8f93\u538b\u7f29\u6a21\u5757 * ngx_http_proxy_module \u6a21\u5757\u5b9e\u73b0\u4ee3\u7406 * ngx_http_upstream_module\u6a21\u5757\u5b9e\u73b0\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u5668\u5217\u8868 Web\u670d\u52a1 Tomcat8005\u30018009\u30018080\u4e09\u4e2a\u7aef\u53e3\u7684\u542b\u4e49\uff1f * 8005\uff1a\u5173\u95ed\u4f7f\u7528 * 8009\uff1aAJP\u7aef\u53e3\uff0c\u5373\u5bb9\u5668\u4f7f\u7528\uff0c\u5982Apache\u80fd\u901a\u8fc7AJP\u534f\u8bae\u8bbf\u95eeTomcat\u76848009\u7aef\u53e3 * 8080\uff1a\u5e94\u7528\u4f7f\u7528 CDN\uff1f * \u5185\u5bb9\u5206\u53d1\u7f51\u7edc\uff0c\u901a\u8fc7\u5728\u73b0\u6709\u7684Internet\u4e2d\u589e\u52a0\u4e00\u5c42\u65b0\u7684\u7f51\u7edc\u67b6\u6784\uff0c\u5c06\u7f51\u7ad9\u7684\u5185\u5bb9\u53d1\u5e03\u5230\u6700\u63a5\u8fd1\u7528\u6237\u7684\u7f51\u7edc\u8fb9\u7f18\uff0c\u4f7f\u7528\u6237\u53ef\u5c31\u8fd1\u53d6\u5f97\u6240\u9700\u7684\u5185\u5bb9\uff0c\u63d0\u9ad8\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u7684\u901f\u5ea6 \u5b58\u50a8 raid0 raid1 raid5 \u5de5\u4f5c\u539f\u7406\u53ca\u7279\u70b9\uff1f * RAID 0\uff0c\u53ef\u4ee5\u662f\u4e00\u5757\u76d8\u548cN\u4e2a\u76d8\u7ec4\u5408\uff0c\u4f18\u70b9\u8bfb\u5199\u5feb\uff0c\u7f3a\u70b9\uff1a\u6ca1\u6709\u5197\u4f59\uff0c\u4e00\u5757\u574f\u4e86\u6570\u636e\u5c31\u5168\u6ca1\u6709\u4e86 * RAID 1\uff0c\u53ea\u80fd2\u5757\u76d8\uff0c\u76d8\u7684\u5927\u5c0f\u53ef\u4ee5\u4e0d\u4e00\u6837\uff0c\u4ee5\u5c0f\u7684\u4e3a\u51c6\uff0c100%\u7684\u5197\u4f59\uff0c\u7f3a\u70b9\uff1a\u6d6a\u8d39\u8d44\u6e90 * RAID 5 \uff0c3\u5757\u76d8\uff0c\u5bb9\u91cf\u8ba1\u7b9710*\uff08n-1\uff09,\u635f\u5931\u4e00\u5757\u76d8\uff0c\u8bfb\u6027\u80fd\u4e00\u822c\uff0c\u5199\u4e0d\u597d * \u5355\u53f0\u670d\u52a1\u5668\uff1a\u7cfb\u7edf\u76d8\uff0cRAID1 * \u6570\u636e\u5e93\u670d\u52a1\u5668\uff1a\u4e3b\u5e93\uff1aRAID10 \u4ece\u5e93 RAID5 \u53d8\u66f4\u4e0e\u53d1\u5e03 \u7070\u5ea6\u53d1\u5e03\uff1f * \u9ed1\u4e0e\u767d\u4e4b\u95f4\uff0c\u80fd\u591f\u5e73\u6ed1\u8fc7\u6e21\u7684\u4e00\u79cd\u53d1\u5e03\u65b9\u5f0f\uff0c\u5982AB Test\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6574\u4f53\u7cfb\u7edf\u7684\u7a33\u5b9a\uff0c\u5728\u521d\u59cb\u7070\u5ea6\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u53d1\u73b0\u3001\u8c03\u6574\u95ee\u9898\uff0c\u4ee5\u4fdd\u8bc1\u5176\u5f71\u54cd\u5ea6 \u7f51\u7edc DNS\u8fdb\u884c\u57df\u540d\u89e3\u6790\u7684\u8fc7\u7a0b\uff1f * \u672c\u673a\u7684host\u6587\u4ef6-->\u672c\u5730\u8bbe\u7f6e\u7684DNS\u670d\u52a1\u5668-->\u7f51\u7edc\u4e2d\u627e\u6839\u670d\u52a1\u5668-->\u4e00\u7ea7\u57df\u540d\u670d\u52a1\u5668.cn-->\u4e8c\u7ea7\u57df\u540d\u670d\u52a1\u5668.com.cn-->\u4e09\u7ea7\u57df\u540d\u670d\u52a1\u5668.baidu.com.cn\uff0c\u6b63\u597d\u6709\u8fd9\u4e2a\u7f51\u7ad9www.baidu.com\uff0c\u7136\u540e\u53d1\u7ed9\u8bf7\u6c42\u7684\u670d\u52a1\u5668\uff0c\u4fdd\u5b58\u4e00\u4efd\u4e4b\u540e\uff0c\u518d\u53d1\u7ed9\u5ba2\u6237\u7aef \u4e2d\u95f4\u4ef6 RabbitMQ\uff1f * \u6d88\u606f\u4e2d\u95f4\u4ef6\u662f\u5728\u6d88\u606f\u7684\u4f20\u606f\u8fc7\u7a0b\u4e2d\u4fdd\u5b58\u6d88\u606f\u7684\u5bb9\u5668\uff1b\u76ee\u7684\u662f\u63d0\u4f9b\u8def\u7531\u5e76\u4fdd\u8bc1\u6d88\u606f\u7684\u4f20\u9012\uff1b\u5982\u679c\u53d1\u9001\u6d88\u606f\u65f6\u63a5\u6536\u8005\u4e0d\u53ef\u7528\u6d88\u606f\u961f\u5217\u4e0d\u4f1a\u4fdd\u7559\u6d88\u606f\uff0c\u76f4\u5230\u53ef\u4ee5\u6210\u529f\u5730\u4f20\u9012\u4e3a\u6b62\uff0c\u6709\u65f6\u9650 \u6570\u636e\u5e93 mysql\u5982\u4f55\u51cf\u5c11\u4e3b\u4ece\u590d\u5236\u5ef6\u8fdf\uff1f\u53ef\u80fd\u539f\u56e0\uff1f * \u4ece\u5e93\u786c\u4ef6\u6bd4\u4e3b\u5e93\u5dee * \u6162SQL\u8bed\u53e5\u8fc7\u591a * \u7f51\u7edc\u5ef6\u8fdf * \u4e3b\u5e93\u8bfb\u5199\u538b\u529b\u5927\uff0c\u5efa\u8bae\u524d\u7aef\u52a0Cache * \u591a\u53f0slave\u6765\u5206\u644a\u8bfb\u8bf7\uff0c\u5176\u4e2d1\u53f0\u4e13\u7528\u4e8e\u5907\u4efd \u91cd\u7f6emysql root\u5bc6\u7801\uff1f * \u672c\u673ash\u4e0b\uff1a mysqladmin \u2013u root \u2013p password \"\u65b0\u5bc6\u7801\" * mysql>\u73af\u5883\u4e2d\uff1a Update mysql.user set password=password('\u65b0\u5bc6\u7801') where user='root';flush privileges; \u6216\u8005 grant all on *.* to root@'localhost' identified by '\u65b0\u5bc6\u7801'\uff1b * \u5fd8\u8bb0root\u5bc6\u7801\u65f6\uff1a * \u505c\u6b62\u670d\u52a1 service mysqld stop * \u5b89\u5168\u6a21\u5f0f mysql/bin/mysqld_safe --skip-grant-table & * \u7528\u7a7a\u5bc6\u7801\u7684root\u7528\u6237\u767b\u5f55 mysql -u root \uff0c\u540e\u540c\u4e0a mysql\u6570\u636e\u5907\u4efd? * mysql/bin/mysqldump \uff1a\u652f\u6301\u70ed\u5907\uff0c\u903b\u8f91\u5907\u4efd\uff0c\u901f\u5ea6\u4e0d\u5feb\uff0c\u9002\u5408\u6570\u636e\u6bd4\u8f83\u5c0f\u573a\u666f * LVM\u5feb\u7167\uff1a\u53ea\u80fd\u8fdb\u884c\u6ce0\u5907\u4efd * tar\u5305\u5907\u4efd \u5e38\u7528bash \u5206\u6790nginx\u8bbf\u95ee\u65e5\u5fd7\uff0c\u627e\u51fa\u8bbf\u95ee\u9875\u9762\u6570\u91cf\u5728\u524d\u5341\u4f4d\u7684ip: cat access.log | awk '{print $1}' | uniq -c | sort -rn | head -10 \u76d1\u542c\u4e3b\u673a\u4e3a192.168.1.1\uff0ctcp\u7aef\u53e3\u4e3a80\u7684\u6570\u636e\uff0c\u540c\u65f6\u5c06\u8f93\u51fa\u7ed3\u679c\u4fdd\u5b58\u8f93\u51fa\u5230tcpdump.log: tcpdump 'host 192.168.1.1 and port 80' > tcpdump.log \u672c\u573080 \u7aef\u53e3\u7684\u8bf7\u6c42\u8f6c\u53d1\u52308080 \u7aef\u53e3\uff0c\u5f53\u524d\u4e3b\u673aIP \u4e3a192.168.2.1: iptables -A PREROUTING -d 192.168.2.1 -p tcp -m tcp -dport 80 -j DNAT-to-destination 192.168.2.1:8080 \u5b9e\u65f6\u6293\u53d6\u5e76\u663e\u793a\u5f53\u524d\u7cfb\u7edf\u4e2dtcp 80\u7aef\u53e3\u7684\u7f51\u7edc\u6570\u636e: tcpdump -nn tcp port 80 \u67e5\u770bhttp\u7684\u5e76\u53d1\u8bf7\u6c42\u6570\u4e0e\u5176TCP\u8fde\u63a5\u72b6\u6001: netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u547d\u4ee4\u53d6\u51fa linux \u4e2d eth0 \u7684 IP: ifconfig eth0|awk 'NR==2'|awk -F \":\" '{print $2}'|awk '{print $1}' \u6bcf\u5929\u665a\u4e0a 12 \u70b9\uff0c\u6253\u5305\u7ad9\u70b9\u76ee\u5f55/var/www/html \u5907\u4efd\u5230/data \u76ee\u5f55\u4e0b: cd /var/www/ && /bin/tar zcf /data/html-`date +%m-%d%H`.tar.gz html/ ,\u4f7f\u7528crontab \u64cd\u4f5c\u7cfb\u7edf \u4f18\u5316Linux\u7cfb\u7edf\uff1f * \u4e0d\u7528root\uff0c\u6dfb\u52a0\u666e\u901a\u7528\u6237\uff0c\u901a\u8fc7sudo\u6388\u6743 * \u66f4\u6539\u9ed8\u8ba4\u7684\u8fdc\u7a0b\u8fde\u63a5SSH\u670d\u52a1\u7aef\u53e3\u53ca\u7981\u6b62root\u7528\u6237\u8fdc\u7a0b * \u5b9a\u65f6\u81ea\u52a8\u66f4\u65b0\u670d\u52a1\u5668\u65f6\u95f4 * \u914d\u7f6e\u56fd\u5185yum\u6e90 * \u5173\u95edselinux\u53caiptables\uff0c\u4f46\u662f\u5de5\u4f5c\u573a\u666f\u5982\u679c\u6709\u5916\u7f51IP\u4e00\u5b9a\u8981\u6253\u5f00 * \u8c03\u6574\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u91cf * \u7cbe\u7b80\u5f00\u673a\u542f\u52a8\u670d\u52a1\uff08crond rsyslog network sshd\uff09 * \u5185\u6838\u53c2\u6570\u4f18\u5316\uff08/etc/sysctl.conf\uff09 * \u66f4\u6539\u5b57\u7b26\u96c6\uff0c\u652f\u6301\u4e2d\u6587\uff0c\u4f46\u5efa\u8bae\u8fd8\u662f\u7528\u82f1\u6587\u5b57\u7b26\u96c6\uff0c\u9632\u6b62\u4e71\u7801 * \u9501\u5b9a\u5173\u952e\u7cfb\u7edf\u6587\u4ef6 * \u6e05\u7a7a/etc/issue\uff0c\u53bb\u9664\u7cfb\u7edf\u53ca\u5185\u6838\u7248\u672c\u767b\u5f55\u524d\u7684\u5c4f\u5e55\u663e\u793a \u4e2a\u4eba\u5b66\u4e60","title":"\u5e38\u89c1\u8fd0\u7ef4\u9762\u8bd5\u9898\u76ee"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_1","text":"","title":"\u5e38\u89c1\u8fd0\u7ef4\u9762\u8bd5\u9898\u76ee"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_2","text":"\u73b0\u6709100\u53f0\u670d\u52a1\u5668\uff0c\u8be5\u5982\u4f55\u7ba1\u7406\uff1f * \u8bbe\u5b9a\u8df3\u677f\u673a\uff0c\u4f7f\u7528\u7edf\u4e00\u8d26\u53f7\u767b\u5f55\uff0c\u4fbf\u4e8e\u5b89\u5168 * \u4f7f\u7528ansiable\u3001puppet\u8fdb\u884c\u7cfb\u7edf\u7684\u7edf\u4e00\u8c03\u5ea6\u4e0e\u914d\u7f6e * \u5efa\u7acb\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u3001\u914d\u7f6e\u3001\u5e94\u7528\u7684cmdb\u4fe1\u606f\u7ba1\u7406\u3002\u4fbf\u4e8e\u67e5\u9605\u5404\u79cd\u4fe1\u606f\u8bb0\u5f55","title":"\u914d\u7ba1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_3","text":"LVS\u3001Nginx\u3001HAproxy\u6709\u4ec0\u4e48\u533a\u522b\u548c\u9009\u62e9\uff1f * LVS\uff1a \u662f\u57fa\u4e8e\u56db\u5c42\u7684\u8f6c\u53d1\uff0c\u9650\u7aef\u53e3 * HAproxy\uff1a \u662f\u57fa\u4e8e\u56db\u5c42\u548c\u4e03\u5c42\u7684\u8f6c\u53d1 * Nginx\uff1a \u662fWEB\u670d\u52a1\u5668\uff0c\u7f13\u5b58\u670d\u52a1\u5668\uff0c\u53c8\u662f\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u505a\u4e03\u5c42\u7684\u8f6c\u53d1 * \u5927\u5e76\u53d1\u91cf\u7684\u65f6\u5019\u6211\u4eec\u5c31\u8981\u9009\u62e9LVS\uff1b\u5e76\u53d1\u91cf\u6ca1\u90a3\u4e48\u5927\u9009\u62e9HAproxy\u6216\u8005Nginx\u8db3\u5df2 Keepalived\u7684\u5de5\u4f5c\u539f\u7406\uff1f * \u4e00\u4e2a\u865a\u62df\u8def\u7531\u5668\u4e2d\uff0c\u53ea\u6709\u4f5c\u4e3aMASTER\u7684VRRP\u8def\u7531\u5668\u4f1a\u4e00\u76f4\u53d1\u9001VRRP\u901a\u544a * \u5f53MASTER\u4e0d\u53ef\u7528\u65f6(BACKUP\u6536\u4e0d\u5230\u901a\u544a\u4fe1\u606f)\uff0c\u591a\u53f0BACKUP\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u8fd9\u53f0\u4f1a\u88ab\u62a2\u5360\u4e3aMASTER(<1s)\uff0c\u4ee5\u4fdd\u8bc1\u670d\u52a1\u7684\u8fde\u7eed\u6027 * VRRP\u5305\u4f7f\u7528\u4e86\u52a0\u5bc6\u534f\u8bae\u8fdb\u884c\u52a0\u5bc6\u3002BACKUP\u4e0d\u4f1a\u53d1\u9001\u901a\u544a\u4fe1\u606f LVS\u4e09\u79cd\u6a21\u5f0f\uff1f * NAT\u6a21\u5f0f\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u6570\u636e\u5305\u7684IP\u5934\u7684\u76ee\u7684\u5730\u5740\uff0c\u5728\u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\u6362\u6210\u5176\u4e2d\u4e00\u53f0RS\u7684IP\u5730\u5740\uff0c\u5e76\u53d1\u81f3\u6b64RS\u6765\u5904\u7406\uff1bRS\u5904\u7406\u5b8c\u540e\u628a\u6570\u636e\u4ea4\u7ed9\u8d1f\u8f7d\u5747\u8861\u5668,\u8d1f\u8f7d\u5747\u8861\u5668\u518d\u628a\u6570\u636e\u5305\u539fIP\u5730\u5740\u6539\u4e3a\u81ea\u5df1\u7684IP * \u4f18\u70b9\uff1a\u53ea\u6709\u8d1f\u8f7d\u5747\u8861\u5668\u9700\u8981\u4e00\u4e2a\u5408\u6cd5\u7684IP\u5730\u5740 * \u7f3a\u70b9\uff1a\u6269\u5c55\u6027\u6709\u9650\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6210\u4e3a\u6574\u4e2a\u7cfb\u7edf\u7684\u74f6\u9888\uff08\u5927\u91cf\u7684\u6570\u636e\u5305\u90fd\u4ea4\u6c47\u5728\u8d1f\u8f7d\u5747\u8861\u5668\uff09 * TUN\u96a7\u9053\u6a21\u5f0f\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u6570\u636e\u5305\uff0c\u5c01\u88c5\u4e00\u4e2a\u65b0\u7684IP\u5934\u6807\u8bb0(\u4ec5\u76ee\u7684IP)\u53d1\u7ed9RS\uff1bRS\uff08\u5185\u6838\u5fc5\u987b\u652f\u6301IPTUNNEL\u534f\u8bae\uff09\u6536\u5230\u540e,\u5148\u628a\u6570\u636e\u5305\u7684\u5934\u89e3\u5f00,\u8fd8\u539f\u6570\u636e\u5305,\u5904\u7406\u540e,\u76f4\u63a5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef,\u4e0d\u9700\u8981\u518d\u7ecf\u8fc7LB * \u4f18\u70b9\uff1a\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\uff0cLB\u4e0d\u662f\u74f6\u9888 * \u7f3a\u70b9\uff1aRS\u8282\u70b9\u9700\u8981\u5408\u6cd5IP\uff0c\u6240\u6709\u7684\u670d\u52a1\u5668\u652f\u6301\u201dIP Tunneling\u201d\u534f\u8bae * DR\u76f4\u63a5\u8def\u7531\u6a21\u5f0f\uff1aLB\u548cRS\u90fd\u4f7f\u7528\u540c\u4e00\u4e2aIP\u5bf9\u5916\u670d\u52a1\uff0c\u53ea\u6709DR\u5bf9ARP\u8bf7\u6c42\u8fdb\u884c\u54cd\u5e94\uff08\u6240\u6709RS\u5bf9\u8fd9\u4e2aIP\u7684ARP\u8bf7\u6c42\u4fdd\u6301\u9759\u9ed8\uff09\uff1bDR\u6536\u5230\u6570\u636e\u5305\u540e\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5,\u627e\u51fa\u5bf9\u5e94\u7684RS,\u628a\u76ee\u7684MAC\u5730\u5740\u6539\u4e3aRS\u7684MAC\uff0c\u5e76\u5c06\u8bf7\u6c42\u5206\u53d1\u7ed9\u8fd9\u53f0RS\uff1bRS\u76f4\u63a5\u8fd4\u56de\u6570\u636e\uff08IP\u4e00\u6837\uff09\uff1bLB\u548cRS\u5728\u540c\u4e00\u53f0\u4ea4\u6362\u673a\u4e0b * \u4f18\u70b9\uff1a\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\uff0c\u5e94\u7b54\u5305\u901a\u8fc7\u5355\u72ec\u7684\u8def\u7531\u65b9\u6cd5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef * \u7f3a\u70b9\uff1aLB\u7684\u7f51\u5361\u5fc5\u987b\u4e0e\u7269\u7406\u7f51\u5361\u5728\u4e00\u4e2a\u7269\u7406\u7f51\u6bb5\u4e0a \u5e38\u7528\u7684Nginx\u6a21\u5757? * rewrite\u6a21\u5757\uff0c\u5b9e\u73b0\u91cd\u5199 * access\u6a21\u5757\uff1a\u6765\u6e90\u63a7\u5236 * ssl\u6a21\u5757\uff1a\u5b89\u5168\u52a0\u5bc6 * ngx_http_gzip_module\uff1a\u7f51\u7edc\u4f20\u8f93\u538b\u7f29\u6a21\u5757 * ngx_http_proxy_module \u6a21\u5757\u5b9e\u73b0\u4ee3\u7406 * ngx_http_upstream_module\u6a21\u5757\u5b9e\u73b0\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u5668\u5217\u8868","title":"\u8d1f\u8f7d\u5747\u8861"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#web","text":"Tomcat8005\u30018009\u30018080\u4e09\u4e2a\u7aef\u53e3\u7684\u542b\u4e49\uff1f * 8005\uff1a\u5173\u95ed\u4f7f\u7528 * 8009\uff1aAJP\u7aef\u53e3\uff0c\u5373\u5bb9\u5668\u4f7f\u7528\uff0c\u5982Apache\u80fd\u901a\u8fc7AJP\u534f\u8bae\u8bbf\u95eeTomcat\u76848009\u7aef\u53e3 * 8080\uff1a\u5e94\u7528\u4f7f\u7528 CDN\uff1f * \u5185\u5bb9\u5206\u53d1\u7f51\u7edc\uff0c\u901a\u8fc7\u5728\u73b0\u6709\u7684Internet\u4e2d\u589e\u52a0\u4e00\u5c42\u65b0\u7684\u7f51\u7edc\u67b6\u6784\uff0c\u5c06\u7f51\u7ad9\u7684\u5185\u5bb9\u53d1\u5e03\u5230\u6700\u63a5\u8fd1\u7528\u6237\u7684\u7f51\u7edc\u8fb9\u7f18\uff0c\u4f7f\u7528\u6237\u53ef\u5c31\u8fd1\u53d6\u5f97\u6240\u9700\u7684\u5185\u5bb9\uff0c\u63d0\u9ad8\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u7684\u901f\u5ea6","title":"Web\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_4","text":"raid0 raid1 raid5 \u5de5\u4f5c\u539f\u7406\u53ca\u7279\u70b9\uff1f * RAID 0\uff0c\u53ef\u4ee5\u662f\u4e00\u5757\u76d8\u548cN\u4e2a\u76d8\u7ec4\u5408\uff0c\u4f18\u70b9\u8bfb\u5199\u5feb\uff0c\u7f3a\u70b9\uff1a\u6ca1\u6709\u5197\u4f59\uff0c\u4e00\u5757\u574f\u4e86\u6570\u636e\u5c31\u5168\u6ca1\u6709\u4e86 * RAID 1\uff0c\u53ea\u80fd2\u5757\u76d8\uff0c\u76d8\u7684\u5927\u5c0f\u53ef\u4ee5\u4e0d\u4e00\u6837\uff0c\u4ee5\u5c0f\u7684\u4e3a\u51c6\uff0c100%\u7684\u5197\u4f59\uff0c\u7f3a\u70b9\uff1a\u6d6a\u8d39\u8d44\u6e90 * RAID 5 \uff0c3\u5757\u76d8\uff0c\u5bb9\u91cf\u8ba1\u7b9710*\uff08n-1\uff09,\u635f\u5931\u4e00\u5757\u76d8\uff0c\u8bfb\u6027\u80fd\u4e00\u822c\uff0c\u5199\u4e0d\u597d * \u5355\u53f0\u670d\u52a1\u5668\uff1a\u7cfb\u7edf\u76d8\uff0cRAID1 * \u6570\u636e\u5e93\u670d\u52a1\u5668\uff1a\u4e3b\u5e93\uff1aRAID10 \u4ece\u5e93 RAID5","title":"\u5b58\u50a8"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_5","text":"\u7070\u5ea6\u53d1\u5e03\uff1f * \u9ed1\u4e0e\u767d\u4e4b\u95f4\uff0c\u80fd\u591f\u5e73\u6ed1\u8fc7\u6e21\u7684\u4e00\u79cd\u53d1\u5e03\u65b9\u5f0f\uff0c\u5982AB Test\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6574\u4f53\u7cfb\u7edf\u7684\u7a33\u5b9a\uff0c\u5728\u521d\u59cb\u7070\u5ea6\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u53d1\u73b0\u3001\u8c03\u6574\u95ee\u9898\uff0c\u4ee5\u4fdd\u8bc1\u5176\u5f71\u54cd\u5ea6","title":"\u53d8\u66f4\u4e0e\u53d1\u5e03"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_6","text":"DNS\u8fdb\u884c\u57df\u540d\u89e3\u6790\u7684\u8fc7\u7a0b\uff1f * \u672c\u673a\u7684host\u6587\u4ef6-->\u672c\u5730\u8bbe\u7f6e\u7684DNS\u670d\u52a1\u5668-->\u7f51\u7edc\u4e2d\u627e\u6839\u670d\u52a1\u5668-->\u4e00\u7ea7\u57df\u540d\u670d\u52a1\u5668.cn-->\u4e8c\u7ea7\u57df\u540d\u670d\u52a1\u5668.com.cn-->\u4e09\u7ea7\u57df\u540d\u670d\u52a1\u5668.baidu.com.cn\uff0c\u6b63\u597d\u6709\u8fd9\u4e2a\u7f51\u7ad9www.baidu.com\uff0c\u7136\u540e\u53d1\u7ed9\u8bf7\u6c42\u7684\u670d\u52a1\u5668\uff0c\u4fdd\u5b58\u4e00\u4efd\u4e4b\u540e\uff0c\u518d\u53d1\u7ed9\u5ba2\u6237\u7aef","title":"\u7f51\u7edc"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_7","text":"RabbitMQ\uff1f * \u6d88\u606f\u4e2d\u95f4\u4ef6\u662f\u5728\u6d88\u606f\u7684\u4f20\u606f\u8fc7\u7a0b\u4e2d\u4fdd\u5b58\u6d88\u606f\u7684\u5bb9\u5668\uff1b\u76ee\u7684\u662f\u63d0\u4f9b\u8def\u7531\u5e76\u4fdd\u8bc1\u6d88\u606f\u7684\u4f20\u9012\uff1b\u5982\u679c\u53d1\u9001\u6d88\u606f\u65f6\u63a5\u6536\u8005\u4e0d\u53ef\u7528\u6d88\u606f\u961f\u5217\u4e0d\u4f1a\u4fdd\u7559\u6d88\u606f\uff0c\u76f4\u5230\u53ef\u4ee5\u6210\u529f\u5730\u4f20\u9012\u4e3a\u6b62\uff0c\u6709\u65f6\u9650","title":"\u4e2d\u95f4\u4ef6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_8","text":"mysql\u5982\u4f55\u51cf\u5c11\u4e3b\u4ece\u590d\u5236\u5ef6\u8fdf\uff1f\u53ef\u80fd\u539f\u56e0\uff1f * \u4ece\u5e93\u786c\u4ef6\u6bd4\u4e3b\u5e93\u5dee * \u6162SQL\u8bed\u53e5\u8fc7\u591a * \u7f51\u7edc\u5ef6\u8fdf * \u4e3b\u5e93\u8bfb\u5199\u538b\u529b\u5927\uff0c\u5efa\u8bae\u524d\u7aef\u52a0Cache * \u591a\u53f0slave\u6765\u5206\u644a\u8bfb\u8bf7\uff0c\u5176\u4e2d1\u53f0\u4e13\u7528\u4e8e\u5907\u4efd \u91cd\u7f6emysql root\u5bc6\u7801\uff1f * \u672c\u673ash\u4e0b\uff1a mysqladmin \u2013u root \u2013p password \"\u65b0\u5bc6\u7801\" * mysql>\u73af\u5883\u4e2d\uff1a Update mysql.user set password=password('\u65b0\u5bc6\u7801') where user='root';flush privileges; \u6216\u8005 grant all on *.* to root@'localhost' identified by '\u65b0\u5bc6\u7801'\uff1b * \u5fd8\u8bb0root\u5bc6\u7801\u65f6\uff1a * \u505c\u6b62\u670d\u52a1 service mysqld stop * \u5b89\u5168\u6a21\u5f0f mysql/bin/mysqld_safe --skip-grant-table & * \u7528\u7a7a\u5bc6\u7801\u7684root\u7528\u6237\u767b\u5f55 mysql -u root \uff0c\u540e\u540c\u4e0a mysql\u6570\u636e\u5907\u4efd? * mysql/bin/mysqldump \uff1a\u652f\u6301\u70ed\u5907\uff0c\u903b\u8f91\u5907\u4efd\uff0c\u901f\u5ea6\u4e0d\u5feb\uff0c\u9002\u5408\u6570\u636e\u6bd4\u8f83\u5c0f\u573a\u666f * LVM\u5feb\u7167\uff1a\u53ea\u80fd\u8fdb\u884c\u6ce0\u5907\u4efd * tar\u5305\u5907\u4efd","title":"\u6570\u636e\u5e93"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#bash","text":"\u5206\u6790nginx\u8bbf\u95ee\u65e5\u5fd7\uff0c\u627e\u51fa\u8bbf\u95ee\u9875\u9762\u6570\u91cf\u5728\u524d\u5341\u4f4d\u7684ip: cat access.log | awk '{print $1}' | uniq -c | sort -rn | head -10 \u76d1\u542c\u4e3b\u673a\u4e3a192.168.1.1\uff0ctcp\u7aef\u53e3\u4e3a80\u7684\u6570\u636e\uff0c\u540c\u65f6\u5c06\u8f93\u51fa\u7ed3\u679c\u4fdd\u5b58\u8f93\u51fa\u5230tcpdump.log: tcpdump 'host 192.168.1.1 and port 80' > tcpdump.log \u672c\u573080 \u7aef\u53e3\u7684\u8bf7\u6c42\u8f6c\u53d1\u52308080 \u7aef\u53e3\uff0c\u5f53\u524d\u4e3b\u673aIP \u4e3a192.168.2.1: iptables -A PREROUTING -d 192.168.2.1 -p tcp -m tcp -dport 80 -j DNAT-to-destination 192.168.2.1:8080 \u5b9e\u65f6\u6293\u53d6\u5e76\u663e\u793a\u5f53\u524d\u7cfb\u7edf\u4e2dtcp 80\u7aef\u53e3\u7684\u7f51\u7edc\u6570\u636e: tcpdump -nn tcp port 80 \u67e5\u770bhttp\u7684\u5e76\u53d1\u8bf7\u6c42\u6570\u4e0e\u5176TCP\u8fde\u63a5\u72b6\u6001: netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u547d\u4ee4\u53d6\u51fa linux \u4e2d eth0 \u7684 IP: ifconfig eth0|awk 'NR==2'|awk -F \":\" '{print $2}'|awk '{print $1}' \u6bcf\u5929\u665a\u4e0a 12 \u70b9\uff0c\u6253\u5305\u7ad9\u70b9\u76ee\u5f55/var/www/html \u5907\u4efd\u5230/data \u76ee\u5f55\u4e0b: cd /var/www/ && /bin/tar zcf /data/html-`date +%m-%d%H`.tar.gz html/ ,\u4f7f\u7528crontab","title":"\u5e38\u7528bash"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_9","text":"\u4f18\u5316Linux\u7cfb\u7edf\uff1f * \u4e0d\u7528root\uff0c\u6dfb\u52a0\u666e\u901a\u7528\u6237\uff0c\u901a\u8fc7sudo\u6388\u6743 * \u66f4\u6539\u9ed8\u8ba4\u7684\u8fdc\u7a0b\u8fde\u63a5SSH\u670d\u52a1\u7aef\u53e3\u53ca\u7981\u6b62root\u7528\u6237\u8fdc\u7a0b * \u5b9a\u65f6\u81ea\u52a8\u66f4\u65b0\u670d\u52a1\u5668\u65f6\u95f4 * \u914d\u7f6e\u56fd\u5185yum\u6e90 * \u5173\u95edselinux\u53caiptables\uff0c\u4f46\u662f\u5de5\u4f5c\u573a\u666f\u5982\u679c\u6709\u5916\u7f51IP\u4e00\u5b9a\u8981\u6253\u5f00 * \u8c03\u6574\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u91cf * \u7cbe\u7b80\u5f00\u673a\u542f\u52a8\u670d\u52a1\uff08crond rsyslog network sshd\uff09 * \u5185\u6838\u53c2\u6570\u4f18\u5316\uff08/etc/sysctl.conf\uff09 * \u66f4\u6539\u5b57\u7b26\u96c6\uff0c\u652f\u6301\u4e2d\u6587\uff0c\u4f46\u5efa\u8bae\u8fd8\u662f\u7528\u82f1\u6587\u5b57\u7b26\u96c6\uff0c\u9632\u6b62\u4e71\u7801 * \u9501\u5b9a\u5173\u952e\u7cfb\u7edf\u6587\u4ef6 * \u6e05\u7a7a/etc/issue\uff0c\u53bb\u9664\u7cfb\u7edf\u53ca\u5185\u6838\u7248\u672c\u767b\u5f55\u524d\u7684\u5c4f\u5e55\u663e\u793a","title":"\u64cd\u4f5c\u7cfb\u7edf"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/monitor_system/ops_interview/#_10","text":"","title":"\u4e2a\u4eba\u5b66\u4e60"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/","text":"\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u8c03\u7814 \u5bf9\u5e38\u89c1\u7684\u5f00\u6e90\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u7684\u5bf9\u6bd4\u8c03\u7814\uff0c\u8c03\u7814\u5bf9\u8c61\u5982\u4e0b\uff1a xxl-job Jenkins pipeline PowerJob Airflow Prefect \u9700\u6c42 \u5f00\u6e90\u534f\u8bae\uff0c\u53ef\u79c1\u6709\u5316\u90e8\u7f72\uff0c\u6682\u65f6\u4e0d\u8003\u8651saas\u7c7b \u5b9a\u65f6\u8c03\u5ea6\u6307\u5b9a\u4efb\u52a1\uff0c\u7c7bCrontab \u5de5\u4f5c\u6d41\uff0c\u7c7bDAG \u652f\u6301\u4efb\u52a1\u5206\u7247 \u8fd0\u884c\u5927\u76d8\uff0c\u8fd0\u884c\u65e5\u5fd7 \u6267\u884c\u7ed3\u679c\u53ef\u53cd\u9988\uff0c\u6bd4\u5982\u4efb\u52a1\u5931\u8d25\u540e\u53d1\u901a\u77e5 \u4efb\u52a1\u6267\u884c\u652f\u6301\u91cd\u8bd5 \u53ef\u63a5\u5165\u591a\u79cd\u5e38\u89c1\u8bed\u8a00\u7684\u4efb\u52a1\uff0c\u5982shell\u3001python\u7b49 \u63d0\u4f9bAPI\u7ed9\u5916\u90e8\u8c03\u7528 \u65e0\u5355\u70b9\u7ec4\u4ef6\uff0c\u5982\u4e00\u4e2amaster\u3001worker\u6302\u4e86\uff0c\u4e0d\u5f71\u54cd\u6574\u4f53 \u7b80\u8bc4 xxl-job \u4f18\u70b9\uff1a \u56fd\u4eba\u5f00\u53d1\uff0cGPLv3\u534f\u8bae\uff0c\u5f53\u524d\u7248\u672c\uff1a2.3.0 \u8c03\u5ea6\u4e2d\u5fc3<->\u6267\u884c\u5668 \u6a21\u5f0f\uff0c\u8f7b\u91cf\u7ea7\uff0c\u7b80\u5355\u597d\u7528 \u57fa\u4e8eWebIDE\uff0c\u652f\u6301\u591a\u79cd\u8bed\u8a00\u811a\u672c \u591a\u79cd\u8c03\u5ea6\u548c\u963b\u585e\u7b56\u7565 \u4efb\u52a1\u5931\u8d25\u63d0\u4f9b\u90ae\u4ef6\u901a\u77e5 \u63d0\u4f9bRestful API \u7f3a\u70b9\uff1a \u4fee\u6539\u914d\u7f6e\u56f0\u96be\uff0c\u6267\u884c\u5668\u9700\u8981\u91cd\u65b0\u6253\u5305 \u8c03\u5ea6\u4e2d\u5fc3\u662f\u5355\u70b9DB\uff0c\u7ed1\u5b9aMysql \u4e0d\u652f\u6301DAG \u4efb\u52a1\u53cd\u9988\u76ee\u524d\u53ea\u652f\u6301\u5931\u8d25\u90ae\u4ef6\uff0c\u5176\u4ed6\u4e0d\u652f\u6301 Jenkins \u4f18\u70b9\uff1a \u8fd0\u7ef4\u5e38\u89c1\u670d\u52a1\uff0c\u5bb9\u6613\u4f7f\u7528 \u5185\u7f6e\u5b9a\u65f6\u4efb\u52a1 \u57fa\u4e8epipeline\uff0c\u5b9e\u73b0\u7c7b\u5de5\u4f5c\u6d41 \u91c7\u96c6\u4efb\u52a1\u6267\u884c\u65f6\u7684\u63a7\u5236\u53f0\u8f93\u51fa\uff0c\u5bb9\u6613\u5b9a\u4f4d\u95ee\u9898 \u7f3a\u70b9\uff1a \u66f4\u805a\u7126\u5728CICD\u9886\u57df\uff0c\u901a\u7528\u6027\u8f83\u4f4e \u7531\u4e8e\u5899\u548c\u7f51\u7edc\u95ee\u9898\uff0c\u66f4\u65b0\u63d2\u4ef6\u56f0\u96be \u63d0\u4f9b\u5b8c\u6574\u7684API pipeline\u4e13\u7528\u7f16\u6392\u8bed\u6cd5\uff0c\u4e14\u53ef\u89c6\u5316\u5dee PowerJob\uff08\u539fOhMyScheduler\uff09 \u4f18\u70b9\uff1a \u56fd\u4eba\u5f00\u53d1\uff0cApache\u534f\u8bae\uff0c\u5f53\u524d\u7248\u672c\uff1a4.0.1 UI\u4f7f\u7528\u7b80\u5355\uff0cCrontab\u652f\u6301\u53cb\u597d \u652f\u6301DAG\u5de5\u4f5c\u6d41 \u652f\u6301\u4efb\u52a1MR \u4e0d\u7ed1\u5b9a\u7279\u5b9a\u6570\u636e\u5e93 \u9ad8\u53ef\u7528 \u57fa\u4e8e\u6267\u884c\u5668\uff0c\u652f\u6301\u591a\u79cd\u8bed\u8a00\u811a\u672c \u63d0\u4f9bAPI \u63d0\u4f9bHook\u6269\u5c55 \u7f3a\u70b9\uff1a \u6267\u884c\u5668\u7684\u7f16\u8f91\u9875\u9762\u8f83\u4e11 Airflow \u4f18\u70b9\uff1a Apache\u65d7\u4e0b\uff0c\u57fa\u4e8ePython\u5f00\u53d1 DAG\u5b8c\u6574\uff0c\u53ef\u5b9e\u73b0\u590d\u6742\u4f9d\u8d56\u6d41\u7a0b \u652f\u6301\u4efb\u52a1MR \u9ad8\u5ea6\u7075\u6d3b\uff0c\u53ef\u5b9a\u5236\u6269\u5c55 \u51e0\u4e4e\u652f\u6301\u6240\u6709\u5e38\u89c1\u6570\u636e\u6e90 \u7f3a\u70b9\uff1a \u66f4\u805a\u7126\u5728\u5927\u6570\u636e\u7684ETL\u5904\u7406\u4e0a \u91cd\u91cf\u7ea7\uff0c\u9700\u8981\u7b26\u5408\u81ea\u5df1\u7684\u751f\u6001\u5708 \u57fa\u4e8eOperators\u5f00\u53d1\u4efb\u52a1\uff0c\u5b66\u4e60\u5761\u5ea6\u8f83\u5927 \u5bf9Crontab\u7c7b\u4efb\u52a1\u652f\u6301\u4e0d\u53cb\u597d Prefect \u4f18\u70b9\uff1a \u6bd4Airflow\u66f4\u7b80\u6d01 \u57fa\u4e8ePython\uff0c\u9ad8\u5ea6\u53ef\u5b9a\u5236 \u7f3a\u70b9\uff1a \u548cAirflow\u4e00\u6837\uff0c\u66f4\u504f\u91cd\u6570\u636eETL\u9886\u57df Core\u662fApache\u5f00\u6e90\u7684\uff0c\u4f46\u662f\u90e8\u5206\u5e38\u7528\u63d2\u4ef6\u662f\u5546\u4e1a\u7248 \u540e\u8d77\u4e4b\u79c0\uff0c\u76ee\u524d\u6587\u6863\u592a\u5c11\uff0c\u90e8\u5206code\u5c31\u662f\u6587\u6863 \u5b9e\u9645\u6d4b\u8bd5\u65f6\uff0c\u90e8\u5206\u670d\u52a1\u542f\u52a8\u4e00\u81f4\u5931\u8d25\uff0c\u4e0d\u7a33\u5b9a \u53c2\u8003 xxl-job\u5b98\u7f51 https://www.xuxueli.com/xxl-job/ Jenkins\u5b98\u7f51 https://www.jenkins.io/zh/ PowerJob\u5b98\u7f51 http://www.powerjob.tech/ Airflow\u5b98\u7f51 https://airflow.apache.org/ Prefect\u5b98\u7f51 https://www.prefect.io/","title":"\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u8c03\u7814"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#_1","text":"\u5bf9\u5e38\u89c1\u7684\u5f00\u6e90\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u7684\u5bf9\u6bd4\u8c03\u7814\uff0c\u8c03\u7814\u5bf9\u8c61\u5982\u4e0b\uff1a xxl-job Jenkins pipeline PowerJob Airflow Prefect","title":"\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u8c03\u7814"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#_2","text":"\u5f00\u6e90\u534f\u8bae\uff0c\u53ef\u79c1\u6709\u5316\u90e8\u7f72\uff0c\u6682\u65f6\u4e0d\u8003\u8651saas\u7c7b \u5b9a\u65f6\u8c03\u5ea6\u6307\u5b9a\u4efb\u52a1\uff0c\u7c7bCrontab \u5de5\u4f5c\u6d41\uff0c\u7c7bDAG \u652f\u6301\u4efb\u52a1\u5206\u7247 \u8fd0\u884c\u5927\u76d8\uff0c\u8fd0\u884c\u65e5\u5fd7 \u6267\u884c\u7ed3\u679c\u53ef\u53cd\u9988\uff0c\u6bd4\u5982\u4efb\u52a1\u5931\u8d25\u540e\u53d1\u901a\u77e5 \u4efb\u52a1\u6267\u884c\u652f\u6301\u91cd\u8bd5 \u53ef\u63a5\u5165\u591a\u79cd\u5e38\u89c1\u8bed\u8a00\u7684\u4efb\u52a1\uff0c\u5982shell\u3001python\u7b49 \u63d0\u4f9bAPI\u7ed9\u5916\u90e8\u8c03\u7528 \u65e0\u5355\u70b9\u7ec4\u4ef6\uff0c\u5982\u4e00\u4e2amaster\u3001worker\u6302\u4e86\uff0c\u4e0d\u5f71\u54cd\u6574\u4f53","title":"\u9700\u6c42"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#_3","text":"","title":"\u7b80\u8bc4"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#xxl-job","text":"\u4f18\u70b9\uff1a \u56fd\u4eba\u5f00\u53d1\uff0cGPLv3\u534f\u8bae\uff0c\u5f53\u524d\u7248\u672c\uff1a2.3.0 \u8c03\u5ea6\u4e2d\u5fc3<->\u6267\u884c\u5668 \u6a21\u5f0f\uff0c\u8f7b\u91cf\u7ea7\uff0c\u7b80\u5355\u597d\u7528 \u57fa\u4e8eWebIDE\uff0c\u652f\u6301\u591a\u79cd\u8bed\u8a00\u811a\u672c \u591a\u79cd\u8c03\u5ea6\u548c\u963b\u585e\u7b56\u7565 \u4efb\u52a1\u5931\u8d25\u63d0\u4f9b\u90ae\u4ef6\u901a\u77e5 \u63d0\u4f9bRestful API \u7f3a\u70b9\uff1a \u4fee\u6539\u914d\u7f6e\u56f0\u96be\uff0c\u6267\u884c\u5668\u9700\u8981\u91cd\u65b0\u6253\u5305 \u8c03\u5ea6\u4e2d\u5fc3\u662f\u5355\u70b9DB\uff0c\u7ed1\u5b9aMysql \u4e0d\u652f\u6301DAG \u4efb\u52a1\u53cd\u9988\u76ee\u524d\u53ea\u652f\u6301\u5931\u8d25\u90ae\u4ef6\uff0c\u5176\u4ed6\u4e0d\u652f\u6301","title":"xxl-job"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#jenkins","text":"\u4f18\u70b9\uff1a \u8fd0\u7ef4\u5e38\u89c1\u670d\u52a1\uff0c\u5bb9\u6613\u4f7f\u7528 \u5185\u7f6e\u5b9a\u65f6\u4efb\u52a1 \u57fa\u4e8epipeline\uff0c\u5b9e\u73b0\u7c7b\u5de5\u4f5c\u6d41 \u91c7\u96c6\u4efb\u52a1\u6267\u884c\u65f6\u7684\u63a7\u5236\u53f0\u8f93\u51fa\uff0c\u5bb9\u6613\u5b9a\u4f4d\u95ee\u9898 \u7f3a\u70b9\uff1a \u66f4\u805a\u7126\u5728CICD\u9886\u57df\uff0c\u901a\u7528\u6027\u8f83\u4f4e \u7531\u4e8e\u5899\u548c\u7f51\u7edc\u95ee\u9898\uff0c\u66f4\u65b0\u63d2\u4ef6\u56f0\u96be \u63d0\u4f9b\u5b8c\u6574\u7684API pipeline\u4e13\u7528\u7f16\u6392\u8bed\u6cd5\uff0c\u4e14\u53ef\u89c6\u5316\u5dee","title":"Jenkins"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#powerjobohmyscheduler","text":"\u4f18\u70b9\uff1a \u56fd\u4eba\u5f00\u53d1\uff0cApache\u534f\u8bae\uff0c\u5f53\u524d\u7248\u672c\uff1a4.0.1 UI\u4f7f\u7528\u7b80\u5355\uff0cCrontab\u652f\u6301\u53cb\u597d \u652f\u6301DAG\u5de5\u4f5c\u6d41 \u652f\u6301\u4efb\u52a1MR \u4e0d\u7ed1\u5b9a\u7279\u5b9a\u6570\u636e\u5e93 \u9ad8\u53ef\u7528 \u57fa\u4e8e\u6267\u884c\u5668\uff0c\u652f\u6301\u591a\u79cd\u8bed\u8a00\u811a\u672c \u63d0\u4f9bAPI \u63d0\u4f9bHook\u6269\u5c55 \u7f3a\u70b9\uff1a \u6267\u884c\u5668\u7684\u7f16\u8f91\u9875\u9762\u8f83\u4e11","title":"PowerJob\uff08\u539fOhMyScheduler\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#airflow","text":"\u4f18\u70b9\uff1a Apache\u65d7\u4e0b\uff0c\u57fa\u4e8ePython\u5f00\u53d1 DAG\u5b8c\u6574\uff0c\u53ef\u5b9e\u73b0\u590d\u6742\u4f9d\u8d56\u6d41\u7a0b \u652f\u6301\u4efb\u52a1MR \u9ad8\u5ea6\u7075\u6d3b\uff0c\u53ef\u5b9a\u5236\u6269\u5c55 \u51e0\u4e4e\u652f\u6301\u6240\u6709\u5e38\u89c1\u6570\u636e\u6e90 \u7f3a\u70b9\uff1a \u66f4\u805a\u7126\u5728\u5927\u6570\u636e\u7684ETL\u5904\u7406\u4e0a \u91cd\u91cf\u7ea7\uff0c\u9700\u8981\u7b26\u5408\u81ea\u5df1\u7684\u751f\u6001\u5708 \u57fa\u4e8eOperators\u5f00\u53d1\u4efb\u52a1\uff0c\u5b66\u4e60\u5761\u5ea6\u8f83\u5927 \u5bf9Crontab\u7c7b\u4efb\u52a1\u652f\u6301\u4e0d\u53cb\u597d","title":"Airflow"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#prefect","text":"\u4f18\u70b9\uff1a \u6bd4Airflow\u66f4\u7b80\u6d01 \u57fa\u4e8ePython\uff0c\u9ad8\u5ea6\u53ef\u5b9a\u5236 \u7f3a\u70b9\uff1a \u548cAirflow\u4e00\u6837\uff0c\u66f4\u504f\u91cd\u6570\u636eETL\u9886\u57df Core\u662fApache\u5f00\u6e90\u7684\uff0c\u4f46\u662f\u90e8\u5206\u5e38\u7528\u63d2\u4ef6\u662f\u5546\u4e1a\u7248 \u540e\u8d77\u4e4b\u79c0\uff0c\u76ee\u524d\u6587\u6863\u592a\u5c11\uff0c\u90e8\u5206code\u5c31\u662f\u6587\u6863 \u5b9e\u9645\u6d4b\u8bd5\u65f6\uff0c\u90e8\u5206\u670d\u52a1\u542f\u52a8\u4e00\u81f4\u5931\u8d25\uff0c\u4e0d\u7a33\u5b9a","title":"Prefect"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/task_scheduling/#_4","text":"xxl-job\u5b98\u7f51 https://www.xuxueli.com/xxl-job/ Jenkins\u5b98\u7f51 https://www.jenkins.io/zh/ PowerJob\u5b98\u7f51 http://www.powerjob.tech/ Airflow\u5b98\u7f51 https://airflow.apache.org/ Prefect\u5b98\u7f51 https://www.prefect.io/","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/","text":"\u65e0\u5934CMS - Strapi \u5b89\u88c5 mysql\u53c2\u8003 \uff0c\u63d0\u524d\u65b0\u5efa strapi \u5e93 \u57fa\u4e8edocke-compose TODO \u7b2c\u4e8c\u6b21\u5b89\u88c5\u5931\u8d25\uff0c\u542f\u52a8\u62a5js\u9519\uff0c\u5f85fix version: '3' services: strapi: image: strapi/strapi:3.6.8-node14 environment: DATABASE_CLIENT: mysql DATABASE_HOST: 0.0.0.0 DATABASE_PORT: 13306 DATABASE_NAME: strapi DATABASE_USERNAME: devops DATABASE_PASSWORD: devops123 DATABASE_SSL: 'false' volumes: - ./app:/srv/app ports: - '1337:1337' \u57fa\u4e8e\u6e90\u7801 \u5b89\u88c5nodejs14 curl -sL https://deb.nodesource.com/setup_14.x | sudo -E bash - apt-get install -y nodejs \u5b89\u88c5yarn npm install -g yarn cd\u8fdb\u81ea\u5df1\u7684\u9879\u76ee\u76ee\u5f55\uff0c\u5b89\u88c5\u4f9d\u8d56 yarn install \uff0c\u6ce8\u610f\u5982\u679c\u5b58\u5728 yarn.lock \uff0c\u9700\u8981\u5148delete\u5b83\uff0c\u5426\u5219\u4f1a\u62a5 Error: `make` failed with exit code: 2 \u5b89\u88c5db\u9a71\u52a8 npm install mysql --save \u65b0\u5efacms\u9879\u76ee yarn create strapi-app your-cms \u4e00\u5806\u7684\u914d\u7f6e\u9009\u62e9 \u68c0\u67e5mysql\u6570\u636e\u6e90 ./config/database.js module.exports = ({ env }) => ({ defaultConnection: 'default', connections: { default: { connector: 'bookshelf', settings: { client: 'mysql', host: env('DATABASE_HOST', '0.0.0.0'), port: env.int('DATABASE_PORT', 13306), database: env('DATABASE_NAME', 'strapi'), username: env('DATABASE_USERNAME', 'devops'), password: env('DATABASE_PASSWORD', 'devops123'), }, options: {}, }, }, }); \u8fd0\u884cweb\u670d\u52a1 yarn develop \u8bbf\u95eeadmin\u9875\u9762 http://localhost:1337/admin \u5e38\u7528\u63d2\u4ef6 DOCUMENTATION SwaggerUI\u53ef\u89c6\u5316\u7684API \u4f7f\u7528 \u5efa\u6a21 \u4ee5\u6784\u5efa \u670d\u52a1\u5bfc\u822a\uff08Service navigation\uff09 \u4e3a\u4f8b \u5728 \u5185\u5bb9\u7c7b\u578b\u751f\u6210\u5668\uff08content-type-builder\uff09 \u9875\uff0c\u70b9\u51fb \u96c6\u5408\u7c7b\u578b \u4e0b\u7684 \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u96c6\u5408\u7c7b\u578b \u57fa\u7840\u8bbe\u7f6e \u4e0b\u586b\u5165\u540d\u79f0\uff0c\u70b9\u51fb \u7ee7\u7eed \u9009\u62e9\u5b57\u6bb5\u7c7b\u578b \u6587\u672c \u5b57\u6bb5\u8be6\u7ec6\u9875\u4e2d\u586b\u5165\u5c5e\u6027\u540d name \uff0c\u9009 \u8f83\u77ed\u7684\u6587\u5b57 \uff0c\u70b9\u51fb \u9ad8\u7ea7\u8bbe\u7f6e \u6839\u636e\u5b9e\u9645\u60c5\u51b5\uff0c\u52fe\u9009 \u5fc5\u987b\u7684\u3001\u552f\u4e00\u7684 \uff0c\u5728\u70b9\u51fb \u6dfb\u52a0\u53e6\u4e00\u4e2a\u5b57\u6bb5 \uff0c\u91cd\u590d\u4e0a\u8ff0\u6b65\u9aa4\uff0c\u76f4\u5230\u5efa\u6a21\u5b8c\u6210\uff0c\u70b9\u51fb \u7ed3\u675f \u6700\u540e \u4fdd\u5b58 \u6a21\u578b \u6388\u6743 \u8fdb \u8bbe\u7f6e \u83dc\u5355\uff0c\u70b9\u51fb\u9009\u62e9 \u89d2\u8272\u548c\u6743\u9650 \u4e0b\u7684 public \u5728 Public \u8be6\u60c5\u9875\u4e2d \u6743\u9650 \u4e0b\u7684 APPLICATION \u5217\u8868\u4e2d\uff0c\u52fe\u9009\u4e4b\u524d\u5efa\u6a21\u7684 SERVICE-NAVIGATION \u7684\u76f8\u5173\u6743\u9650\uff0c\u6700\u540e\u70b9 \u4fdd\u5b58 API\u8bbf\u95ee \u5982\u679c\u5b89\u88c5\u4e86 documentation\u63d2\u4ef6 \uff0c\u63d0\u4f9b\u9ed8\u8ba4\u7684swagger\u7684\u5730\u5740 http://localhost:1337/documentation/ \uff0c\u53c2\u8003\u76f8\u5173\u63a5\u53e3\u7528\u6cd5 \u53d1\u5e03\u5185\u5bb9 \u8fdb\u5165admin\u540e\u53f0\u754c\u9762\uff0c\u5728\u5bf9\u5e94\u7684 \u96c6\u5408\u7c7b\u578b \u91cc\u9009\u62e9\u76f8\u5173\u7684\u7c7b\u578b\uff0c\u8fdb\u884c\u7f16\u8f91 \u70b9\u51fb\u8981\u53d1\u5e03\u8bb0\u5f55\u7684 \u72b6\u6001 \uff0c\u9009\u62e9 \u53d1\u5e03 \u53c2\u8003 \u5b98\u7f51 https://strapi.io/ \u4e2d\u6587\u624b\u518c https://getstrapi.cn/developer-docs/latest/getting-started/introduction.html","title":"\u65e0\u5934CMS - Strapi"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#cms-strapi","text":"","title":"\u65e0\u5934CMS - Strapi"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#_1","text":"mysql\u53c2\u8003 \uff0c\u63d0\u524d\u65b0\u5efa strapi \u5e93","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#docke-compose","text":"TODO \u7b2c\u4e8c\u6b21\u5b89\u88c5\u5931\u8d25\uff0c\u542f\u52a8\u62a5js\u9519\uff0c\u5f85fix version: '3' services: strapi: image: strapi/strapi:3.6.8-node14 environment: DATABASE_CLIENT: mysql DATABASE_HOST: 0.0.0.0 DATABASE_PORT: 13306 DATABASE_NAME: strapi DATABASE_USERNAME: devops DATABASE_PASSWORD: devops123 DATABASE_SSL: 'false' volumes: - ./app:/srv/app ports: - '1337:1337'","title":"\u57fa\u4e8edocke-compose"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#_2","text":"\u5b89\u88c5nodejs14 curl -sL https://deb.nodesource.com/setup_14.x | sudo -E bash - apt-get install -y nodejs \u5b89\u88c5yarn npm install -g yarn cd\u8fdb\u81ea\u5df1\u7684\u9879\u76ee\u76ee\u5f55\uff0c\u5b89\u88c5\u4f9d\u8d56 yarn install \uff0c\u6ce8\u610f\u5982\u679c\u5b58\u5728 yarn.lock \uff0c\u9700\u8981\u5148delete\u5b83\uff0c\u5426\u5219\u4f1a\u62a5 Error: `make` failed with exit code: 2 \u5b89\u88c5db\u9a71\u52a8 npm install mysql --save \u65b0\u5efacms\u9879\u76ee yarn create strapi-app your-cms \u4e00\u5806\u7684\u914d\u7f6e\u9009\u62e9 \u68c0\u67e5mysql\u6570\u636e\u6e90 ./config/database.js module.exports = ({ env }) => ({ defaultConnection: 'default', connections: { default: { connector: 'bookshelf', settings: { client: 'mysql', host: env('DATABASE_HOST', '0.0.0.0'), port: env.int('DATABASE_PORT', 13306), database: env('DATABASE_NAME', 'strapi'), username: env('DATABASE_USERNAME', 'devops'), password: env('DATABASE_PASSWORD', 'devops123'), }, options: {}, }, }, }); \u8fd0\u884cweb\u670d\u52a1 yarn develop \u8bbf\u95eeadmin\u9875\u9762 http://localhost:1337/admin","title":"\u57fa\u4e8e\u6e90\u7801"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#_3","text":"DOCUMENTATION SwaggerUI\u53ef\u89c6\u5316\u7684API","title":"\u5e38\u7528\u63d2\u4ef6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#_4","text":"","title":"\u4f7f\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#_5","text":"\u4ee5\u6784\u5efa \u670d\u52a1\u5bfc\u822a\uff08Service navigation\uff09 \u4e3a\u4f8b \u5728 \u5185\u5bb9\u7c7b\u578b\u751f\u6210\u5668\uff08content-type-builder\uff09 \u9875\uff0c\u70b9\u51fb \u96c6\u5408\u7c7b\u578b \u4e0b\u7684 \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u96c6\u5408\u7c7b\u578b \u57fa\u7840\u8bbe\u7f6e \u4e0b\u586b\u5165\u540d\u79f0\uff0c\u70b9\u51fb \u7ee7\u7eed \u9009\u62e9\u5b57\u6bb5\u7c7b\u578b \u6587\u672c \u5b57\u6bb5\u8be6\u7ec6\u9875\u4e2d\u586b\u5165\u5c5e\u6027\u540d name \uff0c\u9009 \u8f83\u77ed\u7684\u6587\u5b57 \uff0c\u70b9\u51fb \u9ad8\u7ea7\u8bbe\u7f6e \u6839\u636e\u5b9e\u9645\u60c5\u51b5\uff0c\u52fe\u9009 \u5fc5\u987b\u7684\u3001\u552f\u4e00\u7684 \uff0c\u5728\u70b9\u51fb \u6dfb\u52a0\u53e6\u4e00\u4e2a\u5b57\u6bb5 \uff0c\u91cd\u590d\u4e0a\u8ff0\u6b65\u9aa4\uff0c\u76f4\u5230\u5efa\u6a21\u5b8c\u6210\uff0c\u70b9\u51fb \u7ed3\u675f \u6700\u540e \u4fdd\u5b58 \u6a21\u578b","title":"\u5efa\u6a21"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#_6","text":"\u8fdb \u8bbe\u7f6e \u83dc\u5355\uff0c\u70b9\u51fb\u9009\u62e9 \u89d2\u8272\u548c\u6743\u9650 \u4e0b\u7684 public \u5728 Public \u8be6\u60c5\u9875\u4e2d \u6743\u9650 \u4e0b\u7684 APPLICATION \u5217\u8868\u4e2d\uff0c\u52fe\u9009\u4e4b\u524d\u5efa\u6a21\u7684 SERVICE-NAVIGATION \u7684\u76f8\u5173\u6743\u9650\uff0c\u6700\u540e\u70b9 \u4fdd\u5b58","title":"\u6388\u6743"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#api","text":"\u5982\u679c\u5b89\u88c5\u4e86 documentation\u63d2\u4ef6 \uff0c\u63d0\u4f9b\u9ed8\u8ba4\u7684swagger\u7684\u5730\u5740 http://localhost:1337/documentation/ \uff0c\u53c2\u8003\u76f8\u5173\u63a5\u53e3\u7528\u6cd5","title":"API\u8bbf\u95ee"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#_7","text":"\u8fdb\u5165admin\u540e\u53f0\u754c\u9762\uff0c\u5728\u5bf9\u5e94\u7684 \u96c6\u5408\u7c7b\u578b \u91cc\u9009\u62e9\u76f8\u5173\u7684\u7c7b\u578b\uff0c\u8fdb\u884c\u7f16\u8f91 \u70b9\u51fb\u8981\u53d1\u5e03\u8bb0\u5f55\u7684 \u72b6\u6001 \uff0c\u9009\u62e9 \u53d1\u5e03","title":"\u53d1\u5e03\u5185\u5bb9"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86/headless-cms/#_8","text":"\u5b98\u7f51 https://strapi.io/ \u4e2d\u6587\u624b\u518c https://getstrapi.cn/developer-docs/latest/getting-started/introduction.html","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/coreui-free-vue-admin-template/","text":"\u57fa\u4e8eCoreUI Free Vue Bootstrap Admin\u7684\u6539\u9020\u6a21\u677f coreui-free-vue-admin-template \u662f\u4e00\u5bb6\u6ce2\u5170\u8bbe\u8ba1\u516c\u53f8\u5728\u7f51\u4e0a\u514d\u8d39\u5f00\u6e90\u7684\u5168\u54cd\u5e94\u5f0f\u524d\u7aef\u6a21\u677f\uff0c\u96c6\u6210\u4e86Vue3\u3001Bootstrap4\uff0c\u6574\u4f53\u7b80\u6d01\u5927\u65b9\uff0c\u5bb9\u6613\u548c\u540e\u7aef\u6574\u5408\u3002 \u672c\u6587\u6863\u662f\u57fa\u4e8e\u5b83\u7684\u518d\u6b21\u6539\u9020\u8bb0\u5f55\uff0c\u4f9b\u53c2\u8003\u3002 \u529f\u80fd\u70b9 \u52a0\u5165devProxy\uff0c\u652f\u6301\u8de8\u57df\u540e\u7aef\u8054\u8c03 \u62bd\u51faservices\u548cutils\u5c42\uff0c\u72ec\u7acb\u7ba1\u7406js\u51fd\u6570 \u4f7f\u7528 .env \u7ba1\u7406\u914d\u7f6e \u53c2\u8003 \u539f\u751f\u6a21\u677fGithub https://github.com/coreui/coreui-free-vue-admin-template \u501f\u9274\u7684\u56fd\u5185\u4f18\u79c0\u524d\u7aef\u6a21\u677f Vue Antd Admin","title":"\u57fa\u4e8eCoreUI Free Vue Bootstrap Admin\u7684\u6539\u9020\u6a21\u677f"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/coreui-free-vue-admin-template/#coreui-free-vue-bootstrap-admin","text":"coreui-free-vue-admin-template \u662f\u4e00\u5bb6\u6ce2\u5170\u8bbe\u8ba1\u516c\u53f8\u5728\u7f51\u4e0a\u514d\u8d39\u5f00\u6e90\u7684\u5168\u54cd\u5e94\u5f0f\u524d\u7aef\u6a21\u677f\uff0c\u96c6\u6210\u4e86Vue3\u3001Bootstrap4\uff0c\u6574\u4f53\u7b80\u6d01\u5927\u65b9\uff0c\u5bb9\u6613\u548c\u540e\u7aef\u6574\u5408\u3002 \u672c\u6587\u6863\u662f\u57fa\u4e8e\u5b83\u7684\u518d\u6b21\u6539\u9020\u8bb0\u5f55\uff0c\u4f9b\u53c2\u8003\u3002","title":"\u57fa\u4e8eCoreUI Free Vue Bootstrap Admin\u7684\u6539\u9020\u6a21\u677f"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/coreui-free-vue-admin-template/#_1","text":"\u52a0\u5165devProxy\uff0c\u652f\u6301\u8de8\u57df\u540e\u7aef\u8054\u8c03 \u62bd\u51faservices\u548cutils\u5c42\uff0c\u72ec\u7acb\u7ba1\u7406js\u51fd\u6570 \u4f7f\u7528 .env \u7ba1\u7406\u914d\u7f6e","title":"\u529f\u80fd\u70b9"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/coreui-free-vue-admin-template/#_2","text":"\u539f\u751f\u6a21\u677fGithub https://github.com/coreui/coreui-free-vue-admin-template \u501f\u9274\u7684\u56fd\u5185\u4f18\u79c0\u524d\u7aef\u6a21\u677f Vue Antd Admin","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%89%B9%E9%87%8F%E9%83%A8%E7%BD%B2/ansible/","text":"Ansible\u81ea\u52a8\u5316\u90e8\u7f72\u5de5\u5177 \u57fa\u4e8eparamiko\uff08\u7eafPython\u5b9e\u73b0\u7684ssh\u534f\u8bae\u5e93\uff09\u7684\u8fdc\u7a0b\u4e3b\u673a\u6267\u884c\u7684\u6d41\u7a0b\u6846\u67b6 \u5b89\u88c5 pip install ansible \u5e38\u7528 # \u6279\u91cf\u6267\u884c\uff1a\u9a8c\u8bc1\u6307\u5b9a\u6587\u6863\u7684MD5\uff0c-i\u6307\u5b9ahosts\u6587\u4ef6\uff0cprod_app\uff08\u6216\u8005\u6307\u5b9aIP\uff09\u76ee\u6807\u4e3b\u673a\u7ec4 ansible [-i /etc/ansible/hosts] prod_app -m shell -a \"md5sum /opt/scripts/tools.py\" # sync\u672c\u5730\u76ee\u5f55\u5230\u76ee\u6807\u4e3b\u673a\u7ec4\uff0c\u5f3a\u8986\u76d6 ansible -i /etc/ansible/hosts_cq.tmp prod_app -m synchronize -a 'src=/opt/scripts/git/ dest=/opt/scripts/tools/ delete=yes' # \u6279\u91cf\u63a8\u9001\u6587\u4ef6 ansible -i /etc/ansible/hosts_cq.tmp prod_app -m copy -a \"src=/home/op/shell/install.sh dest=/home/op/shell/install.sh\" /etc/ansible/hosts\u7ed3\u6784 [prod_app] 172.0.200.1 172.0.200.2 [prod_te] te01 ansible_ssh_port=22 ansible_ssh_host=172.0.205.3 te02 ansible_ssh_port=22 ansible_ssh_host=172.0.205.4 play_book --- - hosts: prod_te tasks: - name: check_te shell shell: cat /etc/hosts | grep te > /tmp/check_te.log","title":"Ansible\u81ea\u52a8\u5316\u90e8\u7f72\u5de5\u5177"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%89%B9%E9%87%8F%E9%83%A8%E7%BD%B2/ansible/#ansible","text":"\u57fa\u4e8eparamiko\uff08\u7eafPython\u5b9e\u73b0\u7684ssh\u534f\u8bae\u5e93\uff09\u7684\u8fdc\u7a0b\u4e3b\u673a\u6267\u884c\u7684\u6d41\u7a0b\u6846\u67b6","title":"Ansible\u81ea\u52a8\u5316\u90e8\u7f72\u5de5\u5177"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%89%B9%E9%87%8F%E9%83%A8%E7%BD%B2/ansible/#_1","text":"pip install ansible","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%89%B9%E9%87%8F%E9%83%A8%E7%BD%B2/ansible/#_2","text":"# \u6279\u91cf\u6267\u884c\uff1a\u9a8c\u8bc1\u6307\u5b9a\u6587\u6863\u7684MD5\uff0c-i\u6307\u5b9ahosts\u6587\u4ef6\uff0cprod_app\uff08\u6216\u8005\u6307\u5b9aIP\uff09\u76ee\u6807\u4e3b\u673a\u7ec4 ansible [-i /etc/ansible/hosts] prod_app -m shell -a \"md5sum /opt/scripts/tools.py\" # sync\u672c\u5730\u76ee\u5f55\u5230\u76ee\u6807\u4e3b\u673a\u7ec4\uff0c\u5f3a\u8986\u76d6 ansible -i /etc/ansible/hosts_cq.tmp prod_app -m synchronize -a 'src=/opt/scripts/git/ dest=/opt/scripts/tools/ delete=yes' # \u6279\u91cf\u63a8\u9001\u6587\u4ef6 ansible -i /etc/ansible/hosts_cq.tmp prod_app -m copy -a \"src=/home/op/shell/install.sh dest=/home/op/shell/install.sh\"","title":"\u5e38\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%89%B9%E9%87%8F%E9%83%A8%E7%BD%B2/ansible/#etcansiblehosts","text":"[prod_app] 172.0.200.1 172.0.200.2 [prod_te] te01 ansible_ssh_port=22 ansible_ssh_host=172.0.205.3 te02 ansible_ssh_port=22 ansible_ssh_host=172.0.205.4","title":"/etc/ansible/hosts\u7ed3\u6784"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%89%B9%E9%87%8F%E9%83%A8%E7%BD%B2/ansible/#play_book","text":"--- - hosts: prod_te tasks: - name: check_te shell shell: cat /etc/hosts | grep te > /tmp/check_te.log","title":"play_book"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/api_gateway_auth/","text":"\u57fa\u4e8eAPI\u7f51\u5173\u7684\u7528\u6237\u6743\u9650\u7ba1\u7406\u670d\u52a1 \u65b9\u6848\u7684\u6838\u5fc3\u601d\u8def \u5e94\u7528\u7684HTTP\u63a5\u53e3\u5b9a\u4e49\u5728yapi\u5185\u7ba1\u7406\u7ef4\u62a4 \u5728\u73af\u5883\u914d\u7f6e\u4e2d\uff0c\u7ea6\u5b9a\u751f\u4ea7\u4ee3\u8868\u7684code\uff0c\u5982\uff1aprod\uff0c\u4e0b\u9762\u6240\u6709\u7684\u914d\u7f6e\u90fd\u662f\u4e0a\u751f\u4ea7\u7684 auth\u670d\u52a1\u7ef4\u62a4 \u9879\u76eetoken-api\u5b9a\u4e49-\u7528\u6237\u89d2\u8272 \u7684\u5173\u7cfb\uff1a auth\u901a\u8fc7\u9879\u76ee\u7684token\uff0c\u4eceyapi\u4e2d\u8bfb\u53d6\u6240\u6709\u63a5\u53e3\u5b9a\u4e49\uff0c\u4f5c\u4e3acasbin\u7684\u7b56\u7565\u8981\u7d20 auth\u63d0\u4f9b\u4e00\u5f20\u8868\u683c\uff08\u6a2a\u8f74\uff1a\u89d2\u8272\uff0c\u7eb5\u8f74\uff1a\u63a5\u53e3\u5b9a\u4e49\uff0c\u4e2d\u95f4\uff1a\u6388\u6743\u7684checkbox\uff09\uff0c\u8ba9\u7ba1\u7406\u5458\u52fe\u9009 \u6309\u9879\u76ee\uff0c\u5c06\u8868\u683c\u8f6c\u4e3acasbin\u7b56\u7565\uff0c\u63d0\u4ea4db acl\u9a8c\u8bc1\u670d\u52a1\u542f\u52a8\u65f6\uff0c\u4ecedb\u4e2dload\u7b56\u7565\u8fdb\u5185\u5b58 API\u7f51\u5173\u5728 request-response \u6d41\u7a0b\u7684 \u8def\u7531\u8f6c\u8df3 \u524d\uff0c\u52a0\u5165\u4ee5\u4e0b\u8fc7\u6ee4\u903b\u8f91\uff1a \u4ecerequest\u62a5\u6587\u4e2d\u62bd\u53d6 \u7528\u6237\u540d\uff08\u4ecehead\u3001cookie\u6216\u53c2\u6570\u4e2d\u8bfb\uff09\uff0cURI\uff0cMethod \u8981\u7d20\uff0c\u63d0\u4ea4\u7ed9acl\u670d\u52a1\u9a8c\u8bc1 \u9a8c\u8bc1\u901a\u8fc7\u5c31\u6d41\u7a0b\u7ee7\u7eed\uff0c\u5426\u5219\u53cd\u9988403 \u7279\u70b9\uff1a \u5c06 \u7528\u6237\u6743\u9650\u7ba1\u7406 \u63d0\u5347\u5230\u7f51\u5173\u5c42\uff0cweb\u5c42\u7684\u670d\u52a1\u4e0d\u5fc5\u518d\u5404\u81ea\u7ef4\u62a4\u4e00\u5957acl\u6570\u636e\uff0c\u5f00\u53d1\u8005\u76f4\u63a5\u805a\u96c6\u529f\u80fd\u5b9e\u73b0 \u65b9\u6848\u57fa\u4e8eHTTP\u534f\u8bae\uff0c\u4e0d\u5c40\u9650\u5f00\u53d1\u8005\u7684\u4e0b\u6e38\u63a5\u53e3\u5b9e\u73b0\u65b9\u5f0f\uff0c\u7231\u7528\u4ec0\u4e48\u8bed\u8a00\u6846\u67b6\u90fd\u884c \u63a5\u53e3\u5b9a\u4e49\u5728yapi\u4e2d\u7edf\u4e00\u7ba1\u7406\uff0c\u5373\uff1a\u63a5\u53e3\u6587\u6863\u53ea\u9700\u8981\u51991\u6b21 \u4ee5\u4e0a\u65b9\u6848\uff0c\u535a\u4e3b\u5728\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e2d\u4e0a\u7ebf\u9a8c\u8bc1\u8fc7\uff0c\u8f83\u4e3a\u7a33\u5b9a\u901a\u7528\u3002\u8bf7\u6839\u636e\u5b9e\u9645\u4e1a\u52a1\u573a\u666f\uff0c\u81ea\u884c\u6539\u9020\u9002\u914d\u3002 \u53c2\u8003 YAPI\u63a5\u53e3\u7ba1\u7406\u670d\u52a1 APISix\u7f51\u5173 Casbin\u8bbf\u95ee\u63a7\u5236\u6846\u67b6","title":"\u57fa\u4e8eAPI\u7f51\u5173\u7684\u7528\u6237\u6743\u9650\u7ba1\u7406\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/api_gateway_auth/#api","text":"","title":"\u57fa\u4e8eAPI\u7f51\u5173\u7684\u7528\u6237\u6743\u9650\u7ba1\u7406\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/api_gateway_auth/#_1","text":"\u5e94\u7528\u7684HTTP\u63a5\u53e3\u5b9a\u4e49\u5728yapi\u5185\u7ba1\u7406\u7ef4\u62a4 \u5728\u73af\u5883\u914d\u7f6e\u4e2d\uff0c\u7ea6\u5b9a\u751f\u4ea7\u4ee3\u8868\u7684code\uff0c\u5982\uff1aprod\uff0c\u4e0b\u9762\u6240\u6709\u7684\u914d\u7f6e\u90fd\u662f\u4e0a\u751f\u4ea7\u7684 auth\u670d\u52a1\u7ef4\u62a4 \u9879\u76eetoken-api\u5b9a\u4e49-\u7528\u6237\u89d2\u8272 \u7684\u5173\u7cfb\uff1a auth\u901a\u8fc7\u9879\u76ee\u7684token\uff0c\u4eceyapi\u4e2d\u8bfb\u53d6\u6240\u6709\u63a5\u53e3\u5b9a\u4e49\uff0c\u4f5c\u4e3acasbin\u7684\u7b56\u7565\u8981\u7d20 auth\u63d0\u4f9b\u4e00\u5f20\u8868\u683c\uff08\u6a2a\u8f74\uff1a\u89d2\u8272\uff0c\u7eb5\u8f74\uff1a\u63a5\u53e3\u5b9a\u4e49\uff0c\u4e2d\u95f4\uff1a\u6388\u6743\u7684checkbox\uff09\uff0c\u8ba9\u7ba1\u7406\u5458\u52fe\u9009 \u6309\u9879\u76ee\uff0c\u5c06\u8868\u683c\u8f6c\u4e3acasbin\u7b56\u7565\uff0c\u63d0\u4ea4db acl\u9a8c\u8bc1\u670d\u52a1\u542f\u52a8\u65f6\uff0c\u4ecedb\u4e2dload\u7b56\u7565\u8fdb\u5185\u5b58 API\u7f51\u5173\u5728 request-response \u6d41\u7a0b\u7684 \u8def\u7531\u8f6c\u8df3 \u524d\uff0c\u52a0\u5165\u4ee5\u4e0b\u8fc7\u6ee4\u903b\u8f91\uff1a \u4ecerequest\u62a5\u6587\u4e2d\u62bd\u53d6 \u7528\u6237\u540d\uff08\u4ecehead\u3001cookie\u6216\u53c2\u6570\u4e2d\u8bfb\uff09\uff0cURI\uff0cMethod \u8981\u7d20\uff0c\u63d0\u4ea4\u7ed9acl\u670d\u52a1\u9a8c\u8bc1 \u9a8c\u8bc1\u901a\u8fc7\u5c31\u6d41\u7a0b\u7ee7\u7eed\uff0c\u5426\u5219\u53cd\u9988403 \u7279\u70b9\uff1a \u5c06 \u7528\u6237\u6743\u9650\u7ba1\u7406 \u63d0\u5347\u5230\u7f51\u5173\u5c42\uff0cweb\u5c42\u7684\u670d\u52a1\u4e0d\u5fc5\u518d\u5404\u81ea\u7ef4\u62a4\u4e00\u5957acl\u6570\u636e\uff0c\u5f00\u53d1\u8005\u76f4\u63a5\u805a\u96c6\u529f\u80fd\u5b9e\u73b0 \u65b9\u6848\u57fa\u4e8eHTTP\u534f\u8bae\uff0c\u4e0d\u5c40\u9650\u5f00\u53d1\u8005\u7684\u4e0b\u6e38\u63a5\u53e3\u5b9e\u73b0\u65b9\u5f0f\uff0c\u7231\u7528\u4ec0\u4e48\u8bed\u8a00\u6846\u67b6\u90fd\u884c \u63a5\u53e3\u5b9a\u4e49\u5728yapi\u4e2d\u7edf\u4e00\u7ba1\u7406\uff0c\u5373\uff1a\u63a5\u53e3\u6587\u6863\u53ea\u9700\u8981\u51991\u6b21 \u4ee5\u4e0a\u65b9\u6848\uff0c\u535a\u4e3b\u5728\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e2d\u4e0a\u7ebf\u9a8c\u8bc1\u8fc7\uff0c\u8f83\u4e3a\u7a33\u5b9a\u901a\u7528\u3002\u8bf7\u6839\u636e\u5b9e\u9645\u4e1a\u52a1\u573a\u666f\uff0c\u81ea\u884c\u6539\u9020\u9002\u914d\u3002","title":"\u65b9\u6848\u7684\u6838\u5fc3\u601d\u8def"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/api_gateway_auth/#_2","text":"YAPI\u63a5\u53e3\u7ba1\u7406\u670d\u52a1 APISix\u7f51\u5173 Casbin\u8bbf\u95ee\u63a7\u5236\u6846\u67b6","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/casbin/","text":"Casbin \u8bbf\u95ee\u63a7\u5236\u6846\u67b6 \u573a\u666f \u57fa\u4e8eURI\u8bbf\u95ee \u573a\u666f\u63cf\u8ff0\uff1a \u5bf9\u6240\u6709HTTP\u8bf7\u6c42\u8fdb\u884c\u8fc7\u6ee4\uff0c\u62bd\u53d6(\u7528\u6237\u540d, URI, Method)\u4f5c\u4e3a\u5339\u914d\u6761\u4ef6 \u9002\u5408\u653e\u5728\u7c7b\u4f3cNginx\u670d\u52a1\u7684\u63d2\u4ef6\u4e2d\uff0c\u5982\uff1aAPISix\u7684lua\u811a\u672c Model\u65b9\u6848: RESTful(KeyMatch2) [request_definition] r = sub, obj, act [policy_definition] p = sub, obj, act [policy_effect] e = some(where (p.eft == allow)) [matchers] m = r.sub == p.sub && keyMatch2(r.obj, p.obj) && regexMatch(r.act, p.act) Policy\u683c\u5f0f p, alice, /alice_data/:resource, GET p, alice, /alice_data2/:id/using/:resId, GET Request\u683c\u5f0f alice, /alice_data/hello, GET alice, /alice_data/hello, POST \u57fa\u4e8eRBAC\u89d2\u8272\u7ba1\u63a7 [TODO] \u53c2\u8003 \u4e2d\u6587\u5b98\u7f51\u6587\u6863 https://casbin.org/docs/zh-CN/overview","title":"Casbin \u8bbf\u95ee\u63a7\u5236\u6846\u67b6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/casbin/#casbin","text":"","title":"Casbin \u8bbf\u95ee\u63a7\u5236\u6846\u67b6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/casbin/#_1","text":"","title":"\u573a\u666f"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/casbin/#uri","text":"\u573a\u666f\u63cf\u8ff0\uff1a \u5bf9\u6240\u6709HTTP\u8bf7\u6c42\u8fdb\u884c\u8fc7\u6ee4\uff0c\u62bd\u53d6(\u7528\u6237\u540d, URI, Method)\u4f5c\u4e3a\u5339\u914d\u6761\u4ef6 \u9002\u5408\u653e\u5728\u7c7b\u4f3cNginx\u670d\u52a1\u7684\u63d2\u4ef6\u4e2d\uff0c\u5982\uff1aAPISix\u7684lua\u811a\u672c Model\u65b9\u6848: RESTful(KeyMatch2) [request_definition] r = sub, obj, act [policy_definition] p = sub, obj, act [policy_effect] e = some(where (p.eft == allow)) [matchers] m = r.sub == p.sub && keyMatch2(r.obj, p.obj) && regexMatch(r.act, p.act) Policy\u683c\u5f0f p, alice, /alice_data/:resource, GET p, alice, /alice_data2/:id/using/:resId, GET Request\u683c\u5f0f alice, /alice_data/hello, GET alice, /alice_data/hello, POST","title":"\u57fa\u4e8eURI\u8bbf\u95ee"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/casbin/#rbac","text":"[TODO]","title":"\u57fa\u4e8eRBAC\u89d2\u8272\u7ba1\u63a7"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/casbin/#_2","text":"\u4e2d\u6587\u5b98\u7f51\u6587\u6863 https://casbin.org/docs/zh-CN/overview","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/jumper/","text":"\u8df3\u677f\u5821\u5792\u673a Teleport \u9700\u6c42 \u7edf\u4e00\u7ba1\u7406\u80fd\u4e0a\u751f\u4ea7\u7684\u8d26\u53f7 \u63d0\u4f9b\u5ba1\u8ba1\u65e5\u5fd7\u67e5\u8be2 \u5b89\u88c5 # \u4e0b\u8f7d wget https://github.com/gravitational/teleport/archive/refs/tags/v8.0.7.zip unzip v8.0.7.zip -d /opt mv /opt/teleport-8.0.7/ /opt/teleport/ cd /opt/teleport # \u542f\u52a8 docker-compose -f docker/teleport-lab.yml up -d # \u5173\u95ed docker-compose -f docker/teleport-lab.yml down \u4f7f\u7528 \u53c2\u8003 \u5b98\u7f51 https://github.com/gravitational/teleport","title":"\u8df3\u677f\u5821\u5792\u673a Teleport"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/jumper/#teleport","text":"","title":"\u8df3\u677f\u5821\u5792\u673a Teleport"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/jumper/#_1","text":"\u7edf\u4e00\u7ba1\u7406\u80fd\u4e0a\u751f\u4ea7\u7684\u8d26\u53f7 \u63d0\u4f9b\u5ba1\u8ba1\u65e5\u5fd7\u67e5\u8be2","title":"\u9700\u6c42"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/jumper/#_2","text":"# \u4e0b\u8f7d wget https://github.com/gravitational/teleport/archive/refs/tags/v8.0.7.zip unzip v8.0.7.zip -d /opt mv /opt/teleport-8.0.7/ /opt/teleport/ cd /opt/teleport # \u542f\u52a8 docker-compose -f docker/teleport-lab.yml up -d # \u5173\u95ed docker-compose -f docker/teleport-lab.yml down","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/jumper/#_3","text":"","title":"\u4f7f\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E7%AE%A1%E6%8E%A7/jumper/#_4","text":"\u5b98\u7f51 https://github.com/gravitational/teleport","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/","text":"\u76d1\u63a7\u544a\u8b66\u4f53\u7cfb \u76ee\u7684 \u76d1\u63a7\u544a\u8b66\u4f53\u7cfb\u76f8\u5173\u5b9a\u4e49\u3001\u67b6\u6784\u548c\u8bc4\u4ef7\u6807\u51c6 \u4ecb\u7ecd\u4e00\u79cd\u5b9e\u73b0\u65b9\u6848 \u5e38\u7528\u5b9a\u4e49 \u76d1\u63a7\u670d\u52a1\uff1a\u5bf9\u8fd0\u884c\u7684\u670d\u52a1\uff08\u5bf9\u8c61\uff09\u5b9e\u65bd\u6570\u636e\u91c7\u96c6\u548c\u5b58\u50a8\u3001\u5904\u7406\u5206\u6790\u548c\u5f02\u5e38\u8bc6\u522b\u3001\u4e8b\u4ef6\u901a\u77e5\u3001\u53ef\u89c6\u5316\uff0c\u7528\u4e8e\u4fdd\u969cSLA\uff0c\u662f\u8fd0\u7ef4\u7684\u6700\u57fa\u7840\u548c\u91cd\u8981\u7684\u5de5\u4f5c\u4e4b\u4e00\u3002 \u4e8b\u4ef6\u7ba1\u7406\u6d41\u7a0b\uff1a\u4e8b\u4ef6\u662f\u5bf9\u8ba1\u5212\u5916\u7684\u3001\u4f1a\u5f15\u8d77\u670d\u52a1\u8d28\u91cf\u4e0b\u964d\u7684\u4e8b\u6001\uff0c\u4e8b\u4ef6\u7ba1\u7406\u6d41\u7a0b\u662f\u8981\u6c42\u5feb\u901f\u54cd\u5e94\u4e8b\u4ef6\u3001\u53ca\u65f6\u6062\u590d\u670d\u52a1\u8d28\u91cf\u3001\u964d\u4f4e\u7528\u6237\u6295\u8bc9\u7684\u5168\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002 \u7d27\u6025\u53d8\u66f4\uff1a\u6536\u5230\u7a81\u53d1\u4e8b\u4ef6\u65f6\uff0c\u4e3a\u4e86\u6ee1\u8db3\u4e1a\u52a1\u9700\u8981\u800c\u5b9e\u65bd\u7684\u53d8\u66f4\uff0c\u5e38\u7528\u4e8e\u8fd0\u7ef4\u7684\u6545\u969c\u5904\u7406\u3002 \u6545\u969c\u5904\u7406\u6d41\u7a0b\uff1a\u5728\u670d\u52a1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u8fd0\u7ef4\u5feb\u901f\u53d1\u73b0\u548c\u89e3\u51b3\u95ee\u9898\u7684\u6d41\u7a0b\uff0c\u5305\u62ec\uff1a\u6545\u969c\u53d1\u73b0\u3001\u6545\u969c\u8ffd\u8e2a\u3001\u6545\u969c\u4fee\u590d\u3001\u4e8b\u540e\u5c0f\u7ed3\u590d\u76d8\u3002 \u670d\u52a1\u8fde\u7eed\u6027\uff1a\u9047\u5230\u91cd\u5927\u6545\u969c\u65f6\uff0c\u80fd\u5feb\u901f\u6062\u590d\u670d\u52a1\u7684\u80fd\u529b\uff0c\u5982\uff1a\u4e1a\u52a1\u6062\u590d\u8ba1\u5212\u3001\u6570\u636e\u5907\u4efd\u3001\u5bb9\u707e\u3001\u6df7\u6c8c\u5de5\u7a0b\u7b49\u3002 \u4e1a\u52a1\u9ad8\u53ef\u7528\uff1a\u901a\u8fc7\u4e1a\u52a1\u5206\u6790\u7b49\u8c03\u67e5\u65b9\u5f0f\uff0c\u627e\u51fa\u4e1a\u52a1\u7684\u9ad8\u53ef\u7528\u7684\u9700\u6c42\uff0c\u642d\u5efa\u5ea6\u91cf\u6307\u6807\u4f53\u7cfb\uff0c\u8bc6\u522b\u98ce\u9669\uff0c\u5efa\u7acb\u5bf9\u5e94\u7684\u670d\u52a1\u67b6\u6784\u548c\u7ec4\u7ec7\u3002 \u7528\u6237\u4f53\u9a8c\u4f18\u5316\uff1a\u57fa\u4e8e\u76d1\u63a7\u4f53\u7cfb\u7684\u6570\u636e\u91c7\u96c6\u80fd\u529b\uff0c\u91cf\u5316\u7528\u6237\u7684\u4f53\u9a8c\u6307\u6807\uff0c\u7528\u4e8e\u5f02\u5e38\u7684\u53d1\u73b0\u3001\u5b9a\u4f4d\u548c\u4fee\u590d\u3002 \u5e94\u7528\u6027\u80fd\u7ba1\u7406\uff1a\u5bf9\u5e94\u7528|\u7ec4\u4ef6|\u6a21\u5757\u7684\u6027\u80fd\u6307\u6807\u8fdb\u884c\u5ea6\u91cf\u3001\u91c7\u96c6\u3001\u53ef\u89c6\u5316\uff0c\u7528\u4e8e\u4e1a\u52a1\u94fe\u8def\u7684\u6027\u80fd\u95ee\u9898\u8ffd\u6eaf\u3001\u4fee\u590d\uff0c\u548c\u9ad8\u53ef\u7528\u67b6\u6784\u8bbe\u8ba1\u3002 \u67b6\u6784 \u6570\u636e\u91c7\u96c6\u7684\u6a21\u5f0f \u88ab\u52a8\u6a21\u5f0f\uff1a\u901a\u8fc7\u90e8\u7f72\u63a2\u9488\uff0c\u4ece\u5e94\u7528\u5916\u90e8\u83b7\u53d6\u670d\u52a1\u7684\u6307\u6807\u3002 \u4e3b\u52a8\u6a21\u5f0f\uff1a\u5e94\u7528\u4e2d\u52a0\u5165\u57cb\u70b9\uff0c\u4e3b\u52a8\u4e0a\u62a5\u3002 \u65c1\u8def\u6a21\u5f0f\uff1a\u4e0e\u5e94\u7528\u65e0\u5173\uff0c\u901a\u8fc7\u5bf9\u7f51\u7edc\u5c42\u7684 \u7aef\u53e3\u955c\u50cf \u5b9e\u73b0\uff0c\u4e0d\u5f71\u54cd\u4e1a\u52a1\u7684\u7f51\u7edc\u3002 \u4e1a\u52a1\u94fe\u8def \u76d1\u63a7\u5bf9\u8c61\u7684\u5206\u7c7b\u5206\u5c42 \u57fa\u7840\u76d1\u63a7\uff08\u7eff\u8272\uff09\uff0c\u5bb9\u6613\u91c7\u96c6\u800c\u4fe1\u606f\u5bc6\u5ea6\u4f4e\uff0c\u540e\u671f\u88ab\u805a\u5408 \u5bb9\u91cf\u76d1\u63a7\uff1a\u4e3b\u673a\u7684\u78c1\u76d8\u5bb9\u91cf\u3001HTTP\u670d\u52a1\u7684QPS \u8fdb\u7a0b\u76d1\u63a7\uff1a\u4e3b\u673a\u7684\u8fdb\u7a0b\u4fe1\u606f \u7279\u6027\u76d1\u63a7\uff1a\u9488\u5bf9\u4e0d\u540c\u7684\u76d1\u63a7\u76ee\u6807\u7279\u6027\u800c\u5236\u5b9a\u7684\u6307\u6807\u91c7\u96c6 \u670d\u52a1\u7aef\u76d1\u63a7 \u8c03\u7528\u94fe\u8def\u8ffd\u8e2a\uff08\u84dd\u8272\uff09\uff1a\u5e94\u7528\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\u548c\u65f6\u5e8f\u4f53\u73b0 \u7ec4\u4ef6\u76d1\u63a7\uff1a\u5bf9\u5e38\u7528\u7684\u5f00\u6e90\u7ec4\u4ef6\uff08\u5982\uff1aMySQL\u3001Redis\u3001Nginx\u3001MQ\uff09\u7684\u6307\u6807\u76d1\u63a7 \u4e1a\u52a1\u76d1\u63a7\uff1a\u81ea\u7814\u5e94\u7528\u7684\u76d1\u63a7\uff0c\u91cd\u70b9\u5728Log\u91c7\u96c6\u548c\u5206\u6790 \u7f51\u7edc\u8d28\u91cf\u76d1\u63a7\uff08\u9ec4\u8272\uff09\uff1a\u72ec\u7acb\u91c7\u96c6\u7cfb\u7edf\uff0c\u90e8\u7f72\u591a\u70b9\uff0c\u7ed3\u5408GIS \u7528\u6237\u4f53\u9a8c\u76d1\u63a7\uff08\u7ea2\u8272\uff09\uff0c\u6700\u76f4\u89c2\u3001\u91cd\u8981\u7684\u9876\u5c42\u4e1a\u52a1\u8d28\u91cf\u4f53\u73b0 \u8206\u60c5\u76d1\u63a7\uff1a\u7528\u6237\u5bf9\u4e1a\u52a1\u7684\u6295\u8bc9\u548c\u53cd\u9988\u7eb3\u5165\u5de5\u5355\uff0c\u5b9a\u671f\u7edf\u8ba1\u548c\u4f18\u5148\u89e3\u51b3 \u62e8\u6d4b\u76d1\u63a7\uff1aMock\u7528\u6237\u5b9a\u671f\u5bf9\u4e1a\u52a1\u5916\u90e8\u63a5\u53e3\u8bbf\u95ee\uff0c\u83b7\u53d6\u670d\u52a1\u53ef\u7528\u6027\u3001\u76f8\u5e94\u65f6\u957f\u3001\u72b6\u6001\u53cd\u9988\u7801\u7b49\u6838\u5fc3\u6307\u6807 \u8bc4\u4ef7\u6307\u6807\u548c\u6807\u51c6 \u6210\u719f\u5ea6\u7b49\u7ea7 \u521d\u59cb\u7ea7\uff1a\u9760\u4eba\u8089\u76d1\u63a7\u548c\u6392\u969c\u3001\u707e\u5907\u7f3a\u5931\uff0c\u8fd0\u7ef4\u75b2\u4e8e\u6551\u706b\u3002 \u57fa\u7840\u7ea7\uff1a\u6709\u90e8\u5206\u76d1\u63a7\u91c7\u96c6\u5de5\u5177\u3001\u901a\u8fc7\u6570\u636e\u5206\u6790\u80fd\u89e6\u53d1\u544a\u8b66\uff0c\u53ca\u65f6\u901a\u77e5\u8fd0\u7ef4\u3002 \u6210\u719f\u7ea7\uff1a\u7aef\u5230\u7aef\u7684\u5168\u94fe\u8def\u611f\u77e5\uff0c\u901a\u8fc7\u53ef\u89c6\u5316\u7684\u6570\u636e\u5e73\u53f0\uff0c\u5bf9\u95ee\u9898\u70b9\u8fdb\u884c\u5206\u6790\u548c\u5b9a\u4f4d\uff0c\u5728\u7528\u6237\u6295\u8bc9\u4e4b\u524d\u53d1\u73b0\u5e76\u89e3\u51b3\u4e1a\u52a1\u9690\u60a3\u3002 \u4f18\u5316\u7ea7\uff1a\u5bf9\u670d\u52a1\u8d28\u91cf\u8fdb\u4e00\u6b65\u4f18\u5316\u63d0\u9ad8\uff0c\u4fdd\u969c\u7a33\u5b9a\u6027\uff0c\u652f\u6301\u4e1a\u52a1\u7684\u52a8\u6001\u53d8\u5316\u7684\u81ea\u52a8\u5316\u5904\u7406\u3002 \u91c7\u96c6\u6307\u6807 \u8986\u76d6\u5ea6\uff08\u8d8a\u5168\u8d8a\u597d\uff09\uff1a\u8986\u76d6\u4e3b\u673a\u3001\u7f51\u7edc\u3001\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u3001\u4e2d\u95f4\u4ef6\u3001\u4e1a\u52a1\u5e94\u7528\u548c\u7528\u6237\u7ec8\u7aef\u7684\u5168\u94fe\u8def\u91c7\u96c6\u7684\u7a0b\u5ea6\u3002 \u91c7\u96c6\u65b9\u6cd5\uff08\u8d8a\u4e30\u5bcc\u8d8a\u597d\uff09\uff1a\u57fa\u4e8e\u63d2\u4ef6\u3001\u4e3b\u52a8\u91c7\u96c6\u4e0a\u62a5\u7684\u63a2\u9488\uff1b\u57fa\u4e8e\u4efb\u52a1\u8c03\u5ea6\u7684\u88ab\u52a8\u91c7\u96c6\uff1b\u5d4c\u5165\u5f0fSDK\u3002 \u51c6\u786e\u6027\uff1a\u91c7\u96c6\u7684\u6570\u636e\u548c\u8fd0\u7ef4\u89c2\u5bdf\u7684\u8bef\u5dee\uff0c\u8d8a\u5c0f\u8d8a\u597d\u3002 \u6570\u636e\u5b9e\u65f6\u6027\uff1a\u91c7\u96c6\u9891\u7387\u548c\u65f6\u95f4\u7c92\u5ea6\uff0c\u4ece\u5206\u949f\u5230\u79d2\uff0c\u8d8a\u5c0f\u8d8a\u597d\u3002 \u6570\u636e\u5904\u7406\u80fd\u529b ETL\uff1a\u5bf9\u91c7\u96c6\u6570\u636e\u7684\u6e05\u6d17\u3001\u8fc7\u6ee4\u3001\u8f6c\u6362\u540e\uff0c\u63d0\u53d6\u51fa\u4fe1\u606f\u548c\u4e8b\u4ef6\uff0c\u6309\u65f6\u95f4\u7c92\u5ea6\u805a\u5408\u6210\u6307\u6807\u3002 \u6570\u636e\u8ba1\u7b97\u80fd\u529b\uff1a\u4ece\u5355\u673a\u5230\u96c6\u7fa4\uff0c\u63d0\u5347\u6570\u636e\u5e76\u884c\u8ba1\u7b97\u80fd\u529b\u548c\u5b58\u50a8\u5bb9\u91cf\u3002 \u6570\u636e\u9002\u914d\u6027\uff1a\u80fd\u5339\u914d\u591a\u79cd\u7ef4\u5ea6\u7684\u76d1\u63a7\u573a\u666f\u3002 \u4e8b\u4ef6\u68c0\u6d4b\u80fd\u529b\uff08\u4ece\u57fa\u672c\u5230\u9ad8\u7ea7\uff09 \u8bc6\u522b\u65b9\u6cd5\uff1a\u662f\u5426\u8d85\u51fa\u9608\u503c => \u591a\u7ef4\u5ea6\u6307\u6807\u805a\u5408 => \u673a\u5668\u5b66\u4e60 \u4e8b\u4ef6\u6536\u655b\u7b56\u7565\uff1a\u539f\u59cb\u4e8b\u4ef6\uff0c\u65e0\u6536\u655b => \u6309(\u65f6\u95f4\u3001\u76d1\u63a7\u5bf9\u8c61\u3001\u63a5\u6536\u4eba\u3001\u6301\u7eed\u65f6\u95f4)\u591a\u7ef4\u5ea6\u5408\u5e76\u6536\u655b => \u673a\u5668\u5b66\u4e60 \u4e8b\u4ef6\u6709\u6548\u6027\uff1a\u80fd\u611f\u77e5 => \u80fd\u8bc6\u522b\u51fa\u5f02\u5e38\u70b9\uff0c\u4f46\u5b58\u5728\u6f0f\u62a5\u548c\u8bef\u62a5 => \u4e8b\u4ef6\u51c6\u786e\u7387\u548c\u6709\u6548\u6027\u63d0\u5347\u7684\u540c\u65f6\uff0c\u907f\u514d\u91cd\u8981\u544a\u8b66\u88ab\u6df9\u6ca1 \u544a\u8b66\u65f6\u5ef6\uff1a\u544a\u8b66\u5e76\u4e0d\u662f\u8d8a\u5b9e\u65f6\u8d8a\u597d\uff0c\u800c\u662f\uff08\u5b9e\u65f6\u6027\u3001\u51c6\u786e\u6027\uff0c\u91cd\u8981\u5ea6\uff09\u7684\u5e73\u8861\u8003\u91cf \u53ef\u89c6\u5316\u7a0b\u5ea6 \u6307\u6807\u548c\u4e8b\u4ef6\u80fd\u5c55\u793a \u6309\u544a\u8b66\u7ea7\u522b\u3001\u7c7b\u578b\u7b49\u7ef4\u5ea6\uff0c\u6309\u9700\u5c55\u793a \u6309\u7167\u4e1a\u52a1\u8c03\u7528\u94fe\u8def\u5c55\u793a \u901a\u77e5\u6e20\u9053 \u5b9e\u73b0\u90ae\u4ef6\u3001\u77ed\u4fe1\u7b49\u901a\u77e5\u65b9\u5f0f \u6309\u544a\u8b66\u7ea7\u522b\u3001\u7c7b\u578b\u5206\u5c42\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u901a\u77e5\u65b9\u5f0f \u5982\u679c\u4e8b\u4ef6\u6ca1\u6709\u53ca\u65f6\u53d7\u7406\uff0c\u5b9e\u73b0\u4e8b\u4ef6\u4e0a\u62a5 \u544a\u8b66\u81ea\u6108 \u5bf9\u544a\u8b66\u4e8b\u4ef6\u6709\u8bb0\u5f55 \u751f\u6210\u5de5\u5355\uff0c\u91c7\u96c6\u66f4\u591a\u6545\u969c\u73af\u5883\u4fe1\u606f \u6709\u81ea\u52a8\u5904\u7406\u811a\u672c\uff0c\u81ea\u6108\u540e\u81ea\u52a8\u5173\u95ed\u5de5\u5355 \u544a\u8b66\u7edf\u8ba1 \u4eba\u5de5\u7edf\u8ba1 \u6309\u544a\u8b66\u4e8b\u9879\u3001\u7ea7\u522b\u3001\u5468\u671f\u3001\u9891\u7387\u7b49\u7ef4\u5ea6\u81ea\u52a8\u7edf\u8ba1\uff0c\u652f\u6301\u5bfc\u51fa\u548c\u81ea\u52a8\u53d1\u9001\u76f8\u5173\u4eba \u6309\u8c03\u7528\u94fe\u8def\uff0c\u5b9e\u73b0\u76f8\u5173\u4fe1\u606f\u7684\u8fde\u5e26\u7edf\u8ba1\u62a5\u8868 \u544a\u8b66\u4e8b\u4ef6\u5de5\u5355 \u8fd0\u7ef4\u88ab\u52a8\u63a5\u6536\u96f6\u6563\u7684\u544a\u8b66\u4e8b\u4ef6\uff0c\u6ca1\u6709\u65f6\u6548\u6027\u6307\u6807 \u5efa\u7acb\u7edf\u4e00\u7684\u4e8b\u4ef6\u63a5\u6536\u5165\u53e3\uff0c\u5f62\u6210\u5de5\u5355\u8bb0\u5f55\uff08\u751f\u547d\u5468\u671f\u95ed\u73af\uff09\uff0c\u5bf9\u4e8b\u4ef6\u8fdb\u884c\u5206\u7c7b\u3001\u5212\u5206\u7b49\u7ea7\uff0c\u7edf\u8ba1\uff1a\u4e8b\u4ef6\u603b\u91cf\u3001\u89e3\u51b3\u7387\u7b49\u6307\u6807 \u80fd\u8fdb\u4e00\u6b65\u5206\u6790\u5404\u7c7b\u4e8b\u4ef6\u7684\u8d8b\u52bf\u548c\u539f\u56e0\uff0c\u5b9e\u73b0\u81ea\u6108\uff0c\u6709\u6548\u964d\u4f4e\u544a\u8b66\u4e8b\u4ef6\u6570\u91cf \u544a\u8b66\u4e8b\u4ef6\u8d8b\u52bf \u968f\u7cfb\u7edf\u89c4\u6a21\u548c\u590d\u6742\u5ea6\u589e\u957f\uff0c\u6570\u91cf\u5448\u73b0\u6307\u6570\u7ea7\u4e0a\u5347 \u6570\u91cf\u53ef\u63a7\uff0c\u4e0d\u968f\u7cfb\u7edf\u89c4\u6a21\u548c\u590d\u6742\u5ea6\u589e\u957f\uff0c\u6709\u6548\u63a7\u5236\u91cd\u590d\u6027\u4e8b\u4ef6\u7684\u53d1\u751f\u7387 \u4e8b\u4ef6\u6570\u91cf\u7a33\u4e2d\u6709\u964d\uff0c\u6709\u6548\u9884\u9632\u91cd\u5927\u751f\u4ea7\u4e8b\u6545 \u7d27\u6025\u53d8\u66f4\u6d41\u7a0b \u6ca1\u6709\u89c4\u8303\u6d41\u7a0b\uff0c\u9760\u8fd0\u7ef4\u4eba\u5458\u7684\u7ecf\u9a8c\u5b9e\u65bd\uff0c\u98ce\u9669\u4e0d\u53ef\u63a7 \u6709\u6b63\u5f0f\u7684\u7d27\u6025\u53d8\u66f4\u6d41\u7a0b\uff0c\u8fd0\u7ef4\u53ca\u65f6\u62c9\u76f8\u5173\u4eba\u53ec\u5f00\u7d27\u6025\u4f1a\u8bae\u3001\u5ba1\u6279\u53d8\u66f4\uff0c\u63d0\u4f9b\u5de5\u5177\u80fd\u5b9e\u65bd\u5feb\u901f\uff0c\u4e8b\u540e\u590d\u76d8 \u7d27\u6025\u53d8\u66f4\u6d41\u7a0b\u548c\u8fd0\u7ef4\u7cfb\u7edf\u6574\u5408\u5728\u4e00\u8d77\uff0c\u80fd\u667a\u80fd\u7684\u81ea\u52a8\u5316\u5b9e\u65bd\uff0c\u8fd0\u7ef4\u53ea\u9700\u8981\u503c\u5b88 \u670d\u52a1\u53ef\u7528\u6027\u6307\u6807 \u6ca1\u6709\u7edf\u8ba1\u548c\u5efa\u7acb\u53ef\u7528\u6027\u6307\u6807 \u5efa\u7acb\u521d\u6b65\u7684SLA\uff0c\u4f46\u662f\u5b58\u5728\u8fdd\u7ea6 \u901a\u8fc7\u4e91\u3001\u5bb9\u5668\u3001\u8d44\u6e90\u6269\u7f29\u5bb9\u7b49\u65b9\u6cd5\uff0c\u652f\u6301\u4e1a\u52a1\u589e\u957f\u7684\u540c\u65f6\uff0c\u4fdd\u969cSLA\u8fbe\u6807 \u7528\u6237\u4f53\u9a8c \u7528\u6237\u80fd\u611f\u53d7\u5230\u7cfb\u7edf\u7684\u4e0d\u7a33\u5b9a\uff0c\u5076\u5c14\u51fa\u73b0\u670d\u52a1\u4e0d\u53ef\u7528\u3002 \u670d\u52a1\u8f83\u7a33\u5b9a\uff0c\u6545\u969c\u80fd\u5728\u77ed\u65f6\u95f4\u5185\u6062\u590d\uff0c\u4f46\u662f\u9047\u5230\u4e1a\u52a1\u6d2a\u5cf0\u65f6\uff0c\u4f1a\u51fa\u73b0\u5361\u987f\u3002 \u7528\u6237\u5bf9\u4e8b\u6545\u57fa\u672c\u65e0\u611f\u77e5\uff0c\u7cfb\u7edf\u80fd\u652f\u6301\u5e02\u573a\u6d3b\u52a8\u5f15\u8d77\u7684\u6d41\u91cf\u6d2a\u5cf0\u3002 \u6027\u80fd\u7ba1\u7406 \u6ca1\u6709\u5ea6\u91cf\u6307\u6807\uff0c\u51ed\u501f\u8d44\u6df1\u8fd0\u7ef4\u7684\u7ecf\u9a8c\u548c\u76f4\u89c9 \u5efa\u7acb\u57fa\u7840\u7684\u6307\u6807\u91c7\u96c6\u80fd\u529b\uff0c\u5f62\u6210\u6027\u80fd\u5ea6\u91cf\u62a5\u544a \u5efa\u7acb\u7aef\u5230\u7aef\u7684\u6027\u80fd\u6307\u6807\u91c7\u96c6\u4f53\u7cfb\uff0c\u80fd\u5efa\u7acb\u5173\u8054\u5206\u6790\u3001\u8d8b\u52bf\u9884\u6d4b\uff0c\u63d0\u524d\u9884\u9632\u6027\u80fd\u4e8b\u6545\u53d1\u751f \u77e5\u8bc6\u7ba1\u7406 \u6280\u672f\u77e5\u8bc6\u3001\u6545\u969c\u7ecf\u9a8c\u7b49\u6587\u6863\u96f6\u6563\u7684\u5b58\u653e\uff0c\u7f3a\u5c11\u6301\u7eed\u7d2f\u79ef \u5bf9\u5178\u578b\u3001\u91cd\u590d\u7684\u6545\u969c\u5f62\u6210RCA\uff0c\u7edf\u4e00\u5b58\u50a8\u5730\u70b9\uff0c\u5f62\u6210\u77e5\u8bc6\uff0c\u5e2e\u52a9\u8fd0\u7ef4\u90e8\u95e8\u9ad8\u6548\u8fd0\u8f6c \u77e5\u8bc6\u80fd\u548c\u90e8\u95e8\u4ee5\u5916\u7684\u7ec4\u7ec7\u5206\u4eab\uff0c\u652f\u6301\u81ea\u6108\u7cfb\u7edf\u7684\u642d\u5efa \u91c7\u96c6\u4f53\u7cfb \u544a\u8b66\u89c4\u5219 \u544a\u8b66\u89c4\u5219 = \u67e5\u8be2\u6761\u4ef6+\u89e6\u53d1\u6761\u4ef6+\u4e8b\u4ef6\u5b9a\u4e49 \u67e5\u8be2\u6761\u4ef6\uff1a\u6307\u5b9a\u91c7\u96c6\u6307\u6807\uff0c\u548c\u8fc7\u6ee4\u7ea6\u675f\u6761\u4ef6\uff0c\u5982\uff1a\u65f6\u95f4\u8303\u56f4\u3001\u4e3b\u673a\u8303\u56f4\u6307\u5b9a\uff0c\u652f\u6301\u591a\u91cd\u6761\u4ef6\u590d\u5408 \u89e6\u53d1\u6761\u4ef6\uff1a\u9009\u62e9\u8ba1\u7b97\u7684\u8303\u5f0f\uff0c\u4e0e\u9608\u503c\u5bf9\u6bd4 \u8ba1\u7b97\u7684\u8303\u5f0f\uff1a\u4e00\u79cd\u8ba1\u7b97\u7684\u8868\u8fbe\u5f0f|\u5b8f\u5b9a\u4e49\uff0c\u53ef\u4ee5\u7528\u6a21\u677f\u5305\u88c5 \u9608\u503c\uff1a\u9884\u5148\u5b9a\u4e49\u597d\u7684\uff0c\u7528\u4e8e\u5bf9\u6bd4\u7684\u503c|\u5bf9\u8c61\uff0c\u5206\u9759\u6001\u548c\u52a8\u6001 \u4e8b\u4ef6\u5b9a\u4e49\uff1a\u89e6\u53d1\u540e\u7684\u4e8b\u4ef6\u7b49\u7ea7\u3001\u53d1\u9001\u7684\u62a5\u6587\u683c\u5f0f\u7b49\uff0c\u63a8\u9001\u7ed9\u6307\u5b9a\u7684\u901a\u77e5\u670d\u52a1 \u901a\u77e5\u670d\u52a1 \u4e8b\u4ef6\u4e00\u89c8 + \u544a\u8b66\u4e8b\u4ef6\u7684\u901a\u77e5\u6e20\u9053 + \u4e8b\u4ef6\u5904\u7406\u548c\u5347\u7ea7\u6d41\u7a0b + Hook\u673a\u5236 \u4e8b\u4ef6\u4e00\u89c8\uff1a\u6240\u6709\u6536\u5230\u7684\u4e8b\u4ef6\uff0c\u6309\u7167\u6761\u4ef6\u663e\u793a \u901a\u77e5\u6e20\u9053\uff1a\u591a\u79cd\u5916\u90e8\u901a\u77e5\u65b9\u5f0f\uff0c\u5982\uff1a\u90ae\u4ef6\u3001\u5fae\u4fe1\u901a\u77e5\u63a5\u53e3\u3001\u7535\u8bdd \u4e8b\u4ef6\u5904\u7406\u548c\u5347\u7ea7\u6d41\u7a0b\uff1a \u4e8b\u4ef6\u5904\u7406\uff1a \u4fe1\u606f\u8865\u5168\uff1a\u670d\u52a1\u4ece\u4e8b\u4ef6\u62a5\u6587\u4e2d\u62bd\u53d6\u5173\u952ekey\uff0c\u901a\u8fc7\u67e5\u8be2CMDB\uff0c\u8fdb\u4e00\u6b65\u8865\u5168\u4e8b\u4ef6\u5b8c\u6574\u4fe1\u606f\uff0c\u5982\uff1a\u8be5\u4e8b\u4ef6\u5c5e\u4e8e\u54ea\u4e2aAPP\uff08BU\uff09\u3001\u8d1f\u8d23\u4eba\u662f\u8c01\u3001\u4e0a\u4e0b\u6e38\u670d\u52a1\u662f\u8c01\u3001\u540c\u7c7b\u544a\u8b66\u7684\u5904\u7406\u63d0\u793a\uff0c\u53ef\u4ee5\u4e0d\u65ad\u5b8c\u5584 \u544a\u8b66\u6536\u655b\uff1a \u4e8b\u4ef6\u805a\u5408\uff1a\u540c\u7c7b\u4e8b\u4ef6\u5408\u5e76\u4e3a1\u4e2a\u544a\u8b66 \u4e8b\u4ef6\u9759\u9ed8\uff1a\u5df2\u7ecf\u53d1\u9001\u8fc7\u7684\u544a\u8b66\uff0c\u540c\u7c7b\u65b0\u4e8b\u4ef6\u5728\u6307\u5b9a\u4e00\u6bb5\u65f6\u671f\u5185\u4e0d\u518d\u53d1\u9001\u544a\u8b66 \u544a\u8b66\u786e\u8ba4\uff1a \u7528\u6237\u5904\u7406\uff1a\u8fd0\u7ef4\u6216\u5176\u4ed6\u8d1f\u8d23\u4eba\uff0c\u901a\u8fc7\u754c\u9762\u6216\u63a5\u53e3\uff0c\u786e\u8ba4\u5904\u7406\u67d0\u4e2a\u544a\u8b66\uff0c\u7136\u540e\u5173\u95ed\u8be5\u544a\u8b66 \u81ea\u52a8\u5173\u95ed\uff1a\u6ca1\u6709\u6301\u7eed\u6536\u5230\u540c\u7c7b\u4e8b\u4ef6\u3001\u6216\u8005\u6536\u5230\u6062\u590d\u4e8b\u4ef6\uff0c\u5c06\u5bf9\u5e94\u7684\u544a\u8b66\u81ea\u52a8\u5173\u95ed \u4e8b\u4ef6\u5347\u7ea7\uff1a\u540c\u7c7b\u4e8b\u4ef6\u805a\u5408\u5f62\u6210\u544a\u8b66\uff0c\u544a\u8b66\u4e00\u76f4\u672a\u88ab\u5904\u7406\uff0c\u4e00\u6bb5\u65f6\u95f4\u540e\u901a\u77e5\u8be5\u670d\u52a1\u7684\u4e0a\u7ea7\u8d1f\u8d23\u4eba\uff0c\u4e8b\u4ef6\u4e25\u91cd\u7b49\u7ea7\u53ef\u80fd\u4f1a\u63d0\u5347 Hook\u673a\u5236\uff1a\u53ef\u9009\uff0c\u7528\u4e8e\u7ec4\u5efa\u81ea\u52a8\u5904\u7406pipeline\uff0c\u5982\u67d0\u4e2aAPP\u6b7b\u673a\u540e\uff0c\u901a\u8fc7hook\uff0c\u4f20\u5165APP\u7684key\uff0c\u81ea\u52a8\u8c03\u7528APP\u91cd\u542f\u63a5\u53e3 \u53ef\u89c6\u5316 [TODO] \u5143\u6a21\u578b \u91c7\u96c6\u6307\u6807\u5e93 \u5b57\u6bb5\u540d \u7c7b\u578b \u8303\u5f0f \u5907\u6ce8 name String \u552f\u4e00 \u6307\u6807\u552f\u4e00\u540d cname String \u4e2d\u6587\u540d meaning String \u5fc5\u586b \u6307\u6807\u542b\u4e49 calc_formula String \u91c7\u96c6\u8ba1\u7b97\u516c\u5f0f rel_unit \u5b57\u5178 \u6570\u636e\u5355\u4f4d\uff0c\u4ece\u5b57\u5178\uff1a\u5355\u4f4d \u4e2d\u9009\u62e9 rel_level \u5b57\u5178 \u5fc5\u586b \u6240\u5c5e\u5c42\u7ea7\uff0c\u4ece\u5b57\u5178\uff1a\u5c42\u7ea7 \u4e2d\u9009\u62e9 rel_type \u5b57\u5178 \u5fc5\u586b \u91c7\u96c6\u7c7b\u578b\uff0c\u4ece Metric\u3001Log\u3001APM \u4e2d\u9009\u62e9 namespace String \u9ed8\u8ba4default \u547d\u540d\u7a7a\u95f4 \u5bf9\u4e0d\u540c\u7684\u91c7\u96c6\u7c7b\u578b\uff0c\u5b9e\u73b0\u7684\u65b9\u5f0f\u662f \u544a\u8b66\u89c4\u5219\u5e93 \u5b57\u6bb5\u540d \u7c7b\u578b \u8303\u5f0f \u5907\u6ce8 name String \u552f\u4e00 \u6307\u6807\u552f\u4e00\u540d","title":"\u76d1\u63a7\u544a\u8b66\u4f53\u7cfb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_1","text":"","title":"\u76d1\u63a7\u544a\u8b66\u4f53\u7cfb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_2","text":"\u76d1\u63a7\u544a\u8b66\u4f53\u7cfb\u76f8\u5173\u5b9a\u4e49\u3001\u67b6\u6784\u548c\u8bc4\u4ef7\u6807\u51c6 \u4ecb\u7ecd\u4e00\u79cd\u5b9e\u73b0\u65b9\u6848","title":"\u76ee\u7684"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_3","text":"\u76d1\u63a7\u670d\u52a1\uff1a\u5bf9\u8fd0\u884c\u7684\u670d\u52a1\uff08\u5bf9\u8c61\uff09\u5b9e\u65bd\u6570\u636e\u91c7\u96c6\u548c\u5b58\u50a8\u3001\u5904\u7406\u5206\u6790\u548c\u5f02\u5e38\u8bc6\u522b\u3001\u4e8b\u4ef6\u901a\u77e5\u3001\u53ef\u89c6\u5316\uff0c\u7528\u4e8e\u4fdd\u969cSLA\uff0c\u662f\u8fd0\u7ef4\u7684\u6700\u57fa\u7840\u548c\u91cd\u8981\u7684\u5de5\u4f5c\u4e4b\u4e00\u3002 \u4e8b\u4ef6\u7ba1\u7406\u6d41\u7a0b\uff1a\u4e8b\u4ef6\u662f\u5bf9\u8ba1\u5212\u5916\u7684\u3001\u4f1a\u5f15\u8d77\u670d\u52a1\u8d28\u91cf\u4e0b\u964d\u7684\u4e8b\u6001\uff0c\u4e8b\u4ef6\u7ba1\u7406\u6d41\u7a0b\u662f\u8981\u6c42\u5feb\u901f\u54cd\u5e94\u4e8b\u4ef6\u3001\u53ca\u65f6\u6062\u590d\u670d\u52a1\u8d28\u91cf\u3001\u964d\u4f4e\u7528\u6237\u6295\u8bc9\u7684\u5168\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002 \u7d27\u6025\u53d8\u66f4\uff1a\u6536\u5230\u7a81\u53d1\u4e8b\u4ef6\u65f6\uff0c\u4e3a\u4e86\u6ee1\u8db3\u4e1a\u52a1\u9700\u8981\u800c\u5b9e\u65bd\u7684\u53d8\u66f4\uff0c\u5e38\u7528\u4e8e\u8fd0\u7ef4\u7684\u6545\u969c\u5904\u7406\u3002 \u6545\u969c\u5904\u7406\u6d41\u7a0b\uff1a\u5728\u670d\u52a1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u8fd0\u7ef4\u5feb\u901f\u53d1\u73b0\u548c\u89e3\u51b3\u95ee\u9898\u7684\u6d41\u7a0b\uff0c\u5305\u62ec\uff1a\u6545\u969c\u53d1\u73b0\u3001\u6545\u969c\u8ffd\u8e2a\u3001\u6545\u969c\u4fee\u590d\u3001\u4e8b\u540e\u5c0f\u7ed3\u590d\u76d8\u3002 \u670d\u52a1\u8fde\u7eed\u6027\uff1a\u9047\u5230\u91cd\u5927\u6545\u969c\u65f6\uff0c\u80fd\u5feb\u901f\u6062\u590d\u670d\u52a1\u7684\u80fd\u529b\uff0c\u5982\uff1a\u4e1a\u52a1\u6062\u590d\u8ba1\u5212\u3001\u6570\u636e\u5907\u4efd\u3001\u5bb9\u707e\u3001\u6df7\u6c8c\u5de5\u7a0b\u7b49\u3002 \u4e1a\u52a1\u9ad8\u53ef\u7528\uff1a\u901a\u8fc7\u4e1a\u52a1\u5206\u6790\u7b49\u8c03\u67e5\u65b9\u5f0f\uff0c\u627e\u51fa\u4e1a\u52a1\u7684\u9ad8\u53ef\u7528\u7684\u9700\u6c42\uff0c\u642d\u5efa\u5ea6\u91cf\u6307\u6807\u4f53\u7cfb\uff0c\u8bc6\u522b\u98ce\u9669\uff0c\u5efa\u7acb\u5bf9\u5e94\u7684\u670d\u52a1\u67b6\u6784\u548c\u7ec4\u7ec7\u3002 \u7528\u6237\u4f53\u9a8c\u4f18\u5316\uff1a\u57fa\u4e8e\u76d1\u63a7\u4f53\u7cfb\u7684\u6570\u636e\u91c7\u96c6\u80fd\u529b\uff0c\u91cf\u5316\u7528\u6237\u7684\u4f53\u9a8c\u6307\u6807\uff0c\u7528\u4e8e\u5f02\u5e38\u7684\u53d1\u73b0\u3001\u5b9a\u4f4d\u548c\u4fee\u590d\u3002 \u5e94\u7528\u6027\u80fd\u7ba1\u7406\uff1a\u5bf9\u5e94\u7528|\u7ec4\u4ef6|\u6a21\u5757\u7684\u6027\u80fd\u6307\u6807\u8fdb\u884c\u5ea6\u91cf\u3001\u91c7\u96c6\u3001\u53ef\u89c6\u5316\uff0c\u7528\u4e8e\u4e1a\u52a1\u94fe\u8def\u7684\u6027\u80fd\u95ee\u9898\u8ffd\u6eaf\u3001\u4fee\u590d\uff0c\u548c\u9ad8\u53ef\u7528\u67b6\u6784\u8bbe\u8ba1\u3002","title":"\u5e38\u7528\u5b9a\u4e49"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_4","text":"","title":"\u67b6\u6784"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_5","text":"\u88ab\u52a8\u6a21\u5f0f\uff1a\u901a\u8fc7\u90e8\u7f72\u63a2\u9488\uff0c\u4ece\u5e94\u7528\u5916\u90e8\u83b7\u53d6\u670d\u52a1\u7684\u6307\u6807\u3002 \u4e3b\u52a8\u6a21\u5f0f\uff1a\u5e94\u7528\u4e2d\u52a0\u5165\u57cb\u70b9\uff0c\u4e3b\u52a8\u4e0a\u62a5\u3002 \u65c1\u8def\u6a21\u5f0f\uff1a\u4e0e\u5e94\u7528\u65e0\u5173\uff0c\u901a\u8fc7\u5bf9\u7f51\u7edc\u5c42\u7684 \u7aef\u53e3\u955c\u50cf \u5b9e\u73b0\uff0c\u4e0d\u5f71\u54cd\u4e1a\u52a1\u7684\u7f51\u7edc\u3002","title":"\u6570\u636e\u91c7\u96c6\u7684\u6a21\u5f0f"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_6","text":"","title":"\u4e1a\u52a1\u94fe\u8def"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_7","text":"\u57fa\u7840\u76d1\u63a7\uff08\u7eff\u8272\uff09\uff0c\u5bb9\u6613\u91c7\u96c6\u800c\u4fe1\u606f\u5bc6\u5ea6\u4f4e\uff0c\u540e\u671f\u88ab\u805a\u5408 \u5bb9\u91cf\u76d1\u63a7\uff1a\u4e3b\u673a\u7684\u78c1\u76d8\u5bb9\u91cf\u3001HTTP\u670d\u52a1\u7684QPS \u8fdb\u7a0b\u76d1\u63a7\uff1a\u4e3b\u673a\u7684\u8fdb\u7a0b\u4fe1\u606f \u7279\u6027\u76d1\u63a7\uff1a\u9488\u5bf9\u4e0d\u540c\u7684\u76d1\u63a7\u76ee\u6807\u7279\u6027\u800c\u5236\u5b9a\u7684\u6307\u6807\u91c7\u96c6 \u670d\u52a1\u7aef\u76d1\u63a7 \u8c03\u7528\u94fe\u8def\u8ffd\u8e2a\uff08\u84dd\u8272\uff09\uff1a\u5e94\u7528\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\u548c\u65f6\u5e8f\u4f53\u73b0 \u7ec4\u4ef6\u76d1\u63a7\uff1a\u5bf9\u5e38\u7528\u7684\u5f00\u6e90\u7ec4\u4ef6\uff08\u5982\uff1aMySQL\u3001Redis\u3001Nginx\u3001MQ\uff09\u7684\u6307\u6807\u76d1\u63a7 \u4e1a\u52a1\u76d1\u63a7\uff1a\u81ea\u7814\u5e94\u7528\u7684\u76d1\u63a7\uff0c\u91cd\u70b9\u5728Log\u91c7\u96c6\u548c\u5206\u6790 \u7f51\u7edc\u8d28\u91cf\u76d1\u63a7\uff08\u9ec4\u8272\uff09\uff1a\u72ec\u7acb\u91c7\u96c6\u7cfb\u7edf\uff0c\u90e8\u7f72\u591a\u70b9\uff0c\u7ed3\u5408GIS \u7528\u6237\u4f53\u9a8c\u76d1\u63a7\uff08\u7ea2\u8272\uff09\uff0c\u6700\u76f4\u89c2\u3001\u91cd\u8981\u7684\u9876\u5c42\u4e1a\u52a1\u8d28\u91cf\u4f53\u73b0 \u8206\u60c5\u76d1\u63a7\uff1a\u7528\u6237\u5bf9\u4e1a\u52a1\u7684\u6295\u8bc9\u548c\u53cd\u9988\u7eb3\u5165\u5de5\u5355\uff0c\u5b9a\u671f\u7edf\u8ba1\u548c\u4f18\u5148\u89e3\u51b3 \u62e8\u6d4b\u76d1\u63a7\uff1aMock\u7528\u6237\u5b9a\u671f\u5bf9\u4e1a\u52a1\u5916\u90e8\u63a5\u53e3\u8bbf\u95ee\uff0c\u83b7\u53d6\u670d\u52a1\u53ef\u7528\u6027\u3001\u76f8\u5e94\u65f6\u957f\u3001\u72b6\u6001\u53cd\u9988\u7801\u7b49\u6838\u5fc3\u6307\u6807","title":"\u76d1\u63a7\u5bf9\u8c61\u7684\u5206\u7c7b\u5206\u5c42"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_8","text":"","title":"\u8bc4\u4ef7\u6307\u6807\u548c\u6807\u51c6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_9","text":"\u521d\u59cb\u7ea7\uff1a\u9760\u4eba\u8089\u76d1\u63a7\u548c\u6392\u969c\u3001\u707e\u5907\u7f3a\u5931\uff0c\u8fd0\u7ef4\u75b2\u4e8e\u6551\u706b\u3002 \u57fa\u7840\u7ea7\uff1a\u6709\u90e8\u5206\u76d1\u63a7\u91c7\u96c6\u5de5\u5177\u3001\u901a\u8fc7\u6570\u636e\u5206\u6790\u80fd\u89e6\u53d1\u544a\u8b66\uff0c\u53ca\u65f6\u901a\u77e5\u8fd0\u7ef4\u3002 \u6210\u719f\u7ea7\uff1a\u7aef\u5230\u7aef\u7684\u5168\u94fe\u8def\u611f\u77e5\uff0c\u901a\u8fc7\u53ef\u89c6\u5316\u7684\u6570\u636e\u5e73\u53f0\uff0c\u5bf9\u95ee\u9898\u70b9\u8fdb\u884c\u5206\u6790\u548c\u5b9a\u4f4d\uff0c\u5728\u7528\u6237\u6295\u8bc9\u4e4b\u524d\u53d1\u73b0\u5e76\u89e3\u51b3\u4e1a\u52a1\u9690\u60a3\u3002 \u4f18\u5316\u7ea7\uff1a\u5bf9\u670d\u52a1\u8d28\u91cf\u8fdb\u4e00\u6b65\u4f18\u5316\u63d0\u9ad8\uff0c\u4fdd\u969c\u7a33\u5b9a\u6027\uff0c\u652f\u6301\u4e1a\u52a1\u7684\u52a8\u6001\u53d8\u5316\u7684\u81ea\u52a8\u5316\u5904\u7406\u3002","title":"\u6210\u719f\u5ea6\u7b49\u7ea7"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_10","text":"\u8986\u76d6\u5ea6\uff08\u8d8a\u5168\u8d8a\u597d\uff09\uff1a\u8986\u76d6\u4e3b\u673a\u3001\u7f51\u7edc\u3001\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u3001\u4e2d\u95f4\u4ef6\u3001\u4e1a\u52a1\u5e94\u7528\u548c\u7528\u6237\u7ec8\u7aef\u7684\u5168\u94fe\u8def\u91c7\u96c6\u7684\u7a0b\u5ea6\u3002 \u91c7\u96c6\u65b9\u6cd5\uff08\u8d8a\u4e30\u5bcc\u8d8a\u597d\uff09\uff1a\u57fa\u4e8e\u63d2\u4ef6\u3001\u4e3b\u52a8\u91c7\u96c6\u4e0a\u62a5\u7684\u63a2\u9488\uff1b\u57fa\u4e8e\u4efb\u52a1\u8c03\u5ea6\u7684\u88ab\u52a8\u91c7\u96c6\uff1b\u5d4c\u5165\u5f0fSDK\u3002 \u51c6\u786e\u6027\uff1a\u91c7\u96c6\u7684\u6570\u636e\u548c\u8fd0\u7ef4\u89c2\u5bdf\u7684\u8bef\u5dee\uff0c\u8d8a\u5c0f\u8d8a\u597d\u3002 \u6570\u636e\u5b9e\u65f6\u6027\uff1a\u91c7\u96c6\u9891\u7387\u548c\u65f6\u95f4\u7c92\u5ea6\uff0c\u4ece\u5206\u949f\u5230\u79d2\uff0c\u8d8a\u5c0f\u8d8a\u597d\u3002","title":"\u91c7\u96c6\u6307\u6807"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_11","text":"ETL\uff1a\u5bf9\u91c7\u96c6\u6570\u636e\u7684\u6e05\u6d17\u3001\u8fc7\u6ee4\u3001\u8f6c\u6362\u540e\uff0c\u63d0\u53d6\u51fa\u4fe1\u606f\u548c\u4e8b\u4ef6\uff0c\u6309\u65f6\u95f4\u7c92\u5ea6\u805a\u5408\u6210\u6307\u6807\u3002 \u6570\u636e\u8ba1\u7b97\u80fd\u529b\uff1a\u4ece\u5355\u673a\u5230\u96c6\u7fa4\uff0c\u63d0\u5347\u6570\u636e\u5e76\u884c\u8ba1\u7b97\u80fd\u529b\u548c\u5b58\u50a8\u5bb9\u91cf\u3002 \u6570\u636e\u9002\u914d\u6027\uff1a\u80fd\u5339\u914d\u591a\u79cd\u7ef4\u5ea6\u7684\u76d1\u63a7\u573a\u666f\u3002","title":"\u6570\u636e\u5904\u7406\u80fd\u529b"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_12","text":"\u8bc6\u522b\u65b9\u6cd5\uff1a\u662f\u5426\u8d85\u51fa\u9608\u503c => \u591a\u7ef4\u5ea6\u6307\u6807\u805a\u5408 => \u673a\u5668\u5b66\u4e60 \u4e8b\u4ef6\u6536\u655b\u7b56\u7565\uff1a\u539f\u59cb\u4e8b\u4ef6\uff0c\u65e0\u6536\u655b => \u6309(\u65f6\u95f4\u3001\u76d1\u63a7\u5bf9\u8c61\u3001\u63a5\u6536\u4eba\u3001\u6301\u7eed\u65f6\u95f4)\u591a\u7ef4\u5ea6\u5408\u5e76\u6536\u655b => \u673a\u5668\u5b66\u4e60 \u4e8b\u4ef6\u6709\u6548\u6027\uff1a\u80fd\u611f\u77e5 => \u80fd\u8bc6\u522b\u51fa\u5f02\u5e38\u70b9\uff0c\u4f46\u5b58\u5728\u6f0f\u62a5\u548c\u8bef\u62a5 => \u4e8b\u4ef6\u51c6\u786e\u7387\u548c\u6709\u6548\u6027\u63d0\u5347\u7684\u540c\u65f6\uff0c\u907f\u514d\u91cd\u8981\u544a\u8b66\u88ab\u6df9\u6ca1 \u544a\u8b66\u65f6\u5ef6\uff1a\u544a\u8b66\u5e76\u4e0d\u662f\u8d8a\u5b9e\u65f6\u8d8a\u597d\uff0c\u800c\u662f\uff08\u5b9e\u65f6\u6027\u3001\u51c6\u786e\u6027\uff0c\u91cd\u8981\u5ea6\uff09\u7684\u5e73\u8861\u8003\u91cf","title":"\u4e8b\u4ef6\u68c0\u6d4b\u80fd\u529b\uff08\u4ece\u57fa\u672c\u5230\u9ad8\u7ea7\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_13","text":"\u6307\u6807\u548c\u4e8b\u4ef6\u80fd\u5c55\u793a \u6309\u544a\u8b66\u7ea7\u522b\u3001\u7c7b\u578b\u7b49\u7ef4\u5ea6\uff0c\u6309\u9700\u5c55\u793a \u6309\u7167\u4e1a\u52a1\u8c03\u7528\u94fe\u8def\u5c55\u793a","title":"\u53ef\u89c6\u5316\u7a0b\u5ea6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_14","text":"\u5b9e\u73b0\u90ae\u4ef6\u3001\u77ed\u4fe1\u7b49\u901a\u77e5\u65b9\u5f0f \u6309\u544a\u8b66\u7ea7\u522b\u3001\u7c7b\u578b\u5206\u5c42\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u901a\u77e5\u65b9\u5f0f \u5982\u679c\u4e8b\u4ef6\u6ca1\u6709\u53ca\u65f6\u53d7\u7406\uff0c\u5b9e\u73b0\u4e8b\u4ef6\u4e0a\u62a5","title":"\u901a\u77e5\u6e20\u9053"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_15","text":"\u5bf9\u544a\u8b66\u4e8b\u4ef6\u6709\u8bb0\u5f55 \u751f\u6210\u5de5\u5355\uff0c\u91c7\u96c6\u66f4\u591a\u6545\u969c\u73af\u5883\u4fe1\u606f \u6709\u81ea\u52a8\u5904\u7406\u811a\u672c\uff0c\u81ea\u6108\u540e\u81ea\u52a8\u5173\u95ed\u5de5\u5355","title":"\u544a\u8b66\u81ea\u6108"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_16","text":"\u4eba\u5de5\u7edf\u8ba1 \u6309\u544a\u8b66\u4e8b\u9879\u3001\u7ea7\u522b\u3001\u5468\u671f\u3001\u9891\u7387\u7b49\u7ef4\u5ea6\u81ea\u52a8\u7edf\u8ba1\uff0c\u652f\u6301\u5bfc\u51fa\u548c\u81ea\u52a8\u53d1\u9001\u76f8\u5173\u4eba \u6309\u8c03\u7528\u94fe\u8def\uff0c\u5b9e\u73b0\u76f8\u5173\u4fe1\u606f\u7684\u8fde\u5e26\u7edf\u8ba1\u62a5\u8868","title":"\u544a\u8b66\u7edf\u8ba1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_17","text":"\u8fd0\u7ef4\u88ab\u52a8\u63a5\u6536\u96f6\u6563\u7684\u544a\u8b66\u4e8b\u4ef6\uff0c\u6ca1\u6709\u65f6\u6548\u6027\u6307\u6807 \u5efa\u7acb\u7edf\u4e00\u7684\u4e8b\u4ef6\u63a5\u6536\u5165\u53e3\uff0c\u5f62\u6210\u5de5\u5355\u8bb0\u5f55\uff08\u751f\u547d\u5468\u671f\u95ed\u73af\uff09\uff0c\u5bf9\u4e8b\u4ef6\u8fdb\u884c\u5206\u7c7b\u3001\u5212\u5206\u7b49\u7ea7\uff0c\u7edf\u8ba1\uff1a\u4e8b\u4ef6\u603b\u91cf\u3001\u89e3\u51b3\u7387\u7b49\u6307\u6807 \u80fd\u8fdb\u4e00\u6b65\u5206\u6790\u5404\u7c7b\u4e8b\u4ef6\u7684\u8d8b\u52bf\u548c\u539f\u56e0\uff0c\u5b9e\u73b0\u81ea\u6108\uff0c\u6709\u6548\u964d\u4f4e\u544a\u8b66\u4e8b\u4ef6\u6570\u91cf","title":"\u544a\u8b66\u4e8b\u4ef6\u5de5\u5355"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_18","text":"\u968f\u7cfb\u7edf\u89c4\u6a21\u548c\u590d\u6742\u5ea6\u589e\u957f\uff0c\u6570\u91cf\u5448\u73b0\u6307\u6570\u7ea7\u4e0a\u5347 \u6570\u91cf\u53ef\u63a7\uff0c\u4e0d\u968f\u7cfb\u7edf\u89c4\u6a21\u548c\u590d\u6742\u5ea6\u589e\u957f\uff0c\u6709\u6548\u63a7\u5236\u91cd\u590d\u6027\u4e8b\u4ef6\u7684\u53d1\u751f\u7387 \u4e8b\u4ef6\u6570\u91cf\u7a33\u4e2d\u6709\u964d\uff0c\u6709\u6548\u9884\u9632\u91cd\u5927\u751f\u4ea7\u4e8b\u6545","title":"\u544a\u8b66\u4e8b\u4ef6\u8d8b\u52bf"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_19","text":"\u6ca1\u6709\u89c4\u8303\u6d41\u7a0b\uff0c\u9760\u8fd0\u7ef4\u4eba\u5458\u7684\u7ecf\u9a8c\u5b9e\u65bd\uff0c\u98ce\u9669\u4e0d\u53ef\u63a7 \u6709\u6b63\u5f0f\u7684\u7d27\u6025\u53d8\u66f4\u6d41\u7a0b\uff0c\u8fd0\u7ef4\u53ca\u65f6\u62c9\u76f8\u5173\u4eba\u53ec\u5f00\u7d27\u6025\u4f1a\u8bae\u3001\u5ba1\u6279\u53d8\u66f4\uff0c\u63d0\u4f9b\u5de5\u5177\u80fd\u5b9e\u65bd\u5feb\u901f\uff0c\u4e8b\u540e\u590d\u76d8 \u7d27\u6025\u53d8\u66f4\u6d41\u7a0b\u548c\u8fd0\u7ef4\u7cfb\u7edf\u6574\u5408\u5728\u4e00\u8d77\uff0c\u80fd\u667a\u80fd\u7684\u81ea\u52a8\u5316\u5b9e\u65bd\uff0c\u8fd0\u7ef4\u53ea\u9700\u8981\u503c\u5b88","title":"\u7d27\u6025\u53d8\u66f4\u6d41\u7a0b"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_20","text":"\u6ca1\u6709\u7edf\u8ba1\u548c\u5efa\u7acb\u53ef\u7528\u6027\u6307\u6807 \u5efa\u7acb\u521d\u6b65\u7684SLA\uff0c\u4f46\u662f\u5b58\u5728\u8fdd\u7ea6 \u901a\u8fc7\u4e91\u3001\u5bb9\u5668\u3001\u8d44\u6e90\u6269\u7f29\u5bb9\u7b49\u65b9\u6cd5\uff0c\u652f\u6301\u4e1a\u52a1\u589e\u957f\u7684\u540c\u65f6\uff0c\u4fdd\u969cSLA\u8fbe\u6807","title":"\u670d\u52a1\u53ef\u7528\u6027\u6307\u6807"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_21","text":"\u7528\u6237\u80fd\u611f\u53d7\u5230\u7cfb\u7edf\u7684\u4e0d\u7a33\u5b9a\uff0c\u5076\u5c14\u51fa\u73b0\u670d\u52a1\u4e0d\u53ef\u7528\u3002 \u670d\u52a1\u8f83\u7a33\u5b9a\uff0c\u6545\u969c\u80fd\u5728\u77ed\u65f6\u95f4\u5185\u6062\u590d\uff0c\u4f46\u662f\u9047\u5230\u4e1a\u52a1\u6d2a\u5cf0\u65f6\uff0c\u4f1a\u51fa\u73b0\u5361\u987f\u3002 \u7528\u6237\u5bf9\u4e8b\u6545\u57fa\u672c\u65e0\u611f\u77e5\uff0c\u7cfb\u7edf\u80fd\u652f\u6301\u5e02\u573a\u6d3b\u52a8\u5f15\u8d77\u7684\u6d41\u91cf\u6d2a\u5cf0\u3002","title":"\u7528\u6237\u4f53\u9a8c"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_22","text":"\u6ca1\u6709\u5ea6\u91cf\u6307\u6807\uff0c\u51ed\u501f\u8d44\u6df1\u8fd0\u7ef4\u7684\u7ecf\u9a8c\u548c\u76f4\u89c9 \u5efa\u7acb\u57fa\u7840\u7684\u6307\u6807\u91c7\u96c6\u80fd\u529b\uff0c\u5f62\u6210\u6027\u80fd\u5ea6\u91cf\u62a5\u544a \u5efa\u7acb\u7aef\u5230\u7aef\u7684\u6027\u80fd\u6307\u6807\u91c7\u96c6\u4f53\u7cfb\uff0c\u80fd\u5efa\u7acb\u5173\u8054\u5206\u6790\u3001\u8d8b\u52bf\u9884\u6d4b\uff0c\u63d0\u524d\u9884\u9632\u6027\u80fd\u4e8b\u6545\u53d1\u751f","title":"\u6027\u80fd\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_23","text":"\u6280\u672f\u77e5\u8bc6\u3001\u6545\u969c\u7ecf\u9a8c\u7b49\u6587\u6863\u96f6\u6563\u7684\u5b58\u653e\uff0c\u7f3a\u5c11\u6301\u7eed\u7d2f\u79ef \u5bf9\u5178\u578b\u3001\u91cd\u590d\u7684\u6545\u969c\u5f62\u6210RCA\uff0c\u7edf\u4e00\u5b58\u50a8\u5730\u70b9\uff0c\u5f62\u6210\u77e5\u8bc6\uff0c\u5e2e\u52a9\u8fd0\u7ef4\u90e8\u95e8\u9ad8\u6548\u8fd0\u8f6c \u77e5\u8bc6\u80fd\u548c\u90e8\u95e8\u4ee5\u5916\u7684\u7ec4\u7ec7\u5206\u4eab\uff0c\u652f\u6301\u81ea\u6108\u7cfb\u7edf\u7684\u642d\u5efa","title":"\u77e5\u8bc6\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_24","text":"","title":"\u91c7\u96c6\u4f53\u7cfb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_25","text":"\u544a\u8b66\u89c4\u5219 = \u67e5\u8be2\u6761\u4ef6+\u89e6\u53d1\u6761\u4ef6+\u4e8b\u4ef6\u5b9a\u4e49 \u67e5\u8be2\u6761\u4ef6\uff1a\u6307\u5b9a\u91c7\u96c6\u6307\u6807\uff0c\u548c\u8fc7\u6ee4\u7ea6\u675f\u6761\u4ef6\uff0c\u5982\uff1a\u65f6\u95f4\u8303\u56f4\u3001\u4e3b\u673a\u8303\u56f4\u6307\u5b9a\uff0c\u652f\u6301\u591a\u91cd\u6761\u4ef6\u590d\u5408 \u89e6\u53d1\u6761\u4ef6\uff1a\u9009\u62e9\u8ba1\u7b97\u7684\u8303\u5f0f\uff0c\u4e0e\u9608\u503c\u5bf9\u6bd4 \u8ba1\u7b97\u7684\u8303\u5f0f\uff1a\u4e00\u79cd\u8ba1\u7b97\u7684\u8868\u8fbe\u5f0f|\u5b8f\u5b9a\u4e49\uff0c\u53ef\u4ee5\u7528\u6a21\u677f\u5305\u88c5 \u9608\u503c\uff1a\u9884\u5148\u5b9a\u4e49\u597d\u7684\uff0c\u7528\u4e8e\u5bf9\u6bd4\u7684\u503c|\u5bf9\u8c61\uff0c\u5206\u9759\u6001\u548c\u52a8\u6001 \u4e8b\u4ef6\u5b9a\u4e49\uff1a\u89e6\u53d1\u540e\u7684\u4e8b\u4ef6\u7b49\u7ea7\u3001\u53d1\u9001\u7684\u62a5\u6587\u683c\u5f0f\u7b49\uff0c\u63a8\u9001\u7ed9\u6307\u5b9a\u7684\u901a\u77e5\u670d\u52a1","title":"\u544a\u8b66\u89c4\u5219"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_26","text":"\u4e8b\u4ef6\u4e00\u89c8 + \u544a\u8b66\u4e8b\u4ef6\u7684\u901a\u77e5\u6e20\u9053 + \u4e8b\u4ef6\u5904\u7406\u548c\u5347\u7ea7\u6d41\u7a0b + Hook\u673a\u5236 \u4e8b\u4ef6\u4e00\u89c8\uff1a\u6240\u6709\u6536\u5230\u7684\u4e8b\u4ef6\uff0c\u6309\u7167\u6761\u4ef6\u663e\u793a \u901a\u77e5\u6e20\u9053\uff1a\u591a\u79cd\u5916\u90e8\u901a\u77e5\u65b9\u5f0f\uff0c\u5982\uff1a\u90ae\u4ef6\u3001\u5fae\u4fe1\u901a\u77e5\u63a5\u53e3\u3001\u7535\u8bdd \u4e8b\u4ef6\u5904\u7406\u548c\u5347\u7ea7\u6d41\u7a0b\uff1a \u4e8b\u4ef6\u5904\u7406\uff1a \u4fe1\u606f\u8865\u5168\uff1a\u670d\u52a1\u4ece\u4e8b\u4ef6\u62a5\u6587\u4e2d\u62bd\u53d6\u5173\u952ekey\uff0c\u901a\u8fc7\u67e5\u8be2CMDB\uff0c\u8fdb\u4e00\u6b65\u8865\u5168\u4e8b\u4ef6\u5b8c\u6574\u4fe1\u606f\uff0c\u5982\uff1a\u8be5\u4e8b\u4ef6\u5c5e\u4e8e\u54ea\u4e2aAPP\uff08BU\uff09\u3001\u8d1f\u8d23\u4eba\u662f\u8c01\u3001\u4e0a\u4e0b\u6e38\u670d\u52a1\u662f\u8c01\u3001\u540c\u7c7b\u544a\u8b66\u7684\u5904\u7406\u63d0\u793a\uff0c\u53ef\u4ee5\u4e0d\u65ad\u5b8c\u5584 \u544a\u8b66\u6536\u655b\uff1a \u4e8b\u4ef6\u805a\u5408\uff1a\u540c\u7c7b\u4e8b\u4ef6\u5408\u5e76\u4e3a1\u4e2a\u544a\u8b66 \u4e8b\u4ef6\u9759\u9ed8\uff1a\u5df2\u7ecf\u53d1\u9001\u8fc7\u7684\u544a\u8b66\uff0c\u540c\u7c7b\u65b0\u4e8b\u4ef6\u5728\u6307\u5b9a\u4e00\u6bb5\u65f6\u671f\u5185\u4e0d\u518d\u53d1\u9001\u544a\u8b66 \u544a\u8b66\u786e\u8ba4\uff1a \u7528\u6237\u5904\u7406\uff1a\u8fd0\u7ef4\u6216\u5176\u4ed6\u8d1f\u8d23\u4eba\uff0c\u901a\u8fc7\u754c\u9762\u6216\u63a5\u53e3\uff0c\u786e\u8ba4\u5904\u7406\u67d0\u4e2a\u544a\u8b66\uff0c\u7136\u540e\u5173\u95ed\u8be5\u544a\u8b66 \u81ea\u52a8\u5173\u95ed\uff1a\u6ca1\u6709\u6301\u7eed\u6536\u5230\u540c\u7c7b\u4e8b\u4ef6\u3001\u6216\u8005\u6536\u5230\u6062\u590d\u4e8b\u4ef6\uff0c\u5c06\u5bf9\u5e94\u7684\u544a\u8b66\u81ea\u52a8\u5173\u95ed \u4e8b\u4ef6\u5347\u7ea7\uff1a\u540c\u7c7b\u4e8b\u4ef6\u805a\u5408\u5f62\u6210\u544a\u8b66\uff0c\u544a\u8b66\u4e00\u76f4\u672a\u88ab\u5904\u7406\uff0c\u4e00\u6bb5\u65f6\u95f4\u540e\u901a\u77e5\u8be5\u670d\u52a1\u7684\u4e0a\u7ea7\u8d1f\u8d23\u4eba\uff0c\u4e8b\u4ef6\u4e25\u91cd\u7b49\u7ea7\u53ef\u80fd\u4f1a\u63d0\u5347 Hook\u673a\u5236\uff1a\u53ef\u9009\uff0c\u7528\u4e8e\u7ec4\u5efa\u81ea\u52a8\u5904\u7406pipeline\uff0c\u5982\u67d0\u4e2aAPP\u6b7b\u673a\u540e\uff0c\u901a\u8fc7hook\uff0c\u4f20\u5165APP\u7684key\uff0c\u81ea\u52a8\u8c03\u7528APP\u91cd\u542f\u63a5\u53e3","title":"\u901a\u77e5\u670d\u52a1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_27","text":"[TODO]","title":"\u53ef\u89c6\u5316"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_28","text":"","title":"\u5143\u6a21\u578b"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_29","text":"\u5b57\u6bb5\u540d \u7c7b\u578b \u8303\u5f0f \u5907\u6ce8 name String \u552f\u4e00 \u6307\u6807\u552f\u4e00\u540d cname String \u4e2d\u6587\u540d meaning String \u5fc5\u586b \u6307\u6807\u542b\u4e49 calc_formula String \u91c7\u96c6\u8ba1\u7b97\u516c\u5f0f rel_unit \u5b57\u5178 \u6570\u636e\u5355\u4f4d\uff0c\u4ece\u5b57\u5178\uff1a\u5355\u4f4d \u4e2d\u9009\u62e9 rel_level \u5b57\u5178 \u5fc5\u586b \u6240\u5c5e\u5c42\u7ea7\uff0c\u4ece\u5b57\u5178\uff1a\u5c42\u7ea7 \u4e2d\u9009\u62e9 rel_type \u5b57\u5178 \u5fc5\u586b \u91c7\u96c6\u7c7b\u578b\uff0c\u4ece Metric\u3001Log\u3001APM \u4e2d\u9009\u62e9 namespace String \u9ed8\u8ba4default \u547d\u540d\u7a7a\u95f4 \u5bf9\u4e0d\u540c\u7684\u91c7\u96c6\u7c7b\u578b\uff0c\u5b9e\u73b0\u7684\u65b9\u5f0f\u662f","title":"\u91c7\u96c6\u6307\u6807\u5e93"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/#_30","text":"\u5b57\u6bb5\u540d \u7c7b\u578b \u8303\u5f0f \u5907\u6ce8 name String \u552f\u4e00 \u6307\u6807\u552f\u4e00\u540d","title":"\u544a\u8b66\u89c4\u5219\u5e93"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/grafana/","text":"Grafana\u53ef\u89c6\u5316\u76d1\u63a7\u4eea\u8868\u76d8 \u5b89\u88c5\uff08\u57fa\u4e8edocker\uff09 # \u6570\u636e\u548c\u5de5\u4f5c\u76ee\u5f55 mkdir -p /data/grafana/data /data/grafana/log /opt/grafana-conf # docker\u542f\u52a8 docker run -d \\ -p 3000:3000 \\ --name=grafana \\ -e \"GF_SERVER_ROOT_URL=http://grafana.your.com\" \\ -e \"GF_SECURITY_ADMIN_PASSWORD=admin\" \\ -e \"GF_INSTALL_PLUGINS=alexanderzobnin-zabbix-app\" \\ --user $(id -u) \\ --volume \"/data/grafana/data:/var/lib/grafana\" \\ --volume \"/data/grafana/log:/var/log/grafana\" \\ # --volume \"/opt/grafana-conf/dashboards:/usr/share/grafana/public/dashboards\" \\ # --volume \"/opt/grafana-conf/grafana.ini:/etc/grafana/grafana.ini\" \\ --volume \"/etc/localtime:/etc/localtime\" \\ grafana/grafana:5.3.4 GF_SECURITY_ADMIN_PASSWORD \b\b\u7ba1\u7406\u5458\u5bc6\u7801 GF_INSTALL_PLUGINS \b\u9884\u5b89\u88c5\u7684\b\u63d2\u4ef6 --user $(id -u) \b\b\u5bb9\u5668\b\u8bfb\u5199\u5916\u6302\u78c1\u76d8\uff0c\u9700\u8981\b\u5f53\u524d\u7528\u6237\u6743\u9650 \u66f4\u65b0\u914d\u7f6e\u6d41\u7a0b \u66f4\u65b0\u672cgit\u5e93 \u4e0a\u751f\u4ea7\u73af\u5883\u7684\b\u914d\u7f6e\u76ee\u5f55\uff08/opt/grafana-conf/\uff09\u6267\u884cgit pull \u6267\u884c docker restart grafana \u5bfc\u51fa\u548c\u5bfc\u5165 \u53c2\u8003\uff1ahttps://github.com/hagen1778/grafana-import-export \u4f9d\u8d56\uff1ajq - commandline JSON processor \u914d\u7f6e\uff1a \u66f4\u65b0 config.sh \u4e2d\u7684 HOST \u548c FILE_DIR ORGS \u6570\u7ec4\uff0c\u5199\u7533\u8bf7\u5bf9\u5e94\u7684 Name:API_KEY # \u5bfc\u51fa ./exporter.sh # \u8f93\u51fa\u7ed3\u679c\u7c7b\u4f3c\uff1a elastalert-xxx.json % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 1939 100 1939 0 0 33215 0 --:--:-- --:--:-- --:--:-- 33431 # \u5168\u5bfc\u5165 ./importer.sh # \u6307\u5b9a\u5bfc\u5165\uff0c\u652f\u6301* ./importer.sh data/{Name}/dashboards/dashboard.json data/{Name}/datasources/*.json \u8e29\u5751 dashboards\u4e2d\u6709\u968f\u673aurl\uff0c\u5efa\u8bae\u4e0d\u8981\u7528\u5bfc\u51fa\u7684json\uff0c\u800c\u662f\u7528\u63d0\u524d\u5728\u8001Grafana\u4e0a\u7528\u201cExport\u201d\u6309\u94ae\u5bfc\u51fa\u7684json\uff0c\u518d\u4e00\u4e2a\u4e2a\u5bfc\u5165","title":"Grafana\u53ef\u89c6\u5316\u76d1\u63a7\u4eea\u8868\u76d8"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/grafana/#grafana","text":"","title":"Grafana\u53ef\u89c6\u5316\u76d1\u63a7\u4eea\u8868\u76d8"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/grafana/#docker","text":"# \u6570\u636e\u548c\u5de5\u4f5c\u76ee\u5f55 mkdir -p /data/grafana/data /data/grafana/log /opt/grafana-conf # docker\u542f\u52a8 docker run -d \\ -p 3000:3000 \\ --name=grafana \\ -e \"GF_SERVER_ROOT_URL=http://grafana.your.com\" \\ -e \"GF_SECURITY_ADMIN_PASSWORD=admin\" \\ -e \"GF_INSTALL_PLUGINS=alexanderzobnin-zabbix-app\" \\ --user $(id -u) \\ --volume \"/data/grafana/data:/var/lib/grafana\" \\ --volume \"/data/grafana/log:/var/log/grafana\" \\ # --volume \"/opt/grafana-conf/dashboards:/usr/share/grafana/public/dashboards\" \\ # --volume \"/opt/grafana-conf/grafana.ini:/etc/grafana/grafana.ini\" \\ --volume \"/etc/localtime:/etc/localtime\" \\ grafana/grafana:5.3.4 GF_SECURITY_ADMIN_PASSWORD \b\b\u7ba1\u7406\u5458\u5bc6\u7801 GF_INSTALL_PLUGINS \b\u9884\u5b89\u88c5\u7684\b\u63d2\u4ef6 --user $(id -u) \b\b\u5bb9\u5668\b\u8bfb\u5199\u5916\u6302\u78c1\u76d8\uff0c\u9700\u8981\b\u5f53\u524d\u7528\u6237\u6743\u9650","title":"\u5b89\u88c5\uff08\u57fa\u4e8edocker\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/grafana/#_1","text":"\u66f4\u65b0\u672cgit\u5e93 \u4e0a\u751f\u4ea7\u73af\u5883\u7684\b\u914d\u7f6e\u76ee\u5f55\uff08/opt/grafana-conf/\uff09\u6267\u884cgit pull \u6267\u884c docker restart grafana","title":"\u66f4\u65b0\u914d\u7f6e\u6d41\u7a0b"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/grafana/#_2","text":"\u53c2\u8003\uff1ahttps://github.com/hagen1778/grafana-import-export \u4f9d\u8d56\uff1ajq - commandline JSON processor \u914d\u7f6e\uff1a \u66f4\u65b0 config.sh \u4e2d\u7684 HOST \u548c FILE_DIR ORGS \u6570\u7ec4\uff0c\u5199\u7533\u8bf7\u5bf9\u5e94\u7684 Name:API_KEY # \u5bfc\u51fa ./exporter.sh # \u8f93\u51fa\u7ed3\u679c\u7c7b\u4f3c\uff1a elastalert-xxx.json % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 1939 100 1939 0 0 33215 0 --:--:-- --:--:-- --:--:-- 33431 # \u5168\u5bfc\u5165 ./importer.sh # \u6307\u5b9a\u5bfc\u5165\uff0c\u652f\u6301* ./importer.sh data/{Name}/dashboards/dashboard.json data/{Name}/datasources/*.json \u8e29\u5751 dashboards\u4e2d\u6709\u968f\u673aurl\uff0c\u5efa\u8bae\u4e0d\u8981\u7528\u5bfc\u51fa\u7684json\uff0c\u800c\u662f\u7528\u63d0\u524d\u5728\u8001Grafana\u4e0a\u7528\u201cExport\u201d\u6309\u94ae\u5bfc\u51fa\u7684json\uff0c\u518d\u4e00\u4e2a\u4e2a\u5bfc\u5165","title":"\u5bfc\u51fa\u548c\u5bfc\u5165"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/","text":"\u76d1\u63a7\u4f53\u7cfb\u6982\u8981 \u5bf9\u4e00\u4e2a\u5728\u7ebf\u4e1a\u52a1\u7684\u76d1\u63a7\u4f53\u7cfb\u5efa\u7acb\u6240\u9700\u8981\u7684\u5143\u7d20\uff0c\u8fdb\u884c\u6982\u8981\u7684\u9648\u8ff0\u3002 \u8bc4\u4ef7\u7684\u7ef4\u5ea6 \u4ece\u4e1a\u52a1\u6570\u636e\u6d41\u6309\u65f6\u95f4\u6d89\u53ca\u7684\u7ec4\u4ef6 \u5ba2\u6237\u7aef \u7528\u6237\u53d1\u8d771\u4e2a\u8bf7\u6c42\uff1a\u754c\u9762\u89e6\u53d1\u4e8b\u4ef6 -> js\u8c03\u7528app\u63a5\u53e3 -> \u5e95\u5c42sdk\u53d1\u51fa\u7f51\u7edc\u6570\u636e\u5305 \u7f51\u7edc\u6309\u7167\u89e3\u6790\uff0c\u5c42\u5c42\u8f6c\u53d1\uff0c\u76f4\u5230\u76ee\u7684\u5730\u7aef\u53e3 \u670d\u52a1\u7aef \u8d1f\u8f7d\u5747\u8861\uff1a\u6536\u5230\u6570\u636e\u5305\uff0c\u8f6c\u7ed9\u4e0a\u6e38\u4e1a\u52a1\u96c6\u7fa4 \u4e1a\u52a1\u8282\u70b9\u5916\u5c42\u7f51\u5173\uff1a\u8ba4\u8bc1\uff0c\u89e3\u5305\uff0c\u8f6c\u5b9e\u9645\u5de5\u4f5c\u8282\u70b9 \u5de5\u4f5c\u8282\u70b9\uff1a\u6309\u5951\u7ea6\u8bfb\u53d6\u62a5\u6587\uff0c\u6267\u884c\u903b\u8f91\uff0c\u9002\u914d\u6570\u636e\u540e\u843d\u5730\u5b58\u50a8\u5c42 \u5b58\u50a8\u5c42\uff08\u542b\u7f13\u5b58\uff09\uff1a\u66f4\u65b0\u6570\u636e\u524d\uff0c\u52a0\u76ee\u6807\u52a0\u9501\uff0c\u6267\u884c\u66f4\u65b0\uff0c\u89e3\u9501\uff0c\u53cd\u9988\u6267\u884c\u7ed3\u679c \u5de5\u4f5c\u8282\u70b9\uff1a\u62ff\u5230\u5b58\u50a8\u7ed3\u679c\uff0c\u6267\u884c\u540e\u7eed\u903b\u8f91\uff0c\u53cd\u9988\u6700\u7ec8\u62a5\u6587 \u63cf\u8ff0\u4e00\u4e2a\u7ec4\u4ef6\u7684\u89c6\u89d2 \u5b58\u6d3b\uff1a\u7ec4\u4ef6\u5728\u5de5\u4f5c\uff0c\u6700\u57fa\u672c\u8981\u6c42 \u6027\u80fd\u548c\u5bb9\u91cf\uff1a\u80fd\u5de5\u4f5c\u591a\u5feb\uff0c\u80fd\u652f\u6491\u591a\u5c11\u8bf7\u6c42 \u5b8c\u6574\u5ea6\uff1a\u662f\u4ec0\u4e48\u5bf9\u8c61\uff08\u7248\u672c\u6807\u5fd7\uff09 \u63cf\u8ff0\u4e00\u4e2a\u7cfb\u7edf\u7684\u89c6\u89d2 \u9c81\u68d2\u6027\uff1a\u5728\u7a81\u53d1\u60c5\u51b5\u4e0b\u80fd\u4fdd\u969c\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c \u5b89\u5168\u6027\uff1a\u5e94\u5bf9\u5404\u79cd\u653b\u51fb \u6307\u6807\u7c7b\u578b Metric\uff1a\u6570\u503c\u578b|\u679a\u4e3e\u578b\u6307\u6807\uff0c\u53cd\u9988\u6307\u5b9a\u7ec4\u4ef6\u5728\u67d0\u4e2a\u7ef4\u5ea6\u4e0a\u7684\u5373\u65f6\u72b6\u6001\uff0c\u652f\u6301\u7ec4\u5408\u8ba1\u7b97\uff0c\u5bf9\u5e94\u5de5\u5177\uff1aPrometheus\u3001Zabbix\u7b49 Log\uff1a\u5176\u5b9e\u662f\u5185\u90e8\u57cb\u70b9\uff0c\u8f93\u51fa\u670d\u52a1\u5185\u90e8\u8fd0\u884c\u65f6\u7684\u90e8\u5206Message\uff0c\u652f\u6301\u5bf9\u8bed\u53e5\u5207\u8bcd\u540e\u518d\u7edf\u8ba1\u8ba1\u7b97\uff0c\u5bf9\u5e94\u5de5\u5177\uff1aELK\u7b49 APM\uff1a\u4ece\u65f6\u5e8f\u89d2\u5ea6\u51fa\u53d1\uff0c\u8bb0\u5f55\u6bcf\u4e2a\u4ea4\u4e92\u7ec4\u4ef6\u7684IO\u65f6\u95f4\u70b9\uff0c\u518d\u6c47\u603b\u5206\u6790\u51fa\u6700\u5360\u7528\u65f6\u95f4\u7684\u6bb5\u843d\uff0c\u5bf9\u5e94\u5de5\u5177\uff1aSkywalking\u3001\u542c\u4e91\u7b49 \u5e38\u89c1\u7ec4\u4ef6\u7684Metric\u6307\u6807\u548c\u542b\u4e49\u8bf4\u660e \u672c\u6587\u6863\u4ee5\u963f\u91cc\u4e91\u7684\u6307\u6807code\u505a\u4e3a\u6848\u4f8b\uff0c\u5176\u4ed6\u4e91\u548c\u975e\u4e91\u5b9e\u4f8b\u662f\u5dee\u4e0d\u591a\u7684 \u4e3b\u673a \u5b58\u6d3b\uff0c\u79d2\u7ea7 ping\u901a ssh\u901a \u6027\u80fd\u548c\u5bb9\u91cf\uff0c\u5206\u949f\u7ea7 CPU\u4f7f\u7528\u7387 \u5185\u5b58\u4f7f\u7528\u7387 \u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d\uff081\u5206\u949f\uff09\uff1a /proc/loadavg \u7b2c\u4e00\u5217\u6570\u636e \u78c1\u76d8IOPS\uff1a\u5206\u8bfb\u3001\u5199 \u78c1\u76d8\u4f7f\u7528\u7387\uff1a\u5206\u7cfb\u7edf\u76d8\u3001\u6570\u636e\u76d8 \u7f51\u5361IO\u5e26\u5bbd\uff1a\u5355\u4f4dMbps TCP\u8fde\u63a5\u6570 \u5b8c\u6574\u5ea6\uff0c\u5929\u7ea7 \u7ba1\u7406IP \u7f51\u5361MAC OS\u7248\u672c hostname \u4e3b\u677fSN \u786c\u4ef6\u914d\u7f6e\uff1aCPU\u6838\u6570\u3001\u9891\u7387\uff0c\u5185\u5b58\u5bb9\u91cf\uff08MB\uff09\uff0c\u78c1\u76d8\u5bb9\u91cf\uff08GB\uff09 \u6570\u636e\u5e93 \u5b58\u6d3b IP:Port\u901a \u6027\u80fd\u548c\u5bb9\u91cf CPU\u4f7f\u7528\u7387 \u5185\u5b58\u4f7f\u7528\u7387 \u78c1\u76d8\u7a7a\u95f4\uff08\u5355\u4f4dMByte\uff09 IOPS\uff08\u5355\u4f4d\uff1a\u6b21/\u79d2\uff09 \u603b\u8fde\u63a5\u6570 \u7f51\u7edc\u6d41\u91cf\uff08\u5355\u4f4dKB\uff09 TPS\uff08\u5e73\u5747\u6bcf\u79d2\u4e8b\u52a1\u6570\uff09 QPS\uff08\u5e73\u5747\u6bcf\u79d2SQL\u8bed\u53e5\u6267\u884c\u6b21\u6570\uff09 \u5b8c\u6574\u5ea6 \u6570\u636e\u5e93\u7248\u672c \u6700\u5927\u5185\u5b58 \u6700\u5927\u8fde\u63a5\u6570 \u6700\u5927IOPS \u8d1f\u8f7d\u5747\u8861LB \u5b58\u6d3b IP:Port\u901a \u6027\u80fd\u548c\u5bb9\u91cf \u6d41\u91cfbps \u5e76\u53d1\u8fde\u63a5\u6570 \u5e73\u5747\u54cd\u5e94\u65f6\u95f4ms \u9519\u8bef\u53cd\u9988\u7801\u5360\u6bd4 \u5b8c\u6574\u5ea6 \u652f\u6301\u534f\u8bae \u8c03\u5ea6\u7b97\u6cd5 \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4s \u7f13\u5b58Redis \u5b58\u6d3b IP:Port\u901a\uff0c\u53ef\u8bfb\u5199 \u6027\u80fd\u548c\u5bb9\u91cf CPU\u4f7f\u7528\u7387 \u5185\u5b58\u4f7f\u7528\u7387 IOPS \u5df2\u4f7f\u7528\u8fde\u63a5\u6570 \u51fa/\u5165\u53e3\u6d41\u91cf\u901f\u7387 (KBps) \u5e73\u5747\u5ef6\u65f6 (us) Key\u7edf\u8ba1 Key\u547d\u4e2d\u7387 \u5b8c\u6574\u5ea6 \u8f6f\u4ef6\u7248\u672c \u6700\u5927\u8fde\u63a5\u6570 \u6700\u5927\u79c1\u7f51\u5e26\u5bbd \u5e94\u7528 \u5b58\u6d3b \u8fdb\u7a0bpid \u672c\u5730\u7aef\u53e3\u5b58\u6d3b \u6027\u80fd\u548c\u5bb9\u91cf \u4f7f\u7528\u7684CPU\u5360\u6bd4 \u5185\u5b58\u5360\u7528 \u78c1\u76d8IO\u91cf \u5e76\u53d1\u7ebf\u7a0b\u6570 \u5b8c\u6574\u5ea6 \u8f6f\u4ef6\u7248\u672c \u91c7\u96c6\u65b9\u6848","title":"\u76d1\u63a7\u4f53\u7cfb\u6982\u8981"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#_1","text":"\u5bf9\u4e00\u4e2a\u5728\u7ebf\u4e1a\u52a1\u7684\u76d1\u63a7\u4f53\u7cfb\u5efa\u7acb\u6240\u9700\u8981\u7684\u5143\u7d20\uff0c\u8fdb\u884c\u6982\u8981\u7684\u9648\u8ff0\u3002","title":"\u76d1\u63a7\u4f53\u7cfb\u6982\u8981"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#_2","text":"\u4ece\u4e1a\u52a1\u6570\u636e\u6d41\u6309\u65f6\u95f4\u6d89\u53ca\u7684\u7ec4\u4ef6 \u5ba2\u6237\u7aef \u7528\u6237\u53d1\u8d771\u4e2a\u8bf7\u6c42\uff1a\u754c\u9762\u89e6\u53d1\u4e8b\u4ef6 -> js\u8c03\u7528app\u63a5\u53e3 -> \u5e95\u5c42sdk\u53d1\u51fa\u7f51\u7edc\u6570\u636e\u5305 \u7f51\u7edc\u6309\u7167\u89e3\u6790\uff0c\u5c42\u5c42\u8f6c\u53d1\uff0c\u76f4\u5230\u76ee\u7684\u5730\u7aef\u53e3 \u670d\u52a1\u7aef \u8d1f\u8f7d\u5747\u8861\uff1a\u6536\u5230\u6570\u636e\u5305\uff0c\u8f6c\u7ed9\u4e0a\u6e38\u4e1a\u52a1\u96c6\u7fa4 \u4e1a\u52a1\u8282\u70b9\u5916\u5c42\u7f51\u5173\uff1a\u8ba4\u8bc1\uff0c\u89e3\u5305\uff0c\u8f6c\u5b9e\u9645\u5de5\u4f5c\u8282\u70b9 \u5de5\u4f5c\u8282\u70b9\uff1a\u6309\u5951\u7ea6\u8bfb\u53d6\u62a5\u6587\uff0c\u6267\u884c\u903b\u8f91\uff0c\u9002\u914d\u6570\u636e\u540e\u843d\u5730\u5b58\u50a8\u5c42 \u5b58\u50a8\u5c42\uff08\u542b\u7f13\u5b58\uff09\uff1a\u66f4\u65b0\u6570\u636e\u524d\uff0c\u52a0\u76ee\u6807\u52a0\u9501\uff0c\u6267\u884c\u66f4\u65b0\uff0c\u89e3\u9501\uff0c\u53cd\u9988\u6267\u884c\u7ed3\u679c \u5de5\u4f5c\u8282\u70b9\uff1a\u62ff\u5230\u5b58\u50a8\u7ed3\u679c\uff0c\u6267\u884c\u540e\u7eed\u903b\u8f91\uff0c\u53cd\u9988\u6700\u7ec8\u62a5\u6587 \u63cf\u8ff0\u4e00\u4e2a\u7ec4\u4ef6\u7684\u89c6\u89d2 \u5b58\u6d3b\uff1a\u7ec4\u4ef6\u5728\u5de5\u4f5c\uff0c\u6700\u57fa\u672c\u8981\u6c42 \u6027\u80fd\u548c\u5bb9\u91cf\uff1a\u80fd\u5de5\u4f5c\u591a\u5feb\uff0c\u80fd\u652f\u6491\u591a\u5c11\u8bf7\u6c42 \u5b8c\u6574\u5ea6\uff1a\u662f\u4ec0\u4e48\u5bf9\u8c61\uff08\u7248\u672c\u6807\u5fd7\uff09 \u63cf\u8ff0\u4e00\u4e2a\u7cfb\u7edf\u7684\u89c6\u89d2 \u9c81\u68d2\u6027\uff1a\u5728\u7a81\u53d1\u60c5\u51b5\u4e0b\u80fd\u4fdd\u969c\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c \u5b89\u5168\u6027\uff1a\u5e94\u5bf9\u5404\u79cd\u653b\u51fb \u6307\u6807\u7c7b\u578b Metric\uff1a\u6570\u503c\u578b|\u679a\u4e3e\u578b\u6307\u6807\uff0c\u53cd\u9988\u6307\u5b9a\u7ec4\u4ef6\u5728\u67d0\u4e2a\u7ef4\u5ea6\u4e0a\u7684\u5373\u65f6\u72b6\u6001\uff0c\u652f\u6301\u7ec4\u5408\u8ba1\u7b97\uff0c\u5bf9\u5e94\u5de5\u5177\uff1aPrometheus\u3001Zabbix\u7b49 Log\uff1a\u5176\u5b9e\u662f\u5185\u90e8\u57cb\u70b9\uff0c\u8f93\u51fa\u670d\u52a1\u5185\u90e8\u8fd0\u884c\u65f6\u7684\u90e8\u5206Message\uff0c\u652f\u6301\u5bf9\u8bed\u53e5\u5207\u8bcd\u540e\u518d\u7edf\u8ba1\u8ba1\u7b97\uff0c\u5bf9\u5e94\u5de5\u5177\uff1aELK\u7b49 APM\uff1a\u4ece\u65f6\u5e8f\u89d2\u5ea6\u51fa\u53d1\uff0c\u8bb0\u5f55\u6bcf\u4e2a\u4ea4\u4e92\u7ec4\u4ef6\u7684IO\u65f6\u95f4\u70b9\uff0c\u518d\u6c47\u603b\u5206\u6790\u51fa\u6700\u5360\u7528\u65f6\u95f4\u7684\u6bb5\u843d\uff0c\u5bf9\u5e94\u5de5\u5177\uff1aSkywalking\u3001\u542c\u4e91\u7b49","title":"\u8bc4\u4ef7\u7684\u7ef4\u5ea6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#metric","text":"\u672c\u6587\u6863\u4ee5\u963f\u91cc\u4e91\u7684\u6307\u6807code\u505a\u4e3a\u6848\u4f8b\uff0c\u5176\u4ed6\u4e91\u548c\u975e\u4e91\u5b9e\u4f8b\u662f\u5dee\u4e0d\u591a\u7684","title":"\u5e38\u89c1\u7ec4\u4ef6\u7684Metric\u6307\u6807\u548c\u542b\u4e49\u8bf4\u660e"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#_3","text":"\u5b58\u6d3b\uff0c\u79d2\u7ea7 ping\u901a ssh\u901a \u6027\u80fd\u548c\u5bb9\u91cf\uff0c\u5206\u949f\u7ea7 CPU\u4f7f\u7528\u7387 \u5185\u5b58\u4f7f\u7528\u7387 \u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d\uff081\u5206\u949f\uff09\uff1a /proc/loadavg \u7b2c\u4e00\u5217\u6570\u636e \u78c1\u76d8IOPS\uff1a\u5206\u8bfb\u3001\u5199 \u78c1\u76d8\u4f7f\u7528\u7387\uff1a\u5206\u7cfb\u7edf\u76d8\u3001\u6570\u636e\u76d8 \u7f51\u5361IO\u5e26\u5bbd\uff1a\u5355\u4f4dMbps TCP\u8fde\u63a5\u6570 \u5b8c\u6574\u5ea6\uff0c\u5929\u7ea7 \u7ba1\u7406IP \u7f51\u5361MAC OS\u7248\u672c hostname \u4e3b\u677fSN \u786c\u4ef6\u914d\u7f6e\uff1aCPU\u6838\u6570\u3001\u9891\u7387\uff0c\u5185\u5b58\u5bb9\u91cf\uff08MB\uff09\uff0c\u78c1\u76d8\u5bb9\u91cf\uff08GB\uff09","title":"\u4e3b\u673a"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#_4","text":"\u5b58\u6d3b IP:Port\u901a \u6027\u80fd\u548c\u5bb9\u91cf CPU\u4f7f\u7528\u7387 \u5185\u5b58\u4f7f\u7528\u7387 \u78c1\u76d8\u7a7a\u95f4\uff08\u5355\u4f4dMByte\uff09 IOPS\uff08\u5355\u4f4d\uff1a\u6b21/\u79d2\uff09 \u603b\u8fde\u63a5\u6570 \u7f51\u7edc\u6d41\u91cf\uff08\u5355\u4f4dKB\uff09 TPS\uff08\u5e73\u5747\u6bcf\u79d2\u4e8b\u52a1\u6570\uff09 QPS\uff08\u5e73\u5747\u6bcf\u79d2SQL\u8bed\u53e5\u6267\u884c\u6b21\u6570\uff09 \u5b8c\u6574\u5ea6 \u6570\u636e\u5e93\u7248\u672c \u6700\u5927\u5185\u5b58 \u6700\u5927\u8fde\u63a5\u6570 \u6700\u5927IOPS","title":"\u6570\u636e\u5e93"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#lb","text":"\u5b58\u6d3b IP:Port\u901a \u6027\u80fd\u548c\u5bb9\u91cf \u6d41\u91cfbps \u5e76\u53d1\u8fde\u63a5\u6570 \u5e73\u5747\u54cd\u5e94\u65f6\u95f4ms \u9519\u8bef\u53cd\u9988\u7801\u5360\u6bd4 \u5b8c\u6574\u5ea6 \u652f\u6301\u534f\u8bae \u8c03\u5ea6\u7b97\u6cd5 \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4s","title":"\u8d1f\u8f7d\u5747\u8861LB"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#redis","text":"\u5b58\u6d3b IP:Port\u901a\uff0c\u53ef\u8bfb\u5199 \u6027\u80fd\u548c\u5bb9\u91cf CPU\u4f7f\u7528\u7387 \u5185\u5b58\u4f7f\u7528\u7387 IOPS \u5df2\u4f7f\u7528\u8fde\u63a5\u6570 \u51fa/\u5165\u53e3\u6d41\u91cf\u901f\u7387 (KBps) \u5e73\u5747\u5ef6\u65f6 (us) Key\u7edf\u8ba1 Key\u547d\u4e2d\u7387 \u5b8c\u6574\u5ea6 \u8f6f\u4ef6\u7248\u672c \u6700\u5927\u8fde\u63a5\u6570 \u6700\u5927\u79c1\u7f51\u5e26\u5bbd","title":"\u7f13\u5b58Redis"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#_5","text":"\u5b58\u6d3b \u8fdb\u7a0bpid \u672c\u5730\u7aef\u53e3\u5b58\u6d3b \u6027\u80fd\u548c\u5bb9\u91cf \u4f7f\u7528\u7684CPU\u5360\u6bd4 \u5185\u5b58\u5360\u7528 \u78c1\u76d8IO\u91cf \u5e76\u53d1\u7ebf\u7a0b\u6570 \u5b8c\u6574\u5ea6 \u8f6f\u4ef6\u7248\u672c","title":"\u5e94\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/monitoring_system_summary/#_6","text":"","title":"\u91c7\u96c6\u65b9\u6848"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/n9e/","text":"nightingale \u591c\u83ba\u76d1\u63a7\u7cfb\u7edf \u5b89\u88c5 cd \u53c2\u8003 \u5b98\u7f51 https://n9e.gitee.io/","title":"nightingale \u591c\u83ba\u76d1\u63a7\u7cfb\u7edf"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/n9e/#nightingale","text":"","title":"nightingale \u591c\u83ba\u76d1\u63a7\u7cfb\u7edf"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/n9e/#_1","text":"cd","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/n9e/#_2","text":"\u5b98\u7f51 https://n9e.gitee.io/","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/sentry/","text":"Sentry \u6545\u969c\u8ffd\u6eaf\u5e73\u53f0 \u672c\u5730\u5b89\u88c5 # \u4e00\u952e\u5b89\u88c5 git clone https://github.com/getsentry/self-hosted.git mv self-hosted/ sentry cd sentry/ ./install.sh # \u5b89\u88c5\u671f\u95f4\uff0c\u4f1a\u4e92\u52a8\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801 # \u542f\u52a8 docker-compose up -d \u8bbf\u95ee http://\u5bbf\u4e3b\u673aIP:9000/ \uff0c\u521d\u59cb\u5316\u76f8\u5173\u914d\u7f6e\uff0c\u5982\u90ae\u4ef6\u53d1\u9001 app\u63a5\u5165 \u4ee5py\u4e3a\u4f8b \u5728\u5de5\u7a0b\u9879\u76ee\u4e0b pip install --upgrade sentry-sdk \u5728\u6587\u4ef6\u542f\u52a8\u90e8\u5206\uff0c\u52a0\u8f7dsdk\uff0c\u914d\u7f6eDSN\u548c\u91c7\u96c6\u7387 \u6d4b\u8bd5\u6545\u969c\u4e0a\u62a5 \u53c2\u8003 \u5b98\u7f51 https://sentry.io/","title":"Sentry \u6545\u969c\u8ffd\u6eaf\u5e73\u53f0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/sentry/#sentry","text":"","title":"Sentry \u6545\u969c\u8ffd\u6eaf\u5e73\u53f0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/sentry/#_1","text":"# \u4e00\u952e\u5b89\u88c5 git clone https://github.com/getsentry/self-hosted.git mv self-hosted/ sentry cd sentry/ ./install.sh # \u5b89\u88c5\u671f\u95f4\uff0c\u4f1a\u4e92\u52a8\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801 # \u542f\u52a8 docker-compose up -d \u8bbf\u95ee http://\u5bbf\u4e3b\u673aIP:9000/ \uff0c\u521d\u59cb\u5316\u76f8\u5173\u914d\u7f6e\uff0c\u5982\u90ae\u4ef6\u53d1\u9001","title":"\u672c\u5730\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/sentry/#app","text":"\u4ee5py\u4e3a\u4f8b \u5728\u5de5\u7a0b\u9879\u76ee\u4e0b pip install --upgrade sentry-sdk \u5728\u6587\u4ef6\u542f\u52a8\u90e8\u5206\uff0c\u52a0\u8f7dsdk\uff0c\u914d\u7f6eDSN\u548c\u91c7\u96c6\u7387 \u6d4b\u8bd5\u6545\u969c\u4e0a\u62a5","title":"app\u63a5\u5165"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/sentry/#_2","text":"\u5b98\u7f51 https://sentry.io/","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/troubleshooting_tmplete/","text":"\u8fd0\u7ef4\u6545\u969c\u5904\u7406\u6587\u6863\u6a21\u677f \u95ee\u9898\u63cf\u8ff0 \u6545\u969c\u7684\u73b0\u8c61 \u9002\u7528\u7684\u5bf9\u8c61 \u6587\u6863\u7684tag \u5904\u7406\u6d41\u7a0b \u6309\u5e8f\u53f7\u5199\u51fa\u5206\u6b65\u5904\u7406\u52a8\u4f5c\uff0c\u8ba9\u4f7f\u7528\u8005\u4e86\u89e3\u5e76\u660e\u767d\u76f8\u5173\u672f\u8bed \u5c3d\u91cf\u63d0\u4f9b\u56fe\u7247\u8bf4\u660e \u5f53\u65b9\u6848\u4e0d\u77e5\u4e00\u79cd\u65f6\uff0c\u7ed9\u51fa\u63d0\u793a\uff0c\u5982\u76f8\u5173\u6587\u7ae0\u7684\u94fe\u63a5 \u53c2\u8003\u6587\u6863 \u76f8\u5173RCA\u6587\u6863\u94fe\u63a5 \u76f8\u5173\u672f\u8bed\u89e3\u91ca \u7248\u672c\u8bf4\u660e \u6bcf\u6b21\u6587\u6863\u4fee\u8ba2\u7684\u65f6\u95f4\u3001\u4f5c\u8005\u548c\u76f8\u5173\u53d8\u52a8\u7684\u7b80\u8981\u8bf4\u660e","title":"\u8fd0\u7ef4\u6545\u969c\u5904\u7406\u6587\u6863\u6a21\u677f"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/troubleshooting_tmplete/#_1","text":"","title":"\u8fd0\u7ef4\u6545\u969c\u5904\u7406\u6587\u6863\u6a21\u677f"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/troubleshooting_tmplete/#_2","text":"\u6545\u969c\u7684\u73b0\u8c61 \u9002\u7528\u7684\u5bf9\u8c61 \u6587\u6863\u7684tag","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/troubleshooting_tmplete/#_3","text":"\u6309\u5e8f\u53f7\u5199\u51fa\u5206\u6b65\u5904\u7406\u52a8\u4f5c\uff0c\u8ba9\u4f7f\u7528\u8005\u4e86\u89e3\u5e76\u660e\u767d\u76f8\u5173\u672f\u8bed \u5c3d\u91cf\u63d0\u4f9b\u56fe\u7247\u8bf4\u660e \u5f53\u65b9\u6848\u4e0d\u77e5\u4e00\u79cd\u65f6\uff0c\u7ed9\u51fa\u63d0\u793a\uff0c\u5982\u76f8\u5173\u6587\u7ae0\u7684\u94fe\u63a5","title":"\u5904\u7406\u6d41\u7a0b"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/troubleshooting_tmplete/#_4","text":"\u76f8\u5173RCA\u6587\u6863\u94fe\u63a5 \u76f8\u5173\u672f\u8bed\u89e3\u91ca","title":"\u53c2\u8003\u6587\u6863"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/troubleshooting_tmplete/#_5","text":"\u6bcf\u6b21\u6587\u6863\u4fee\u8ba2\u7684\u65f6\u95f4\u3001\u4f5c\u8005\u548c\u76f8\u5173\u53d8\u52a8\u7684\u7b80\u8981\u8bf4\u660e","title":"\u7248\u672c\u8bf4\u660e"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/","text":"ELK\u96c6\u7fa4\u5b89\u88c5\u914d\u7f6e\u624b\u518c\uff08Docker\u7248\uff09 \u53c2\u8003 \u5b98\u65b9\u6587\u6863 Elastic Stack \u6280\u672f\u6307\u5357 \u7d22\u5f15\u7ba1\u7406\u5de5\u5177curator ELK \u67b6\u6784\u548c Filebeat \u5de5\u4f5c\u539f\u7406\u8be6\u89e3 \u76d1\u63a7\u65b9\u6848Elasticsearch Exporter Prometheus\u535a\u6587 \u67b6\u6784 graph TD Beat1 -->|\u63a8| Kafka\u96c6\u7fa4 Beat2 -->|\u63a8| Kafka\u96c6\u7fa4 BeatN -->|\u63a8| Kafka\u96c6\u7fa4 Kafka\u96c6\u7fa4 -->|\u6d88\u8d39| Logstash\u96c6\u7fa4 Logstash\u96c6\u7fa4 -->|\u6309Topic\u5199| ES\u96c6\u7fa4 Logstash\u96c6\u7fa4 -->|\u51b7\u5907| HDFS ES\u96c6\u7fa4 -->|\u8bfb| Kibana \u5b89\u88c5 Elasticsearch # \u51c6\u5907\u5916\u6302\u76ee\u5f55 mkdir /opt/elasticsearch chmod 777 /opt/elasticsearch # \u5f00\u53d1\u73af\u5883\uff0c\u5355\u8282\u70b9\uff0c\u9650\u5236\u5185\u5b58\uff0c\u7981\u7528swap\uff0c\u5916\u6302\u6570\u636e docker pull elasticsearch:7.8.1 docker run -d \\ --name=elasticsearch \\ -p 9200:9200 \\ -p 9300:9300 \\ -v /opt/elasticsearch:/usr/share/elasticsearch/data \\ -e \"discovery.type=single-node\" \\ -e \"ES_JAVA_OPTS=-Xms2000m -Xmx2000m\" \\ -m 2g \\ --memory-swap=\"2g\" \\ elasticsearch:7.8.1 # \u9a8c\u8bc1 curl 0.0.0.0:9300 \u6ce8\u610f\u4e8b\u9879 \u5bbf\u4e3b\u673a\u7684 /etc/sysctl.conf \u8bbe\u7f6e vm.max_map_count=262144 \uff0c sysctl -p \u8d77\u6548 \u8c03\u5927\u5355\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u6709\u7684VMA(\u865a\u62df\u5185\u5b58\u533a\u57df)\u7684\u6570\u91cf\uff0c\u5426\u5219\u5bb9\u6613OOM \u76d1\u63a7\u65b9\u6848 \u57fa\u4e8ePrometheus Exporter # \u65b0\u5efaelasticsearch_exporter\u76ee\u5f55 mkdir /opt/elasticsearch_exporter cd /opt/elasticsearch_exporter # \u751f\u6210docker-compose.yml\uff0c\u53c2\u8003\u4e0b\u6587 # \u8fd0\u884c docker-compose up -d # docker-compose.yml\uff0c\u7528\u4e8e\u5b9a\u4e49elasticsearch_exporter\u7684\u542f\u52a8\u53c2\u6570 elasticsearch_exporter: image: justwatch/elasticsearch_exporter:1.1.0 command: - '--es.uri=http://10.10.0.140:9200' restart: always ports: - \"0.0.0.0:9114:9114\" \u5728Prometheus\u914d\u7f6e\u670d\u52a1\u53d1\u73b0 // sd_config.json\u6dfb\u52a0\u76f8\u5173\u670d\u52a1 { \"targets\": [ \"10.10.0.140:9114\" ], \"labels\": { \"env\": \"dev\", \"job\": \"elasticsearch\" } }, \u6ce8\u518c\u6210\u529f\u5982\u56fe \u901a\u8fc7Prometheus\u7684HTTP API\u786e\u8ba4ES\u96c6\u7fa4\u7684\u5b58\u6d3b\uff0c\u5982 'curl http://10.10.0.140:9090/api/v1/query?query=elasticsearch_cluster_health_up' \u53cd\u9988json\u5982\u4e0b\uff1a { \"status\": \"success\", \"data\": { \"resultType\": \"vector\", \"result\": [ { \"metric\": { \"__name__\": \"elasticsearch_cluster_health_up\", // \u552f\u4e00Metric\uff0c\u5176\u4ed6\u662ftag \"env\": \"dev\", \"instance\": \"10.10.0.140:9114\", // \u5bf9\u5e94es\u7684Exporter\u5730\u5740 \"job\": \"elasticsearch\" }, \"value\": [ 1598001650.145, // \u91c7\u96c6\u7684\u6700\u540e\u65f6\u95f4\u6233 \"1\" // \u503c\uff0c\u6839\u636eMetric\u5b9a\u4e49 ] } ] } } \u5e38\u7528\u6307\u6807 \u6307\u6807 \u76d1\u63a7\u76ee\u6807 \u7c7b\u578b \u5355\u4f4d \u610f\u4e49 elasticsearch_cluster_health_up \u96c6\u7fa4 gauge \u5b57\u5178 ES\u96c6\u7fa4\u7684\u5b58\u6d3b\u72b6\u6001\uff0c1=\u8fd0\u884c\uff1b0=\u5b95\u673a elasticsearch_cluster_health_active_shards \u96c6\u7fa4 gauge \u6b63\u6574\u6570 \u5206\u7247\u603b\u6570\u91cf\uff0c\u5305\u62ec\u526f\u672c elasticsearch_cluster_health_unassigned_shards \u96c6\u7fa4 gauge \u6b63\u6574\u6570 \u672a\u5206\u914d\u7684\u5206\u7247\u6570\uff0c\u5927\u4e8e\u603b\u5206\u7247\u6570\u768450%\uff0c\u4ee3\u8868\u96c6\u7fa4\u5f02\u5e38 elasticsearch_jvm_memory_max_bytes node gauge byte jvm\u6700\u5927\u5185\u5b58\u6570\uff0c\u7531Xmx\u6307\u5b9a elasticsearch_jvm_memory_used_bytes{area=\"heap\"} node gauge byte node\u7684jvm\u4f7f\u7528\u7684\u5806\u5185\u5b58\u6570\uff0c\u5927\u4e8e\u603b\u5185\u5b58\u768490%\u4ee3\u8868\u5f02\u5e38 elasticsearch_filesystem_data_used_percent \u96c6\u7fa4 gauge \u767e\u5206\u6bd4 \u5df2\u7528\u78c1\u76d8\u767e\u5206\u6bd4 elasticsearch_filesystem_data_used_percent = 100 * (elasticsearch_filesystem_data_size_bytes - elasticsearch_filesystem_data_free_bytes) / elasticsearch_filesystem_data_size_bytes # \u63a5Prometheus\u7684\u5e38\u7528\u544a\u8b66\u89c4\u5219elasticsearch.rules.yml # calculate filesystem used and free percent elasticsearch_filesystem_data_used_percent = 100 * (elasticsearch_filesystem_data_size_bytes - elasticsearch_filesystem_data_free_bytes) / elasticsearch_filesystem_data_size_bytes # alert if heap usage is over 90% ALERT ElasticsearchHeapTooHigh IF elasticsearch_jvm_memory_used_bytes{area=\"heap\"} / elasticsearch_jvm_memory_max_bytes{area=\"heap\"} > 0.9 FOR 15m LABELS {severity=\"critical\"} ANNOTATIONS {description=\"The heap usage is over 90% for 15m\", summary=\"ElasticSearch node {{$labels.node}} heap usage is high\"} Kibana docker pull kibana:7.8.1 docker run \\ --link elasticsearch:elasticsearch \\ -p 5601:5601 \\ kibana:7.8.1 \u8bbf\u95ee http://\u4e3b\u673a:5601 \u67e5\u770b\u6548\u679c Kafka \u53c2\u8003 kafka\u6559\u7a0b Logstash docker pull logstash:7.8.1 # \u51c6\u5907\u653e\u914d\u7f6e\u7684\u76ee\u5f55 mkdir /opt/logstash chmod 777 /opt/logstash cd /opt/logstash # \u751f\u6210\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\uff0c\u53c2\u8003\u4e0b\u9762 # \u542f\u52a8 docker run -d \\ --name=logstash \\ --volume=/opt/logstash/:/usr/share/logstash/config/ \\ --rm \\ -m 2g \\ -p 9600:9600 \\ -t logstash:7.8.1 \\ -f /usr/share/logstash/config/logstash.conf # logstash.yml\u7528\u4e8e\u914d\u7f6e http.host: \"0.0.0.0\" # logstash.conf\u7528\u4e8e\u8bf4\u660epipeline input { # syslog kafka { bootstrap_servers => \"10.10.0.106:32775,10.10.0.106:32776\" topics => [\"syslog\"] codec => \"json\" consumer_threads => 3 id => \"syslog\" } } filter { grok { match => { \"message\" => \"%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\\[%{POSINT:syslog_pid}\\])?: %{GREEDYDATA:syslog_message}\" } add_field => [ \"received_at\", \"%{@timestamp}\" ] } date { match => [ \"syslog_timestamp\", \"MMM d HH:mm:ss\", \"MMM dd HH:mm:ss\" ] } } output { # \u8fdb\u5185\u90e8es elasticsearch { hosts => [\"10.10.0.140:9200\"] index => \"syslog-%{+YYYY.MM.dd}\" id => \"dev-es\" # \u6307\u5b9a\u6a21\u677f\uff0c\u89e3\u51b3\u5355\u8282\u70b9\u6709\u526f\u672c\uff0c\u9020\u6210\u96c6\u7fa4\u72b6\u6001yellow\u7684\u95ee\u9898 template => \"/usr/share/logstash/config/syslog.json\" template_name => \"syslog-*\" template_overwrite => true } } // syslog.json\uff0c\u7531\u4e8e\u9ed8\u8ba41\u5206\u72471\u526f\u672c\uff0c\u4f1a\u5728\u5355\u5b9e\u4f8b\u4e0a\u9020\u6210unassign shard\uff0c\u5bfc\u81f4yellow\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e0d\u8981\u526f\u672c { \"template\": \"syslog-*\", \"settings\": { \"number_of_replicas\" : 0 } } Filebeat # \u5b89\u88c5\u89e3\u538b curl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.8.1-linux-x86_64.tar.gz tar xzvf filebeat-7.8.1-linux-x86_64.tar.gz mv filebeat-7.8.1-linux-x86_64 filebeat cd filebeat # \u751f\u6210\u914d\u7f6e\u6587\u4ef6filebeat_syslog.yml # \u6d4b\u8bd5\u914d\u7f6e\u662f\u5426\u6b63\u786e ./filebeat test config -c filebeat_syslog.yml # \u5982\u679c\u9700\u8981\u8bfb\u7cfb\u7edflog\uff0c\u9700\u8981filebeat\u7684\u6743\u9650chown root # \u542f\u52a8 ./filebeat -e -c filebeat_syslog.yml filebeat.inputs: # filebeat_syslog.yml \u7528\u4e8e\u91c7\u96c6\u672c\u673asyslog - type: log enabled: true paths: - /var/log/messages fields: kafka_topic: syslog # \u548ckafka\u4e0a\u5b9a\u4e49\u7684topic\u5bf9\u5e94 # \u5ffd\u75651h\u524d\u7684\u5185\u5bb9 # ignore_older: 1h # \u8f93\u51fa #output.console: # pretty: true output: kafka: hosts: [\"10.10.0.106:32775\", \"10.10.0.106:32776\"] topic: '%{[fields][kafka_topic]}' compression: snappy","title":"ELK\u96c6\u7fa4\u5b89\u88c5\u914d\u7f6e\u624b\u518c\uff08Docker\u7248\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#elkdocker","text":"","title":"ELK\u96c6\u7fa4\u5b89\u88c5\u914d\u7f6e\u624b\u518c\uff08Docker\u7248\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#_1","text":"\u5b98\u65b9\u6587\u6863 Elastic Stack \u6280\u672f\u6307\u5357 \u7d22\u5f15\u7ba1\u7406\u5de5\u5177curator ELK \u67b6\u6784\u548c Filebeat \u5de5\u4f5c\u539f\u7406\u8be6\u89e3 \u76d1\u63a7\u65b9\u6848Elasticsearch Exporter Prometheus\u535a\u6587","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#_2","text":"graph TD Beat1 -->|\u63a8| Kafka\u96c6\u7fa4 Beat2 -->|\u63a8| Kafka\u96c6\u7fa4 BeatN -->|\u63a8| Kafka\u96c6\u7fa4 Kafka\u96c6\u7fa4 -->|\u6d88\u8d39| Logstash\u96c6\u7fa4 Logstash\u96c6\u7fa4 -->|\u6309Topic\u5199| ES\u96c6\u7fa4 Logstash\u96c6\u7fa4 -->|\u51b7\u5907| HDFS ES\u96c6\u7fa4 -->|\u8bfb| Kibana","title":"\u67b6\u6784"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#_3","text":"","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#elasticsearch","text":"# \u51c6\u5907\u5916\u6302\u76ee\u5f55 mkdir /opt/elasticsearch chmod 777 /opt/elasticsearch # \u5f00\u53d1\u73af\u5883\uff0c\u5355\u8282\u70b9\uff0c\u9650\u5236\u5185\u5b58\uff0c\u7981\u7528swap\uff0c\u5916\u6302\u6570\u636e docker pull elasticsearch:7.8.1 docker run -d \\ --name=elasticsearch \\ -p 9200:9200 \\ -p 9300:9300 \\ -v /opt/elasticsearch:/usr/share/elasticsearch/data \\ -e \"discovery.type=single-node\" \\ -e \"ES_JAVA_OPTS=-Xms2000m -Xmx2000m\" \\ -m 2g \\ --memory-swap=\"2g\" \\ elasticsearch:7.8.1 # \u9a8c\u8bc1 curl 0.0.0.0:9300","title":"Elasticsearch"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#_4","text":"\u5bbf\u4e3b\u673a\u7684 /etc/sysctl.conf \u8bbe\u7f6e vm.max_map_count=262144 \uff0c sysctl -p \u8d77\u6548 \u8c03\u5927\u5355\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u6709\u7684VMA(\u865a\u62df\u5185\u5b58\u533a\u57df)\u7684\u6570\u91cf\uff0c\u5426\u5219\u5bb9\u6613OOM","title":"\u6ce8\u610f\u4e8b\u9879"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#_5","text":"\u57fa\u4e8ePrometheus Exporter # \u65b0\u5efaelasticsearch_exporter\u76ee\u5f55 mkdir /opt/elasticsearch_exporter cd /opt/elasticsearch_exporter # \u751f\u6210docker-compose.yml\uff0c\u53c2\u8003\u4e0b\u6587 # \u8fd0\u884c docker-compose up -d # docker-compose.yml\uff0c\u7528\u4e8e\u5b9a\u4e49elasticsearch_exporter\u7684\u542f\u52a8\u53c2\u6570 elasticsearch_exporter: image: justwatch/elasticsearch_exporter:1.1.0 command: - '--es.uri=http://10.10.0.140:9200' restart: always ports: - \"0.0.0.0:9114:9114\" \u5728Prometheus\u914d\u7f6e\u670d\u52a1\u53d1\u73b0 // sd_config.json\u6dfb\u52a0\u76f8\u5173\u670d\u52a1 { \"targets\": [ \"10.10.0.140:9114\" ], \"labels\": { \"env\": \"dev\", \"job\": \"elasticsearch\" } }, \u6ce8\u518c\u6210\u529f\u5982\u56fe \u901a\u8fc7Prometheus\u7684HTTP API\u786e\u8ba4ES\u96c6\u7fa4\u7684\u5b58\u6d3b\uff0c\u5982 'curl http://10.10.0.140:9090/api/v1/query?query=elasticsearch_cluster_health_up' \u53cd\u9988json\u5982\u4e0b\uff1a { \"status\": \"success\", \"data\": { \"resultType\": \"vector\", \"result\": [ { \"metric\": { \"__name__\": \"elasticsearch_cluster_health_up\", // \u552f\u4e00Metric\uff0c\u5176\u4ed6\u662ftag \"env\": \"dev\", \"instance\": \"10.10.0.140:9114\", // \u5bf9\u5e94es\u7684Exporter\u5730\u5740 \"job\": \"elasticsearch\" }, \"value\": [ 1598001650.145, // \u91c7\u96c6\u7684\u6700\u540e\u65f6\u95f4\u6233 \"1\" // \u503c\uff0c\u6839\u636eMetric\u5b9a\u4e49 ] } ] } }","title":"\u76d1\u63a7\u65b9\u6848"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#_6","text":"\u6307\u6807 \u76d1\u63a7\u76ee\u6807 \u7c7b\u578b \u5355\u4f4d \u610f\u4e49 elasticsearch_cluster_health_up \u96c6\u7fa4 gauge \u5b57\u5178 ES\u96c6\u7fa4\u7684\u5b58\u6d3b\u72b6\u6001\uff0c1=\u8fd0\u884c\uff1b0=\u5b95\u673a elasticsearch_cluster_health_active_shards \u96c6\u7fa4 gauge \u6b63\u6574\u6570 \u5206\u7247\u603b\u6570\u91cf\uff0c\u5305\u62ec\u526f\u672c elasticsearch_cluster_health_unassigned_shards \u96c6\u7fa4 gauge \u6b63\u6574\u6570 \u672a\u5206\u914d\u7684\u5206\u7247\u6570\uff0c\u5927\u4e8e\u603b\u5206\u7247\u6570\u768450%\uff0c\u4ee3\u8868\u96c6\u7fa4\u5f02\u5e38 elasticsearch_jvm_memory_max_bytes node gauge byte jvm\u6700\u5927\u5185\u5b58\u6570\uff0c\u7531Xmx\u6307\u5b9a elasticsearch_jvm_memory_used_bytes{area=\"heap\"} node gauge byte node\u7684jvm\u4f7f\u7528\u7684\u5806\u5185\u5b58\u6570\uff0c\u5927\u4e8e\u603b\u5185\u5b58\u768490%\u4ee3\u8868\u5f02\u5e38 elasticsearch_filesystem_data_used_percent \u96c6\u7fa4 gauge \u767e\u5206\u6bd4 \u5df2\u7528\u78c1\u76d8\u767e\u5206\u6bd4 elasticsearch_filesystem_data_used_percent = 100 * (elasticsearch_filesystem_data_size_bytes - elasticsearch_filesystem_data_free_bytes) / elasticsearch_filesystem_data_size_bytes # \u63a5Prometheus\u7684\u5e38\u7528\u544a\u8b66\u89c4\u5219elasticsearch.rules.yml # calculate filesystem used and free percent elasticsearch_filesystem_data_used_percent = 100 * (elasticsearch_filesystem_data_size_bytes - elasticsearch_filesystem_data_free_bytes) / elasticsearch_filesystem_data_size_bytes # alert if heap usage is over 90% ALERT ElasticsearchHeapTooHigh IF elasticsearch_jvm_memory_used_bytes{area=\"heap\"} / elasticsearch_jvm_memory_max_bytes{area=\"heap\"} > 0.9 FOR 15m LABELS {severity=\"critical\"} ANNOTATIONS {description=\"The heap usage is over 90% for 15m\", summary=\"ElasticSearch node {{$labels.node}} heap usage is high\"}","title":"\u5e38\u7528\u6307\u6807"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#kibana","text":"docker pull kibana:7.8.1 docker run \\ --link elasticsearch:elasticsearch \\ -p 5601:5601 \\ kibana:7.8.1 \u8bbf\u95ee http://\u4e3b\u673a:5601 \u67e5\u770b\u6548\u679c","title":"Kibana"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#kafka","text":"\u53c2\u8003 kafka\u6559\u7a0b","title":"Kafka"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#logstash","text":"docker pull logstash:7.8.1 # \u51c6\u5907\u653e\u914d\u7f6e\u7684\u76ee\u5f55 mkdir /opt/logstash chmod 777 /opt/logstash cd /opt/logstash # \u751f\u6210\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\uff0c\u53c2\u8003\u4e0b\u9762 # \u542f\u52a8 docker run -d \\ --name=logstash \\ --volume=/opt/logstash/:/usr/share/logstash/config/ \\ --rm \\ -m 2g \\ -p 9600:9600 \\ -t logstash:7.8.1 \\ -f /usr/share/logstash/config/logstash.conf # logstash.yml\u7528\u4e8e\u914d\u7f6e http.host: \"0.0.0.0\" # logstash.conf\u7528\u4e8e\u8bf4\u660epipeline input { # syslog kafka { bootstrap_servers => \"10.10.0.106:32775,10.10.0.106:32776\" topics => [\"syslog\"] codec => \"json\" consumer_threads => 3 id => \"syslog\" } } filter { grok { match => { \"message\" => \"%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\\[%{POSINT:syslog_pid}\\])?: %{GREEDYDATA:syslog_message}\" } add_field => [ \"received_at\", \"%{@timestamp}\" ] } date { match => [ \"syslog_timestamp\", \"MMM d HH:mm:ss\", \"MMM dd HH:mm:ss\" ] } } output { # \u8fdb\u5185\u90e8es elasticsearch { hosts => [\"10.10.0.140:9200\"] index => \"syslog-%{+YYYY.MM.dd}\" id => \"dev-es\" # \u6307\u5b9a\u6a21\u677f\uff0c\u89e3\u51b3\u5355\u8282\u70b9\u6709\u526f\u672c\uff0c\u9020\u6210\u96c6\u7fa4\u72b6\u6001yellow\u7684\u95ee\u9898 template => \"/usr/share/logstash/config/syslog.json\" template_name => \"syslog-*\" template_overwrite => true } } // syslog.json\uff0c\u7531\u4e8e\u9ed8\u8ba41\u5206\u72471\u526f\u672c\uff0c\u4f1a\u5728\u5355\u5b9e\u4f8b\u4e0a\u9020\u6210unassign shard\uff0c\u5bfc\u81f4yellow\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e0d\u8981\u526f\u672c { \"template\": \"syslog-*\", \"settings\": { \"number_of_replicas\" : 0 } }","title":"Logstash"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/#filebeat","text":"# \u5b89\u88c5\u89e3\u538b curl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.8.1-linux-x86_64.tar.gz tar xzvf filebeat-7.8.1-linux-x86_64.tar.gz mv filebeat-7.8.1-linux-x86_64 filebeat cd filebeat # \u751f\u6210\u914d\u7f6e\u6587\u4ef6filebeat_syslog.yml # \u6d4b\u8bd5\u914d\u7f6e\u662f\u5426\u6b63\u786e ./filebeat test config -c filebeat_syslog.yml # \u5982\u679c\u9700\u8981\u8bfb\u7cfb\u7edflog\uff0c\u9700\u8981filebeat\u7684\u6743\u9650chown root # \u542f\u52a8 ./filebeat -e -c filebeat_syslog.yml filebeat.inputs: # filebeat_syslog.yml \u7528\u4e8e\u91c7\u96c6\u672c\u673asyslog - type: log enabled: true paths: - /var/log/messages fields: kafka_topic: syslog # \u548ckafka\u4e0a\u5b9a\u4e49\u7684topic\u5bf9\u5e94 # \u5ffd\u75651h\u524d\u7684\u5185\u5bb9 # ignore_older: 1h # \u8f93\u51fa #output.console: # pretty: true output: kafka: hosts: [\"10.10.0.106:32775\", \"10.10.0.106:32776\"] topic: '%{[fields][kafka_topic]}' compression: snappy","title":"Filebeat"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/curator/","text":"curator ES\u7d22\u5f15\u7ba1\u7406\u5de5\u5177 PS: \u5b98\u65b96.x\u5f00\u59cb\uff0c\u5df2\u7ecf\u5185\u90e8\u57fa\u7840ILM\u5de5\u5177\uff0c\u57fa\u4e8eindex\u6a21\u677f\uff0c\u63a8\u8350\u4f7f\u7528 \u5b89\u88c5 # \u5982\u679c\u9047\u5230\u90e8\u5206\u4f9d\u8d56\u7248\u672c\u51b2\u7a81\uff0c\u53ef\u4ee5\u5f3a\u5236\u5ffd\u7565 pip install elasticsearch-curator [--ignore-installed PyYAML] \u4f7f\u7528 # \u6d4b\u8bd5\u7248\u672c curator --version # \u8fde\u63a5es","title":"curator ES\u7d22\u5f15\u7ba1\u7406\u5de5\u5177"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/curator/#curator-es","text":"PS: \u5b98\u65b96.x\u5f00\u59cb\uff0c\u5df2\u7ecf\u5185\u90e8\u57fa\u7840ILM\u5de5\u5177\uff0c\u57fa\u4e8eindex\u6a21\u677f\uff0c\u63a8\u8350\u4f7f\u7528","title":"curator ES\u7d22\u5f15\u7ba1\u7406\u5de5\u5177"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/curator/#_1","text":"# \u5982\u679c\u9047\u5230\u90e8\u5206\u4f9d\u8d56\u7248\u672c\u51b2\u7a81\uff0c\u53ef\u4ee5\u5f3a\u5236\u5ffd\u7565 pip install elasticsearch-curator [--ignore-installed PyYAML]","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/curator/#_2","text":"# \u6d4b\u8bd5\u7248\u672c curator --version # \u8fde\u63a5es","title":"\u4f7f\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/docker-elk/","text":"docker-comepose\u7248\u7684ELK \u9700\u6c42 docker-compose\u7684\u5b89\u88c5 es\u5b58\u50a8\u72ec\u7acb \u53ef\u96c6\u7fa4\u6269\u5c55 \u5173\u95ed\u6536\u8d39\u90e8\u5206 \u5b89\u88c5 \u5b89\u88c5\u524d\u63d0 \u5efa\u8bae\u5185\u5b582G\u4ee5\u4e0a\uff0cdata\u5b58\u50a8100G\uff08\u72ec\u7acb\u6302\u8f7d\u5728/data\uff09\u4ee5\u4e0a\uff0c\u5e76777\u6388\u6743 docker\u548ccompose\u7248\u672c\u7b26\u5408\u8981\u6c42 root\u6743\u9650 OS\u914d\u7f6e\u4f18\u5316\uff1a ulimit -n 65535 \u6587\u4ef6\u53e5\u67c4\u8c03\u5927\uff0c\u56e0\u4e3aes\u4f1a\u6709\u5927\u91cf\u788e\u7247\u6587\u4ef6IO swapoff -a \u7981\u7528swap\uff0c\u9632\u6b62\u78c1\u76d8IO\u964d\u4f4ees\u6027\u80fd sysctl -w vm.max_map_count=262144 \u8c03\u5927\u865a\u62df\u5730\u5740\u7a7a\u95f4 sysctl -w net.ipv4.tcp_retries2=5 \u964d\u4f4eTCP\u91cd\u4f20\u6b21\u6570\uff0c\u4ee5\u63d0\u9ad8es\u53d1\u73b0\u6545\u969c\u8282\u70b9\u7684\u5904\u7406\u901f\u5ea6 \u5b89\u88c5 cd /opt git clone https://github.com/deviantony/docker-elk.git cd docker-elk docker-compose up -d \uff08\u53ef\u9009\uff09\u5173\u95ed\u6536\u8d39\uff1a\u4fee\u6539 docker-elk/elasticsearch/config/elasticsearch.yml \u91cc\u7684 xpack.license.self_generated.type \u4e3a basic \u8bbf\u95ee http://localhost:5601 \u8fdb\u5165Kibana\uff0c\u9ed8\u8ba4\u8d26\u53f7 elastic/changeme \u8bbf\u95eees\u7684http api curl http://localhost:9200 -u elastic:{yml\u6587\u4ef6\u4e2d\u7684\u5bc6\u7801} \u5378\u8f7d\u5e76\u6e05\u7406\u6570\u636e docker-compose down -v \u914d\u7f6e \u4fee\u6539\u9ed8\u8ba4\u5bc6\u7801 es\u5bc6\u7801 docker-compose.yml \u7684 ELASTIC_PASSWORD kibana\u5bf9\u63a5es kibana/config/kibana.yml \u7684 elasticsearch.password logstash\u7684\u76d1\u63a7\u91c7\u96c6 logstash/config/logstash.yml \u7684 xpack.monitoring.elasticsearch.password \u589e\u52a0JVM\u5185\u5b58\uff0c\u4fee\u6539 docker-compose.yml es ES_JAVA_OPTS: \"-Xmx2g -Xms2g\" logstash LS_JAVA_OPTS: \"-Xmx1g -Xms1g\" \u53c2\u8003 \u539f\u7248\u914d\u7f6e https://github.com/deviantony/docker-elk","title":"docker-comepose\u7248\u7684ELK"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/docker-elk/#docker-comeposeelk","text":"","title":"docker-comepose\u7248\u7684ELK"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/docker-elk/#_1","text":"docker-compose\u7684\u5b89\u88c5 es\u5b58\u50a8\u72ec\u7acb \u53ef\u96c6\u7fa4\u6269\u5c55 \u5173\u95ed\u6536\u8d39\u90e8\u5206","title":"\u9700\u6c42"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/docker-elk/#_2","text":"","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/docker-elk/#_3","text":"\u5efa\u8bae\u5185\u5b582G\u4ee5\u4e0a\uff0cdata\u5b58\u50a8100G\uff08\u72ec\u7acb\u6302\u8f7d\u5728/data\uff09\u4ee5\u4e0a\uff0c\u5e76777\u6388\u6743 docker\u548ccompose\u7248\u672c\u7b26\u5408\u8981\u6c42 root\u6743\u9650 OS\u914d\u7f6e\u4f18\u5316\uff1a ulimit -n 65535 \u6587\u4ef6\u53e5\u67c4\u8c03\u5927\uff0c\u56e0\u4e3aes\u4f1a\u6709\u5927\u91cf\u788e\u7247\u6587\u4ef6IO swapoff -a \u7981\u7528swap\uff0c\u9632\u6b62\u78c1\u76d8IO\u964d\u4f4ees\u6027\u80fd sysctl -w vm.max_map_count=262144 \u8c03\u5927\u865a\u62df\u5730\u5740\u7a7a\u95f4 sysctl -w net.ipv4.tcp_retries2=5 \u964d\u4f4eTCP\u91cd\u4f20\u6b21\u6570\uff0c\u4ee5\u63d0\u9ad8es\u53d1\u73b0\u6545\u969c\u8282\u70b9\u7684\u5904\u7406\u901f\u5ea6","title":"\u5b89\u88c5\u524d\u63d0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/docker-elk/#_4","text":"cd /opt git clone https://github.com/deviantony/docker-elk.git cd docker-elk docker-compose up -d \uff08\u53ef\u9009\uff09\u5173\u95ed\u6536\u8d39\uff1a\u4fee\u6539 docker-elk/elasticsearch/config/elasticsearch.yml \u91cc\u7684 xpack.license.self_generated.type \u4e3a basic \u8bbf\u95ee http://localhost:5601 \u8fdb\u5165Kibana\uff0c\u9ed8\u8ba4\u8d26\u53f7 elastic/changeme \u8bbf\u95eees\u7684http api curl http://localhost:9200 -u elastic:{yml\u6587\u4ef6\u4e2d\u7684\u5bc6\u7801} \u5378\u8f7d\u5e76\u6e05\u7406\u6570\u636e docker-compose down -v","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/docker-elk/#_5","text":"\u4fee\u6539\u9ed8\u8ba4\u5bc6\u7801 es\u5bc6\u7801 docker-compose.yml \u7684 ELASTIC_PASSWORD kibana\u5bf9\u63a5es kibana/config/kibana.yml \u7684 elasticsearch.password logstash\u7684\u76d1\u63a7\u91c7\u96c6 logstash/config/logstash.yml \u7684 xpack.monitoring.elasticsearch.password \u589e\u52a0JVM\u5185\u5b58\uff0c\u4fee\u6539 docker-compose.yml es ES_JAVA_OPTS: \"-Xmx2g -Xms2g\" logstash LS_JAVA_OPTS: \"-Xmx1g -Xms1g\"","title":"\u914d\u7f6e"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/docker-elk/#_6","text":"\u539f\u7248\u914d\u7f6e https://github.com/deviantony/docker-elk","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/","text":"Elastalert - Elasticsearch\u65e5\u5fd7\u544a\u8b66\u7ec4\u4ef6 \u53c2\u8003 \u5b98\u7f51\u6587\u6863 https://elastalert.readthedocs.io/ \u5b89\u88c5 git clone https://github.com/Yelp/elastalert.git cd elastalert/ pip install -U setuptools # \u5347\u7ea7\u4f9d\u8d56\u5de5\u5177 python setup.py install pip install -r ./requirements.txt \u914d\u7f6e # \u52a0\u8f7d\u89c4\u5219\u914d\u7f6e\u6587\u4ef6\u7684\u5730\u65b9. \u5b83\u5c06\u5c1d\u8bd5\u52a0\u8f7d\u6587\u4ef6\u5939\u4e2d\u7684\u6bcf\u4e00\u4e2a.yaml\u6587\u4ef6. rules_folder: example_rules # \u591a\u4e45\u67e5\u8be2\u4e00\u6b21es\uff0c\u5355\u4f4d\uff1a\u5206\u949f\uff0c\u53ef\u6307\u5b9a\u5176\u4ed6\u65f6\u95f4\u5355\u4f4d run_every: minutes: 1 # \u67e5\u8be2\u533a\u95f4\uff0c\u9ed8\u8ba4\u4ece15\u5206\u949f\u524d\u5230\u73b0\u5728 buffer_time: minutes: 15 # \u67e5\u8be2\u7684\u76ee\u6807es\u5730\u5740 es_host: 127.0.0.1 # es\u8bbf\u95ee\u7aef\u53e3 es_port: 9200 # \u8bbf\u95ee\u6743\u9650\u9a8c\u8bc1\uff0c\u4ee5\u96c6\u6d4b\u4e3a\u4f8b es_username: admin es_password: admin123 # es-alert\u9ed8\u8ba4\u5b58\u50a8\u5728es\u7684index\u540d writeback_index: elastalert_status # \u91cd\u8bd5\u9519\u8bef\u7684\u65f6\u95f4\u6bb5 alert_time_limit: days: 2 \u4f7f\u7528 # \u521b\u5efaelastalert\u7684\u5b58\u50a8index elastalert-create-index # \u6d4b\u8bd5\u89c4\u5219 elastalert-test-rule --config ./config.yaml example_rules/example_frequency.yaml # \u5728\u7ec8\u7aef\u8f93\u51fa\u8fd0\u884c\u7ed3\u679c # --verbose: \u663e\u793ainfo\u7ea7log # --rule <*.yaml>: \u52a0\u8f7d\u6307\u5b9a\u89c4\u5219\uff1b\u4e0d\u52a0\uff0c\u5219\u52a0\u8f7drules_folder\u4e0b\u6240\u6709\u89c4\u5219 python -m elastalert.elastalert --verbose --rule example_frequency.yaml \u89c4\u5219\u7c7b\u578b\u4ecb\u7ecd frequency\u7c7b\u578b\uff1a\u5339\u914d\u5f53 Y \u65f6\u95f4\u6bb5\u5185\u6709 X \u4e2a\u4e8b\u4ef6 # \u552f\u4e00\u89c4\u5219\u540d name: frequency-test-rule # \u89c4\u5219\u7c7b\u578b type: frequency # \u76d1\u63a7\u7684\u7d22\u5f15 index: log-* # \u9650\u5b9a\u65f6\u95f4\u5185\uff0c\u4e8b\u4ef6\u53d1\u751f\u7684\u6b21\u6570 num_events: 50 # \u9650\u5b9a\u67e5\u8be2\u7684\u65f6\u95f4\u7a97\u53e3 timeframe: days: 7 # \u67e5\u8be2\u6761\u4ef6\uff1a\u548ckibana\u4e0a\u7684\u67e5\u8be2\u6761\u4ef6\u4e00\u81f4 filter: - query: query_string: query: \"level:ERROR\" # \u62a5\u8b66\u65b9\u5f0f alert: - \"email\" # \u63a5\u6536\u65b9\u90ae\u4ef6\u5217\u8868 email: - \"admin@test.com\" spike\u7c7b\u578b\uff1a\u5339\u914d\u4e8b\u4ef6\u53d1\u751f\u7387\u4e0a\u5347\u6216\u8005\u4e0b\u964d name: spike-test-rule type: spike index: log-* # \u5f53\u524d\u7a97\u53e3\u4e8b\u4ef6\u53d1\u751f\u6570\u7684\u57fa\u7ebf threshold_cur: 5 # \u67e5\u8be2\u7a97\u53e3\uff1a\u672c\u4f8b\u4e2d\uff0c\u4ee5\u5f53\u524d1\u5206\u949f\u4e3a\u5f53\u524d\u7a97\u53e3\uff0c\u4ee5\u5012\u65702~1\u5206\u949f\u4e3a\u5bf9\u6bd4\u7a97\u53e3 timeframe: minutes: 1 # \u5f53\u524d\u7a97\u53e3\u4e8b\u4ef6\u6570/\u5bf9\u6bd4\u7a97\u53e3\u4e8b\u4ef6\u6570\u7684\u500d\u6570\uff08\u6bd4\u7387\uff09 spike_height: 2 # up\u7c7b\u578b\uff1a\u5982\u679c\u6bd4\u7387\u5927\u4e8espike\u2014\u2014height\uff0c\u4e14\u4e8b\u4ef6\u6570\u8d85\u8fc7threshold_cur # \u8fd8\u6709down\u3001both\u7c7b\u578b spike_type: \"up\" filter: - query: query_string: query: \"level:ERROR\" alert: - \"email\" email: - \"admin@test.com\"","title":"Elastalert - Elasticsearch\u65e5\u5fd7\u544a\u8b66\u7ec4\u4ef6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/#elastalert-elasticsearch","text":"","title":"Elastalert - Elasticsearch\u65e5\u5fd7\u544a\u8b66\u7ec4\u4ef6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/#_1","text":"\u5b98\u7f51\u6587\u6863 https://elastalert.readthedocs.io/","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/#_2","text":"git clone https://github.com/Yelp/elastalert.git cd elastalert/ pip install -U setuptools # \u5347\u7ea7\u4f9d\u8d56\u5de5\u5177 python setup.py install pip install -r ./requirements.txt","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/#_3","text":"# \u52a0\u8f7d\u89c4\u5219\u914d\u7f6e\u6587\u4ef6\u7684\u5730\u65b9. \u5b83\u5c06\u5c1d\u8bd5\u52a0\u8f7d\u6587\u4ef6\u5939\u4e2d\u7684\u6bcf\u4e00\u4e2a.yaml\u6587\u4ef6. rules_folder: example_rules # \u591a\u4e45\u67e5\u8be2\u4e00\u6b21es\uff0c\u5355\u4f4d\uff1a\u5206\u949f\uff0c\u53ef\u6307\u5b9a\u5176\u4ed6\u65f6\u95f4\u5355\u4f4d run_every: minutes: 1 # \u67e5\u8be2\u533a\u95f4\uff0c\u9ed8\u8ba4\u4ece15\u5206\u949f\u524d\u5230\u73b0\u5728 buffer_time: minutes: 15 # \u67e5\u8be2\u7684\u76ee\u6807es\u5730\u5740 es_host: 127.0.0.1 # es\u8bbf\u95ee\u7aef\u53e3 es_port: 9200 # \u8bbf\u95ee\u6743\u9650\u9a8c\u8bc1\uff0c\u4ee5\u96c6\u6d4b\u4e3a\u4f8b es_username: admin es_password: admin123 # es-alert\u9ed8\u8ba4\u5b58\u50a8\u5728es\u7684index\u540d writeback_index: elastalert_status # \u91cd\u8bd5\u9519\u8bef\u7684\u65f6\u95f4\u6bb5 alert_time_limit: days: 2","title":"\u914d\u7f6e"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/#_4","text":"# \u521b\u5efaelastalert\u7684\u5b58\u50a8index elastalert-create-index # \u6d4b\u8bd5\u89c4\u5219 elastalert-test-rule --config ./config.yaml example_rules/example_frequency.yaml # \u5728\u7ec8\u7aef\u8f93\u51fa\u8fd0\u884c\u7ed3\u679c # --verbose: \u663e\u793ainfo\u7ea7log # --rule <*.yaml>: \u52a0\u8f7d\u6307\u5b9a\u89c4\u5219\uff1b\u4e0d\u52a0\uff0c\u5219\u52a0\u8f7drules_folder\u4e0b\u6240\u6709\u89c4\u5219 python -m elastalert.elastalert --verbose --rule example_frequency.yaml","title":"\u4f7f\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/#_5","text":"","title":"\u89c4\u5219\u7c7b\u578b\u4ecb\u7ecd"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/#frequency-y-x","text":"# \u552f\u4e00\u89c4\u5219\u540d name: frequency-test-rule # \u89c4\u5219\u7c7b\u578b type: frequency # \u76d1\u63a7\u7684\u7d22\u5f15 index: log-* # \u9650\u5b9a\u65f6\u95f4\u5185\uff0c\u4e8b\u4ef6\u53d1\u751f\u7684\u6b21\u6570 num_events: 50 # \u9650\u5b9a\u67e5\u8be2\u7684\u65f6\u95f4\u7a97\u53e3 timeframe: days: 7 # \u67e5\u8be2\u6761\u4ef6\uff1a\u548ckibana\u4e0a\u7684\u67e5\u8be2\u6761\u4ef6\u4e00\u81f4 filter: - query: query_string: query: \"level:ERROR\" # \u62a5\u8b66\u65b9\u5f0f alert: - \"email\" # \u63a5\u6536\u65b9\u90ae\u4ef6\u5217\u8868 email: - \"admin@test.com\"","title":"frequency\u7c7b\u578b\uff1a\u5339\u914d\u5f53 Y \u65f6\u95f4\u6bb5\u5185\u6709 X \u4e2a\u4e8b\u4ef6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/elastalert/#spike","text":"name: spike-test-rule type: spike index: log-* # \u5f53\u524d\u7a97\u53e3\u4e8b\u4ef6\u53d1\u751f\u6570\u7684\u57fa\u7ebf threshold_cur: 5 # \u67e5\u8be2\u7a97\u53e3\uff1a\u672c\u4f8b\u4e2d\uff0c\u4ee5\u5f53\u524d1\u5206\u949f\u4e3a\u5f53\u524d\u7a97\u53e3\uff0c\u4ee5\u5012\u65702~1\u5206\u949f\u4e3a\u5bf9\u6bd4\u7a97\u53e3 timeframe: minutes: 1 # \u5f53\u524d\u7a97\u53e3\u4e8b\u4ef6\u6570/\u5bf9\u6bd4\u7a97\u53e3\u4e8b\u4ef6\u6570\u7684\u500d\u6570\uff08\u6bd4\u7387\uff09 spike_height: 2 # up\u7c7b\u578b\uff1a\u5982\u679c\u6bd4\u7387\u5927\u4e8espike\u2014\u2014height\uff0c\u4e14\u4e8b\u4ef6\u6570\u8d85\u8fc7threshold_cur # \u8fd8\u6709down\u3001both\u7c7b\u578b spike_type: \"up\" filter: - query: query_string: query: \"level:ERROR\" alert: - \"email\" email: - \"admin@test.com\"","title":"spike\u7c7b\u578b\uff1a\u5339\u914d\u4e8b\u4ef6\u53d1\u751f\u7387\u4e0a\u5347\u6216\u8005\u4e0b\u964d"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/filebeat/","text":"Filebeat\u7b80\u4ecb \u5b89\u88c5 \u5728Ubuntu 18\u4e0b\u6d4b\u8bd5\u901a\u8fc7\uff0c\u7248\u672c7.16 curl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.16.2-linux-x86_64.tar.gz tar xzvf filebeat-7.16.2-linux-x86_64.tar.gz -C /opt/ \u4e1a\u52a1\u573a\u666f \u63a5\u5165syslog\uff0c\u8f93\u51fa\u5230logstash \u8fdb\u5165filebeat\u76ee\u5f55\uff0c\u7f16\u8f91\u914d\u7f6e filebeat.yml \u542f\u7528\u5185\u7f6e\u91c7\u96c6\u6a21\u5757system ./filebeat modules list ./filebeat modules enable system \u542f\u52a8\u524d\uff0c\u9a8c\u8bc1\u914d\u7f6e ./filebeat test config -e -c filebeat.yml \u542f\u52a8\u524d\uff0c\u9a8c\u8bc1\u4e0b\u6e38 ./filebeat test output -e -c filebeat.yml \u542f\u52a8 ./filebeat -e -c filebeat.yml \u53c2\u8003 \u5b98\u65b9\u6587\u6863 https://www.elastic.co/guide/en/beats/filebeat/current/index.html \u6e90\u7801 https://github.com/elastic/beats","title":"Filebeat\u7b80\u4ecb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/filebeat/#filebeat","text":"","title":"Filebeat\u7b80\u4ecb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/filebeat/#_1","text":"\u5728Ubuntu 18\u4e0b\u6d4b\u8bd5\u901a\u8fc7\uff0c\u7248\u672c7.16 curl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.16.2-linux-x86_64.tar.gz tar xzvf filebeat-7.16.2-linux-x86_64.tar.gz -C /opt/","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/filebeat/#_2","text":"","title":"\u4e1a\u52a1\u573a\u666f"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/filebeat/#sysloglogstash","text":"\u8fdb\u5165filebeat\u76ee\u5f55\uff0c\u7f16\u8f91\u914d\u7f6e filebeat.yml \u542f\u7528\u5185\u7f6e\u91c7\u96c6\u6a21\u5757system ./filebeat modules list ./filebeat modules enable system \u542f\u52a8\u524d\uff0c\u9a8c\u8bc1\u914d\u7f6e ./filebeat test config -e -c filebeat.yml \u542f\u52a8\u524d\uff0c\u9a8c\u8bc1\u4e0b\u6e38 ./filebeat test output -e -c filebeat.yml \u542f\u52a8 ./filebeat -e -c filebeat.yml","title":"\u63a5\u5165syslog\uff0c\u8f93\u51fa\u5230logstash"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/elk/filebeat/#_3","text":"\u5b98\u65b9\u6587\u6863 https://www.elastic.co/guide/en/beats/filebeat/current/index.html \u6e90\u7801 https://github.com/elastic/beats","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/mysqld_exporter/","text":"MySQL Server Exporter \u539f\u751fMysql\u6307\u6807\u91c7\u96c6 \u53c2\u8003 \u5b98\u65b9github \u5b89\u88c5 \u5728\u76ee\u6807DB\u4e0a\uff0c\u5f00\u901a\u76d1\u63a7\u8d26\u53f7exporter CREATE USER 'exporter'@'{\u5b9e\u9645client\u7684IP}' IDENTIFIED BY '{\u5bc6\u7801}' WITH MAX_USER_CONNECTIONS 3; GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'{\u5b9e\u9645client\u7684IP}'; \u542f\u52a8\u5bb9\u5668\u5b9e\u4f8b # \u65b0\u5efa\u7f51\u7edc\u5b9e\u4f8b docker network create my-mysql-network docker pull prom/mysqld-exporter docker run -d \\ -p 9104:9104 \\ --network my-mysql-network \\ -e DATA_SOURCE_NAME=\"exporter:{\u5bc6\u7801}@({mysql server\u7684ip}:{mysql server\u7684port})/\" \\ prom/mysqld-exporter \u9a8c\u8bc1\u670d\u52a1\uff0c\u8bbf\u95ee http://{\u5b9e\u9645client\u7684IP}:9104 \u8e29\u5751\u8bb0\u5f55 \u91c7\u96c6\u7684Mysql\u6307\u6807\u5f88\u5c11\uff0c\u67e5\u770bdocker log\uff0c\u53d1\u73b0\u5927\u91cf\u62d2\u7edd\u8bbf\u95ee 1045: Access denied Mysql\u7684\u76d1\u63a7\u8d26\u53f7\u51fa\u9519\uff0c\u8bf7\u68c0\u67e5\uff1a\u7528\u6237\u540d/\u5bc6\u7801/\u5141\u8bb8\u8bbf\u95ee\u7684\u6765\u6e90\u7f51\u6bb5","title":"MySQL Server Exporter \u539f\u751fMysql\u6307\u6807\u91c7\u96c6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/mysqld_exporter/#mysql-server-exporter-mysql","text":"","title":"MySQL Server Exporter \u539f\u751fMysql\u6307\u6807\u91c7\u96c6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/mysqld_exporter/#_1","text":"\u5b98\u65b9github","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/mysqld_exporter/#_2","text":"\u5728\u76ee\u6807DB\u4e0a\uff0c\u5f00\u901a\u76d1\u63a7\u8d26\u53f7exporter CREATE USER 'exporter'@'{\u5b9e\u9645client\u7684IP}' IDENTIFIED BY '{\u5bc6\u7801}' WITH MAX_USER_CONNECTIONS 3; GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'{\u5b9e\u9645client\u7684IP}'; \u542f\u52a8\u5bb9\u5668\u5b9e\u4f8b # \u65b0\u5efa\u7f51\u7edc\u5b9e\u4f8b docker network create my-mysql-network docker pull prom/mysqld-exporter docker run -d \\ -p 9104:9104 \\ --network my-mysql-network \\ -e DATA_SOURCE_NAME=\"exporter:{\u5bc6\u7801}@({mysql server\u7684ip}:{mysql server\u7684port})/\" \\ prom/mysqld-exporter \u9a8c\u8bc1\u670d\u52a1\uff0c\u8bbf\u95ee http://{\u5b9e\u9645client\u7684IP}:9104","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/mysqld_exporter/#_3","text":"\u91c7\u96c6\u7684Mysql\u6307\u6807\u5f88\u5c11\uff0c\u67e5\u770bdocker log\uff0c\u53d1\u73b0\u5927\u91cf\u62d2\u7edd\u8bbf\u95ee 1045: Access denied Mysql\u7684\u76d1\u63a7\u8d26\u53f7\u51fa\u9519\uff0c\u8bf7\u68c0\u67e5\uff1a\u7528\u6237\u540d/\u5bc6\u7801/\u5141\u8bb8\u8bbf\u95ee\u7684\u6765\u6e90\u7f51\u6bb5","title":"\u8e29\u5751\u8bb0\u5f55"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/","text":"Prometheus \u4f7f\u7528\u624b\u518c \u53c2\u8003 \u5b98\u7f51 \u4e2d\u6587\u6559\u7a0b \u538b\u6d4b\u65b9\u6848 \u67b6\u6784 \u9ad8\u53ef\u7528\uff1a \u53ccServer\u5b9e\u4f8b\u6a21\u578b \u53ccAlertManager+Nginx\u7684LB \u6570\u636e\u5b58\u50a8\u7b56\u7565\uff1a\u51b7\u70ed\u5206\u79bb 2\u5468\u5185\u6570\u636e\uff1aPrometheus-Server\u7684\u672c\u5730\u5b58\u50a8 2\u5468\u4ee5\u5916\u6570\u636e\uff1a\u8fdc\u7a0b\u5199\u5165ES \u652f\u6301\u544a\u8b66\u89c4\u5219\u52a8\u6001\u52a0\u8f7d\uff1a \u57fa\u4e8e\u8054\u90a6\u6a21\u578b\uff0c\u89c4\u5219\u52a0\u8f7d\u5728\u4e0a\u5c42Prometheus-Server\u4e0b\uff0c\u5b9e\u73b0\u84dd\u7eff\u5207\u6362 \u544a\u8b66\u89c4\u5219\u5b58\u50a8\u5728git\u4e2d\uff0c\u5b9a\u671f\u68c0\u67e5\u66f4\u65b0 graph TD Alertmanager\u96c6\u7fa4 -->|\u63a5\u6536| Prometheus1 Alertmanager\u96c6\u7fa4 -->|\u63a5\u6536| Prometheus2 Prometheus1 -->|\u62c9| PushGateway Prometheus1 -->|\u62c9| Exporter Prometheus2 --> PushGateway Prometheus2 --> Exporter Prometheus2 -->|\u8fdc\u7a0b\u5199| Kafka Kafka -->|logstash\u6d88\u8d39| ES \u5b89\u88c5 \u73af\u5883\u51c6\u5907 \u5347\u7ea7yum\u6e90\uff0c\u53c2\u8003\uff1a https://developer.aliyun.com/mirror/centos \u914d\u7f6e\u65f6\u95f4ntp\u540c\u6b65\uff0cTSDB\u6838\u5fc3\u6307\u6807 \u9002\u914ddocker\uff0c\u5347\u7ea7\u5185\u6838\uff0c \u53c2\u8003 \u5b89\u88c5docker-ce\uff0c \u53c2\u8003 \u914d\u7f6e # \u5728\"/opt/prometheus\"\u4e0b\u751f\u6210\u914d\u7f6eprometheus.yml global: scrape_interval: 15s # \u91c7\u96c6\u95f4\u9694\u65f6\u95f4 evaluation_interval: 15s # \u6267\u884c\u89c4\u5219\u7684\u95f4\u9694\u65f6\u95f4 rule_files: # \u52a0\u8f7d\u89c4\u5219 - \"first.rules.yml\" # \u9002\u914d\u4e0b\u6587\u7684\u81ea\u5b9a\u4e49Metric - \"alert_example.rules.yml\" # \u9002\u914d\u4e0b\u6587\u7684\u81ea\u5b9a\u4e49\u544a\u8b66 scrape_configs: # \u76d1\u63a7\u76ee\u6807 - job_name: prometheus static_configs: - targets: ['localhost:9090'] # \u9ed8\u8ba4\u91c7\u96c6HTTP\u5730\u5740\uff1ahttp://localhost:9090/metrics - job_name: node # \u9002\u914d\u4e0b\u65b9\u7684\u4e3b\u673a\u8282\u70b9\u76d1\u63a7 scrape_interval: 5s # \u8986\u76d6\u5168\u5c40\u53d8\u91cf file_sd_configs: # \u8bfb\u670d\u52a1\u53d1\u73b0\u76ee\u6807\u6587\u4ef6\uff0c\u652f\u6301*\u901a\u914d\u7b26\uff0c\u9002\u914d\u4e0b\u6587\u670d\u52a1\u53d1\u73b0 - files: - sd_config.json refresh_interval: 10m # 10\u5206\u949f\u6267\u884c\u4e00\u6b21\u53d1\u73b0\uff0c\u9ed8\u8ba45m static_configs: - targets: ['\u5bbf\u4e3b\u673aIP:9100'] # \u5982\u679cserver\u662fdocker\u542f\u52a8\uff0c\u8fd9\u91cc\u9700\u8981\u660e\u786eip labels: group: 'dev' # \u81ea\u5b9a\u4e49\u6807\u7b7e\uff0cdev\u7ec4 # \u5bf9\u63a5Alertmanager alerting: alertmanagers: - static_configs: - targets: - '\u5bbf\u4e3b\u673aIP:9093' \u542f\u52a8 # \u6307\u5b9a\u914d\u7f6e\u8def\u5f84\uff0c\u66b4\u97329090\u7aef\u53e3\uff0c\u9650\u5236\u6700\u5927\u5185\u5b58\uff0c\u6570\u636e\u4fdd\u75597\u5929 docker run -d --name=prometheus \\ -m 4G \\ --restart=always \\ -p 9090:9090 \\ -v /opt/prometheus:/etc/prometheus \\ prom/prometheus:v2.19.3 # \u5e26\u53c2\u6570\u542f\u52a8 docker run \\ --name=prometheus \\ --volume=/opt/prometheus:/etc/prometheus \\ --volume=/prometheus \\ -p 9090:9090 \\ --restart=always \\ --detach=true prom/prometheus:v2.19.3 \\ --storage.tsdb.retention.time=7d \\ --config.file=/etc/prometheus/prometheus.yml \\ --storage.tsdb.path=/prometheus \\ --web.console.libraries=/usr/share/prometheus/console_libraries \\ --web.console.templates=/usr/share/prometheus/consoles \u4f7f\u7528 \u4e3b\u673aNode Exporter # \u4e0b\u8f7d\u7ec4\u4ef6 wget https://github.com/prometheus/node_exporter/releases/download/v1.0.1/node_exporter-1.0.1.linux-amd64.tar.gz # \u89e3\u538b\u540e\u542f\u52a8 tar xvfz node_exporter-1.0.1.linux-amd64.tar.gz mv node_exporter-1.0.1.linux-amd64/ node_exporter cd node_exporter/ nohup ./node_exporter & \u6ce8\u610f\uff1a\u5173\u95ed\u4e3b\u673a\u4e0a\u9632\u706b\u5899 systemctl stop firewalld \u81ea\u5b9a\u4e49Metric \u9002\u7528\u4e8e\u539f\u6709\u6570\u636e\u7684\u9884\u8ba1\u7b97\u3002 # \u5728\"/opt/prometheus\"\u4e0b\u751f\u6210yml\u89c4\u5219\u6587\u4ef6 first.rules.yml groups: - name: cpu-node rules: - record: job_instance_mode:node_cpu_seconds:avg_rate5m # \u6bcf\u79d2CPU\u65f6\u95f4\u901f\u7387\uff0c\u6309\u7167job\u3001\u5b9e\u4f8b\u3001\u6a21\u5f0f\u533a\u5206\uff0c5\u5206\u949f\u5747\u503c expr: avg by (job, instance, mode) (rate(node_cpu_seconds_total[5m])) # \u9a8c\u8bc1\u89c4\u5219\u6587\u4ef6\u662f\u5426\u6b63\u786e promtool check rules first.rules.yml \u9875\u9762\u6548\u679c\u5982\u4e0b \u81ea\u5b9a\u4e49\u544a\u8b66 # \u5728\u914d\u7f6e\u76ee\u5f55\u4e0b\u5b9a\u4e49\u544a\u8b66\u89c4\u5219\u6587\u4ef6 alert_example.rules.yml groups: - name: alert_example rules: - alert: node_cpu_seconds_avg_rate5m expr: job_instance_mode:node_cpu_seconds:avg_rate5m > 0.5 for: 2m labels: alert_label: demo annotations: summary: \"Test Alert: {{ $labels.instance }}\" description: \"\u6d4b\u8bd5 {{ $labels.instance }} of job {{ $labels.job }} has been > 0.5\" \u5728Prometheus\u7684conf\u4e2d\u542f\u7528\uff0c\u6548\u679c\u5982\u4e0b \u670d\u52a1\u53d1\u73b0\u57fa\u4e8e\u6587\u4ef6 // \u5728\u914d\u7f6e\u76ee\u5f55\u4e0b\u5b9a\u4e49\u76d1\u63a7\u670d\u52a1\u76ee\u6807\u7684 sd_config.json [ { \"targets\": [\"10.10.0.106:9100\"], \"labels\": { \"env\": \"dev\", \"job\": \"slaver\" // \u4f1a\u8986\u76d6\u4e0a\u5c42label } } ] \u5728Prometheus\u7684conf\u4e2d\u542f\u7528\uff0c\u6548\u679c\u5982\u4e0b \u5e38\u7528PromQL\u4e3e\u4f8b # \u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\uff1a\u6309\u7167bu, product\u7ef4\u5ea6\u533a\u5206\uff0c\u8ba1\u7b97\u6307\u6807\u548c sum(es_inte_applog_error_count_group_by_servername_last_min) by (bu, product) # \u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\uff1a\u6309\u7167bu, product\u7ef4\u5ea6\u533a\u5206\uff0c\u8ba1\u7b97\u6307\u6807\u548c\uff0c5\u5206\u949f\u524d\u7684\u6570\u636e sum(es_inte_applog_error_count_group_by_servername_last_min offset 5m) by (bu, product) # \u8ba1\u7b97\u6307\u6807\u4e2a\u6570 count(es_inte_applog_error_count_group_by_servername_last_min) # \u533a\u95f4\u5411\u91cf\u8868\u8fbe\u5f0f\uff1a\u53ea\u80fd\u7528\u4e8e\u8868\u683c\uff0c\u83b7\u53d6\u6307\u5b9a\u6307\u6807 5\u5206\u949f\u5185\u7684\u6240\u6709\u6837\u672c\u6570\u636e es_inte_applog_error_count_group_by_servername_last_min{product=\"INS\"}[5m] # \u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\uff1a\u83b7\u53d6\u6307\u5b9a\u6307\u6807 5\u5206\u949f\u5185\u7684\u6240\u6709\u6837\u672c\u6570\u636e\u4e4b\u548c sum_over_time(range-vector)\uff1a\u6307\u5b9a\u65f6\u95f4\u95f4\u9694\u5185\u6240\u6709\u503c\u7684\u603b\u548c sum_over_time(es_inte_applog_error_count_group_by_servername_last_min{product=\"INS\"}[5m]) # \u77ac\u65f6\u5411\u91cf \u6309\u4e1a\u52a1\u7ebf\u533a\u5206\uff0c\u67d0\u6307\u6807\u7684\u5e73\u57471\u5206\u949f\u5185\u548c\uff0c\u7531\u4e8ePrometheus15\u79d2pull\u6b21\uff0c\u4f1a\u5bfc\u81f41\u5206\u949f\u5185\u6307\u6807\u8bfb4\u6b21\uff084\u4e2a\u70b9\uff09\uff0c\u6240\u4ee5\u7528avg_over_time\u53d6\u533a\u95f4\u5747\u503c sum(avg_over_time(es_inte_applog_error_count_group_by_servername_last_min[1m])) by (bu) # \u8ba1\u7b97\u5e73\u57471\u5206\u949f\uff0c2xx\u5728\u603b\u91cf\u4e2d\u7684% sum(avg_over_time(es_prod_accesslog_status_count_group_by_host_last_min{status=~'2.+'}[1m])) /sum(avg_over_time(es_prod_accesslog_status_count_group_by_host_last_min[1m])) \u6027\u80fd\u538b\u6d4b\u62a5\u544a \u6d4b\u8bd5\u4e3b\u673a\u914d\u7f6e\uff1a4C8G \u4e0d\u9650\u5236docker\u5185\u5b58 \u538b\u6d4b\u523022\u4e2aavalanche\u5b9e\u4f8b\u65f6\uff0c\u8fbe\u523024k\u7684QPS\uff0c\u5185\u5b58\u5360\u75287.7G\uff0c\u968f\u540e\u5361\u673a \u4e3b\u673aCPU\u8d1f\u8f7d\u4e0d\u5927\uff0c\u5185\u5b58\u5360\u7528\u6301\u7eed\u589e\u52a0\uff0c\u4e0a\u4e0d\u5c01\u9876 \u5728\u505c\u6b62Prometheus\u670d\u52a1\u65f6\uff0c\u4e3b\u673a\u8d1f\u8f7d\u77ac\u95f4\u98da\u9ad8\uff0c\u9020\u6210VM\u5361\u4f4f\uff0c\u6700\u540e\u91cd\u542f\u6062\u590d \u9650\u5236Prometheus\u5bb9\u5668\u5185\u5b584G 14\u8282\u70b9=15.5kQPS\uff0c\u5185\u5b58~=3.9G\uff0c\u5bb9\u5668\u5185\u5b58\u57fa\u672c\u6253\u6ee1\uff0c\u51fa\u73b0\u670d\u52a1\u4e0d\u7a33\u5b9a\uff0c\u6267\u884c\u67e5\u8be2\u65f6\u95f4\u53d8\u957f\uff0cQPS\u7a81\u7136\u4e0b\u964d\uff0c\u4e3b\u673a\u8d1f\u8f7d\u5f00\u59cb\u5347\u9ad8\uff0c\u4ece0.x\u5347\u52304\uff0c\u5927\u91cf\u78c1\u76d8IO \u964d\u4f4e\u8282\u70b9\u6570\u523012\u540e\uff0c\u4e3b\u673a\u78c1\u76d8\u4e0b\u964d\uff0c\u670d\u52a1\u6062\u590d\u6b63\u5e38\uff0c\u4f46\u662f\u5185\u5b58\u672a\u91ca\u653e \u7ed3\u8bba\uff1a Prometheus\u662f\u4ee5Go\u8bed\u8a00\u5f00\u53d1\uff0c\u6240\u4ee5\u5e76\u53d1\u6027\u80fd\u975e\u5e38\u5f3a\uff0c\u4f46\u662f\u4ee5\u6d88\u8017\u5185\u5b58\u4e3a\u4ee3\u4ef7 \u5355\u5b9e\u4f8b4G\u7684Prom\u80fd\u652f\u649112.5K\u7684QPS \u5f53\u51fa\u73b0\u67e5\u8be2\u5361\u987f\u65f6\uff0c\u53ef\u4ee5\u5224\u65ad\u91c7\u96c6\u670d\u52a1\u51fa\u73b0\u95ee\u9898 \u5728\u5b9e\u9645\u4f7f\u7528\u4e2d\uff0c\u5fc5\u987b\u9650\u5236\u5185\u5b58\uff0c\u5426\u5219\u4f1a\u5403\u5149 \u6062\u590d\u7b56\u7565\u5efa\u8bae\uff1a\u4e0d\u8981\u6062\u590d\u539f\u5b9e\u4f8b\uff0c\u4ee5\u4e22\u5931\u539f\u6570\u636e\u4e3a\u4ee3\u4ef7\uff0c\u5f00\u4e00\u4e2a\u65b0\u5b9e\u4f8b","title":"Prometheus \u4f7f\u7528\u624b\u518c"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#prometheus","text":"","title":"Prometheus \u4f7f\u7528\u624b\u518c"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_1","text":"\u5b98\u7f51 \u4e2d\u6587\u6559\u7a0b \u538b\u6d4b\u65b9\u6848","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_2","text":"\u9ad8\u53ef\u7528\uff1a \u53ccServer\u5b9e\u4f8b\u6a21\u578b \u53ccAlertManager+Nginx\u7684LB \u6570\u636e\u5b58\u50a8\u7b56\u7565\uff1a\u51b7\u70ed\u5206\u79bb 2\u5468\u5185\u6570\u636e\uff1aPrometheus-Server\u7684\u672c\u5730\u5b58\u50a8 2\u5468\u4ee5\u5916\u6570\u636e\uff1a\u8fdc\u7a0b\u5199\u5165ES \u652f\u6301\u544a\u8b66\u89c4\u5219\u52a8\u6001\u52a0\u8f7d\uff1a \u57fa\u4e8e\u8054\u90a6\u6a21\u578b\uff0c\u89c4\u5219\u52a0\u8f7d\u5728\u4e0a\u5c42Prometheus-Server\u4e0b\uff0c\u5b9e\u73b0\u84dd\u7eff\u5207\u6362 \u544a\u8b66\u89c4\u5219\u5b58\u50a8\u5728git\u4e2d\uff0c\u5b9a\u671f\u68c0\u67e5\u66f4\u65b0 graph TD Alertmanager\u96c6\u7fa4 -->|\u63a5\u6536| Prometheus1 Alertmanager\u96c6\u7fa4 -->|\u63a5\u6536| Prometheus2 Prometheus1 -->|\u62c9| PushGateway Prometheus1 -->|\u62c9| Exporter Prometheus2 --> PushGateway Prometheus2 --> Exporter Prometheus2 -->|\u8fdc\u7a0b\u5199| Kafka Kafka -->|logstash\u6d88\u8d39| ES","title":"\u67b6\u6784"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_3","text":"","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_4","text":"\u5347\u7ea7yum\u6e90\uff0c\u53c2\u8003\uff1a https://developer.aliyun.com/mirror/centos \u914d\u7f6e\u65f6\u95f4ntp\u540c\u6b65\uff0cTSDB\u6838\u5fc3\u6307\u6807 \u9002\u914ddocker\uff0c\u5347\u7ea7\u5185\u6838\uff0c \u53c2\u8003 \u5b89\u88c5docker-ce\uff0c \u53c2\u8003","title":"\u73af\u5883\u51c6\u5907"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_5","text":"# \u5728\"/opt/prometheus\"\u4e0b\u751f\u6210\u914d\u7f6eprometheus.yml global: scrape_interval: 15s # \u91c7\u96c6\u95f4\u9694\u65f6\u95f4 evaluation_interval: 15s # \u6267\u884c\u89c4\u5219\u7684\u95f4\u9694\u65f6\u95f4 rule_files: # \u52a0\u8f7d\u89c4\u5219 - \"first.rules.yml\" # \u9002\u914d\u4e0b\u6587\u7684\u81ea\u5b9a\u4e49Metric - \"alert_example.rules.yml\" # \u9002\u914d\u4e0b\u6587\u7684\u81ea\u5b9a\u4e49\u544a\u8b66 scrape_configs: # \u76d1\u63a7\u76ee\u6807 - job_name: prometheus static_configs: - targets: ['localhost:9090'] # \u9ed8\u8ba4\u91c7\u96c6HTTP\u5730\u5740\uff1ahttp://localhost:9090/metrics - job_name: node # \u9002\u914d\u4e0b\u65b9\u7684\u4e3b\u673a\u8282\u70b9\u76d1\u63a7 scrape_interval: 5s # \u8986\u76d6\u5168\u5c40\u53d8\u91cf file_sd_configs: # \u8bfb\u670d\u52a1\u53d1\u73b0\u76ee\u6807\u6587\u4ef6\uff0c\u652f\u6301*\u901a\u914d\u7b26\uff0c\u9002\u914d\u4e0b\u6587\u670d\u52a1\u53d1\u73b0 - files: - sd_config.json refresh_interval: 10m # 10\u5206\u949f\u6267\u884c\u4e00\u6b21\u53d1\u73b0\uff0c\u9ed8\u8ba45m static_configs: - targets: ['\u5bbf\u4e3b\u673aIP:9100'] # \u5982\u679cserver\u662fdocker\u542f\u52a8\uff0c\u8fd9\u91cc\u9700\u8981\u660e\u786eip labels: group: 'dev' # \u81ea\u5b9a\u4e49\u6807\u7b7e\uff0cdev\u7ec4 # \u5bf9\u63a5Alertmanager alerting: alertmanagers: - static_configs: - targets: - '\u5bbf\u4e3b\u673aIP:9093'","title":"\u914d\u7f6e"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_6","text":"# \u6307\u5b9a\u914d\u7f6e\u8def\u5f84\uff0c\u66b4\u97329090\u7aef\u53e3\uff0c\u9650\u5236\u6700\u5927\u5185\u5b58\uff0c\u6570\u636e\u4fdd\u75597\u5929 docker run -d --name=prometheus \\ -m 4G \\ --restart=always \\ -p 9090:9090 \\ -v /opt/prometheus:/etc/prometheus \\ prom/prometheus:v2.19.3 # \u5e26\u53c2\u6570\u542f\u52a8 docker run \\ --name=prometheus \\ --volume=/opt/prometheus:/etc/prometheus \\ --volume=/prometheus \\ -p 9090:9090 \\ --restart=always \\ --detach=true prom/prometheus:v2.19.3 \\ --storage.tsdb.retention.time=7d \\ --config.file=/etc/prometheus/prometheus.yml \\ --storage.tsdb.path=/prometheus \\ --web.console.libraries=/usr/share/prometheus/console_libraries \\ --web.console.templates=/usr/share/prometheus/consoles","title":"\u542f\u52a8"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_7","text":"","title":"\u4f7f\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#node-exporter","text":"# \u4e0b\u8f7d\u7ec4\u4ef6 wget https://github.com/prometheus/node_exporter/releases/download/v1.0.1/node_exporter-1.0.1.linux-amd64.tar.gz # \u89e3\u538b\u540e\u542f\u52a8 tar xvfz node_exporter-1.0.1.linux-amd64.tar.gz mv node_exporter-1.0.1.linux-amd64/ node_exporter cd node_exporter/ nohup ./node_exporter & \u6ce8\u610f\uff1a\u5173\u95ed\u4e3b\u673a\u4e0a\u9632\u706b\u5899 systemctl stop firewalld","title":"\u4e3b\u673aNode Exporter"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#metric","text":"\u9002\u7528\u4e8e\u539f\u6709\u6570\u636e\u7684\u9884\u8ba1\u7b97\u3002 # \u5728\"/opt/prometheus\"\u4e0b\u751f\u6210yml\u89c4\u5219\u6587\u4ef6 first.rules.yml groups: - name: cpu-node rules: - record: job_instance_mode:node_cpu_seconds:avg_rate5m # \u6bcf\u79d2CPU\u65f6\u95f4\u901f\u7387\uff0c\u6309\u7167job\u3001\u5b9e\u4f8b\u3001\u6a21\u5f0f\u533a\u5206\uff0c5\u5206\u949f\u5747\u503c expr: avg by (job, instance, mode) (rate(node_cpu_seconds_total[5m])) # \u9a8c\u8bc1\u89c4\u5219\u6587\u4ef6\u662f\u5426\u6b63\u786e promtool check rules first.rules.yml \u9875\u9762\u6548\u679c\u5982\u4e0b","title":"\u81ea\u5b9a\u4e49Metric"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_8","text":"# \u5728\u914d\u7f6e\u76ee\u5f55\u4e0b\u5b9a\u4e49\u544a\u8b66\u89c4\u5219\u6587\u4ef6 alert_example.rules.yml groups: - name: alert_example rules: - alert: node_cpu_seconds_avg_rate5m expr: job_instance_mode:node_cpu_seconds:avg_rate5m > 0.5 for: 2m labels: alert_label: demo annotations: summary: \"Test Alert: {{ $labels.instance }}\" description: \"\u6d4b\u8bd5 {{ $labels.instance }} of job {{ $labels.job }} has been > 0.5\" \u5728Prometheus\u7684conf\u4e2d\u542f\u7528\uff0c\u6548\u679c\u5982\u4e0b","title":"\u81ea\u5b9a\u4e49\u544a\u8b66"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_9","text":"// \u5728\u914d\u7f6e\u76ee\u5f55\u4e0b\u5b9a\u4e49\u76d1\u63a7\u670d\u52a1\u76ee\u6807\u7684 sd_config.json [ { \"targets\": [\"10.10.0.106:9100\"], \"labels\": { \"env\": \"dev\", \"job\": \"slaver\" // \u4f1a\u8986\u76d6\u4e0a\u5c42label } } ] \u5728Prometheus\u7684conf\u4e2d\u542f\u7528\uff0c\u6548\u679c\u5982\u4e0b","title":"\u670d\u52a1\u53d1\u73b0\u57fa\u4e8e\u6587\u4ef6"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#promql","text":"# \u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\uff1a\u6309\u7167bu, product\u7ef4\u5ea6\u533a\u5206\uff0c\u8ba1\u7b97\u6307\u6807\u548c sum(es_inte_applog_error_count_group_by_servername_last_min) by (bu, product) # \u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\uff1a\u6309\u7167bu, product\u7ef4\u5ea6\u533a\u5206\uff0c\u8ba1\u7b97\u6307\u6807\u548c\uff0c5\u5206\u949f\u524d\u7684\u6570\u636e sum(es_inte_applog_error_count_group_by_servername_last_min offset 5m) by (bu, product) # \u8ba1\u7b97\u6307\u6807\u4e2a\u6570 count(es_inte_applog_error_count_group_by_servername_last_min) # \u533a\u95f4\u5411\u91cf\u8868\u8fbe\u5f0f\uff1a\u53ea\u80fd\u7528\u4e8e\u8868\u683c\uff0c\u83b7\u53d6\u6307\u5b9a\u6307\u6807 5\u5206\u949f\u5185\u7684\u6240\u6709\u6837\u672c\u6570\u636e es_inte_applog_error_count_group_by_servername_last_min{product=\"INS\"}[5m] # \u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\uff1a\u83b7\u53d6\u6307\u5b9a\u6307\u6807 5\u5206\u949f\u5185\u7684\u6240\u6709\u6837\u672c\u6570\u636e\u4e4b\u548c sum_over_time(range-vector)\uff1a\u6307\u5b9a\u65f6\u95f4\u95f4\u9694\u5185\u6240\u6709\u503c\u7684\u603b\u548c sum_over_time(es_inte_applog_error_count_group_by_servername_last_min{product=\"INS\"}[5m]) # \u77ac\u65f6\u5411\u91cf \u6309\u4e1a\u52a1\u7ebf\u533a\u5206\uff0c\u67d0\u6307\u6807\u7684\u5e73\u57471\u5206\u949f\u5185\u548c\uff0c\u7531\u4e8ePrometheus15\u79d2pull\u6b21\uff0c\u4f1a\u5bfc\u81f41\u5206\u949f\u5185\u6307\u6807\u8bfb4\u6b21\uff084\u4e2a\u70b9\uff09\uff0c\u6240\u4ee5\u7528avg_over_time\u53d6\u533a\u95f4\u5747\u503c sum(avg_over_time(es_inte_applog_error_count_group_by_servername_last_min[1m])) by (bu) # \u8ba1\u7b97\u5e73\u57471\u5206\u949f\uff0c2xx\u5728\u603b\u91cf\u4e2d\u7684% sum(avg_over_time(es_prod_accesslog_status_count_group_by_host_last_min{status=~'2.+'}[1m])) /sum(avg_over_time(es_prod_accesslog_status_count_group_by_host_last_min[1m]))","title":"\u5e38\u7528PromQL\u4e3e\u4f8b"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/prometheus/#_10","text":"\u6d4b\u8bd5\u4e3b\u673a\u914d\u7f6e\uff1a4C8G \u4e0d\u9650\u5236docker\u5185\u5b58 \u538b\u6d4b\u523022\u4e2aavalanche\u5b9e\u4f8b\u65f6\uff0c\u8fbe\u523024k\u7684QPS\uff0c\u5185\u5b58\u5360\u75287.7G\uff0c\u968f\u540e\u5361\u673a \u4e3b\u673aCPU\u8d1f\u8f7d\u4e0d\u5927\uff0c\u5185\u5b58\u5360\u7528\u6301\u7eed\u589e\u52a0\uff0c\u4e0a\u4e0d\u5c01\u9876 \u5728\u505c\u6b62Prometheus\u670d\u52a1\u65f6\uff0c\u4e3b\u673a\u8d1f\u8f7d\u77ac\u95f4\u98da\u9ad8\uff0c\u9020\u6210VM\u5361\u4f4f\uff0c\u6700\u540e\u91cd\u542f\u6062\u590d \u9650\u5236Prometheus\u5bb9\u5668\u5185\u5b584G 14\u8282\u70b9=15.5kQPS\uff0c\u5185\u5b58~=3.9G\uff0c\u5bb9\u5668\u5185\u5b58\u57fa\u672c\u6253\u6ee1\uff0c\u51fa\u73b0\u670d\u52a1\u4e0d\u7a33\u5b9a\uff0c\u6267\u884c\u67e5\u8be2\u65f6\u95f4\u53d8\u957f\uff0cQPS\u7a81\u7136\u4e0b\u964d\uff0c\u4e3b\u673a\u8d1f\u8f7d\u5f00\u59cb\u5347\u9ad8\uff0c\u4ece0.x\u5347\u52304\uff0c\u5927\u91cf\u78c1\u76d8IO \u964d\u4f4e\u8282\u70b9\u6570\u523012\u540e\uff0c\u4e3b\u673a\u78c1\u76d8\u4e0b\u964d\uff0c\u670d\u52a1\u6062\u590d\u6b63\u5e38\uff0c\u4f46\u662f\u5185\u5b58\u672a\u91ca\u653e \u7ed3\u8bba\uff1a Prometheus\u662f\u4ee5Go\u8bed\u8a00\u5f00\u53d1\uff0c\u6240\u4ee5\u5e76\u53d1\u6027\u80fd\u975e\u5e38\u5f3a\uff0c\u4f46\u662f\u4ee5\u6d88\u8017\u5185\u5b58\u4e3a\u4ee3\u4ef7 \u5355\u5b9e\u4f8b4G\u7684Prom\u80fd\u652f\u649112.5K\u7684QPS \u5f53\u51fa\u73b0\u67e5\u8be2\u5361\u987f\u65f6\uff0c\u53ef\u4ee5\u5224\u65ad\u91c7\u96c6\u670d\u52a1\u51fa\u73b0\u95ee\u9898 \u5728\u5b9e\u9645\u4f7f\u7528\u4e2d\uff0c\u5fc5\u987b\u9650\u5236\u5185\u5b58\uff0c\u5426\u5219\u4f1a\u5403\u5149 \u6062\u590d\u7b56\u7565\u5efa\u8bae\uff1a\u4e0d\u8981\u6062\u590d\u539f\u5b9e\u4f8b\uff0c\u4ee5\u4e22\u5931\u539f\u6570\u636e\u4e3a\u4ee3\u4ef7\uff0c\u5f00\u4e00\u4e2a\u65b0\u5b9e\u4f8b","title":"\u6027\u80fd\u538b\u6d4b\u62a5\u544a"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/","text":"Prometheus Pushgateway \u7b80\u4ecb \u53c2\u8003 \u5b98\u65b9\u6e90\u7801 https://github.com/prometheus/pushgateway \u5b98\u65b9sdk https://github.com/prometheus/client_python Prometheus\u624b\u518c \u5b89\u88c5 docker pull prom/pushgateway:v1.2.0 # web.enable-admin-api\u542f\u7528admin\u63a5\u53e3 docker run -d \\ --name=pushgateway \\ -p 9091:9091 \\ prom/pushgateway:v1.2.0 --web.enable-admin-api # \u6d4b\u8bd5 curl --location --request GET 'http://0.0.0.0:9091/metrics' \u63a5\u5165Prometheus \u53c2\u8003\u624b\u518c\uff0c\u5728\u670d\u52a1\u53d1\u73b0\u914d\u7f6e sd_config.json \u4e2d\u5199\u5165\u5f53\u524dpushgateway\u5b9e\u4f8b \u4f7f\u7528 \u5199\u5165\u548c\u66f4\u65b0 # \u751f\u6210Metric\uff0c\u6307\u5b9ajob\uff0c\u53ef\u9009\u6307\u5b9ainstance\uff0c\u5b9a\u4e49type\uff0c\u53ef\u9009\u52a0\u5165help\u8bf4\u660e\uff0c\u81ea\u5b9a\u4e49label\uff0c\u5fc5\u987b\u56de\u8f66\u6536\u5c3e\uff0c\u652f\u6301\u6279\u91cf\u751f\u6210 curl --location --request POST 'http://10.10.0.140:9091/metrics/job/some_job/instance/some_instance' \\ --header 'Content-Type: text/plain' \\ --data-raw ' # TYPE some_metric counter # HELP some_metric Just an example. some_metric{label=\"val1\"} 42 ' # \u5220\u9664\u6307\u5b9aMetric curl --location --request DELETE 'http://10.10.0.140:9091/metrics/job/some_job/instance/some_instance' python\u63a8\u9001\u6307\u6807\u8fdbPushgateway \u5b89\u88c5\u5e93 pip install prometheus_client from prometheus_client import CollectorRegistry, Gauge, push_to_gateway registry = CollectorRegistry() # \u53c2\u6570\u4f9d\u6b21: \u552f\u4e00Metric\uff0c\u89e3\u91ca\u8bf4\u660e\uff0c\u4e4b\u524d\u5b9a\u4e49\u7684\u6ce8\u518c\u8868\u5b9e\u4f8b g = Gauge('job_last_success_unixtime', 'Last time a batch job successfully finished', registry=registry) g.set_to_current_time() push_to_gateway('10.10.0.140:9091', job='batchA', registry=registry) \u67e5\u8be2 # \u83b7\u53d6\u670d\u52a1\u5b9e\u4f8bstatus curl --location --request GET 'http://10.10.0.140:9091/api/v1/status' # \u83b7\u53d6\u6240\u6709Metric\uff0c\u53cd\u9988json curl --location --request GET 'http://10.10.0.140:9091/api/v1/metrics' # \u67e5\u8be2\u5b9e\u4f8b\u5065\u5eb7\u72b6\u6001 curl --location --request GET 'http://10.10.0.140:9091/-/healthy'","title":"Prometheus Pushgateway \u7b80\u4ecb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/#prometheus-pushgateway","text":"","title":"Prometheus Pushgateway \u7b80\u4ecb"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/#_1","text":"\u5b98\u65b9\u6e90\u7801 https://github.com/prometheus/pushgateway \u5b98\u65b9sdk https://github.com/prometheus/client_python Prometheus\u624b\u518c","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/#_2","text":"docker pull prom/pushgateway:v1.2.0 # web.enable-admin-api\u542f\u7528admin\u63a5\u53e3 docker run -d \\ --name=pushgateway \\ -p 9091:9091 \\ prom/pushgateway:v1.2.0 --web.enable-admin-api # \u6d4b\u8bd5 curl --location --request GET 'http://0.0.0.0:9091/metrics'","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/#prometheus","text":"\u53c2\u8003\u624b\u518c\uff0c\u5728\u670d\u52a1\u53d1\u73b0\u914d\u7f6e sd_config.json \u4e2d\u5199\u5165\u5f53\u524dpushgateway\u5b9e\u4f8b","title":"\u63a5\u5165Prometheus"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/#_3","text":"","title":"\u4f7f\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/#_4","text":"# \u751f\u6210Metric\uff0c\u6307\u5b9ajob\uff0c\u53ef\u9009\u6307\u5b9ainstance\uff0c\u5b9a\u4e49type\uff0c\u53ef\u9009\u52a0\u5165help\u8bf4\u660e\uff0c\u81ea\u5b9a\u4e49label\uff0c\u5fc5\u987b\u56de\u8f66\u6536\u5c3e\uff0c\u652f\u6301\u6279\u91cf\u751f\u6210 curl --location --request POST 'http://10.10.0.140:9091/metrics/job/some_job/instance/some_instance' \\ --header 'Content-Type: text/plain' \\ --data-raw ' # TYPE some_metric counter # HELP some_metric Just an example. some_metric{label=\"val1\"} 42 ' # \u5220\u9664\u6307\u5b9aMetric curl --location --request DELETE 'http://10.10.0.140:9091/metrics/job/some_job/instance/some_instance'","title":"\u5199\u5165\u548c\u66f4\u65b0"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/#pythonpushgateway","text":"\u5b89\u88c5\u5e93 pip install prometheus_client from prometheus_client import CollectorRegistry, Gauge, push_to_gateway registry = CollectorRegistry() # \u53c2\u6570\u4f9d\u6b21: \u552f\u4e00Metric\uff0c\u89e3\u91ca\u8bf4\u660e\uff0c\u4e4b\u524d\u5b9a\u4e49\u7684\u6ce8\u518c\u8868\u5b9e\u4f8b g = Gauge('job_last_success_unixtime', 'Last time a batch job successfully finished', registry=registry) g.set_to_current_time() push_to_gateway('10.10.0.140:9091', job='batchA', registry=registry)","title":"python\u63a8\u9001\u6307\u6807\u8fdbPushgateway"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/prometheus/pushgateway/#_5","text":"# \u83b7\u53d6\u670d\u52a1\u5b9e\u4f8bstatus curl --location --request GET 'http://10.10.0.140:9091/api/v1/status' # \u83b7\u53d6\u6240\u6709Metric\uff0c\u53cd\u9988json curl --location --request GET 'http://10.10.0.140:9091/api/v1/metrics' # \u67e5\u8be2\u5b9e\u4f8b\u5065\u5eb7\u72b6\u6001 curl --location --request GET 'http://10.10.0.140:9091/-/healthy'","title":"\u67e5\u8be2"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/","text":"\u84dd\u9cb8\u667a\u4e91\u914d\u7f6e\u5e73\u53f0(BlueKing CMDB) \u672c\u6587\u5728\u84dd\u9cb8cmdb v3.9.5 \u4e0a\u9a8c\u8bc1\u901a\u8fc7\u3002 \u5b89\u88c5 \u76ee\u5f55\u548c\u67b6\u6784 Web\u5c55\u793a\u5c42 cmdb_webserver API\u7f51\u5173\u5c42 cmdb_apiserver \u670d\u52a1\u5c42 \u539f\u5b50\u4e1a\u52a1\u5c42 cmdb_adminserver \u914d\u7f6e\u5237\u65b0\u3001\u521d\u59cb\u5316\u6570\u636e\u5199\u5165\u7b49 cmdb_eventserver \u4e8b\u4ef6\u8ba2\u9605\u4e0e\u63a8\u9001 cmdb_procserver \u7cfb\u7edf\u8fdb\u7a0b cmdb_toposerver \u62d3\u6251\u6a21\u578b cmdb_hostserver \u4e3b\u673a cmdb_datacollection \u7cfb\u7edf\u5feb\u7167\u6570\u636e\u7684\u91c7\u96c6 cmdb_operationserver \u8fd0\u8425\u7edf\u8ba1\u76f8\u5173 cmdb_synchronizeserver \u6570\u636e\u540c\u6b65 cmdb_taskserver \u5f02\u6b65\u4efb\u52a1\u7ba1\u7406 \u8d44\u6e90\u7ba1\u7406\u5c42 cmdb_coreservice \u5b58\u50a8\u5c42 /data/sidecar/{mongodb,redis} \uff0c\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u3001\u6d88\u606f\u961f\u5217\u4ee5\u53ca\u7f13\u5b58 \u670d\u52a1\u6ce8\u518c\u53d1\u73b0 /data/sidecar/zookeeper Docker\u4e00\u952e\u5b89\u88c5 docker run -d \\ --name=cmdb \\ --restart=always \\ -v /Users/jeffchen/bak:/tmp/export \\ -p 8090:8090 \\ -p 18080:8080 \\ ccr.ccs.tencentyun.com/bk.io/cmdb-standalone:v3.9.5 \u9ed8\u8ba4\u914d\u7f6e\uff1a zk 127.0.0.1:2181 mongo cc:cc@127.0.0.1:27017 \uff0cdb cmdb redis 127.0.0.1:6379 \uff0cpw cc web\u8bbf\u95ee http://127.0.0.1:8090/ \uff0c\u9ed8\u8ba4\u7528\u6237 admin \uff0c\u4e0d\u7528\u5bc6\u7801 \u5185\u90e8 8080 \u7aef\u53e3\u662fapi\u670d\u52a1 /tmp/export \u662fmongo\u5bfc\u51fa\u6570\u636e\u7684\u76ee\u5f55 \u4f7f\u7528 \u4e1a\u52a1\u5efa\u6a21 \u5e38\u89c1\u540d\u8bcd\u89e3\u91ca\uff1a \u4e1a\u52a1 \uff0c\u6307\u516c\u53f8\u5185\u90e8\u7684\u4e00\u4e2a\u9879\u76ee\u6216\u8005\u4ea7\u54c1\uff0c\u5f80\u5f80\u662f\u4e00\u7ec4\u76f8\u5173\u670d\u52a1\uff08\u5982\uff1alb+web+db\uff09\u7684\u603b\u4f53\u4ee3\u8868\uff0c\u662f\u4e1a\u52a1\u7ebf\u7684\u6700\u5c0f\u7ec4\u6210\u5355\u5143\uff0c\u6709\u5b8c\u6574\u751f\u547d\u5468\u671f\u3002 \u96c6\u7fa4 \uff0c\u5982\u679c\u8bf4\u4e1a\u52a1\u662f\u7eb5\u5411\u6982\u5ff5\uff0c\u90a3\u4e48\u96c6\u7fa4\u5c31\u662f\u6a2a\u5411\u6982\u5ff5\uff0c\u4ee3\u8868\u7a7a\u95f4\u533a\u57df\u7684\u9694\u79bb\uff0c\u5982\uff1a\u6d4b\u8bd5\u96c6\u7fa4\uff08\u53ef\u80fd\u516c\u53f8\u5185\u7f51\uff09\u4e2d\u7684\u670d\u52a1\u4e0d\u5e94\u8be5\u8bbf\u95ee\u751f\u4ea7\u96c6\u7fa4\uff08\u90e8\u7f72\u5728\u516c\u7f51\u4e91\u4e0a\uff09\u7684\u63a5\u53e3\uff0c\u96c6\u7fa4\u662f\u53ef\u4ee5\u6269\u7f29\u5bb9\u7684\uff0c\u662f\u9ad8\u53ef\u7528\u7684\u57fa\u77f3\uff0c\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u6765\u770b\uff0cK8s\u4f53\u7cfb\u4e2d\u7684Pod\u6982\u5ff5\u5c31\u662f\u6700\u5c0f\u7684\u96c6\u7fa4\u3002 \u6a21\u5757 \uff0c\u662f\u5404\u79cd\u5e94\u7528\u548c\u670d\u52a1\u7684\u62bd\u8c61\uff1a\u516c\u53f8\u81ea\u7814\u7684App\u3001Web\u662f\u4e00\u79cd\u6a21\u5757\uff0c\u6570\u636e\u5e93\u3001\u4e2d\u95f4\u4ef6\u670d\u52a1\u4e5f\u662f\u4e00\u79cd\u6a21\u5757\u3002\u6bcf\u4e2a\u6a21\u5757\u90fd\u5e94\u8be5\u6709\u5bf9\u5e94\u7684\u8d1f\u8d23\u4eba\u3002 \u4e3b\u673a \uff0c\u548c\u4f20\u7edf\u8ba4\u77e5\u4e0a\u7684\u670d\u52a1\u5668\u6709\u4e9b\u533a\u522b\uff0c\u66f4\u63a5\u8fd1Docker\u7684\u5b9e\u4f8b\u6982\u5ff5\uff1a\u6709IP\u5730\u5740\u3001CPU\u6838\u6570\u3001\u5185\u5b58\u548c\u78c1\u76d8\u5bb9\u91cf\u3001OS\u7248\u672c\u3001\u8fd0\u884c\u72b6\u6001\uff0c\u5728\u8fd9\u4e9b\u57fa\u7840\u4e0a\u518d\u6269\u5145\u5176\u4ed6\u975e\u5fc5\u8981\u5c5e\u6027\uff0c\u5982\uff1a\u8d44\u4ea7\u7f16\u53f7\uff0c\u6240\u5c5e\u533a\u57df\u7b49\u3002 \u5efa\u6a21\u987a\u5e8f\uff1a \u90e8\u95e8-\u5458\u5de5 \uff0c\u57fa\u7840\u5b57\u5178\uff0c\u662f\u5176\u4ed6\u6a21\u578b\u4e2d\u4eba\u5458\u76f8\u5173\u5c5e\u6027\u7684\u9009\u62e9\u5217\u8868\u6570\u636e\u6e90\uff0c\u7531\u4e8e\u5f00\u6e90\u7248\u9609\u5272\u4e86\u7528\u6237\u7ba1\u7406\u7684\u529f\u80fd\uff0c\u8003\u8651\u7528 \u5173\u8054\u5173\u7cfb \u4ee3\u66ff\u3002 \u5bfc\u5165 \u4e3b\u673a \u8fdb\u8d44\u6e90\u6c60 \u65b0\u5efa \u6a21\u5757 \uff0c\u6709\u8d1f\u8d23\u4eba\uff0c\u81ea\u7814\u670d\u52a1\u6709\u5bf9\u5e94\u7684git\u5730\u5740 \u4e1a\u52a1 \uff0c\u516c\u53f8\u7684\u4ea7\u54c1\uff0c\u6240\u5c5e\u90e8\u95e8\u3001\u5bf9\u5e94\u7684\u8d1f\u8d23\u4eba\u3001\u5f53\u524d\u751f\u547d\u5468\u671f\uff08\u9ed8\u8ba4\uff1a\u4e0a\u7ebf\uff09 \u5728 \u4e1a\u52a1\u62d3\u6251 \u754c\u9762\uff0c\u6bcf\u4e2a\u4e1a\u52a1\u4e0b\u5efa\u7acb\u5bf9\u5e94\u7684 \u96c6\u7fa4-\u6a21\u5757 \u6743\u9650\u8ba4\u8bc1 Docker\u7248\u670d\u52a1\u9ed8\u8ba4\u4e0d\u5f00\u542f\u6743\u9650\uff0c\u76f4\u63a5\u4ee5admin\u64cd\u4f5c\uff0c\u975e\u5e38\u4e0d\u5b89\u5168\uff0c\u89e3\u51b3\u65b9\u6848\u67092\u79cd\uff1a \u4f7f\u7528\u539f\u751f\u670d\u52a1\uff1a\u84dd\u9cb8\u201c\u5168\u5bb6\u6876\u201d\u4e2d\u7684 PaaS\u5e73\u53f0 \uff0c\u8bf7\u770b\u5b98\u65b9\u6587\u6863 \u7528\u81ea\u5df1\u7684\u670d\u52a1\u5c01\u88c5\u4e00\u5c42\uff0c\u5927\u81f4\u601d\u8def\u5982\u4e0b\uff1a cmdb\u5b9e\u4f8b\u548c\u5176\u4ed6DB\u4e00\u6837\uff0c\u90e8\u7f72\u5728\u5185\u90e8\u5b89\u5168\u7f51\u7edc\u4e2d\uff0c\u4e0d\u5141\u8bb8\u5916\u90e8\u76f4\u63a5\u8bbf\u95ee \u53ea\u4fe1\u4efb\u4ece\u6307\u5b9a\u7f51\u5173\u5730\u5740\u8fc7\u6765\u7684\u8bbf\u95ee\uff0c\u5b9e\u8d28\u662f\u628a\u6743\u9650\u89e3\u8026\uff0c\u6258\u7ba1\u7ed9\u4e0a\u6e38\uff0c\u53c2\u8003 \u8fd9\u4e00\u7bc7\u6587\u7ae0\u8be6\u7ec6\u4ecb\u7ecd \u3002 \u63a5\u53e3\u8c03\u7528 \u6ce8\u610f\u4e8b\u9879: \u5728\u8bf7\u6c42head\u4e2d\u6dfb\u52a0 BK_USER=admin;HTTP_BLUEKING_SUPPLIER_ID=0 \uff0c\u5426\u5219\u4f1a\u62a5\u9519 [user]\u6388\u6743\u4fe1\u606f\u67e5\u8be2\u5931\u8d25 api\u5f53\u524d\u7248\u672c v3 \uff0c\u5efa\u8bae\u76f4\u63a5\u770bgithub\u4e0a docs/apidoc/v3.1 \u4e0b\u7684\u6587\u6863\uff0c\u5b98\u7f51\u4e0a\u7684\u6709\u70b9\u8fc7\u671f \u5efa\u8bae\u4f7f\u7528api_server\u7684\u7aef\u53e3\uff0c\u9700\u8981\u5bf9\u5916\u66b4\u9732 # \u67e5\u8be2\u4e3b\u673a\u5217\u8868\uff0c\u9ed8\u8ba4\u7a7a\u5e93 curl --location --request POST 'http://0.0.0.0:18080/api/v3/hosts/search' \\ --header 'HTTP_BLUEKING_SUPPLIER_ID: 0' \\ --header 'BK_USER: admin' \u53cd\u9988: { \"result\": true, \"bk_error_code\": 0, \"bk_error_msg\": \"success\", \"permission\": null, \"data\": { \"count\": 0, \"info\": [] } } \u6570\u636e\u5907\u4efd\u548c\u6062\u590d mongo\u5907\u4efdcmdb: docker exec -it cmdb /data/sidecar/mongodb/bin/mongodump --host 127.0.0.1 --port 27017 --out /tmp/export --db cmdb \u6253\u5305\u538b\u7f29 tar -czvf cmdb.tar.gz /tmp/export/cmdb/ \u4ece\u5907\u4efd\u6062\u590d\uff08\u5728mongo/bin\u76ee\u5f55\uff09: 1. docker exec -it cmdb /data/sidecar/mongodb/bin/mongorestore -h 127.0.0.1:27017 -d cmdb /tmp/export/cmdb/ \u5751: docker\u7248\u9ed8\u8ba4\u4f1a\u521d\u59cb\u5316db\uff0c\u5199\u5165\u90e8\u5206\u4e1a\u52a1\u6a21\u578b\uff0c\u5bfc\u81f4\u4ece\u5907\u4efd\u5bfc\u5165\u540e\uff0c\u51fa\u73b0\u91cd\u590d\u8bb0\u5f55 \u5bf9\u63a5\u5bc6\u7801\u7ba1\u7406 \u7531\u4e8ecmdb\u6709\u5bf9\u63a5\u5916\u90e8\u7cfb\u7edf\u7684\u9700\u6c42\uff0c\u4e00\u4e9bci\u7684\u8d26\u53f7\u4fe1\u606f\u4e0d\u9002\u5408\u76f4\u63a5\u660e\u6587\u5b58\u50a8\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u89e3\u51b3\u601d\u8def\uff0c\u4f9b\u53c2\u8003\uff1a KeePassXC \u4e00\u79cd\u5b89\u5168\u5f00\u6e90\\\u8de8\u5e73\u53f0\u7684\u5bc6\u7801\u52a0\u5bc6\u3001\u5b58\u7ba1\u5de5\u5177 ci\u8bb0\u5f55\u7684\u5bc6\u7801\u5c5e\u6027\u4fe1\u606f\u5b58\u5165KeePassXC\u7ba1\u7406\u7684.kdbx\u52a0\u5bc6\u5e93\u4e2d \u57fa\u4e8epy\u5e93 pykeepass \u6784\u5efa\u5bc6\u7801\u67e5\u8be2\u63a5\u53e3\uff0c\u5165\u53c2(ci\u5206\u7c7b, ci.id, [\u5c5e\u6027kv])\uff0c\u53cd\u9988\u89e3\u5bc6\u540e\u7684\u62a5\u6587\uff08\u5982\uff1a\u5bc6\u7801\uff09 \u5728\u4e1a\u52a1\u6d41\u7a0b\u5f00\u53d1\u65f6\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u63a5\u53e3\uff0c\u8bfb\u53d6\u5bc6\u7801 TODO \u4e3b\u673a\u4fe1\u606f\u81ea\u52a8\u91c7\u96c6\u548c\u6ce8\u518c \u5bf9\u63a5\u7edf\u4e00\u670d\u52a1\u5e73\u53f0\u5165\u53e3 \u53c2\u8003 github\u6e90\u7801 https://github.com/Tencent/bk-cmdb \u5b98\u7f51\u6587\u6863 https://bk.tencent.com/docs/document/5.1/9/222","title":"\u84dd\u9cb8\u667a\u4e91\u914d\u7f6e\u5e73\u53f0(BlueKing CMDB)"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#blueking-cmdb","text":"\u672c\u6587\u5728\u84dd\u9cb8cmdb v3.9.5 \u4e0a\u9a8c\u8bc1\u901a\u8fc7\u3002","title":"\u84dd\u9cb8\u667a\u4e91\u914d\u7f6e\u5e73\u53f0(BlueKing CMDB)"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_1","text":"","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_2","text":"Web\u5c55\u793a\u5c42 cmdb_webserver API\u7f51\u5173\u5c42 cmdb_apiserver \u670d\u52a1\u5c42 \u539f\u5b50\u4e1a\u52a1\u5c42 cmdb_adminserver \u914d\u7f6e\u5237\u65b0\u3001\u521d\u59cb\u5316\u6570\u636e\u5199\u5165\u7b49 cmdb_eventserver \u4e8b\u4ef6\u8ba2\u9605\u4e0e\u63a8\u9001 cmdb_procserver \u7cfb\u7edf\u8fdb\u7a0b cmdb_toposerver \u62d3\u6251\u6a21\u578b cmdb_hostserver \u4e3b\u673a cmdb_datacollection \u7cfb\u7edf\u5feb\u7167\u6570\u636e\u7684\u91c7\u96c6 cmdb_operationserver \u8fd0\u8425\u7edf\u8ba1\u76f8\u5173 cmdb_synchronizeserver \u6570\u636e\u540c\u6b65 cmdb_taskserver \u5f02\u6b65\u4efb\u52a1\u7ba1\u7406 \u8d44\u6e90\u7ba1\u7406\u5c42 cmdb_coreservice \u5b58\u50a8\u5c42 /data/sidecar/{mongodb,redis} \uff0c\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u3001\u6d88\u606f\u961f\u5217\u4ee5\u53ca\u7f13\u5b58 \u670d\u52a1\u6ce8\u518c\u53d1\u73b0 /data/sidecar/zookeeper","title":"\u76ee\u5f55\u548c\u67b6\u6784"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#docker","text":"docker run -d \\ --name=cmdb \\ --restart=always \\ -v /Users/jeffchen/bak:/tmp/export \\ -p 8090:8090 \\ -p 18080:8080 \\ ccr.ccs.tencentyun.com/bk.io/cmdb-standalone:v3.9.5 \u9ed8\u8ba4\u914d\u7f6e\uff1a zk 127.0.0.1:2181 mongo cc:cc@127.0.0.1:27017 \uff0cdb cmdb redis 127.0.0.1:6379 \uff0cpw cc web\u8bbf\u95ee http://127.0.0.1:8090/ \uff0c\u9ed8\u8ba4\u7528\u6237 admin \uff0c\u4e0d\u7528\u5bc6\u7801 \u5185\u90e8 8080 \u7aef\u53e3\u662fapi\u670d\u52a1 /tmp/export \u662fmongo\u5bfc\u51fa\u6570\u636e\u7684\u76ee\u5f55","title":"Docker\u4e00\u952e\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_3","text":"","title":"\u4f7f\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_4","text":"\u5e38\u89c1\u540d\u8bcd\u89e3\u91ca\uff1a \u4e1a\u52a1 \uff0c\u6307\u516c\u53f8\u5185\u90e8\u7684\u4e00\u4e2a\u9879\u76ee\u6216\u8005\u4ea7\u54c1\uff0c\u5f80\u5f80\u662f\u4e00\u7ec4\u76f8\u5173\u670d\u52a1\uff08\u5982\uff1alb+web+db\uff09\u7684\u603b\u4f53\u4ee3\u8868\uff0c\u662f\u4e1a\u52a1\u7ebf\u7684\u6700\u5c0f\u7ec4\u6210\u5355\u5143\uff0c\u6709\u5b8c\u6574\u751f\u547d\u5468\u671f\u3002 \u96c6\u7fa4 \uff0c\u5982\u679c\u8bf4\u4e1a\u52a1\u662f\u7eb5\u5411\u6982\u5ff5\uff0c\u90a3\u4e48\u96c6\u7fa4\u5c31\u662f\u6a2a\u5411\u6982\u5ff5\uff0c\u4ee3\u8868\u7a7a\u95f4\u533a\u57df\u7684\u9694\u79bb\uff0c\u5982\uff1a\u6d4b\u8bd5\u96c6\u7fa4\uff08\u53ef\u80fd\u516c\u53f8\u5185\u7f51\uff09\u4e2d\u7684\u670d\u52a1\u4e0d\u5e94\u8be5\u8bbf\u95ee\u751f\u4ea7\u96c6\u7fa4\uff08\u90e8\u7f72\u5728\u516c\u7f51\u4e91\u4e0a\uff09\u7684\u63a5\u53e3\uff0c\u96c6\u7fa4\u662f\u53ef\u4ee5\u6269\u7f29\u5bb9\u7684\uff0c\u662f\u9ad8\u53ef\u7528\u7684\u57fa\u77f3\uff0c\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u6765\u770b\uff0cK8s\u4f53\u7cfb\u4e2d\u7684Pod\u6982\u5ff5\u5c31\u662f\u6700\u5c0f\u7684\u96c6\u7fa4\u3002 \u6a21\u5757 \uff0c\u662f\u5404\u79cd\u5e94\u7528\u548c\u670d\u52a1\u7684\u62bd\u8c61\uff1a\u516c\u53f8\u81ea\u7814\u7684App\u3001Web\u662f\u4e00\u79cd\u6a21\u5757\uff0c\u6570\u636e\u5e93\u3001\u4e2d\u95f4\u4ef6\u670d\u52a1\u4e5f\u662f\u4e00\u79cd\u6a21\u5757\u3002\u6bcf\u4e2a\u6a21\u5757\u90fd\u5e94\u8be5\u6709\u5bf9\u5e94\u7684\u8d1f\u8d23\u4eba\u3002 \u4e3b\u673a \uff0c\u548c\u4f20\u7edf\u8ba4\u77e5\u4e0a\u7684\u670d\u52a1\u5668\u6709\u4e9b\u533a\u522b\uff0c\u66f4\u63a5\u8fd1Docker\u7684\u5b9e\u4f8b\u6982\u5ff5\uff1a\u6709IP\u5730\u5740\u3001CPU\u6838\u6570\u3001\u5185\u5b58\u548c\u78c1\u76d8\u5bb9\u91cf\u3001OS\u7248\u672c\u3001\u8fd0\u884c\u72b6\u6001\uff0c\u5728\u8fd9\u4e9b\u57fa\u7840\u4e0a\u518d\u6269\u5145\u5176\u4ed6\u975e\u5fc5\u8981\u5c5e\u6027\uff0c\u5982\uff1a\u8d44\u4ea7\u7f16\u53f7\uff0c\u6240\u5c5e\u533a\u57df\u7b49\u3002 \u5efa\u6a21\u987a\u5e8f\uff1a \u90e8\u95e8-\u5458\u5de5 \uff0c\u57fa\u7840\u5b57\u5178\uff0c\u662f\u5176\u4ed6\u6a21\u578b\u4e2d\u4eba\u5458\u76f8\u5173\u5c5e\u6027\u7684\u9009\u62e9\u5217\u8868\u6570\u636e\u6e90\uff0c\u7531\u4e8e\u5f00\u6e90\u7248\u9609\u5272\u4e86\u7528\u6237\u7ba1\u7406\u7684\u529f\u80fd\uff0c\u8003\u8651\u7528 \u5173\u8054\u5173\u7cfb \u4ee3\u66ff\u3002 \u5bfc\u5165 \u4e3b\u673a \u8fdb\u8d44\u6e90\u6c60 \u65b0\u5efa \u6a21\u5757 \uff0c\u6709\u8d1f\u8d23\u4eba\uff0c\u81ea\u7814\u670d\u52a1\u6709\u5bf9\u5e94\u7684git\u5730\u5740 \u4e1a\u52a1 \uff0c\u516c\u53f8\u7684\u4ea7\u54c1\uff0c\u6240\u5c5e\u90e8\u95e8\u3001\u5bf9\u5e94\u7684\u8d1f\u8d23\u4eba\u3001\u5f53\u524d\u751f\u547d\u5468\u671f\uff08\u9ed8\u8ba4\uff1a\u4e0a\u7ebf\uff09 \u5728 \u4e1a\u52a1\u62d3\u6251 \u754c\u9762\uff0c\u6bcf\u4e2a\u4e1a\u52a1\u4e0b\u5efa\u7acb\u5bf9\u5e94\u7684 \u96c6\u7fa4-\u6a21\u5757","title":"\u4e1a\u52a1\u5efa\u6a21"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_5","text":"Docker\u7248\u670d\u52a1\u9ed8\u8ba4\u4e0d\u5f00\u542f\u6743\u9650\uff0c\u76f4\u63a5\u4ee5admin\u64cd\u4f5c\uff0c\u975e\u5e38\u4e0d\u5b89\u5168\uff0c\u89e3\u51b3\u65b9\u6848\u67092\u79cd\uff1a \u4f7f\u7528\u539f\u751f\u670d\u52a1\uff1a\u84dd\u9cb8\u201c\u5168\u5bb6\u6876\u201d\u4e2d\u7684 PaaS\u5e73\u53f0 \uff0c\u8bf7\u770b\u5b98\u65b9\u6587\u6863 \u7528\u81ea\u5df1\u7684\u670d\u52a1\u5c01\u88c5\u4e00\u5c42\uff0c\u5927\u81f4\u601d\u8def\u5982\u4e0b\uff1a cmdb\u5b9e\u4f8b\u548c\u5176\u4ed6DB\u4e00\u6837\uff0c\u90e8\u7f72\u5728\u5185\u90e8\u5b89\u5168\u7f51\u7edc\u4e2d\uff0c\u4e0d\u5141\u8bb8\u5916\u90e8\u76f4\u63a5\u8bbf\u95ee \u53ea\u4fe1\u4efb\u4ece\u6307\u5b9a\u7f51\u5173\u5730\u5740\u8fc7\u6765\u7684\u8bbf\u95ee\uff0c\u5b9e\u8d28\u662f\u628a\u6743\u9650\u89e3\u8026\uff0c\u6258\u7ba1\u7ed9\u4e0a\u6e38\uff0c\u53c2\u8003 \u8fd9\u4e00\u7bc7\u6587\u7ae0\u8be6\u7ec6\u4ecb\u7ecd \u3002","title":"\u6743\u9650\u8ba4\u8bc1"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_6","text":"\u6ce8\u610f\u4e8b\u9879: \u5728\u8bf7\u6c42head\u4e2d\u6dfb\u52a0 BK_USER=admin;HTTP_BLUEKING_SUPPLIER_ID=0 \uff0c\u5426\u5219\u4f1a\u62a5\u9519 [user]\u6388\u6743\u4fe1\u606f\u67e5\u8be2\u5931\u8d25 api\u5f53\u524d\u7248\u672c v3 \uff0c\u5efa\u8bae\u76f4\u63a5\u770bgithub\u4e0a docs/apidoc/v3.1 \u4e0b\u7684\u6587\u6863\uff0c\u5b98\u7f51\u4e0a\u7684\u6709\u70b9\u8fc7\u671f \u5efa\u8bae\u4f7f\u7528api_server\u7684\u7aef\u53e3\uff0c\u9700\u8981\u5bf9\u5916\u66b4\u9732 # \u67e5\u8be2\u4e3b\u673a\u5217\u8868\uff0c\u9ed8\u8ba4\u7a7a\u5e93 curl --location --request POST 'http://0.0.0.0:18080/api/v3/hosts/search' \\ --header 'HTTP_BLUEKING_SUPPLIER_ID: 0' \\ --header 'BK_USER: admin' \u53cd\u9988: { \"result\": true, \"bk_error_code\": 0, \"bk_error_msg\": \"success\", \"permission\": null, \"data\": { \"count\": 0, \"info\": [] } }","title":"\u63a5\u53e3\u8c03\u7528"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_7","text":"mongo\u5907\u4efdcmdb: docker exec -it cmdb /data/sidecar/mongodb/bin/mongodump --host 127.0.0.1 --port 27017 --out /tmp/export --db cmdb \u6253\u5305\u538b\u7f29 tar -czvf cmdb.tar.gz /tmp/export/cmdb/ \u4ece\u5907\u4efd\u6062\u590d\uff08\u5728mongo/bin\u76ee\u5f55\uff09: 1. docker exec -it cmdb /data/sidecar/mongodb/bin/mongorestore -h 127.0.0.1:27017 -d cmdb /tmp/export/cmdb/ \u5751: docker\u7248\u9ed8\u8ba4\u4f1a\u521d\u59cb\u5316db\uff0c\u5199\u5165\u90e8\u5206\u4e1a\u52a1\u6a21\u578b\uff0c\u5bfc\u81f4\u4ece\u5907\u4efd\u5bfc\u5165\u540e\uff0c\u51fa\u73b0\u91cd\u590d\u8bb0\u5f55","title":"\u6570\u636e\u5907\u4efd\u548c\u6062\u590d"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_8","text":"\u7531\u4e8ecmdb\u6709\u5bf9\u63a5\u5916\u90e8\u7cfb\u7edf\u7684\u9700\u6c42\uff0c\u4e00\u4e9bci\u7684\u8d26\u53f7\u4fe1\u606f\u4e0d\u9002\u5408\u76f4\u63a5\u660e\u6587\u5b58\u50a8\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u89e3\u51b3\u601d\u8def\uff0c\u4f9b\u53c2\u8003\uff1a KeePassXC \u4e00\u79cd\u5b89\u5168\u5f00\u6e90\\\u8de8\u5e73\u53f0\u7684\u5bc6\u7801\u52a0\u5bc6\u3001\u5b58\u7ba1\u5de5\u5177 ci\u8bb0\u5f55\u7684\u5bc6\u7801\u5c5e\u6027\u4fe1\u606f\u5b58\u5165KeePassXC\u7ba1\u7406\u7684.kdbx\u52a0\u5bc6\u5e93\u4e2d \u57fa\u4e8epy\u5e93 pykeepass \u6784\u5efa\u5bc6\u7801\u67e5\u8be2\u63a5\u53e3\uff0c\u5165\u53c2(ci\u5206\u7c7b, ci.id, [\u5c5e\u6027kv])\uff0c\u53cd\u9988\u89e3\u5bc6\u540e\u7684\u62a5\u6587\uff08\u5982\uff1a\u5bc6\u7801\uff09 \u5728\u4e1a\u52a1\u6d41\u7a0b\u5f00\u53d1\u65f6\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u63a5\u53e3\uff0c\u8bfb\u53d6\u5bc6\u7801","title":"\u5bf9\u63a5\u5bc6\u7801\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#todo","text":"\u4e3b\u673a\u4fe1\u606f\u81ea\u52a8\u91c7\u96c6\u548c\u6ce8\u518c \u5bf9\u63a5\u7edf\u4e00\u670d\u52a1\u5e73\u53f0\u5165\u53e3","title":"TODO"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/bk_cmdb/#_9","text":"github\u6e90\u7801 https://github.com/Tencent/bk-cmdb \u5b98\u7f51\u6587\u6863 https://bk.tencent.com/docs/document/5.1/9/222","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/cmdbuild/","text":"CMDBuild \u5f00\u6e90\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf \u53c2\u8003 \u5b98\u7f51\uff1a http://www.cmdbuild.org/en/ Pgsql-9.4\u5b98\u65b9\u955c\u50cf\uff1a https://hub.docker.com/r/library/postgres/ PostgreSQL\u65b0\u624b\u5165\u95e8\uff1a http://www.ruanyifeng.com/blog/2013/12/getting_started_with_postgresql.html CMDBuild-2.4.2\uff08tomcat7\uff09\u5f00\u6e90\u955c\u50cf\uff1a https://hub.docker.com/r/quentinv/cmdbuild/ \u5b89\u88c5\uff08Docker\u7248\uff09 # \u4e0b\u8f7d\u5b98\u65b9img docker pull postgres:9.4 # \u540e\u53f0\u542f\u52a8pgsql-9.4\uff0c\u7ed1\u5b9a\u7aef\u53e3\uff0c\u6307\u5b9a\u7ba1\u7406\u5458\u5bc6\u7801 docker run --name pgsql9.4 \\ -p 0.0.0.0:5432:5432 \\ -e POSTGRES_PASSWORD=test123 \\ -d postgres:9.4 # \uff08\u53ef\u9009\uff09\uff0c\u539f\u6570\u636e\u8fc1\u79fb)\u590d\u5236sql\u8fdb\u5bb9\u5668 docker cp ./cmdb_db_dump.sql pgsql9.4:/tmp/ # \u8fdb\u5165\u5bb9\u5668\u540e\u64cd\u4f5c docker exec -it pgsql9.4 /bin/bash # \u8fdbPostgresql\u8d26\u53f7 su postgres # \u5efa\u5e93 createdb -O postgres cmdbuild # \u5bfc\u6570\u636e psql -U postgres -d cmdbuild < /tmp/cmdb_db_dump.sql # \u9000\u51fa\u5bb9\u5668 # \uff08\u5b89\u5168\uff09\u5141\u8bb8\u7aef\u53e3\u8bbf\u95ee\uff0c\u8fd9\u91cc\u53ea\u7b80\u5355\u7684\u5173\u95ed\u9632\u706b\u5899\uff0c\u7ebf\u4e0a\u6309\u5b9e\u9645\u9700\u6c42\u8c03\u6574 systemctl stop firewalld.service # \u542f\u52a8\u670d\u52a1\u5bb9\u5668 docker run --name cmdbuild2.4 -p 8080:8080 -d quentinv/cmdbuild:t7-2.4.2 \u8fdb\u5165web\u914d\u7f6e\uff0c\u9ed8\u8ba4admin\u5bc6\u7801\uff1a1~6 \u5e38\u89c1\u6545\u969c docker\u542f\u52a8\u540e\uff0cjvm\u8fdb\u7a0b\u7684\u5185\u5b58\u5360\u7528\u8fc7\u5927\uff0c\u5bb9\u6613\u88ab\u6740 \u539f\u56e0\uff1a\u672c\u4f8b\u7684\u5f00\u6e90img\u4f7f\u7528tomcat\u4f5c\u4e3aWeb Server\uff0c\u9ed8\u8ba4\u6ca1\u6709\u914d\u7f6eXmx\uff1bjvm\u542f\u52a8\u65f6\uff0c\u9ed8\u8ba4\u8bfb\u53d6\u6240\u6709\u5185\u5b58\uff08\u7269\u7406\u673a\u7684\uff09\u4f5c\u4e3a\u4e0a\u9650\uff0c\u5bfc\u81f4\u95ee\u9898\u3002 \u89e3\u51b3\u65b9\u6848\uff1adocker\u542f\u52a8\u65f6\uff0c\u52a0\u5165JAVA_OPTS='Xmx1024m'\u73af\u5883\u53d8\u91cf \u53c2\u8003\u6587\u6863\uff1a https://yq.aliyun.com/articles/18037 \u7b2c\u4e00\u6b21\u767b\u5f55\u4f1a\u62a5\u9519500\uff0c\u8fc7\u4e86\u51e0\u79d2\u540e\u6210\u529f\u767b\u5f55\uff0c\u5bc6\u7801\u6b63\u786e \u539f\u56e01\uff1a\u7528\u6237\u6ca1\u6709\u8bbe\u7f6e\u9ed8\u8ba4\u89d2\u8272\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u5728\u7528\u6237\u7ba1\u7406\u9875\u9762\u914d\u7f6e\u9ed8\u8ba4\u89d2\u8272 \u539f\u56e02\uff1aPostgresqlDB\u548cWeb\u4e0d\u5728\u540c\u4e00\u53f0\u4e3b\u673a\uff0c\u5bfc\u81f4connect timeout \u89e3\u51b3\u65b9\u6848\uff1a\u90e8\u7f72\u5728\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a","title":"CMDBuild \u5f00\u6e90\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/cmdbuild/#cmdbuild","text":"","title":"CMDBuild \u5f00\u6e90\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/cmdbuild/#_1","text":"\u5b98\u7f51\uff1a http://www.cmdbuild.org/en/ Pgsql-9.4\u5b98\u65b9\u955c\u50cf\uff1a https://hub.docker.com/r/library/postgres/ PostgreSQL\u65b0\u624b\u5165\u95e8\uff1a http://www.ruanyifeng.com/blog/2013/12/getting_started_with_postgresql.html CMDBuild-2.4.2\uff08tomcat7\uff09\u5f00\u6e90\u955c\u50cf\uff1a https://hub.docker.com/r/quentinv/cmdbuild/","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/cmdbuild/#docker","text":"# \u4e0b\u8f7d\u5b98\u65b9img docker pull postgres:9.4 # \u540e\u53f0\u542f\u52a8pgsql-9.4\uff0c\u7ed1\u5b9a\u7aef\u53e3\uff0c\u6307\u5b9a\u7ba1\u7406\u5458\u5bc6\u7801 docker run --name pgsql9.4 \\ -p 0.0.0.0:5432:5432 \\ -e POSTGRES_PASSWORD=test123 \\ -d postgres:9.4 # \uff08\u53ef\u9009\uff09\uff0c\u539f\u6570\u636e\u8fc1\u79fb)\u590d\u5236sql\u8fdb\u5bb9\u5668 docker cp ./cmdb_db_dump.sql pgsql9.4:/tmp/ # \u8fdb\u5165\u5bb9\u5668\u540e\u64cd\u4f5c docker exec -it pgsql9.4 /bin/bash # \u8fdbPostgresql\u8d26\u53f7 su postgres # \u5efa\u5e93 createdb -O postgres cmdbuild # \u5bfc\u6570\u636e psql -U postgres -d cmdbuild < /tmp/cmdb_db_dump.sql # \u9000\u51fa\u5bb9\u5668 # \uff08\u5b89\u5168\uff09\u5141\u8bb8\u7aef\u53e3\u8bbf\u95ee\uff0c\u8fd9\u91cc\u53ea\u7b80\u5355\u7684\u5173\u95ed\u9632\u706b\u5899\uff0c\u7ebf\u4e0a\u6309\u5b9e\u9645\u9700\u6c42\u8c03\u6574 systemctl stop firewalld.service # \u542f\u52a8\u670d\u52a1\u5bb9\u5668 docker run --name cmdbuild2.4 -p 8080:8080 -d quentinv/cmdbuild:t7-2.4.2 \u8fdb\u5165web\u914d\u7f6e\uff0c\u9ed8\u8ba4admin\u5bc6\u7801\uff1a1~6","title":"\u5b89\u88c5\uff08Docker\u7248\uff09"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/cmdbuild/#_2","text":"docker\u542f\u52a8\u540e\uff0cjvm\u8fdb\u7a0b\u7684\u5185\u5b58\u5360\u7528\u8fc7\u5927\uff0c\u5bb9\u6613\u88ab\u6740 \u539f\u56e0\uff1a\u672c\u4f8b\u7684\u5f00\u6e90img\u4f7f\u7528tomcat\u4f5c\u4e3aWeb Server\uff0c\u9ed8\u8ba4\u6ca1\u6709\u914d\u7f6eXmx\uff1bjvm\u542f\u52a8\u65f6\uff0c\u9ed8\u8ba4\u8bfb\u53d6\u6240\u6709\u5185\u5b58\uff08\u7269\u7406\u673a\u7684\uff09\u4f5c\u4e3a\u4e0a\u9650\uff0c\u5bfc\u81f4\u95ee\u9898\u3002 \u89e3\u51b3\u65b9\u6848\uff1adocker\u542f\u52a8\u65f6\uff0c\u52a0\u5165JAVA_OPTS='Xmx1024m'\u73af\u5883\u53d8\u91cf \u53c2\u8003\u6587\u6863\uff1a https://yq.aliyun.com/articles/18037 \u7b2c\u4e00\u6b21\u767b\u5f55\u4f1a\u62a5\u9519500\uff0c\u8fc7\u4e86\u51e0\u79d2\u540e\u6210\u529f\u767b\u5f55\uff0c\u5bc6\u7801\u6b63\u786e \u539f\u56e01\uff1a\u7528\u6237\u6ca1\u6709\u8bbe\u7f6e\u9ed8\u8ba4\u89d2\u8272\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u5728\u7528\u6237\u7ba1\u7406\u9875\u9762\u914d\u7f6e\u9ed8\u8ba4\u89d2\u8272 \u539f\u56e02\uff1aPostgresqlDB\u548cWeb\u4e0d\u5728\u540c\u4e00\u53f0\u4e3b\u673a\uff0c\u5bfc\u81f4connect timeout \u89e3\u51b3\u65b9\u6848\uff1a\u90e8\u7f72\u5728\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a","title":"\u5e38\u89c1\u6545\u969c"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/gitlab/","text":"Gitlab \u4ee3\u7801\u7248\u672c\u7ba1\u7406 \u5b89\u88c5 \u57fa\u4e8edocker\uff0c\u7248\u672c13.6.3\uff0cUbuntu18\u4e0a\u6d4b\u8bd5\u901a\u8fc7 \u524d\u63d0\uff1a * \u786c\u4ef6\u914d\u7f6e 4C-8G-100G * \u5b89\u88c5 docker # \u670d\u52a1\u5b58\u50a8\u8def\u5f84 cd /data/gitlab docker run --detach \\ --hostname gitlab.test.com \\ --publish 443:443 --publish 80:80 --publish 10022:22 \\ --name gitlab \\ --restart always \\ -v /data/gitlab/ca/license_key.pub:/opt/gitlab/embedded/service/gitlab-rails/.license_encryption_key.pub \\ -v /data/gitlab/ca/license.rb:/opt/gitlab/embedded/service/gitlab-rails/ee/app/models/license.rb \\ --volume /data/gitlab/config:/etc/gitlab \\ --volume /data/gitlab/logs:/var/log/gitlab \\ --volume /data/gitlab/data:/var/opt/gitlab \\ gitlab/gitlab-ee:13.6.3-ee.0 # \u8bbe\u7f6e\u5b89\u5168\u8bbf\u95ee iptables -I DOCKER -p tcp -m tcp --dport 22 -j DROP iptables -I DOCKER -s 10.0.0.0/23 -p tcp -m tcp --dport 22 -j ACCEPT /data/gitlab/ca/ \u4e0b\u662fhttps\u7684\u8bc1\u4e66 \u5907\u4efd # \u8c03\u7528\u5185\u90e8\u547d\u4ee4\u5907\u4efd\u6570\u636e\uff0c\u4e0d\u542b\u914d\u7f6e\uff0c\u751f\u6210{\u65f6\u95f4\u6233}_{gitlab\u7248\u672c}_gitlab_backup.tar docker exec -t gitlab gitlab-backup create # \u5907\u4efd\u914d\u7f6e\uff0c\u5305\u62ec\u914d\u7f6e\u548chttps\u8bc1\u4e66 zip gitlab_config.zip -r /data/gitlab/config/ /data/gitlab/ca/ \u6062\u590d \u5728\u53e6\u4e00\u53f0\u4e3b\u673a\u4e0a\u6062\u590d gitlab_config.zip\u89e3\u836f\u5230\u5bf9\u5e94\u76ee\u5f55 gitlab_backup.tar\u590d\u5236\u5230 /data/gitlab/data/backups \uff0c\u6587\u4ef6\u6743\u9650\u5f00777 \u5728\u5bb9\u5668\u5185\u6267\u884c # \u6682\u505c\u670d\u52a1 gitlab-ctl stop unicorn gitlab-ctl stop puma gitlab-ctl stop sidekiq # gitlab-ctl status\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u5173\u95ed # \u6267\u884c\u6062\u590d\uff0c1643099038_2022_01_25_13.6.3-ee\u662f\u4e4b\u524d\u5907\u4efd\u7684{\u65f6\u95f4\u6233}_{gitlab\u7248\u672c} gitlab-backup restore BACKUP=1643099038_2022_01_25_13.6.3-ee \u9000\u51fa\u5bb9\u5668\u540e\uff0c\u91cd\u542fgitlab \u9a8c\u8bc1\u670d\u52a1\u6062\u590d docker exec -it gitlab gitlab-rake gitlab:check SANITIZE=true \u9a8c\u8bc12\uff1a\u672c\u5730hosts\u91cc\u6307\u5b9a\u65b0\u4e3b\u673aip\u548c\u57df\u540d\uff0c\u5c1d\u8bd5\u8bbf\u95ee \u66b4\u529b\u7248\uff1a # \u505cdocker\uff0c\u5907\u4efd\uff0c\u76f4\u63a5\u628adata\u6253\u5305\uff0c\u751f\u6210\u7c7b\u4f3c\uff1agitback-2019-04-18.tar.gz tar -zcvf /backup/data/gitback-${DATE}.tar.gz -C /data/ # \u6062\u590d\uff0c\u518d\u91cd\u542fdocker tar -xf gitback-2019-04-18.tar.gz -C /data/ docker-compose up -d \u53c2\u8003 \u5b98\u7f51\u6587\u6863 https://docs.gitlab.com/","title":"Gitlab \u4ee3\u7801\u7248\u672c\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/gitlab/#gitlab","text":"","title":"Gitlab \u4ee3\u7801\u7248\u672c\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/gitlab/#_1","text":"\u57fa\u4e8edocker\uff0c\u7248\u672c13.6.3\uff0cUbuntu18\u4e0a\u6d4b\u8bd5\u901a\u8fc7 \u524d\u63d0\uff1a * \u786c\u4ef6\u914d\u7f6e 4C-8G-100G * \u5b89\u88c5 docker # \u670d\u52a1\u5b58\u50a8\u8def\u5f84 cd /data/gitlab docker run --detach \\ --hostname gitlab.test.com \\ --publish 443:443 --publish 80:80 --publish 10022:22 \\ --name gitlab \\ --restart always \\ -v /data/gitlab/ca/license_key.pub:/opt/gitlab/embedded/service/gitlab-rails/.license_encryption_key.pub \\ -v /data/gitlab/ca/license.rb:/opt/gitlab/embedded/service/gitlab-rails/ee/app/models/license.rb \\ --volume /data/gitlab/config:/etc/gitlab \\ --volume /data/gitlab/logs:/var/log/gitlab \\ --volume /data/gitlab/data:/var/opt/gitlab \\ gitlab/gitlab-ee:13.6.3-ee.0 # \u8bbe\u7f6e\u5b89\u5168\u8bbf\u95ee iptables -I DOCKER -p tcp -m tcp --dport 22 -j DROP iptables -I DOCKER -s 10.0.0.0/23 -p tcp -m tcp --dport 22 -j ACCEPT /data/gitlab/ca/ \u4e0b\u662fhttps\u7684\u8bc1\u4e66","title":"\u5b89\u88c5"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/gitlab/#_2","text":"# \u8c03\u7528\u5185\u90e8\u547d\u4ee4\u5907\u4efd\u6570\u636e\uff0c\u4e0d\u542b\u914d\u7f6e\uff0c\u751f\u6210{\u65f6\u95f4\u6233}_{gitlab\u7248\u672c}_gitlab_backup.tar docker exec -t gitlab gitlab-backup create # \u5907\u4efd\u914d\u7f6e\uff0c\u5305\u62ec\u914d\u7f6e\u548chttps\u8bc1\u4e66 zip gitlab_config.zip -r /data/gitlab/config/ /data/gitlab/ca/","title":"\u5907\u4efd"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/gitlab/#_3","text":"\u5728\u53e6\u4e00\u53f0\u4e3b\u673a\u4e0a\u6062\u590d gitlab_config.zip\u89e3\u836f\u5230\u5bf9\u5e94\u76ee\u5f55 gitlab_backup.tar\u590d\u5236\u5230 /data/gitlab/data/backups \uff0c\u6587\u4ef6\u6743\u9650\u5f00777 \u5728\u5bb9\u5668\u5185\u6267\u884c # \u6682\u505c\u670d\u52a1 gitlab-ctl stop unicorn gitlab-ctl stop puma gitlab-ctl stop sidekiq # gitlab-ctl status\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u5173\u95ed # \u6267\u884c\u6062\u590d\uff0c1643099038_2022_01_25_13.6.3-ee\u662f\u4e4b\u524d\u5907\u4efd\u7684{\u65f6\u95f4\u6233}_{gitlab\u7248\u672c} gitlab-backup restore BACKUP=1643099038_2022_01_25_13.6.3-ee \u9000\u51fa\u5bb9\u5668\u540e\uff0c\u91cd\u542fgitlab \u9a8c\u8bc1\u670d\u52a1\u6062\u590d docker exec -it gitlab gitlab-rake gitlab:check SANITIZE=true \u9a8c\u8bc12\uff1a\u672c\u5730hosts\u91cc\u6307\u5b9a\u65b0\u4e3b\u673aip\u548c\u57df\u540d\uff0c\u5c1d\u8bd5\u8bbf\u95ee \u66b4\u529b\u7248\uff1a # \u505cdocker\uff0c\u5907\u4efd\uff0c\u76f4\u63a5\u628adata\u6253\u5305\uff0c\u751f\u6210\u7c7b\u4f3c\uff1agitback-2019-04-18.tar.gz tar -zcvf /backup/data/gitback-${DATE}.tar.gz -C /data/ # \u6062\u590d\uff0c\u518d\u91cd\u542fdocker tar -xf gitback-2019-04-18.tar.gz -C /data/ docker-compose up -d","title":"\u6062\u590d"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/gitlab/#_4","text":"\u5b98\u7f51\u6587\u6863 https://docs.gitlab.com/","title":"\u53c2\u8003"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/%E5%9F%BA%E4%BA%8Econfd%E7%9A%84%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/","text":"\u57fa\u4e8econfd\u7684\u672c\u5730\u670d\u52a1\u914d\u7f6e\u7ba1\u7406 \u76ee\u7684 \u4ecb\u7ecd\u4e00\u79cd\u901a\u7528\u7684\u3001\u7ba1\u7406\u672c\u5730\u5fae\u670d\u52a1\u914d\u7f6e\u7684\u6280\u672f\u65b9\u6848 \u75db\u70b9 \u6bcf\u53f0\u4e3b\u673a\u4e0a\u6709\u591a\u4e2a\u5fae\u670d\u52a1\uff0c\u6bcf\u4e2a\u5fae\u670d\u52a1\u90fd\u6709\u81ea\u5df1\u7684setting\u6587\u4ef6 \u5f53\u914d\u7f6e\u9700\u8981\u66f4\u65b0\u65f6\uff0c\u9700\u8981\u66f4\u65b0setting\u540e\u91cd\u542f \u67b6\u6784 \u5b9e\u4f8b TODO \u53c2\u8003 Confd\u624b\u518c Etcd\u624b\u518c Mug\u6846\u67b6","title":"\u57fa\u4e8econfd\u7684\u672c\u5730\u670d\u52a1\u914d\u7f6e\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/%E5%9F%BA%E4%BA%8Econfd%E7%9A%84%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/#confd","text":"","title":"\u57fa\u4e8econfd\u7684\u672c\u5730\u670d\u52a1\u914d\u7f6e\u7ba1\u7406"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/%E5%9F%BA%E4%BA%8Econfd%E7%9A%84%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/#_1","text":"\u4ecb\u7ecd\u4e00\u79cd\u901a\u7528\u7684\u3001\u7ba1\u7406\u672c\u5730\u5fae\u670d\u52a1\u914d\u7f6e\u7684\u6280\u672f\u65b9\u6848","title":"\u76ee\u7684"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/%E5%9F%BA%E4%BA%8Econfd%E7%9A%84%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/#_2","text":"\u6bcf\u53f0\u4e3b\u673a\u4e0a\u6709\u591a\u4e2a\u5fae\u670d\u52a1\uff0c\u6bcf\u4e2a\u5fae\u670d\u52a1\u90fd\u6709\u81ea\u5df1\u7684setting\u6587\u4ef6 \u5f53\u914d\u7f6e\u9700\u8981\u66f4\u65b0\u65f6\uff0c\u9700\u8981\u66f4\u65b0setting\u540e\u91cd\u542f","title":"\u75db\u70b9"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/%E5%9F%BA%E4%BA%8Econfd%E7%9A%84%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/#_3","text":"","title":"\u67b6\u6784"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/%E5%9F%BA%E4%BA%8Econfd%E7%9A%84%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/#_4","text":"TODO","title":"\u5b9e\u4f8b"},{"location":"%E4%B8%9A%E5%8A%A1%E6%96%B9%E6%A1%88/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/%E5%9F%BA%E4%BA%8Econfd%E7%9A%84%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/#_5","text":"Confd\u624b\u518c Etcd\u624b\u518c Mug\u6846\u67b6","title":"\u53c2\u8003"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/MugWeb%E6%A1%86%E6%9E%B6/","text":"Mug Web Framework \u9a6c\u514b\u676fWeb\u5f00\u53d1\u6846\u67b6 \u57fa\u4e8ebottle + peewee\u7684web api\u6846\u67b6 \u53c2\u8003 GitHub\u5730\u5740 https://github.com/chenqing24/mug-skeleton \u7279\u6027 \u8981\u6c42Python 3.7 \u57fa\u4e8eBottle Web Framework \u96c6\u6210Peewee ORM\uff0c\u5df2\u5e26MySQL\u9a71\u52a8 \u96c6\u6210Cache\uff0c\u901a\u8fc7\u88c5\u9970\u5668\u7f13\u5b58\u6267\u884c\u7ed3\u679c \u96c6\u6210Access log \u96c6\u6210\u4efb\u52a1\u8c03\u5ea6\u6846\u67b6APScheduler \u533a\u5206\u5f00\u53d1\u548c\u751f\u4ea7\u73af\u5883 \u6709\u591a\u8fdb\u7a0b\u6a21\u5f0f \u6743\u9650\u6846\u67b6 \uff08TODO\uff09 \u5355\u7528\u6d4b\u8bd5\u6846\u67b6 boddle \u914d\u7f6e \u4fee\u6539 <project_path>/app/app/settings.py \u4f7f\u7528 \u542f\u52a8\u670d\u52a1 pip install -r requirements.txt \u542f\u52a8 python app/manage.py runserver [--port 19999 --dev true] \u8bbf\u95ee\u6e38\u89c8\u5668 http://0.0.0.0:19999/ \u5355\u5143\u6d4b\u8bd5 python app/manage.py test","title":"Mug Web Framework \u9a6c\u514b\u676fWeb\u5f00\u53d1\u6846\u67b6"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/MugWeb%E6%A1%86%E6%9E%B6/#mug-web-framework-web","text":"\u57fa\u4e8ebottle + peewee\u7684web api\u6846\u67b6","title":"Mug Web Framework \u9a6c\u514b\u676fWeb\u5f00\u53d1\u6846\u67b6"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/MugWeb%E6%A1%86%E6%9E%B6/#_1","text":"GitHub\u5730\u5740 https://github.com/chenqing24/mug-skeleton","title":"\u53c2\u8003"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/MugWeb%E6%A1%86%E6%9E%B6/#_2","text":"\u8981\u6c42Python 3.7 \u57fa\u4e8eBottle Web Framework \u96c6\u6210Peewee ORM\uff0c\u5df2\u5e26MySQL\u9a71\u52a8 \u96c6\u6210Cache\uff0c\u901a\u8fc7\u88c5\u9970\u5668\u7f13\u5b58\u6267\u884c\u7ed3\u679c \u96c6\u6210Access log \u96c6\u6210\u4efb\u52a1\u8c03\u5ea6\u6846\u67b6APScheduler \u533a\u5206\u5f00\u53d1\u548c\u751f\u4ea7\u73af\u5883 \u6709\u591a\u8fdb\u7a0b\u6a21\u5f0f \u6743\u9650\u6846\u67b6 \uff08TODO\uff09 \u5355\u7528\u6d4b\u8bd5\u6846\u67b6 boddle","title":"\u7279\u6027"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/MugWeb%E6%A1%86%E6%9E%B6/#_3","text":"\u4fee\u6539 <project_path>/app/app/settings.py","title":"\u914d\u7f6e"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/MugWeb%E6%A1%86%E6%9E%B6/#_4","text":"","title":"\u4f7f\u7528"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/MugWeb%E6%A1%86%E6%9E%B6/#_5","text":"pip install -r requirements.txt \u542f\u52a8 python app/manage.py runserver [--port 19999 --dev true] \u8bbf\u95ee\u6e38\u89c8\u5668 http://0.0.0.0:19999/","title":"\u542f\u52a8\u670d\u52a1"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/MugWeb%E6%A1%86%E6%9E%B6/#_6","text":"python app/manage.py test","title":"\u5355\u5143\u6d4b\u8bd5"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/stock-starer%E8%82%A1%E7%A5%A8%E7%9B%AF%E7%9B%98/readme/","text":"Stock Starer\u80a1\u7968\u76ef\u76d8 \u4e00\u4e2a\u4e1a\u4f59\u5c0f\u9879\u76ee\uff0c\u7528\u4e8e\u76d1\u63a7\u6307\u5b9a\u80a1\u7968\u7684\u6210\u4ea4\u6307\u6807\uff0c\u89e6\u53d1\u4e8b\u4ef6\u7684\u4e3b\u52a8\u901a\u77e5 \u6e90\u7801 ! https://github.com/jeffchen81/stock-starer \u8bbe\u8ba1\u8bf4\u660e \u573a\u666f \u5b9a\u65f6\u4efb\u52a11\uff1a\u901a\u8fc7\u7f51\u4e0aOpen API\uff0c\u6293\u53d6\u6307\u5b9a\u80a1\u7968\u7684\u5373\u65f6\u4ea4\u6613\u4fe1\u606f\uff0c\u683c\u5f0f\u5316\u540e\u5b58\u5165\u539f\u59cb\u6570\u636e\u8868 \u5b9a\u65f6\u4efb\u52a12\uff1a\u6839\u636e\u6307\u6807\u516c\u5f0f\uff0c\u8ba1\u7b97\u51fa\u65b0\u7684\u6307\u6807\u6570\u636e\uff0c\u5b58\u5165\u6307\u6807\u6570\u636e\u8868 \u5b9a\u65f6\u4efb\u52a13\uff1a\u5224\u65ad\u6307\u6807\u6570\u636e\u662f\u5426\u89e6\u53d1\u63d0\u9192\u4e8b\u4ef6\uff0c\u5982\u89e6\u53d1\u5c31\u53d1\u90ae\u4ef6\u7ed9\u7528\u6237 \uff08\u53ef\u9009\uff09\u53ef\u89c6\u5316\u56fe\u8868\uff1a\u6307\u5b9a\u80a1\u7968\u7684\u6307\u6807\u8d8b\u52bf\u56fe \u6280\u672f\u9009\u578b \u5f00\u53d1\u8bed\u8a00\uff1apython2.7 \u6570\u636e\u5e93\uff1asqlite \u4efb\u52a1\u8c03\u5ea6\u5668\uff1acrontab \u80a1\u7968\u6307\u6807\uff1aMACD \u6570\u636e\u6a21\u578b","title":"Stock Starer\u80a1\u7968\u76ef\u76d8"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/stock-starer%E8%82%A1%E7%A5%A8%E7%9B%AF%E7%9B%98/readme/#stock-starer","text":"\u4e00\u4e2a\u4e1a\u4f59\u5c0f\u9879\u76ee\uff0c\u7528\u4e8e\u76d1\u63a7\u6307\u5b9a\u80a1\u7968\u7684\u6210\u4ea4\u6307\u6807\uff0c\u89e6\u53d1\u4e8b\u4ef6\u7684\u4e3b\u52a8\u901a\u77e5","title":"Stock Starer\u80a1\u7968\u76ef\u76d8"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/stock-starer%E8%82%A1%E7%A5%A8%E7%9B%AF%E7%9B%98/readme/#_1","text":"! https://github.com/jeffchen81/stock-starer","title":"\u6e90\u7801"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/stock-starer%E8%82%A1%E7%A5%A8%E7%9B%AF%E7%9B%98/readme/#_2","text":"","title":"\u8bbe\u8ba1\u8bf4\u660e"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/stock-starer%E8%82%A1%E7%A5%A8%E7%9B%AF%E7%9B%98/readme/#_3","text":"\u5b9a\u65f6\u4efb\u52a11\uff1a\u901a\u8fc7\u7f51\u4e0aOpen API\uff0c\u6293\u53d6\u6307\u5b9a\u80a1\u7968\u7684\u5373\u65f6\u4ea4\u6613\u4fe1\u606f\uff0c\u683c\u5f0f\u5316\u540e\u5b58\u5165\u539f\u59cb\u6570\u636e\u8868 \u5b9a\u65f6\u4efb\u52a12\uff1a\u6839\u636e\u6307\u6807\u516c\u5f0f\uff0c\u8ba1\u7b97\u51fa\u65b0\u7684\u6307\u6807\u6570\u636e\uff0c\u5b58\u5165\u6307\u6807\u6570\u636e\u8868 \u5b9a\u65f6\u4efb\u52a13\uff1a\u5224\u65ad\u6307\u6807\u6570\u636e\u662f\u5426\u89e6\u53d1\u63d0\u9192\u4e8b\u4ef6\uff0c\u5982\u89e6\u53d1\u5c31\u53d1\u90ae\u4ef6\u7ed9\u7528\u6237 \uff08\u53ef\u9009\uff09\u53ef\u89c6\u5316\u56fe\u8868\uff1a\u6307\u5b9a\u80a1\u7968\u7684\u6307\u6807\u8d8b\u52bf\u56fe","title":"\u573a\u666f"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/stock-starer%E8%82%A1%E7%A5%A8%E7%9B%AF%E7%9B%98/readme/#_4","text":"\u5f00\u53d1\u8bed\u8a00\uff1apython2.7 \u6570\u636e\u5e93\uff1asqlite \u4efb\u52a1\u8c03\u5ea6\u5668\uff1acrontab \u80a1\u7968\u6307\u6807\uff1aMACD","title":"\u6280\u672f\u9009\u578b"},{"location":"%E8%87%AA%E7%A0%94%E9%A1%B9%E7%9B%AE/stock-starer%E8%82%A1%E7%A5%A8%E7%9B%AF%E7%9B%98/readme/#_5","text":"","title":"\u6570\u636e\u6a21\u578b"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/","text":"\u8bc1\u5238\u6295\u8d44\u57fa\u91d1 \u4e3a\u4e86\u8003\u300a\u57fa\u91d1\u4ece\u4e1a\u8d44\u683c\u8bc1\u300b\u7684\u8bfb\u4e66\u7b14\u8bb0","title":"\u8bc1\u5238\u6295\u8d44\u57fa\u91d1"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/#_1","text":"\u4e3a\u4e86\u8003\u300a\u57fa\u91d1\u4ece\u4e1a\u8d44\u683c\u8bc1\u300b\u7684\u8bfb\u4e66\u7b14\u8bb0","title":"\u8bc1\u5238\u6295\u8d44\u57fa\u91d1"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/%E8%A1%8C%E4%B8%9A%E6%A6%82%E8%BF%B0/","text":"\u884c\u4e1a\u6982\u8ff0 \u91d1\u878d\u5e02\u573a \u8d44\u4ea7\u7ba1\u7406 \u6295\u8d44\u57fa\u91d1 \u5c45\u6c11\u7406\u8d22&\u91d1\u878d\u5e02\u573a \u5c45\u6c11\u7406\u8d22\uff1a * \u91d1\u878d\uff1a \u8d27\u5e01\u8d44\u91d1\u7684\u901a\u878d\uff0c\u8d27\u5e01\u8d44\u91d1\u6765\u6e90\u4e8e\u5c45\u6c11\u4ece\u4e8b\u7684\u751f\u4ea7\u6d3b\u52a8\u3002\u65e5\u5e38\u6536\u5165\u3001\u652f\u51fa\u3001\u50a8\u84c4\u3001\u6295\u8d44\u7b49\u662f\u7ec4\u6210\u90e8\u5206 * \u7406\u8d22\uff1a \u5bf9\u8d22\u52a1\u8fdb\u884c\u7ba1\u7406\uff0c\u4ee5\u5b9e\u73b0\u8d22\u4ea7\u7684\u4fdd\u503c\u3001\u5347\u503c\uff1b\u4e3b\u8981\u662f\u50a8\u84c4\u548c\u7406\u8d222\u7c7b * \u50a8\u84c4\uff1a \u5c45\u6c11\u6682\u65f6\u4e0d\u7528\u3001\u7ed3\u4f59\u7684\u8d27\u5e01\u6536\u5165\u5b58\u94f6\u884c\uff08\u6216\u5176\u4ed6\u91d1\u878d\u673a\u6784\uff09\u7684\u5b58\u6b3e\u6d3b\u52a8\uff0c\u7279\u5f81\u662f\u4fdd\u503c\u6027\uff08\u672c\u91d1\u5b89\u5168\uff09 * \u6295\u8d44\uff1a \u6295\u8d44\u8005\u5f53\u671f\u6295\u5165\u4e00\u5b9a\u6570\u989d\u7684\u8d44\u91d1\uff0c\u671f\u671b\u5728\u672a\u6765\u6536\u83b7\u66f4\u591a\u56de\u62a5\uff0c\u5176\u80fd\u8865\u507f\u6295\u8d44\u8d44\u91d1\u88ab\u5360\u7528\u7684\u65f6\u95f4\u3001\u9884\u671f\u7684\u901a\u8d27\u81a8\u80c0\u7387\u3001\u66f4\u591a\u7684\u672a\u6765\u6536\u76ca\uff0c\u5177\u6709\u4e0d\u786e\u5b9a\u6027 \u91d1\u878d\u5e02\u573a\uff1a * \u5b9a\u4e49\uff1a\u8d44\u91d1\u4f9b\u5e94\u8005\u3001\u8d44\u91d1\u9700\u6c42\u8005\u901a\u8fc7\u91d1\u878d\u5de5\u5177\u8fdb\u884c\u4ea4\u6613\u800c\u8d27\u5e01\u8d44\u91d1\u901a\u878d\u5e02\u573a * \u5206\u7c7b\uff1a * \u4ea4\u6613\u5de5\u5177\u7684\u4e0d\u540c\u671f\u9650\uff1a * \u8d27\u5e01\uff08\u77ed\u671f\u91d1\u878d\uff09\u5e02\u573a\uff1a \u4e0d\u8d85\u8fc7\u4e00\u5e74\uff0c\u540c\u4e1a\u62c6\u501f\u3001\u56de\u8d2d\u3001\u7968\u636e\u3001\u5927\u9762\u989d\u53ef\u8f6c\u8ba9\u5b58\u5355\u7b49\u5e02\u573a * \u8d44\u672c\uff08\u957f\u671f\u91d1\u878d\uff09\u5e02\u573a\uff1a \u4e00\u5e74\u4ee5\u4e0a\u6709\u4ef7\u8bc1\u5238\u4e3a\u4ea4\u6613\u5de5\u5177\uff0c\u94f6\u884c\u4e2d\u957f\u671f\u5b58\u8d37\u6b3e\u3001\u6709\u4ef7\u8bc1\u5238\uff08\u4e2d\u957f\u671f\u503a\u5238\u548c\u80a1\u7968\uff09\u5e02\u573a * \u4e0d\u540c\u4ea4\u6613\u6807\u7684\u7269\uff1a * \u7968\u636e\u5e02\u573a\uff1a \u7968\u636e\u627f\u5151\u3001\u8d34\u73b0\uff0c\u662f\u8d27\u5e01\u5e02\u573a\u7684\u91cd\u8981\u7ec4\u6210 * \u8bc1\u5238\u5e02\u573a\uff1a \u6709\u4ef7\u8bc1\u5238\u53d1\u884c\u548c\u8f6c\u8ba9\u6d41\u901a * \u80a1\u7968\uff1a \u80a1\u4efd\u6709\u9650\u516c\u53f8\u53d1\u884c\u65b0\u80a1\u7968\u7684\u53d1\u884c\uff08\u80a1\u7968\u521d\u7ea7\uff09\u5e02\u573a\uff1b\u5df2\u53d1\u884c\u80a1\u7968\u7684\u8f6c\u8ba9\u6d41\u901a\u7684\u80a1\u7968\u4e8c\u7ea7\u5e02\u573a * \u503a\u5238\uff1a \u653f\u5e9c\u503a\u5238\u3001\u4f01\u4e1a\u503a\u5238\u3001\u91d1\u878d\u503a\u5238 * \u57fa\u91d1\uff1a * \u884d\u751f\u5de5\u5177\u5e02\u573a\uff1a \u884d\u751f\u91d1\u878d\u5de5\u5177\u8fdb\u884c\u4ea4\u6613\uff0c\u5957\u671f\u4fdd\u503c\u3001\u9632\u8303\u98ce\u9669\u4f5c\u7528 * \u8fdc\u671f\u5408\u7ea6 * \u671f\u8d27\u5408\u7ea6 * \u671f\u6743\u4ea4\u6613 * \u4e92\u6362\u534f\u8bae * \u5916\u6c47\u5e02\u573a\uff1a\u592e\u884c\u3001\u94f6\u884c\u3001\u7ecf\u7eaa\u4eba\u3001\u5ba2\u6237\u7684\u5916\u6c47\u4e70\u5356\u3001\u7ecf\u8425\u6d3b\u52a8\u7684\u603b\u548c * \u9ec4\u91d1\u5e02\u573a\uff1a \u9ec4\u91d1\u4ecd\u662f\u56fd\u9645\u50a8\u5907\u8d44\u4ea7\u4e4b\u4e00\uff0c\u5728\u652f\u4ed8\u4e2d\u6709\u5730\u4f4d * \u4ea4\u5272\u671f\u9650\uff1a * \u73b0\u8d27\u5e02\u573a\uff1a \u534f\u8bae\u8fbe\u6210\u540e2\u4e2a\u4ea4\u6613\u65e5\u5185\u4ea4\u5272\uff0c * \u671f\u8d27\u5e02\u573a\uff1a TODO \u91d1\u878d\u8d44\u4ea7&\u8d44\u4ea7\u7ba1\u7406\u884c\u4e1a \u4e2d\u56fd\u8d44\u4ea7\u7ba1\u7406\u884c\u4e1a\u73b0\u72b6 \u6295\u8d44\u57fa\u91d1\u7b80\u4ecb","title":"\u884c\u4e1a\u6982\u8ff0"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/%E8%A1%8C%E4%B8%9A%E6%A6%82%E8%BF%B0/#_1","text":"","title":"\u884c\u4e1a\u6982\u8ff0"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/%E8%A1%8C%E4%B8%9A%E6%A6%82%E8%BF%B0/#_2","text":"","title":"\u91d1\u878d\u5e02\u573a \u8d44\u4ea7\u7ba1\u7406 \u6295\u8d44\u57fa\u91d1"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/%E8%A1%8C%E4%B8%9A%E6%A6%82%E8%BF%B0/#_3","text":"\u5c45\u6c11\u7406\u8d22\uff1a * \u91d1\u878d\uff1a \u8d27\u5e01\u8d44\u91d1\u7684\u901a\u878d\uff0c\u8d27\u5e01\u8d44\u91d1\u6765\u6e90\u4e8e\u5c45\u6c11\u4ece\u4e8b\u7684\u751f\u4ea7\u6d3b\u52a8\u3002\u65e5\u5e38\u6536\u5165\u3001\u652f\u51fa\u3001\u50a8\u84c4\u3001\u6295\u8d44\u7b49\u662f\u7ec4\u6210\u90e8\u5206 * \u7406\u8d22\uff1a \u5bf9\u8d22\u52a1\u8fdb\u884c\u7ba1\u7406\uff0c\u4ee5\u5b9e\u73b0\u8d22\u4ea7\u7684\u4fdd\u503c\u3001\u5347\u503c\uff1b\u4e3b\u8981\u662f\u50a8\u84c4\u548c\u7406\u8d222\u7c7b * \u50a8\u84c4\uff1a \u5c45\u6c11\u6682\u65f6\u4e0d\u7528\u3001\u7ed3\u4f59\u7684\u8d27\u5e01\u6536\u5165\u5b58\u94f6\u884c\uff08\u6216\u5176\u4ed6\u91d1\u878d\u673a\u6784\uff09\u7684\u5b58\u6b3e\u6d3b\u52a8\uff0c\u7279\u5f81\u662f\u4fdd\u503c\u6027\uff08\u672c\u91d1\u5b89\u5168\uff09 * \u6295\u8d44\uff1a \u6295\u8d44\u8005\u5f53\u671f\u6295\u5165\u4e00\u5b9a\u6570\u989d\u7684\u8d44\u91d1\uff0c\u671f\u671b\u5728\u672a\u6765\u6536\u83b7\u66f4\u591a\u56de\u62a5\uff0c\u5176\u80fd\u8865\u507f\u6295\u8d44\u8d44\u91d1\u88ab\u5360\u7528\u7684\u65f6\u95f4\u3001\u9884\u671f\u7684\u901a\u8d27\u81a8\u80c0\u7387\u3001\u66f4\u591a\u7684\u672a\u6765\u6536\u76ca\uff0c\u5177\u6709\u4e0d\u786e\u5b9a\u6027 \u91d1\u878d\u5e02\u573a\uff1a * \u5b9a\u4e49\uff1a\u8d44\u91d1\u4f9b\u5e94\u8005\u3001\u8d44\u91d1\u9700\u6c42\u8005\u901a\u8fc7\u91d1\u878d\u5de5\u5177\u8fdb\u884c\u4ea4\u6613\u800c\u8d27\u5e01\u8d44\u91d1\u901a\u878d\u5e02\u573a * \u5206\u7c7b\uff1a * \u4ea4\u6613\u5de5\u5177\u7684\u4e0d\u540c\u671f\u9650\uff1a * \u8d27\u5e01\uff08\u77ed\u671f\u91d1\u878d\uff09\u5e02\u573a\uff1a \u4e0d\u8d85\u8fc7\u4e00\u5e74\uff0c\u540c\u4e1a\u62c6\u501f\u3001\u56de\u8d2d\u3001\u7968\u636e\u3001\u5927\u9762\u989d\u53ef\u8f6c\u8ba9\u5b58\u5355\u7b49\u5e02\u573a * \u8d44\u672c\uff08\u957f\u671f\u91d1\u878d\uff09\u5e02\u573a\uff1a \u4e00\u5e74\u4ee5\u4e0a\u6709\u4ef7\u8bc1\u5238\u4e3a\u4ea4\u6613\u5de5\u5177\uff0c\u94f6\u884c\u4e2d\u957f\u671f\u5b58\u8d37\u6b3e\u3001\u6709\u4ef7\u8bc1\u5238\uff08\u4e2d\u957f\u671f\u503a\u5238\u548c\u80a1\u7968\uff09\u5e02\u573a * \u4e0d\u540c\u4ea4\u6613\u6807\u7684\u7269\uff1a * \u7968\u636e\u5e02\u573a\uff1a \u7968\u636e\u627f\u5151\u3001\u8d34\u73b0\uff0c\u662f\u8d27\u5e01\u5e02\u573a\u7684\u91cd\u8981\u7ec4\u6210 * \u8bc1\u5238\u5e02\u573a\uff1a \u6709\u4ef7\u8bc1\u5238\u53d1\u884c\u548c\u8f6c\u8ba9\u6d41\u901a * \u80a1\u7968\uff1a \u80a1\u4efd\u6709\u9650\u516c\u53f8\u53d1\u884c\u65b0\u80a1\u7968\u7684\u53d1\u884c\uff08\u80a1\u7968\u521d\u7ea7\uff09\u5e02\u573a\uff1b\u5df2\u53d1\u884c\u80a1\u7968\u7684\u8f6c\u8ba9\u6d41\u901a\u7684\u80a1\u7968\u4e8c\u7ea7\u5e02\u573a * \u503a\u5238\uff1a \u653f\u5e9c\u503a\u5238\u3001\u4f01\u4e1a\u503a\u5238\u3001\u91d1\u878d\u503a\u5238 * \u57fa\u91d1\uff1a * \u884d\u751f\u5de5\u5177\u5e02\u573a\uff1a \u884d\u751f\u91d1\u878d\u5de5\u5177\u8fdb\u884c\u4ea4\u6613\uff0c\u5957\u671f\u4fdd\u503c\u3001\u9632\u8303\u98ce\u9669\u4f5c\u7528 * \u8fdc\u671f\u5408\u7ea6 * \u671f\u8d27\u5408\u7ea6 * \u671f\u6743\u4ea4\u6613 * \u4e92\u6362\u534f\u8bae * \u5916\u6c47\u5e02\u573a\uff1a\u592e\u884c\u3001\u94f6\u884c\u3001\u7ecf\u7eaa\u4eba\u3001\u5ba2\u6237\u7684\u5916\u6c47\u4e70\u5356\u3001\u7ecf\u8425\u6d3b\u52a8\u7684\u603b\u548c * \u9ec4\u91d1\u5e02\u573a\uff1a \u9ec4\u91d1\u4ecd\u662f\u56fd\u9645\u50a8\u5907\u8d44\u4ea7\u4e4b\u4e00\uff0c\u5728\u652f\u4ed8\u4e2d\u6709\u5730\u4f4d * \u4ea4\u5272\u671f\u9650\uff1a * \u73b0\u8d27\u5e02\u573a\uff1a \u534f\u8bae\u8fbe\u6210\u540e2\u4e2a\u4ea4\u6613\u65e5\u5185\u4ea4\u5272\uff0c * \u671f\u8d27\u5e02\u573a\uff1a TODO","title":"\u5c45\u6c11\u7406\u8d22&amp;\u91d1\u878d\u5e02\u573a"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/%E8%A1%8C%E4%B8%9A%E6%A6%82%E8%BF%B0/#_4","text":"","title":"\u91d1\u878d\u8d44\u4ea7&amp;\u8d44\u4ea7\u7ba1\u7406\u884c\u4e1a"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/%E8%A1%8C%E4%B8%9A%E6%A6%82%E8%BF%B0/#_5","text":"","title":"\u4e2d\u56fd\u8d44\u4ea7\u7ba1\u7406\u884c\u4e1a\u73b0\u72b6"},{"location":"%E8%AF%BB%E4%B9%A6%E5%92%8C%E8%AE%A4%E8%AF%81/%E5%9F%BA%E9%87%91/%E8%A1%8C%E4%B8%9A%E6%A6%82%E8%BF%B0/#_6","text":"","title":"\u6295\u8d44\u57fa\u91d1\u7b80\u4ecb"}]}